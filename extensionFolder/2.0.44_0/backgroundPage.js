/*! For license information please see backgroundPage.js.LICENSE.txt */
(()=>{var t,e,n,r,i={4148:(t,e,n)=>{"use strict";n.d(e,{V:()=>p});var r=n(9293),i=function(){function t(){this.ua=new r.UAParser("undefined"!=typeof navigator?navigator.userAgent:null).getResult()}return t.prototype.getApplicationContext=function(){return{versionName:this.versionName,language:a(),platform:"Web",os:o(this.ua),deviceModel:s(this.ua)}},t}(),o=function(t){var e,n;return[null===(e=t.browser)||void 0===e?void 0:e.name,null===(n=t.browser)||void 0===n?void 0:n.major].filter((function(t){return null!=t})).join(" ")},s=function(t){var e;return null===(e=t.os)||void 0===e?void 0:e.name},a=function(){return"undefined"!=typeof navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||""},c=function(){function t(){this.queue=[]}return t.prototype.logEvent=function(t){this.receiver?this.receiver(t):this.queue.length<512&&this.queue.push(t)},t.prototype.setEventReceiver=function(t){this.receiver=t,this.queue.length>0&&(this.queue.forEach((function(e){t(e)})),this.queue=[])},t}(),u=function(){return u=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},u.apply(this,arguments)},l=function(t,e){var n=typeof t;if(n!==typeof e)return!1;for(var r=0,i=["string","number","boolean","undefined"];r<i.length;r++){if(i[r]===n)return t===e}if(null==t&&null==e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;var o=Array.isArray(t),s=Array.isArray(e);if(o!==s)return!1;if(!o||!s){var a=Object.keys(t).sort(),c=Object.keys(e).sort();if(!l(a,c))return!1;var u=!0;return Object.keys(t).forEach((function(n){l(t[n],e[n])||(u=!1)})),u}for(var h=0;h<t.length;h++)if(!l(t[h],e[h]))return!1;return!0};Object.entries||(Object.entries=function(t){for(var e=Object.keys(t),n=e.length,r=new Array(n);n--;)r[n]=[e[n],t[e[n]]];return r});var h=function(){function t(){this.identity={userProperties:{}},this.listeners=new Set}return t.prototype.editIdentity=function(){var t=this,e=u({},this.identity.userProperties),n=u(u({},this.identity),{userProperties:e});return{setUserId:function(t){return n.userId=t,this},setDeviceId:function(t){return n.deviceId=t,this},setUserProperties:function(t){return n.userProperties=t,this},updateUserProperties:function(t){for(var e=n.userProperties||{},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r],s=o[0],a=o[1];switch(s){case"$set":for(var c=0,u=Object.entries(a);c<u.length;c++){var l=u[c],h=l[0],d=l[1];e[h]=d}break;case"$unset":for(var p=0,f=Object.keys(a);p<f.length;p++){delete e[h=f[p]]}break;case"$clearAll":e={}}}return n.userProperties=e,this},commit:function(){return t.setIdentity(n),this}}},t.prototype.getIdentity=function(){return u({},this.identity)},t.prototype.setIdentity=function(t){var e=u({},this.identity);this.identity=u({},t),l(e,this.identity)||this.listeners.forEach((function(e){e(t)}))},t.prototype.addIdentityListener=function(t){this.listeners.add(t)},t.prototype.removeIdentityListener=function(t){this.listeners.delete(t)},t}(),d="undefined"!=typeof globalThis?globalThis:void 0!==n.g?n.g:self,p=function(){function t(){this.identityStore=new h,this.eventBridge=new c,this.applicationContextProvider=new i}return t.getInstance=function(e){return d.analyticsConnectorInstances||(d.analyticsConnectorInstances={}),d.analyticsConnectorInstances[e]||(d.analyticsConnectorInstances[e]=new t),d.analyticsConnectorInstances[e]},t}()},9293:function(t,e,n){var r;!function(i,o){"use strict";var s="function",a="undefined",c="object",u="string",l="model",h="name",d="type",p="vendor",f="version",_="architecture",g="console",v="mobile",m="tablet",y="smarttv",E="wearable",I="embedded",b="Amazon",S="Apple",T="ASUS",w="BlackBerry",O="Browser",C="Chrome",A="Firefox",R="Google",k="Huawei",D="LG",N="Microsoft",P="Motorola",L="Opera",x="Samsung",U="Sony",F="Xiaomi",M="Zebra",H="Facebook",j=function(t){for(var e={},n=0;n<t.length;n++)e[t[n].toUpperCase()]=t[n];return e},B=function(t,e){return typeof t===u&&-1!==G(e).indexOf(G(t))},G=function(t){return t.toLowerCase()},W=function(t,e){if(typeof t===u)return t=t.replace(/^\s\s*/,"").replace(/\s\s*$/,""),typeof e===a?t:t.substring(0,275)},z=function(t,e){for(var n,r,i,a,u,l,h=0;h<e.length&&!u;){var d=e[h],p=e[h+1];for(n=r=0;n<d.length&&!u;)if(u=d[n++].exec(t))for(i=0;i<p.length;i++)l=u[++r],typeof(a=p[i])===c&&a.length>0?2===a.length?typeof a[1]==s?this[a[0]]=a[1].call(this,l):this[a[0]]=a[1]:3===a.length?typeof a[1]!==s||a[1].exec&&a[1].test?this[a[0]]=l?l.replace(a[1],a[2]):o:this[a[0]]=l?a[1].call(this,l,a[2]):o:4===a.length&&(this[a[0]]=l?a[3].call(this,l.replace(a[1],a[2])):o):this[a]=l||o;h+=2}},V=function(t,e){for(var n in e)if(typeof e[n]===c&&e[n].length>0){for(var r=0;r<e[n].length;r++)if(B(e[n][r],t))return"?"===n?o:n}else if(B(e[n],t))return"?"===n?o:n;return t},q={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},$={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[f,[h,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[f,[h,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[h,f],[/opios[\/ ]+([\w\.]+)/i],[f,[h,L+" Mini"]],[/\bopr\/([\w\.]+)/i],[f,[h,L]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[h,f],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[f,[h,"UC"+O]],[/\bqbcore\/([\w\.]+)/i],[f,[h,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[f,[h,"WeChat"]],[/konqueror\/([\w\.]+)/i],[f,[h,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[f,[h,"IE"]],[/yabrowser\/([\w\.]+)/i],[f,[h,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[h,/(.+)/,"$1 Secure "+O],f],[/\bfocus\/([\w\.]+)/i],[f,[h,A+" Focus"]],[/\bopt\/([\w\.]+)/i],[f,[h,L+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[f,[h,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[f,[h,"Dolphin"]],[/coast\/([\w\.]+)/i],[f,[h,L+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[f,[h,"MIUI "+O]],[/fxios\/([-\w\.]+)/i],[f,[h,A]],[/\bqihu|(qi?ho?o?|360)browser/i],[[h,"360 "+O]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[h,/(.+)/,"$1 "+O],f],[/(comodo_dragon)\/([\w\.]+)/i],[[h,/_/g," "],f],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[h,f],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[h],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[h,H],f],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[h,f],[/\bgsa\/([\w\.]+) .*safari\//i],[f,[h,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[f,[h,C+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[h,C+" WebView"],f],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[f,[h,"Android "+O]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[h,f],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[f,[h,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[f,h],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[h,[f,V,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[h,f],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[h,"Netscape"],f],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[f,[h,A+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[h,f]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[_,"amd64"]],[/(ia32(?=;))/i],[[_,G]],[/((?:i[346]|x)86)[;\)]/i],[[_,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[_,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[_,"armhf"]],[/windows (ce|mobile); ppc;/i],[[_,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[_,/ower/,"",G]],[/(sun4\w)[;\)]/i],[[_,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[_,G]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[l,[p,x],[d,m]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[l,[p,x],[d,v]],[/((ipod|iphone)\d+,\d+)/i],[l,[p,S],[d,v]],[/(ipad\d+,\d+)/i],[l,[p,S],[d,m]],[/\((ip(?:hone|od)[\w ]*);/i],[l,[p,S],[d,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[l,[p,S],[d,m]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[l,[p,k],[d,m]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[l,[p,k],[d,v]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[l,/_/g," "],[p,F],[d,v]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[l,/_/g," "],[p,F],[d,m]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[l,[p,"OPPO"],[d,v]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[l,[p,"Vivo"],[d,v]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[l,[p,"Realme"],[d,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[l,[p,P],[d,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[l,[p,P],[d,m]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[l,[p,D],[d,m]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[l,[p,D],[d,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[l,[p,"Lenovo"],[d,m]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[l,/_/g," "],[p,"Nokia"],[d,v]],[/(pixel c)\b/i],[l,[p,R],[d,m]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[l,[p,R],[d,v]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[l,[p,U],[d,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[l,"Xperia Tablet"],[p,U],[d,m]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[l,[p,"OnePlus"],[d,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[l,[p,b],[d,m]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[l,/(.+)/g,"Fire Phone $1"],[p,b],[d,v]],[/(playbook);[-\w\),; ]+(rim)/i],[l,p,[d,m]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[l,[p,w],[d,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[l,[p,T],[d,m]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[l,[p,T],[d,v]],[/(nexus 9)/i],[l,[p,"HTC"],[d,m]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony(?!-bra))[-_ ]?([-\w]*)/i],[p,[l,/_/g," "],[d,v]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[l,[p,"Acer"],[d,m]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[l,[p,"Meizu"],[d,v]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[l,[p,"Sharp"],[d,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[p,l,[d,v]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[p,l,[d,m]],[/(surface duo)/i],[l,[p,N],[d,m]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[l,[p,"Fairphone"],[d,v]],[/(u304aa)/i],[l,[p,"AT&T"],[d,v]],[/\bsie-(\w*)/i],[l,[p,"Siemens"],[d,v]],[/\b(rct\w+) b/i],[l,[p,"RCA"],[d,m]],[/\b(venue[\d ]{2,7}) b/i],[l,[p,"Dell"],[d,m]],[/\b(q(?:mv|ta)\w+) b/i],[l,[p,"Verizon"],[d,m]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[l,[p,"Barnes & Noble"],[d,m]],[/\b(tm\d{3}\w+) b/i],[l,[p,"NuVision"],[d,m]],[/\b(k88) b/i],[l,[p,"ZTE"],[d,m]],[/\b(nx\d{3}j) b/i],[l,[p,"ZTE"],[d,v]],[/\b(gen\d{3}) b.+49h/i],[l,[p,"Swiss"],[d,v]],[/\b(zur\d{3}) b/i],[l,[p,"Swiss"],[d,m]],[/\b((zeki)?tb.*\b) b/i],[l,[p,"Zeki"],[d,m]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[p,"Dragon Touch"],l,[d,m]],[/\b(ns-?\w{0,9}) b/i],[l,[p,"Insignia"],[d,m]],[/\b((nxa|next)-?\w{0,9}) b/i],[l,[p,"NextBook"],[d,m]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[p,"Voice"],l,[d,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[p,"LvTel"],l,[d,v]],[/\b(ph-1) /i],[l,[p,"Essential"],[d,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[l,[p,"Envizen"],[d,m]],[/\b(trio[-\w\. ]+) b/i],[l,[p,"MachSpeed"],[d,m]],[/\btu_(1491) b/i],[l,[p,"Rotor"],[d,m]],[/(shield[\w ]+) b/i],[l,[p,"Nvidia"],[d,m]],[/(sprint) (\w+)/i],[p,l,[d,v]],[/(kin\.[onetw]{3})/i],[[l,/\./g," "],[p,N],[d,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[l,[p,M],[d,m]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[l,[p,M],[d,v]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[p,l,[d,g]],[/droid.+; (shield) bui/i],[l,[p,"Nvidia"],[d,g]],[/(playstation [345portablevi]+)/i],[l,[p,U],[d,g]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[l,[p,N],[d,g]],[/smart-tv.+(samsung)/i],[p,[d,y]],[/hbbtv.+maple;(\d+)/i],[[l,/^/,"SmartTV"],[p,x],[d,y]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[p,D],[d,y]],[/(apple) ?tv/i],[p,[l,S+" TV"],[d,y]],[/crkey/i],[[l,C+"cast"],[p,R],[d,y]],[/droid.+aft(\w)( bui|\))/i],[l,[p,b],[d,y]],[/\(dtv[\);].+(aquos)/i],[l,[p,"Sharp"],[d,y]],[/(bravia[\w- ]+) bui/i],[l,[p,U],[d,y]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[p,W],[l,W],[d,y]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[d,y]],[/((pebble))app/i],[p,l,[d,E]],[/droid.+; (glass) \d/i],[l,[p,R],[d,E]],[/droid.+; (wt63?0{2,3})\)/i],[l,[p,M],[d,E]],[/(quest( 2)?)/i],[l,[p,H],[d,E]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[p,[d,I]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[l,[d,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[l,[d,m]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[d,m]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[d,v]],[/(android[-\w\. ]{0,9});.+buil/i],[l,[p,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[f,[h,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[f,[h,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[h,f],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[f,h]],os:[[/microsoft (windows) (vista|xp)/i],[h,f],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[h,[f,V,q]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[h,"Windows"],[f,V,q]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[f,/_/g,"."],[h,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[h,"Mac OS"],[f,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[f,h],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[h,f],[/\(bb(10);/i],[f,[h,w]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[f,[h,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[f,[h,A+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[f,[h,"webOS"]],[/crkey\/([\d\.]+)/i],[f,[h,C+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[h,"Chromium OS"],f],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[h,f],[/(sunos) ?([\w\.\d]*)/i],[[h,"Solaris"],f],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[h,f]]},Y=function(t,e){if(typeof t===c&&(e=t,t=o),!(this instanceof Y))return new Y(t,e).getResult();var n=t||(typeof i!==a&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:""),r=e?function(t,e){var n={};for(var r in t)e[r]&&e[r].length%2==0?n[r]=e[r].concat(t[r]):n[r]=t[r];return n}($,e):$;return this.getBrowser=function(){var t,e={};return e[h]=o,e[f]=o,z.call(e,n,r.browser),e.major=typeof(t=e.version)===u?t.replace(/[^\d\.]/g,"").split(".")[0]:o,e},this.getCPU=function(){var t={};return t[_]=o,z.call(t,n,r.cpu),t},this.getDevice=function(){var t={};return t[p]=o,t[l]=o,t[d]=o,z.call(t,n,r.device),t},this.getEngine=function(){var t={};return t[h]=o,t[f]=o,z.call(t,n,r.engine),t},this.getOS=function(){var t={};return t[h]=o,t[f]=o,z.call(t,n,r.os),t},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(t){return n=typeof t===u&&t.length>275?W(t,275):t,this},this.setUA(n),this};Y.VERSION="0.7.31",Y.BROWSER=j([h,f,"major"]),Y.CPU=j([_]),Y.DEVICE=j([l,p,d,g,v,y,m,E,I]),Y.ENGINE=Y.OS=j([h,f]),typeof e!==a?(t.exports&&(e=t.exports=Y),e.UAParser=Y):n.amdO?(r=function(){return Y}.call(e,n,e,t))===o||(t.exports=r):typeof i!==a&&(i.UAParser=Y);var K=typeof i!==a&&(i.jQuery||i.Zepto);if(K&&!K.ua){var Q=new Y;K.ua=Q.getResult(),K.ua.get=function(){return Q.getUA()},K.ua.set=function(t){Q.setUA(t);var e=Q.getResult();for(var n in e)K.ua[n]=e[n]}}}("object"==typeof window?window:this)},8433:(t,e,n)=>{"use strict";function r(){return"object"==typeof window&&void 0!==(null===window||void 0===window?void 0:window.document)}n.d(e,{XQ:()=>i,kP:()=>r});var i=function(){var t;if(r()){var e=window,n=Array;if(void 0!==e.Prototype&&void 0!==(null===(t=n.prototype)||void 0===t?void 0:t.toJSON))return delete n.prototype.toJSON,!0}return!1}},1330:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=function(t){return function(){return function(e){return function(n){var r=t[n.type];return e(r?r(n):n)}}}}},3974:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_PORT_NAME=e.PATCH_STATE_TYPE=e.STATE_TYPE=e.FETCH_STATE_TYPE=e.DISPATCH_TYPE=void 0;e.DISPATCH_TYPE="chromex.dispatch";e.FETCH_STATE_TYPE="chromex.fetch_state";e.STATE_TYPE="chromex.state";e.PATCH_STATE_TYPE="chromex.patch_state";e.DEFAULT_PORT_NAME="chromex.port_name"},8141:(t,e,n)=>{"use strict";Object.defineProperty(e,"IF",{enumerable:!0,get:function(){return o.default}});var r=a(n(3705)),i=a(n(166)),o=a(n(8596)),s=a(n(1330));function a(t){return t&&t.__esModule?t:{default:t}}},2641:(t,e)=>{"use strict";function n(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),e.withSerializer=e.withDeserializer=e.noop=void 0;var r=function(t){return t};e.noop=r;var i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable})))),i.forEach((function(e){n(t,e,r[e])}))}return t}({},t,t.payload?{payload:e(t.payload)}:{})},o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,n=arguments.length>2?arguments[2]:void 0;return n?function(r){for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];return n.apply(void 0,[r].concat(s))?t.apply(void 0,[i(r,e)].concat(s)):t.apply(void 0,[r].concat(s))}:function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return t.apply(void 0,[i(n,e)].concat(o))}};e.withDeserializer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;return function(e){return function(n,r){return e(o(n,t,r))}}};e.withSerializer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];if(o.length<=n)throw new Error("Message in request could not be serialized. "+"Expected message in position ".concat(n," but only received ").concat(o.length," args."));return o[n]=i(o[n],t),e.apply(void 0,o)}}}},3705:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=c(n(5089)),i=n(3974),o=n(2641),s=c(n(1184)),a=n(560);function c(t){return t&&t.__esModule?t:{default:t}}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l="\nLooks like there is an error in the background page. You might want to inspect your background page for more details.\n",h={portName:i.DEFAULT_PORT_NAME,state:{},extensionId:null,serializer:o.noop,deserializer:o.noop,patchStrategy:s.default},d=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,r=n.portName,s=void 0===r?h.portName:r,c=n.state,u=void 0===c?h.state:c,l=n.extensionId,d=void 0===l?h.extensionId:l,p=n.serializer,f=void 0===p?h.serializer:p,_=n.deserializer,g=void 0===_?h.deserializer:_,v=n.patchStrategy,m=void 0===v?h.patchStrategy:v;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!s)throw new Error("portName is required in options");if("function"!=typeof f)throw new Error("serializer must be a function");if("function"!=typeof g)throw new Error("deserializer must be a function");if("function"!=typeof m)throw new Error("patchStrategy must be one of the included patching strategies or a custom patching function");this.portName=s,this.readyResolved=!1,this.readyPromise=new Promise((function(t){return e.readyResolve=t})),this.browserAPI=(0,a.getBrowserAPI)(),this.extensionId=d,this.initializeStore=this.initializeStore.bind(this),this.browserAPI.runtime.sendMessage(this.extensionId,{type:i.FETCH_STATE_TYPE,portName:s},void 0,this.initializeStore),this.deserializer=g,this.serializedPortListener=(0,o.withDeserializer)(g)((function(){var t;return(t=e.browserAPI.runtime.onMessage).addListener.apply(t,arguments)})),this.serializedMessageSender=(0,o.withSerializer)(f)((function(){var t;return(t=e.browserAPI.runtime).sendMessage.apply(t,arguments)}),1),this.listeners=[],this.state=u,this.patchStrategy=m,this.serializedPortListener((function(t){if(t.portName===e.portName)switch(t.type){case i.STATE_TYPE:e.replaceState(t.payload),e.readyResolved||(e.readyResolved=!0,e.readyResolve());break;case i.PATCH_STATE_TYPE:e.patchState(t.payload)}})),this.dispatch=this.dispatch.bind(this)}var e,n,s;return e=t,n=[{key:"ready",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null!==t?this.readyPromise.then(t):this.readyPromise}},{key:"subscribe",value:function(t){var e=this;return this.listeners.push(t),function(){e.listeners=e.listeners.filter((function(e){return e!==t}))}}},{key:"patchState",value:function(t){this.state=this.patchStrategy(this.state,t),this.listeners.forEach((function(t){return t()}))}},{key:"replaceState",value:function(t){this.state=t,this.listeners.forEach((function(t){return t()}))}},{key:"getState",value:function(){return this.state}},{key:"replaceReducer",value:function(){}},{key:"dispatch",value:function(t){var e=this;return new Promise((function(n,o){e.serializedMessageSender(e.extensionId,{type:i.DISPATCH_TYPE,portName:e.portName,payload:t},null,(function(t){if(t){var i=t.error,s=t.value;if(i){var a=new Error("".concat(l).concat(i));o((0,r.default)(a,i))}else n(s&&s.payload)}else{var c=e.browserAPI.runtime.lastError,u=new Error("".concat(l).concat(c));o((0,r.default)(u,c))}}))}))}},{key:"initializeStore",value:function(t){t&&t.type===i.FETCH_STATE_TYPE&&(this.replaceState(t.payload),this.readyResolved||(this.readyResolved=!0,this.readyResolve()))}}],n&&u(e.prototype,n),s&&u(e,s),t}();e.default=d},166:(t,e)=>{"use strict";function n(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return 0===e.length?function(t){return t}:1===e.length?e[0]:e.reduce((function(t,e){return function(){return t(e.apply(void 0,arguments))}}))}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];var o=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},s={getState:t.getState.bind(t),dispatch:function(){return o.apply(void 0,arguments)}};return r=(r||[]).map((function(t){return t(s)})),o=n.apply(void 0,function(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(r))(t.dispatch),t.dispatch=o,t}},7320:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DIFF_STATUS_ARRAY_UPDATED=e.DIFF_STATUS_KEYS_UPDATED=e.DIFF_STATUS_REMOVED=e.DIFF_STATUS_UPDATED=void 0;e.DIFF_STATUS_UPDATED="updated";e.DIFF_STATUS_REMOVED="removed";e.DIFF_STATUS_KEYS_UPDATED="updated_keys";e.DIFF_STATUS_ARRAY_UPDATED="updated_array"},6674:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.applyPatch=function(t,e){for(var n=[],r=0,i=0;i<e.length;++i){var o=e[i];r!==o.oldPos&&n.push(t.slice(r,o.oldPos)),"add"===o.type?(n.push(o.items),r=o.oldPos):r=o.items?o.oldPos+o.items.length:o.oldPos+o.length}return r!==t.length&&n.push(t.slice(r)),[].concat.apply([],n)}},8781:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.diff=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t,e){return t===e},r={removed:[],added:[]};return(0,i.default)(t,e,n,(function(t,e,n,i,o,s,a){if("add"===t)for(var c=s;c<a;++c)r.added.push(o[c]);else if("remove"===t)for(var u=n;u<i;++u)r.removed.push(e[u])})),r};var r,i=(r=n(1258))&&r.__esModule?r:{default:r}},1258:(t,e)=>{"use strict";function n(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n,o){var s=function(t,e,n){for(var r=t.length,i=e.length,o=r+i,s={1:0},a=0;a<=o;++a)for(var c=-a;c<=a;c+=2){for(var u=void 0,l=(u=c===-a||c!==a&&s[c-1]+1<s[c+1]?s[c+1]:s[c-1]+1)-c;u<r&&l<i&&n(t[u],e[l]);)u++,l++;if(u===r&&l===i)return a;s[c]=u}return-1}(t,e,n);i(t,0,t.length,e,0,e.length,s,r.diagonal,r.all,n,o)};var r={none:0,horizontal:1,vertical:2,diagonal:4};function i(t,e,o,s,a,c,u,l,h,d,p){var f,_;if(0!==u)if(u!==o-e+(c-a)){for(var g=o-e,v=c-a,m=Math.floor(v/2),y={},E=-u-1;E<=u+1;++E)y[E]={d:1/0,segments:0,direct:r.none};for(var I=(n(f={},-u-1,{d:1/0,segments:0,direct:r.none}),n(f,u+1,{d:1/0,segments:0,direct:r.none}),f),b=0;b<=m;++b){var S=[I,y];y=S[0],I=S[1];for(var T=function(n){var i=b+n;if(0===b&&0===i)return y[n]={d:0,segments:0,direct:l},"continue";var o=[{direct:r.horizontal,d:y[n-1].d+1,segments:y[n-1].segments+(y[n-1].direct&r.horizontal?0:1)},{direct:r.vertical,d:I[n+1].d+1,segments:I[n+1].segments+(I[n+1].direct&r.vertical?0:1)}];i>0&&i<=g&&b>0&&b<=v&&d(t[e+i-1],s[a+b-1])&&o.push({direct:r.diagonal,d:I[n].d,segments:I[n].segments+(I[n].direct&r.diagonal?0:1)});var c=o.reduce((function(t,e){return t.d>e.d||t.d===e.d&&t.segments>e.segments?e:t}));o.forEach((function(t){c.d===t.d&&c.segments===t.segments&&(c.direct|=t.direct)})),y[n]=c},w=-u;w<=u;++w)T(w)}for(var O={},C=-u-1;C<=u+1;++C)O[C]={d:1/0,segments:0,direct:r.none};for(var A=(n(_={},-u-1,{d:1/0,segments:0,direct:r.none}),n(_,u+1,{d:1/0,segments:0,direct:r.none}),_),R=v;R>=m;--R){var k=[A,O];O=k[0],A=k[1];for(var D=function(n){var i=R+n;if(R===v&&i===g)return O[n]={d:0,segments:0,direct:h},"continue";var o=[{direct:r.horizontal,d:O[n+1].d+1,segments:O[n+1].segments+(O[n+1].direct&r.horizontal?0:1)},{direct:r.vertical,d:A[n-1].d+1,segments:A[n-1].segments+(A[n-1].direct&r.vertical?0:1)}];i>=0&&i<g&&R>=0&&R<v&&d(t[e+i],s[a+R])&&o.push({direct:r.diagonal,d:A[n].d,segments:A[n].segments+(A[n].direct&r.diagonal?0:1)});var c=o.reduce((function(t,e){return t.d>e.d||t.d===e.d&&t.segments>e.segments?e:t}));o.forEach((function(t){c.d===t.d&&c.segments===t.segments&&(c.direct|=t.direct)})),O[n]=c},N=u;N>=-u;--N)D(N)}for(var P={k:-1,d:1/0,segments:0,direct:r.none},L=-u;L<=u;++L){var x=y[L].d+O[L].d;if(x<P.d)P.k=L,P.d=x,P.segments=y[L].segments+O[L].segments+(y[L].segments&O[L].segments?0:1),P.direct=O[L].direct;else if(x===P.d){var U=y[L].segments+O[L].segments+(y[L].segments&O[L].segments?0:1);(U<P.segments||U===P.segments&&!(P.direct&r.diagonal)&&O[L].direct&r.diagonal)&&(P.k=L,P.d=x,P.segments=U,P.direct=O[L].direct)}}m+P.k===0&&0===m&&(m++,y[P.k].direct=O[P.k].direct,O[P.k].direct=A[P.k].direct),i(t,e,e+m+P.k,s,a,a+m,y[P.k].d,l,O[P.k].direct,d,p),i(t,e+m+P.k,o,s,a+m,c,O[P.k].d,y[P.k].direct,h,d,p)}else(l&r.horizontal?1:0)+(h&r.vertical?1:0)>=(l&r.vertical?1:0)+(h&r.horizontal?1:0)?(e!==o&&p("remove",t,e,o,s,a,a),a!==c&&p("add",t,o,o,s,a,c)):(a!==c&&p("add",t,e,e,s,a,c),e!==o&&p("remove",t,e,o,s,c,c));else p("same",t,e,o,s,a,c)}r.all=r.horizontal|r.vertical|r.diagonal},6830:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getPatch=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t,e){return t===e},r=[],o=null,s=null;function a(t,e,n,i,a,c,u){if("same"===t)s&&r.push(s),o&&r.push(o),s=null,o=null;else if("remove"===t){s||(s={type:"remove",oldPos:n,newPos:c,items:[]});for(var l=n;l<i;++l)s.items.push(e[l]);o&&(o.oldPos+=i-n,s.oldPos===n&&(s.newPos-=i-n))}else if("add"===t){o||(o={type:"add",oldPos:n,newPos:c,items:[]});for(var h=c;h<u;++h)o.items.push(a[h])}}return(0,i.default)(t,e,n,a),a("same",[],0,0,[],0,0),r};var r,i=(r=n(1258))&&r.__esModule?r:{default:r}},6771:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t,e){return t===e},r=[];return(0,i.default)(t,e,n,(function(t,e,n,i){if("same"===t)for(var o=n;o<i;++o)r.push(e[o])})),r};var r,i=(r=n(1258))&&r.__esModule?r:{default:r}},9187:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={same:!0};Object.defineProperty(e,"same",{enumerable:!0,get:function(){return o.default}});var i,o=(i=n(6771))&&i.__esModule?i:{default:i},s=n(8781);Object.keys(s).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(r,t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return s[t]}}))}));var a=n(6830);Object.keys(a).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(r,t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return a[t]}}))}));var c=n(6674);Object.keys(c).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(r,t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return c[t]}}))}))},3941:(t,e,n)=>{"use strict";e.Z=u;var r=n(7320),i=n(9187);function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}var a={}.constructor;function c(t,e){var n,r=Array.isArray(t)&&Array.isArray(e);return!("object"===s(n=e)&&null!==n&&n.constructor===a||r)||s(e)!==s(t)}function u(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=[];return Object.keys(e).forEach((function(l){t[l]!==e[l]&&a.push(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){o(t,e,n[e])}))}return t}({key:l},function(t,e,n,o){return null===t||c(t,e)||!n(t,e,o)?{change:r.DIFF_STATUS_UPDATED,value:e}:Array.isArray(t)&&Array.isArray(e)?{change:r.DIFF_STATUS_ARRAY_UPDATED,value:(0,i.getPatch)(t,e)}:{change:r.DIFF_STATUS_KEYS_UPDATED,value:u(t,e,n,o)}}(t[l],e[l],n,s.concat(l))))})),Object.keys(t).forEach((function(t){e.hasOwnProperty(t)||a.push({key:t,change:r.DIFF_STATUS_REMOVED})})),a}},4719:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=[];return Object.keys(e).forEach((function(i){t[i]!==e[i]&&n.push({key:i,value:e[i],change:r.DIFF_STATUS_UPDATED})})),Object.keys(t).forEach((function(t){e.hasOwnProperty(t)||n.push({key:t,change:r.DIFF_STATUS_REMOVED})})),n};var r=n(7320)},1184:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=Object.assign({},t);return e.forEach((function(t){var e=t.change,i=t.key,o=t.value;switch(e){case r.DIFF_STATUS_UPDATED:n[i]=o;break;case r.DIFF_STATUS_REMOVED:Reflect.deleteProperty(n,i)}})),n};var r=n(7320)},560:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getBrowserAPI=function(){var t;try{t=self.chrome||self.browser||browser}catch(e){t=browser}if(!t)throw new Error("Browser API is not present");return t}},8596:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=n(3974),o=n(2641),s=n(560),a=(r=n(4719))&&r.__esModule?r:{default:r};var c={portName:i.DEFAULT_PORT_NAME,dispatchResponder:function(t,e){Promise.resolve(t).then((function(t){e({error:null,value:t})})).catch((function(t){console.error("error dispatching result:",t),e({error:t.message,value:null})}))},serializer:o.noop,deserializer:o.noop,diffStrategy:a.default};e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c,n=e.portName,r=void 0===n?c.portName:n,a=e.dispatchResponder,u=void 0===a?c.dispatchResponder:a,l=e.serializer,h=void 0===l?c.serializer:l,d=e.deserializer,p=void 0===d?c.deserializer:d,f=e.diffStrategy,_=void 0===f?c.diffStrategy:f;if(!r)throw new Error("portName is required in options");if("function"!=typeof h)throw new Error("serializer must be a function");if("function"!=typeof p)throw new Error("deserializer must be a function");if("function"!=typeof _)throw new Error("diffStrategy must be one of the included diffing strategies or a custom diff function");var g=(0,s.getBrowserAPI)(),v=function(e,n,o){if(e.type===i.DISPATCH_TYPE&&e.portName===r){var s=Object.assign({},e.payload,{_sender:n}),a=null;try{a=t.dispatch(s)}catch(t){a=Promise.reject(t.message),console.error(t)}return u(a,o),!0}},m=(0,o.withSerializer)(h)((function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=function(){g.runtime.lastError};return(t=g.runtime).sendMessage.apply(t,n.concat([i])),g.tabs.query({},(function(t){var e=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(e=(s=a.next()).done);e=!0){var c,u=s.value;(c=g.tabs).sendMessage.apply(c,[u.id].concat(n,[i]))}}catch(t){r=!0,o=t}finally{try{e||null==a.return||a.return()}finally{if(r)throw o}}}))})),y=t.getState();t.subscribe((function(){var e=t.getState(),n=_(y,e);n.length&&(y=e,m({type:i.PATCH_STATE_TYPE,payload:n,portName:r}))})),m({type:i.STATE_TYPE,payload:y,portName:r});var E=(0,o.withDeserializer)(p),I=function(t){return t.type===i.DISPATCH_TYPE&&t.portName===r};g.runtime.onMessage.addListener((function(e,n,o){var s=t.getState();e.type===i.FETCH_STATE_TYPE&&e.portName===r&&o({type:i.FETCH_STATE_TYPE,payload:s})})),E((function(){var t;return(t=g.runtime.onMessage).addListener.apply(t,arguments)}))(v,I),g.runtime.onMessageExternal?E((function(){var t;return(t=g.runtime.onMessageExternal).addListener.apply(t,arguments)}))(v,I):console.warn("runtime.onMessageExternal is not supported")}},4444:(t,e,n)=>{"use strict";n.d(e,{BH:()=>E,DV:()=>H,GJ:()=>F,L:()=>l,LL:()=>D,P0:()=>v,Pz:()=>y,Sg:()=>I,UI:()=>B,US:()=>a,Wl:()=>L,Yr:()=>C,ZR:()=>k,aH:()=>m,b$:()=>w,cI:()=>P,dS:()=>X,eu:()=>R,g5:()=>o,gK:()=>J,gQ:()=>$,h$:()=>u,hl:()=>A,hu:()=>i,m9:()=>tt,ne:()=>Y,p$:()=>d,pd:()=>q,q4:()=>g,r3:()=>M,ru:()=>T,tV:()=>h,uI:()=>S,ug:()=>Z,vZ:()=>G,w1:()=>O,w9:()=>U,xO:()=>z,xb:()=>j,z$:()=>b,zd:()=>V});const r={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},i=function(t,e){if(!t)throw o(e)},o=function(t){return new Error("Firebase Database ("+r.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},s=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let e=0;e<t.length;e+=3){const i=t[e],o=e+1<t.length,s=o?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,u=i>>2,l=(3&i)<<4|s>>4;let h=(15&s)<<2|c>>6,d=63&c;a||(d=64,o||(h=64)),r.push(n[u],n[l],n[h],n[d])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const o=((7&i)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(o>>10)),e[r++]=String.fromCharCode(56320+(1023&o))}else{const o=t[n++],s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let e=0;e<t.length;){const i=n[t.charAt(e++)],o=e<t.length?n[t.charAt(e)]:0;++e;const s=e<t.length?n[t.charAt(e)]:64;++e;const a=e<t.length?n[t.charAt(e)]:64;if(++e,null==i||null==o||null==s||null==a)throw new c;const u=i<<2|o>>4;if(r.push(u),64!==s){const t=o<<4&240|s>>2;if(r.push(t),64!==a){const t=s<<6&192|a;r.push(t)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class c extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const u=function(t){const e=s(t);return a.encodeByteArray(e,!0)},l=function(t){return u(t).replace(/\./g,"")},h=function(t){try{return a.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function d(t){return p(void 0,t)}function p(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=p(t[n],e[n]));return t}const f=()=>function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,_=()=>{try{return f()||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&h(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},g=t=>{var e,n;return null===(n=null===(e=_())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]},v=t=>{const e=g(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),r]:[e.substring(0,n),r]},m=()=>{var t;return null===(t=_())||void 0===t?void 0:t.config},y=t=>{var e;return null===(e=_())||void 0===e?void 0:e[`_${t}`]};class E{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function I(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[l(JSON.stringify({alg:"none",type:"JWT"})),l(JSON.stringify(o)),""].join(".")}function b(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function S(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(b())}function T(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function w(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function O(){const t=b();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function C(){return!0===r.NODE_CLIENT||!0===r.NODE_ADMIN}function A(){try{return"object"==typeof indexedDB}catch(t){return!1}}function R(){return new Promise(((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}class k extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,k.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,D.prototype.create)}}class D{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},r=`${this.service}/${t}`,i=this.errors[t],o=i?function(t,e){return t.replace(N,((t,n)=>{const r=e[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",s=`${this.serviceName}: ${o} (${r}).`;return new k(r,s,n)}}const N=/\{\$([^}]+)}/g;function P(t){return JSON.parse(t)}function L(t){return JSON.stringify(t)}const x=function(t){let e={},n={},r={},i="";try{const o=t.split(".");e=P(h(o[0])||""),n=P(h(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}},U=function(t){const e=x(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},F=function(t){const e=x(t).claims;return"object"==typeof e&&!0===e.admin};function M(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function H(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function j(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function B(t,e,n){const r={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function G(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const n=t[i],o=e[i];if(W(n)&&W(o)){if(!G(n,o))return!1}else if(n!==o)return!1}for(const t of r)if(!n.includes(t))return!1;return!0}function W(t){return null!==t&&"object"==typeof t}function z(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function V(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[n,r]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(r)}})),e}function q(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class ${constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,e){e||(e=0);const n=this.W_;if("string"==typeof t)for(let r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(let r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(let t=16;t<80;t++){const e=n[t-3]^n[t-8]^n[t-14]^n[t-16];n[t]=4294967295&(e<<1|e>>>31)}let r,i,o=this.chain_[0],s=this.chain_[1],a=this.chain_[2],c=this.chain_[3],u=this.chain_[4];for(let t=0;t<80;t++){t<40?t<20?(r=c^s&(a^c),i=1518500249):(r=s^a^c,i=1859775393):t<60?(r=s&a|c&(s|a),i=2400959708):(r=s^a^c,i=3395469782);const e=(o<<5|o>>>27)+r+u+i+n[t]&4294967295;u=c,c=a,a=4294967295&(s<<30|s>>>2),s=o,o=e}this.chain_[0]=this.chain_[0]+o&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(t,e){if(null==t)return;void 0===e&&(e=t.length);const n=e-this.blockSize;let r=0;const i=this.buf_;let o=this.inbuf_;for(;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}digest(){const t=[];let e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let t=this.blockSize-1;t>=56;t--)this.buf_[t]=255&e,e/=256;this.compress_(this.buf_);let n=0;for(let e=0;e<5;e++)for(let r=24;r>=0;r-=8)t[n]=this.chain_[e]>>r&255,++n;return t}}function Y(t,e){const n=new K(t,e);return n.subscribe.bind(n)}class K{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,n){let r;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");r=function(t,e){if("object"!=typeof t||null===t)return!1;for(const n of e)if(n in t&&"function"==typeof t[n])return!0;return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n},void 0===r.next&&(r.next=Q),void 0===r.error&&(r.error=Q),void 0===r.complete&&(r.complete=Q);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(t){}})),this.observers.push(r),i}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function Q(){}function J(t,e){return`${t} failed: ${e} argument `}const X=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let o=t.charCodeAt(r);if(o>=55296&&o<=56319){const e=o-55296;r++,i(r<t.length,"Surrogate pair missing trail surrogate.");o=65536+(e<<10)+(t.charCodeAt(r)-56320)}o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=63&o|128):o<65536?(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=63&o|128):(e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=63&o|128)}return e},Z=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};function tt(t){return t&&t._delegate?t._delegate:t}},7380:(t,e,n)=>{"use strict";n.d(e,{Z:()=>Lt});var r=n(8433),i=n(9560),o=n.n(i),s=n(7563),a=n(9293),c=n.n(a),u=n(4148);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),t}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){f(t,e,n[e])}))}return t}function g(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var v={DEFAULT_INSTANCE:"$default_instance",API_VERSION:2,MAX_STRING_LENGTH:4096,MAX_PROPERTY_KEYS:1e3,IDENTIFY_EVENT:"$identify",GROUP_IDENTIFY_EVENT:"$groupidentify",EVENT_LOG_URL:"api.amplitude.com",EVENT_LOG_EU_URL:"api.eu.amplitude.com",DYNAMIC_CONFIG_URL:"regionconfig.amplitude.com",DYNAMIC_CONFIG_EU_URL:"regionconfig.eu.amplitude.com",LAST_EVENT_ID:"amplitude_lastEventId",LAST_EVENT_TIME:"amplitude_lastEventTime",LAST_IDENTIFY_ID:"amplitude_lastIdentifyId",LAST_SEQUENCE_NUMBER:"amplitude_lastSequenceNumber",SESSION_ID:"amplitude_sessionId",DEVICE_ID:"amplitude_deviceId",OPT_OUT:"amplitude_optOut",USER_ID:"amplitude_userId",DEVICE_ID_INDEX:0,USER_ID_INDEX:1,OPT_OUT_INDEX:2,SESSION_ID_INDEX:3,LAST_EVENT_TIME_INDEX:4,EVENT_ID_INDEX:5,IDENTIFY_ID_INDEX:6,SEQUENCE_NUMBER_INDEX:7,COOKIE_TEST_PREFIX:"amp_cookie_test",COOKIE_PREFIX:"amp",STORAGE_DEFAULT:"",STORAGE_COOKIES:"cookies",STORAGE_NONE:"none",STORAGE_LOCAL:"localStorage",STORAGE_SESSION:"sessionStorage",REVENUE_EVENT:"revenue_amount",REVENUE_PRODUCT_ID:"$productId",REVENUE_QUANTITY:"$quantity",REVENUE_PRICE:"$price",REVENUE_REVENUE_TYPE:"$revenueType",AMP_DEVICE_ID_PARAM:"amp_device_id",AMP_REFERRER_PARAM:"amp_referrer",REFERRER:"referrer",UTM_SOURCE:"utm_source",UTM_MEDIUM:"utm_medium",UTM_CAMPAIGN:"utm_campaign",UTM_TERM:"utm_term",UTM_CONTENT:"utm_content",ATTRIBUTION_EVENT:"[Amplitude] Attribution Captured",TRANSPORT_HTTP:"http",TRANSPORT_BEACON:"beacon"},m=function(t){for(var e="",n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e+=String.fromCharCode(r):r>127&&r<2048?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(63&r|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(63&r|128))}return e},y=function(t){for(var e="",n=0,r=0,i=0,o=0;n<t.length;)(r=t.charCodeAt(n))<128?(e+=String.fromCharCode(r),n++):r>191&&r<224?(i=t.charCodeAt(n+1),e+=String.fromCharCode((31&r)<<6|63&i),n+=2):(i=t.charCodeAt(n+1),o=t.charCodeAt(n+2),e+=String.fromCharCode((15&r)<<12|(63&i)<<6|63&o),n+=3);return e},E="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0!==n.g?n.g:void 0,I={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(t){try{if(E.btoa&&E.atob)return E.btoa(unescape(encodeURIComponent(t)))}catch(t){}return I._encode(t)},_encode:function(t){var e,n,r,i,o,s,a,c="",u=0;for(t=m(t);u<t.length;)i=(e=t.charCodeAt(u++))>>2,o=(3&e)<<4|(n=t.charCodeAt(u++))>>4,s=(15&n)<<2|(r=t.charCodeAt(u++))>>6,a=63&r,isNaN(n)?s=a=64:isNaN(r)&&(a=64),c=c+I._keyStr.charAt(i)+I._keyStr.charAt(o)+I._keyStr.charAt(s)+I._keyStr.charAt(a);return c},decode:function(t){try{if(E.btoa&&E.atob)return decodeURIComponent(escape(E.atob(t)))}catch(t){}return I._decode(t)},_decode:function(t){var e,n,r,i,o,s,a="",c=0;for(t=t.replace(/[^A-Za-z0-9+/=]/g,"");c<t.length;)e=I._keyStr.indexOf(t.charAt(c++))<<2|(i=I._keyStr.indexOf(t.charAt(c++)))>>4,n=(15&i)<<4|(o=I._keyStr.indexOf(t.charAt(c++)))>>2,r=(3&o)<<6|(s=I._keyStr.indexOf(t.charAt(c++))),a+=String.fromCharCode(e),64!==o&&(a+=String.fromCharCode(n)),64!==s&&(a+=String.fromCharCode(r));return a=y(a)}},b=Object.prototype.toString;function S(t){switch(b.call(t)){case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object Error]":return"error"}return null===t?"null":void 0===t?"undefined":t!=t?"nan":t&&1===t.nodeType?"element":"undefined"!=typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(t)?"buffer":l(t=t.valueOf?t.valueOf():Object.prototype.valueOf.apply(t))}var T,w={DISABLE:0,ERROR:1,WARN:2,INFO:3},O=w.WARN,C={error:function(t){O>=w.ERROR&&A(t)},warn:function(t){O>=w.WARN&&A(t)},info:function(t){O>=w.INFO&&A(t)}},A=function(t){try{console.log("[Amplitude] "+t)}catch(t){}},R=function(t){return"string"===S(t)&&t.length>v.MAX_STRING_LENGTH?t.substring(0,v.MAX_STRING_LENGTH):t},k=function(t,e,n){return S(t)===n||(C.error("Invalid "+e+" input type. Expected "+n+" but received "+S(t)),!1)},D=function(t){var e=S(t);if("object"!==e)return C.error("Error: invalid properties format. Expecting Javascript object, received "+e+", ignoring"),{};if(Object.keys(t).length>v.MAX_PROPERTY_KEYS)return C.error("Error: too many properties (more than 1000), ignoring"),{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=r,o=S(i);"string"!==o&&(i=String(i),C.warn("WARNING: Non-string property key, received type "+o+', coercing to string "'+i+'"'));var s=P(i,t[r]);null!==s&&(n[i]=s)}return n},N=["nan","function","arguments","regexp","element"],P=function t(e,n){var r=S(n);if(-1!==N.indexOf(r))C.warn('WARNING: Property key "'+e+'" with invalid value type '+r+", ignoring"),n=null;else if("undefined"===r)n=null;else if("error"===r)n=String(n),C.warn('WARNING: Property key "'+e+'" with value type error, coercing to '+n);else if("array"===r){for(var i=[],o=0;o<n.length;o++){var s=n[o],a=S(s);"array"!==a?"object"===a?i.push(D(s)):i.push(t(e,s)):C.warn("WARNING: Cannot have "+a+" nested in an array property value, skipping")}n=i}else"object"===r&&(n=D(n));return n},L=function(t,e){var n=S(e);if("string"===n)return e;if("date"===n||"number"===n||"boolean"===n)return e=String(e),C.warn("WARNING: Non-string groupName, received type "+n+', coercing to string "'+e+'"'),e;if("array"===n){for(var r=[],i=0;i<e.length;i++){var o=e[i],s=S(o);"array"!==s&&"object"!==s?"string"===s?r.push(o):"date"!==s&&"number"!==s&&"boolean"!==s||(o=String(o),C.warn("WARNING: Non-string groupName, received type "+s+', coercing to string "'+o+'"'),r.push(o)):C.warn("WARNING: Skipping nested "+s+" in array groupName")}return r}C.warn("WARNING: Non-string groupName, received type "+n+". Please use strings or array of strings for groupName")},x={setLogLevel:function(t){Object.prototype.hasOwnProperty.call(w,t)&&(O=w[t])},getLogLevel:function(){return O},logLevels:w,log:C,isEmptyString:function(t){return!t||0===t.length},isWebWorkerEnvironment:function(){return"undefined"!=typeof WorkerGlobalScope},getQueryParam:function(t,e){t=t.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);return null===n?void 0:decodeURIComponent(n[1].replace(/\+/g," "))},sessionStorageEnabled:function(){try{if(E.sessionStorage)return!0}catch(t){}return!1},truncate:function t(e){if("array"===S(e))for(var n=0;n<e.length;n++)e[n]=t(e[n]);else if("object"===S(e))for(var r in e)r in e&&(e[r]=t(e[r]));else e=R(e);return e},validateGroups:function(t){var e=S(t);if("object"!==e)return C.error("Error: invalid groups format. Expecting Javascript object, received "+e+", ignoring"),{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=r,o=S(i);"string"!==o&&(i=String(i),C.warn("WARNING: Non-string groupType, received type "+o+', coercing to string "'+i+'"'));var s=L(i,t[r]);null!==s&&(n[i]=s)}return n},validateInput:k,validateProperties:D,validateDeviceId:function(t){return!!k(t,"deviceId","string")&&(!(t.indexOf(".")>=0)||(C.error("Device IDs may not contain '.' characters. Value will be ignored: \"".concat(t,'"')),!1))},validateTransport:function(t){return!!k(t,"transport","string")&&(t!==v.TRANSPORT_HTTP&&t!==v.TRANSPORT_BEACON?(C.error("transport value must be one of '".concat(v.TRANSPORT_BEACON,"' or '").concat(v.TRANSPORT_HTTP,"'")),!1):!(t!==v.TRANSPORT_HTTP&&"undefined"!=typeof navigator&&!navigator.sendBeacon)||(C.error("browser does not support sendBeacon, so transport must be HTTP"),!1))},validateSessionId:function(t){return!!(k(t,"sessionId","number")&&new Date(t).getTime()>0)||(C.error("sessionId value must in milliseconds since epoch (Unix Timestamp)"),!1)}},U=function(){return E.location},F=function(){for(var t="",e=0;e<22;++e)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".charAt(Math.floor(64*Math.random()));return t},M=function(t){try{for(var e=document.cookie.split(";"),n=null,r=0;r<e.length;r++){for(var i=e[r];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t)){n=i.substring(t.length,i.length);break}}return n}catch(t){return null}},H=function(t,e,n){var r=null!==e?n.expirationDays:-1;if(r){var i=new Date;i.setTime(i.getTime()+24*r*60*60*1e3),r=i}var o=t+"="+e;r&&(o+="; expires="+r.toUTCString()),o+="; path=/",n.domain&&(o+="; domain="+n.domain),n.secure&&(o+="; Secure"),n.sameSite&&(o+="; SameSite="+n.sameSite),document.cookie=o},j=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=e.split(".")[v.LAST_EVENT_TIME_INDEX];return n&&(t=parseInt(n,32)),t||(x.log.warn("unable to parse malformed cookie: ".concat(e)),0)},B={set:H,get:M,getAll:function(t){try{var e=document.cookie.split(";").map((function(t){return t.trimStart()})),n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){for(var c=s.value;" "===c.charAt(0);)c=c.substring(1);0===c.indexOf(t)&&n.push(c.substring(t.length))}}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}catch(t){return[]}},getLastEventTime:j,sortByEventTime:function(t){return g(t).sort((function(t,e){var n=j(t);return j(e)-n}))},areCookiesEnabled:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=v.COOKIE_TEST_PREFIX+F();if("undefined"==typeof document)return!1;var n=!1;try{var r=String(Date.now());H(e,r,t),x.log.info("Testing if cookies available"),n=M(e+"=")===r}catch(t){x.log.warn('Error thrown when checking for cookies. Reason: "'.concat(t,'"'))}finally{x.log.info("Cleaning up cookies availability test"),H(e,null,t)}return n}},G=function(t){var e=E.location?E.location.hostname:"";if(t){if("undefined"!=typeof document){var n=document.createElement("a");return n.href=t,n.hostname||e}if("function"==typeof URL)return new URL(t).hostname||e}return e},W=function(t){var e=G(t).split("."),n=[],r="_tldtest_"+F();if(x.isWebWorkerEnvironment())return"";for(var i=e.length-2;i>=0;--i)n.push(e.slice(i).join("."));for(var o=0;o<n.length;++o){var s=n[o],a={domain:"."+s};if(B.set(r,1,a),B.get(r))return B.set(r,null,a),s}return""},z={expirationDays:void 0,domain:void 0},V=function(t){var e="";return z.domain&&(e="."===z.domain.charAt(0)?z.domain.substring(1):z.domain),t+e},q=function(t){var e=V(t)+"=",n=B.get(e);try{if(n)return JSON.parse(I.decode(n))}catch(t){return null}return null},$=function(t,e){try{return B.set(V(t),I.encode(JSON.stringify(e)),z),!0}catch(t){return!1}},Y=function(t){try{return B.set(V(t),null,z),!0}catch(t){return!1}},K={reset:function(){z={expirationDays:void 0,domain:void 0}},options:function(t){if(0===arguments.length)return z;t=t||{},z.expirationDays=t.expirationDays,z.secure=t.secure,z.sameSite=t.sameSite;var e=x.isEmptyString(t.domain)?"."+W(U().href):t.domain,n=Math.random();z.domain=e,$("amplitude_test",n);var r=q("amplitude_test");return r&&r===n||(e=null),Y("amplitude_test"),z.domain=e,z},get:q,set:$,remove:Y,setRaw:function(t,e){try{return B.set(V(t),e,z),!0}catch(t){return!1}},getRaw:function(t){var e=V(t)+"=";return B.get(e)}},Q=function(){function t(){h(this,t),this.map=new Map,this.length=0}return p(t,[{key:"key",value:function(t){var e=Array.from(this.map.keys())[t];return this.map.get(e)}},{key:"getItem",value:function(t){return this.map.get(t)}},{key:"setItem",value:function(t,e){this.map.has(t)||(this.length+=1),this.map.set(t,e)}},{key:"removeItem",value:function(t){this.map.has(t)&&(this.length-=1,this.map.delete(t))}},{key:"clear",value:function(){this.map.clear(),this.length=0}}]),t}();if(function(){var t,e=new Date;try{return E.localStorage.setItem(e,e),t=E.localStorage.getItem(e)===String(e),E.localStorage.removeItem(e),t}catch(t){}return!1}())T=E.localStorage;else if(void 0!==E&&E.globalStorage)try{T=E.globalStorage[E.location.hostname]}catch(t){}else if("undefined"!=typeof document){var J=document.createElement("div"),X="localStorage";J.style.display="none",document.getElementsByTagName("head")[0].appendChild(J),J.addBehavior&&(J.addBehavior("#default#userdata"),T={length:0,setItem:function(t,e){J.load(X),J.getAttribute(t)||this.length++,J.setAttribute(t,e),J.save(X)},getItem:function(t){return J.load(X),J.getAttribute(t)},removeItem:function(t){J.load(X),J.getAttribute(t)&&this.length--,J.removeAttribute(t),J.save(X)},clear:function(){J.load(X);for(var t,e=0;t=J.XMLDocument.documentElement.attributes[e++];)J.removeAttribute(t.name);J.save(X),this.length=0},key:function(t){return J.load(X),J.XMLDocument.documentElement.attributes[t]}},J.load(X),T.length=J.XMLDocument.documentElement.attributes.length)}else x.isWebWorkerEnvironment()&&(T=new Q);T||(T={length:0,setItem:function(t,e){},getItem:function(t){},removeItem:function(t){},clear:function(){},key:function(t){}});var Z,tt=T,et=function(){this.storage=null};et.prototype.getStorage=function(){if(null!==this.storage)return this.storage;if(B.areCookiesEnabled())this.storage=K;else{var t="amp_cookiestore_";this.storage={_options:{expirationDays:void 0,domain:void 0,secure:!1},reset:function(){this._options={expirationDays:void 0,domain:void 0,secure:!1}},options:function(t){return 0===arguments.length?this._options:(t=t||{},this._options.expirationDays=t.expirationDays||this._options.expirationDays,this._options.domain=t.domain||this._options.domain||E&&E.location&&E.location.hostname,this._options.secure=t.secure||!1)},get:function(e){try{return JSON.parse(tt.getItem(t+e))}catch(t){}return null},set:function(e,n){try{return tt.setItem(t+e,JSON.stringify(n)),!0}catch(t){}return!1},remove:function(e){try{tt.removeItem(t+e)}catch(t){return!1}}}}return this.storage};var nt=(f(Z={},v.STORAGE_COOKIES,!0),f(Z,v.STORAGE_NONE,!0),f(Z,v.STORAGE_LOCAL,!0),f(Z,v.STORAGE_SESSION,!0),Z),rt=function(){function t(e){var n=e.storageKey,r=e.disableCookies,i=e.domain,o=e.secure,s=e.sameSite,a=e.expirationDays,c=e.storage;h(this,t),this.storageKey=n,this.domain=i,this.secure=o,this.sameSite=s,this.expirationDays=a,this.cookieDomain="";var u=U()?U().href:void 0,l=W(u);if(this.cookieDomain=i||(l?"."+l:null),nt[c])this.storage=c;else{var d=r||!B.areCookiesEnabled({domain:this.cookieDomain,secure:this.secure,sameSite:this.sameSite,expirationDays:this.expirationDays});this.storage=d?v.STORAGE_LOCAL:v.STORAGE_COOKIES}}return p(t,[{key:"getCookieStorageKey",value:function(){if(!this.domain)return this.storageKey;var t="."===this.domain.charAt(0)?this.domain.substring(1):this.domain;return"".concat(this.storageKey).concat(t?"_".concat(t):"")}},{key:"save",value:function(t){var e=t.deviceId,n=t.userId,r=t.optOut,i=t.sessionId,o=t.lastEventTime,s=t.eventId,a=t.identifyId,c=t.sequenceNumber;if(this.storage!==v.STORAGE_NONE){var u=[e,I.encode(n||""),r?"1":"",i?i.toString(32):"0",o?o.toString(32):"0",s?s.toString(32):"0",a?a.toString(32):"0",c?c.toString(32):"0"].join(".");switch(this.storage){case v.STORAGE_SESSION:E.sessionStorage&&E.sessionStorage.setItem(this.storageKey,u);break;case v.STORAGE_LOCAL:tt.setItem(this.storageKey,u);break;case v.STORAGE_COOKIES:this.saveCookie(u)}}}},{key:"saveCookie",value:function(t){B.set(this.getCookieStorageKey(),t,{domain:this.cookieDomain,secure:this.secure,sameSite:this.sameSite,expirationDays:this.expirationDays})}},{key:"load",value:function(){var t,e=this;if(this.storage===v.STORAGE_COOKIES){var n=this.getCookieStorageKey()+"=",r=B.getAll(n);if(0===r.length||1===r.length)t=r[0];else{var i=B.sortByEventTime(r)[0];r.forEach((function(){return B.set(e.getCookieStorageKey(),null,{})})),this.saveCookie(i),t=B.get(n)}}if(t||(t=tt.getItem(this.storageKey)),!t)try{t=E.sessionStorage&&E.sessionStorage.getItem(this.storageKey)}catch(t){x.log.info('window.sessionStorage unavailable. Reason: "'.concat(t,'"'))}if(!t)return null;var o=t.split("."),s=null;if(o[v.USER_ID_INDEX])try{s=I.decode(o[v.USER_ID_INDEX])}catch(t){s=null}return{deviceId:o[v.DEVICE_ID_INDEX],userId:s,optOut:"1"===o[v.OPT_OUT_INDEX],sessionId:parseInt(o[v.SESSION_ID_INDEX],32),lastEventTime:parseInt(o[v.LAST_EVENT_TIME_INDEX],32),eventId:parseInt(o[v.EVENT_ID_INDEX],32),identifyId:parseInt(o[v.IDENTIFY_ID_INDEX],32),sequenceNumber:parseInt(o[v.SEQUENCE_NUMBER_INDEX],32)}}},{key:"clear",value:function(){var t;if(this.storage===v.STORAGE_COOKIES&&(t=B.get(this.getCookieStorageKey()+"="),B.set(this.getCookieStorageKey(),null,{domain:this.cookieDomain,secure:this.secure,sameSite:this.sameSite,expirationDays:0})),t||(t=tt.getItem(this.storageKey),tt.clear()),!t)try{t=E.sessionStorage&&E.sessionStorage.getItem(this.storageKey),E.sessionStorage.clear()}catch(t){x.log.info('window.sessionStorage unavailable. Reason: "'.concat(t,'"'))}return!!t}}]),t}(),it="$clearAll",ot=function(){this.userPropertiesOperations={},this.properties=[]};ot.prototype.add=function(t,e){return"number"===S(e)||"string"===S(e)?this._addOperation("$add",t,e):x.log.error("Unsupported type for value: "+S(e)+", expecting number or string"),this},ot.prototype.append=function(t,e){return this._addOperation("$append",t,e),this},ot.prototype.clearAll=function(){return Object.keys(this.userPropertiesOperations).length>0?(Object.prototype.hasOwnProperty.call(this.userPropertiesOperations,it)||x.log.error("Need to send $clearAll on its own Identify object without any other operations, skipping $clearAll"),this):(this.userPropertiesOperations[it]="-",this)},ot.prototype.prepend=function(t,e){return this._addOperation("$prepend",t,e),this},ot.prototype.set=function(t,e){return this._addOperation("$set",t,e),this},ot.prototype.setOnce=function(t,e){return this._addOperation("$setOnce",t,e),this},ot.prototype.unset=function(t){return this._addOperation("$unset",t,"-"),this},ot.prototype.preInsert=function(t,e){return this._addOperation("$preInsert",t,e),this},ot.prototype.postInsert=function(t,e){return this._addOperation("$postInsert",t,e),this},ot.prototype.remove=function(t,e){return this._addOperation("$remove",t,e),this},ot.prototype._addOperation=function(t,e,n){Object.prototype.hasOwnProperty.call(this.userPropertiesOperations,it)?x.log.error("This identify already contains a $clearAll operation, skipping operation "+t):-1===this.properties.indexOf(e)?(Object.prototype.hasOwnProperty.call(this.userPropertiesOperations,t)||(this.userPropertiesOperations[t]={}),this.userPropertiesOperations[t][e]=n,this.properties.push(e)):x.log.error('User property "'+e+'" already used in this identify, skipping operation '+t)};var st=function(t,e,n){this.url=t,this.data=e||{},this.headers=n},at="Cross-Origin-Resource-Policy";st.prototype.send=function(t){if(!!E.XDomainRequest){var e=new E.XDomainRequest;e.open("POST",this.url,!0),e.onload=function(){t(200,e.responseText)},e.onerror=function(){"Request Entity Too Large"===e.responseText?t(413,e.responseText):t(500,e.responseText)},e.ontimeout=function(){},e.onprogress=function(){},e.send(s.stringify(this.data))}else if("undefined"!=typeof XMLHttpRequest){var n=new XMLHttpRequest;n.open("POST",this.url,!0),n.onreadystatechange=function(){4===n.readyState&&t(n.status,n.responseText)},function(t,e){for(var n in e)(n!==at||e[n])&&t.setRequestHeader(n,e[n])}(n,this.headers),n.send(s.stringify(this.data))}else{var r=void 0;fetch(this.url,{method:"POST",headers:this.headers,body:s.stringify(this.data)}).then((function(t){return r=t.status,t.text()})).then((function(e){t(r,e)}))}};var ct=function(){this._price=null,this._productId=null,this._quantity=1,this._revenueType=null,this._properties=null};ct.prototype.setProductId=function(t){return"string"!==S(t)?x.log.error("Unsupported type for productId: "+S(t)+", expecting string"):x.isEmptyString(t)?x.log.error("Invalid empty productId"):this._productId=t,this},ct.prototype.setQuantity=function(t){return"number"!==S(t)?x.log.error("Unsupported type for quantity: "+S(t)+", expecting number"):this._quantity=parseInt(t),this},ct.prototype.setPrice=function(t){return"number"!==S(t)?x.log.error("Unsupported type for price: "+S(t)+", expecting number"):this._price=t,this},ct.prototype.setRevenueType=function(t){return"string"!==S(t)?x.log.error("Unsupported type for revenueType: "+S(t)+", expecting string"):this._revenueType=t,this},ct.prototype.setEventProperties=function(t){return"object"!==S(t)?x.log.error("Unsupported type for eventProperties: "+S(t)+", expecting object"):this._properties=x.validateProperties(t),this},ct.prototype._isValidRevenue=function(){return"number"===S(this._price)||(x.log.error("Invalid revenue, need to set price field"),!1)},ct.prototype._toJSONObject=function(){var t="object"===S(this._properties)?this._properties:{};return null!==this._productId&&(t[v.REVENUE_PRODUCT_ID]=this._productId),null!==this._quantity&&(t[v.REVENUE_QUANTITY]=this._quantity),null!==this._price&&(t[v.REVENUE_PRICE]=this._price),null!==this._revenueType&&(t[v.REVENUE_REVENUE_TYPE]=this._revenueType),t};var ut=function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t)},lt=function(){return"undefined"!=typeof navigator&&(navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage)||""},ht={US:"US",EU:"EU"},dt=function(t){var e=v.EVENT_LOG_URL;switch(t){case ht.EU:e=v.EVENT_LOG_EU_URL;break;case ht.US:e=v.EVENT_LOG_URL}return e},pt="8.21.3",ft={apiEndpoint:v.EVENT_LOG_URL,batchEvents:!1,cookieExpiration:365,cookieName:"amplitude_id",sameSiteCookie:"Lax",cookieForceUpgrade:!1,deferInitialization:!1,disableCookies:!1,deviceIdFromUrlParam:!1,domain:"",eventUploadPeriodMillis:3e4,eventUploadThreshold:30,forceHttps:!0,includeFbclid:!1,includeGclid:!1,includeReferrer:!1,includeUtm:!1,ingestionMetadata:{sourceName:"",sourceVersion:""},language:lt(),library:{name:"amplitude-js",version:pt},logLevel:"WARN",logAttributionCapturedEvent:!1,optOut:!1,onError:function(){},onExitPage:function(){},onNewSessionStart:function(){},plan:{branch:"",source:"",version:"",versionId:""},platform:"Web",savedMaxCount:1e3,saveEvents:!0,saveParamsReferrerOncePerSession:!0,secureCookie:!1,sessionTimeout:18e5,storage:v.STORAGE_DEFAULT,trackingOptions:{city:!0,country:!0,carrier:!0,device_manufacturer:!0,device_model:!0,dma:!0,ip_address:!0,language:!0,os_name:!0,os_version:!0,platform:!0,region:!0,version_name:!0},transport:v.TRANSPORT_HTTP,unsetParamsReferrerOnNewSession:!1,unsentKey:"amplitude_unsent",unsentIdentifyKey:"amplitude_unsent_identify",uploadBatchSize:100,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","Cross-Origin-Resource-Policy":"cross-origin"},serverZone:ht.US,useDynamicConfig:!1,serverZoneBasedApi:!1,sessionId:null,partnerId:""},_t=new(function(){function t(){return h(this,t),t.instance||(this.ingestionEndpoint=v.EVENT_LOG_URL,t.instance=this),t.instance}return p(t,[{key:"refresh",value:function(t,e,n){var r="https";e||"https:"===E.location.protocol||(r="http");var i=r+"://"+function(t){var e=v.DYNAMIC_CONFIG_URL;switch(t){case ht.EU:e=v.DYNAMIC_CONFIG_EU_URL;break;case ht.US:e=v.DYNAMIC_CONFIG_URL}return e}(t),o=this;if(!!E.XDomainRequest){var s=new E.XDomainRequest;s.open("GET",i,!0),s.onload=function(){var t=JSON.parse(s.responseText);o.ingestionEndpoint=t.ingestionEndpoint,n&&n()},s.onerror=function(){},s.ontimeout=function(){},s.onprogress=function(){},s.send()}else{var a=new XMLHttpRequest;a.open("GET",i,!0),a.onreadystatechange=function(){if(4===a.readyState&&200===a.status){var t=JSON.parse(a.responseText);o.ingestionEndpoint=t.ingestionEndpoint,n&&n()}},a.send()}}}]),t}()),gt=function(t){(0,r.kP)()||x.isWebWorkerEnvironment()||x.log.warn("amplitude-js will not work in a non-browser environment. If you are planning to add Amplitude to a node environment, please use @amplitude/node"),this._instanceName=x.isEmptyString(t)?v.DEFAULT_INSTANCE:t.toLowerCase(),this._unsentEvents=[],this._unsentIdentifys=[],this.options=_({},ft,{headers:_({},ft.headers),ingestionMetadata:_({},ft.ingestionMetadata),library:_({},ft.library),plan:_({},ft.plan),trackingOptions:_({},ft.trackingOptions)}),this.cookieStorage=(new et).getStorage(),this._q=[],this._sending=!1,this._updateScheduled=!1,this._onInitCallbacks=[],this._onNewSessionStartCallbacks=[],this._eventId=0,this._identifyId=0,this._lastEventTime=null,this._newSession=!1,this._sequenceNumber=0,this._sessionId=null,this._isInitialized=!1,this._connector=null,this._userAgent="undefined"!=typeof navigator&&navigator&&navigator.userAgent||null,this._ua=new(c())(this._userAgent).getResult()};gt.prototype.Identify=ot,gt.prototype.Revenue=ct,gt.prototype.init=function(t,e,n,i){var o=this;if("string"!==S(t)||x.isEmptyString(t))x.log.error("Invalid apiKey. Please re-initialize with a valid apiKey");else try{this._connector=u.V.getInstance(this._instanceName),mt(this.options,n),((0,r.kP)()||x.isWebWorkerEnvironment())&&void 0!==E.Prototype&&Array.prototype.toJSON&&((0,r.XQ)(),x.log.warn("Prototype.js injected Array.prototype.toJSON. Deleting Array.prototype.toJSON to prevent double-stringify")),this.options.cookieName!==ft.cookieName&&x.log.warn("The cookieName option is deprecated. We will be ignoring it for newer cookies"),this.options.serverZoneBasedApi&&(this.options.apiEndpoint=dt(this.options.serverZone)),this._refreshDynamicConfig(),this.options.apiKey=t,this._storageSuffix="_"+t+(this._instanceName===v.DEFAULT_INSTANCE?"":"_"+this._instanceName),this._storageSuffixV5=t.slice(0,6),this._oldCookiename=this.options.cookieName+this._storageSuffix,this._unsentKey=this.options.unsentKey+this._storageSuffix,this._unsentIdentifyKey=this.options.unsentIdentifyKey+this._storageSuffix,this._cookieName=v.COOKIE_PREFIX+"_"+this._storageSuffixV5,this.cookieStorage.options({expirationDays:this.options.cookieExpiration,domain:this.options.domain,secure:this.options.secureCookie,sameSite:this.options.sameSiteCookie}),this._metadataStorage=new rt({storageKey:this._cookieName,disableCookies:this.options.disableCookies,expirationDays:this.options.cookieExpiration,domain:this.options.domain,secure:this.options.secureCookie,sameSite:this.options.sameSiteCookie,storage:this.options.storage});var s=!!this.cookieStorage.get(this._oldCookiename),a=!!this._metadataStorage.load();this._useOldCookie=!a&&s&&!this.options.cookieForceUpgrade;var c=a||s;if(this.options.deferInitialization&&!c)return void this._deferInitialization(t,e,n,i);this.options.domain=this.cookieStorage.options().domain,"string"===S(this.options.logLevel)&&x.setLogLevel(this.options.logLevel);var l=At(this);this._apiPropertiesTrackingOptions=Object.keys(l).length>0?{tracking_options:l}:{},this.options.cookieForceUpgrade&&s&&(a||Et(this),this.cookieStorage.remove(this._oldCookiename)),yt(this),this._pendingReadStorage=!0;this.options.saveEvents&&(this._unsentEvents=this._loadSavedUnsentEvents(this.options.unsentKey).map((function(t){return{event:t}})).concat(this._unsentEvents),this._unsentIdentifys=this._loadSavedUnsentEvents(this.options.unsentIdentifyKey).map((function(t){return{event:t}})).concat(this._unsentIdentifys)),n&&n.onNewSessionStart&&this.onNewSessionStart(this.options.onNewSessionStart),function(t){n&&n.deviceId&&!x.validateDeviceId(n.deviceId)&&(x.log.error('Invalid device ID rejected. Randomly generated UUID will be used instead of "'.concat(n.deviceId,'"')),delete n.deviceId),o.options.deviceId=o._getInitialDeviceId(n&&n.deviceId,t),o.options.userId="string"===S(e)&&!x.isEmptyString(e)&&e||"number"===S(e)&&e.toString()||o.options.userId||null;var r=(new Date).getTime(),i=!o._sessionId||!o._lastEventTime||r-o._lastEventTime>o.options.sessionTimeout||o.options.sessionId;i&&(o.options.unsetParamsReferrerOnNewSession&&o._unsetUTMParams(),o._newSession=!0,o._sessionId=o.options.sessionId||r,o.options.sessionId=void 0,o.options.saveParamsReferrerOncePerSession&&o._trackParamsAndReferrer()),o.options.saveParamsReferrerOncePerSession||o._trackParamsAndReferrer(),o.options.saveEvents&&(vt(o._unsentEvents),vt(o._unsentIdentifys)),o._lastEventTime=r,bt(o),o._pendingReadStorage=!1,o._sendEventsIfReady();for(var s=0;s<o._onInitCallbacks.length;s++)o._onInitCallbacks[s](o);o._onInitCallbacks=[],o._isInitialized=!0,i&&o._runNewSessionStartCallbacks()}(),this.runQueuedFunctions(),"function"===S(i)&&i(this);var h=this.options.onExitPage;if("function"===S(h)&&E.addEventListener&&!this.pageHandlersAdded){this.pageHandlersAdded=!0;E.addEventListener("pagehide",(function(){var t;t=o.options.transport,o.setTransport(v.TRANSPORT_BEACON),h(),o.setTransport(t)}),!1)}this._connector.eventBridge.setEventReceiver((function(t){o._logEvent(t.eventType,t.eventProperties,t.userProperties)}));var d=this._connector.identityStore.editIdentity();this.options.deviceId&&d.setDeviceId(this.options.deviceId),this.options.userId&&d.setUserId(this.options.userId),d.commit()}catch(t){x.log.error(t),n&&"function"===S(n.onError)&&n.onError(t)}},gt.prototype._runNewSessionStartCallbacks=function(){for(var t=0;t<this._onNewSessionStartCallbacks.length;t++)this._onNewSessionStartCallbacks[t](this)},gt.prototype.deleteLowerLevelDomainCookies=function(){var t=G(),e=this.options.domain&&"."===this.options.domain[0]?this.options.domain.slice(1):this.options.domain;if(e&&x.isWebWorkerEnvironment()&&t!==e&&new RegExp(e+"$").test(t)){for(var n=t.split("."),r=e.split("."),i=n.length;i>r.length;--i){var o=n.slice(n.length-i).join(".");B.set(this._cookieName,null,{domain:"."+o})}B.set(this._cookieName,null,{})}},gt.prototype._getInitialDeviceId=function(t,e){if(t)return t;if(this.options.deviceIdFromUrlParam){var n=this._getDeviceIdFromUrlParam(this._getUrlParams());if(n)return n}return this.options.deviceId?this.options.deviceId:e||F()};var vt=function(t){for(var e=0;e<t.length;e++){var n=t[e].event.user_properties,r=t[e].event.event_properties,i=t[e].event.groups;t[e].event.user_properties=x.validateProperties(n),t[e].event.event_properties=x.validateProperties(r),t[e].event.groups=x.validateGroups(i)}};gt.prototype._trackParamsAndReferrer=function(){var t,e,n,r;if(this.options.includeUtm&&(t=this._initUtmData()),this.options.includeReferrer&&(e=this._saveReferrer(this._getReferrer())),this.options.includeGclid&&(n=this._saveGclid(this._getUrlParams())),this.options.includeFbclid&&(r=this._saveFbclid(this._getUrlParams())),this.options.logAttributionCapturedEvent){var i=_({},t,e,n,r);Object.keys(i).length>0&&this.logEvent(v.ATTRIBUTION_EVENT,i)}};var mt=function t(e,n){if("object"===S(n)){var r=new Set(["headers"]),i=function(r){if(Object.prototype.hasOwnProperty.call(e,r)){var i=n[r],o=S(e[r]);("transport"!==r||x.validateTransport(i))&&("sessionId"!==r||null===i?x.validateInput(i,r+" option",o)&&("boolean"===o?e[r]=!!i:"string"===o&&!x.isEmptyString(i)||"number"===o&&i>0||"function"===o?e[r]=i:"object"===o&&t(e[r],i)):e[r]=x.validateSessionId(i)?i:null)}};for(var o in n)r.has(o)?e[o]=_({},e[o],n[o]):Object.prototype.hasOwnProperty.call(n,o)&&i(o)}};gt.prototype.runQueuedFunctions=function(){var t=this._q;this._q=[];for(var e=0;e<t.length;e++){var n=this[t[e][0]];"function"===S(n)&&n.apply(this,t[e].slice(1))}},gt.prototype._apiKeySet=function(t){return!x.isEmptyString(this.options.apiKey)||(x.log.error("Invalid apiKey. Please set a valid apiKey with init() before calling "+t),!1)},gt.prototype._loadSavedUnsentEvents=function(t){var e=this._getFromStorage(tt,t),n=this._parseSavedUnsentEventsString(e,t);return this._setInStorage(tt,t,JSON.stringify(n)),n},gt.prototype._parseSavedUnsentEventsString=function(t,e){if(x.isEmptyString(t))return[];if("string"===S(t))try{var n=JSON.parse(t);if("array"===S(n))return n}catch(t){}return x.log.error("Unable to load "+e+" events. Restart with a new empty queue."),[]},gt.prototype.isNewSession=function(){return this._newSession},gt.prototype.onInit=function(t){this._isInitialized?t(this):this._onInitCallbacks.push(t)},gt.prototype.onNewSessionStart=function(t){this._onNewSessionStartCallbacks.push(t)},gt.prototype.getSessionId=function(){return this._sessionId},gt.prototype.nextEventId=function(){return this._eventId++,this._eventId},gt.prototype.nextIdentifyId=function(){return this._identifyId++,this._identifyId},gt.prototype.nextSequenceNumber=function(){return this._sequenceNumber++,this._sequenceNumber},gt.prototype._unsentCount=function(){return this._unsentEvents.length+this._unsentIdentifys.length},gt.prototype._sendEventsIfReady=function(){return 0!==this._unsentCount()&&(this.options.batchEvents?this._unsentCount()>=this.options.eventUploadThreshold||this.options.transport===v.TRANSPORT_BEACON?(this.sendEvents(),!0):(this._updateScheduled||(this._updateScheduled=!0,setTimeout(function(){this._updateScheduled=!1,this.sendEvents()}.bind(this),this.options.eventUploadPeriodMillis)),!1):(this.sendEvents(),!0))},gt.prototype.clearStorage=function(){return this._metadataStorage.clear()},gt.prototype._getFromStorage=function(t,e){return t.getItem(e+this._storageSuffix)},gt.prototype._setInStorage=function(t,e,n){t.setItem(e+this._storageSuffix,n)};var yt=function(t){if(t._useOldCookie){var e=t.cookieStorage.get(t._oldCookiename);"object"!==S(e)||It(t,e)}else{var n=t._metadataStorage.load();"object"===S(n)&&It(t,n)}},Et=function(t){var e=t.cookieStorage.get(t._oldCookiename);"object"===S(e)&&(It(t,e),bt(t))},It=function(t,e){e.deviceId&&(t.options.deviceId=e.deviceId),e.userId&&(t.options.userId=e.userId),null!==e.optOut&&void 0!==e.optOut&&!1!==e.optOut&&(t.options.optOut=e.optOut),e.sessionId&&(t._sessionId=parseInt(e.sessionId,10)),e.lastEventTime&&(t._lastEventTime=parseInt(e.lastEventTime,10)),e.eventId&&(t._eventId=parseInt(e.eventId,10)),e.identifyId&&(t._identifyId=parseInt(e.identifyId,10)),e.sequenceNumber&&(t._sequenceNumber=parseInt(e.sequenceNumber,10))},bt=function(t){var e={deviceId:t.options.deviceId,userId:t.options.userId,optOut:t.options.optOut,sessionId:t._sessionId,lastEventTime:t._lastEventTime,eventId:t._eventId,identifyId:t._identifyId,sequenceNumber:t._sequenceNumber};t._useOldCookie?t.cookieStorage.set(t.options.cookieName+t._storageSuffix,e):t._metadataStorage.save(e)};gt.prototype._initUtmData=function(t,e){t=t||this._getUrlParams(),e=e||this.cookieStorage.get("__utmz");var n,r,i,o,s,a,c,u,l,h,d,p=(r=t,i=(n=e)?"?"+n.split(".").slice(-1)[0].replace(/\|/g,"&"):"",o=function(t,e,n,r){return x.getQueryParam(t,e)||x.getQueryParam(n,r)},s=o(v.UTM_SOURCE,r,"utmcsr",i),a=o(v.UTM_MEDIUM,r,"utmcmd",i),c=o(v.UTM_CAMPAIGN,r,"utmccn",i),u=o(v.UTM_TERM,r,"utmctr",i),l=o(v.UTM_CONTENT,r,"utmcct",i),h={},(d=function(t,e){x.isEmptyString(e)||(h[t]=e)})(v.UTM_SOURCE,s),d(v.UTM_MEDIUM,a),d(v.UTM_CAMPAIGN,c),d(v.UTM_TERM,u),d(v.UTM_CONTENT,l),h);return St(this,p),p},gt.prototype._unsetUTMParams=function(){var t=new ot;t.unset(v.REFERRER),t.unset(v.UTM_SOURCE),t.unset(v.UTM_MEDIUM),t.unset(v.UTM_CAMPAIGN),t.unset(v.UTM_TERM),t.unset(v.UTM_CONTENT),this.identify(t)};var St=function(t,e){if("object"===S(e)&&0!==Object.keys(e).length){var n=new ot;for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n.setOnce("initial_"+r,e[r]),n.set(r,e[r]));t.identify(n)}};gt.prototype._getReferrer=function(){var t=this._getReferrerFromUrlParam(this._getUrlParams());return t||("undefined"!=typeof document?document.referrer:"")},gt.prototype._getUrlParams=function(){return E.location.search},gt.prototype._saveGclid=function(t){var e=x.getQueryParam("gclid",t);if(!x.isEmptyString(e)){var n={gclid:e};return St(this,n),n}},gt.prototype._saveFbclid=function(t){var e=x.getQueryParam("fbclid",t);if(!x.isEmptyString(e)){var n={fbclid:e};return St(this,n),n}},gt.prototype._getDeviceIdFromUrlParam=function(t){return x.getQueryParam(v.AMP_DEVICE_ID_PARAM,t)},gt.prototype._getReferrerFromUrlParam=function(t){return x.getQueryParam(v.AMP_REFERRER_PARAM,t)},gt.prototype._getReferringDomain=function(t){if(x.isEmptyString(t))return null;var e=t.split("/");return e.length>=3?e[2]:null},gt.prototype._saveReferrer=function(t){if(!x.isEmptyString(t)){var e={referrer:t,referring_domain:this._getReferringDomain(t)};return St(this,e),e}},gt.prototype.saveEvents=function(){try{var t=JSON.stringify(this._unsentEvents.map((function(t){return t.event})));this._setInStorage(tt,this.options.unsentKey,t)}catch(t){}try{var e=JSON.stringify(this._unsentIdentifys.map((function(t){return t.event})));this._setInStorage(tt,this.options.unsentIdentifyKey,e)}catch(t){}},gt.prototype.setDomain=function(t){if(this._shouldDeferCall())return this._q.push(["setDomain"].concat(Array.prototype.slice.call(arguments,0)));if(x.validateInput(t,"domain","string"))try{this.cookieStorage.options({expirationDays:this.options.cookieExpiration,secure:this.options.secureCookie,domain:t,sameSite:this.options.sameSiteCookie}),this.options.domain=this.cookieStorage.options().domain,yt(this),bt(this)}catch(t){x.log.error(t)}},gt.prototype.setUserId=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(x.validateInput(e,"startNewSession","boolean")){if(this._shouldDeferCall())return this._q.push(["setUserId"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.userId=null!=t&&""+t||null,e&&(this.options.unsetParamsReferrerOnNewSession&&this._unsetUTMParams(),this._newSession=!0,this._sessionId=(new Date).getTime(),this._runNewSessionStartCallbacks(),this.options.saveParamsReferrerOncePerSession&&this._trackParamsAndReferrer()),bt(this),this._connector&&this._connector.identityStore.editIdentity().setUserId(this.options.userId).commit()}catch(t){x.log.error(t)}}},gt.prototype.setGroup=function(t,e){if(this._shouldDeferCall())return this._q.push(["setGroup"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("setGroup()")&&x.validateInput(t,"groupType","string")&&!x.isEmptyString(t)){var n={};n[t]=e;var r=(new ot).set(t,e);this._logEvent(v.IDENTIFY_EVENT,null,null,r.userPropertiesOperations,n,null,null,null)}},gt.prototype.setOptOut=function(t){if(this._shouldDeferCall())return this._q.push(["setOptOut"].concat(Array.prototype.slice.call(arguments,0)));if(x.validateInput(t,"enable","boolean"))try{this.options.optOut=t,bt(this)}catch(t){x.log.error(t)}},gt.prototype.setSessionId=function(t){if(x.validateInput(t,"sessionId","number"))try{this._sessionId=t,bt(this)}catch(t){x.log.error(t)}},gt.prototype.resetSessionId=function(){this.setSessionId((new Date).getTime())},gt.prototype.regenerateDeviceId=function(){if(this._shouldDeferCall())return this._q.push(["regenerateDeviceId"].concat(Array.prototype.slice.call(arguments,0)));this.setDeviceId(F())},gt.prototype.setDeviceId=function(t){if(this._shouldDeferCall())return this._q.push(["setDeviceId"].concat(Array.prototype.slice.call(arguments,0)));if(x.validateDeviceId(t))try{x.isEmptyString(t)||(this.options.deviceId=""+t,bt(this),this._connector&&this._connector.identityStore.editIdentity().setDeviceId(this.options.deviceId).commit())}catch(t){x.log.error(t)}},gt.prototype.setTransport=function(t){if(this._shouldDeferCall())return this._q.push(["setTransport"].concat(Array.prototype.slice.call(arguments,0)));x.validateTransport(t)&&(this.options.transport=t)},gt.prototype.setUserProperties=function(t){if(this._shouldDeferCall())return this._q.push(["setUserProperties"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("setUserProperties()")&&x.validateInput(t,"userProperties","object")){var e=x.truncate(x.validateProperties(t));if(0!==Object.keys(e).length){var n=new ot;for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.set(r,e[r]);this.identify(n)}}},gt.prototype.clearUserProperties=function(){if(this._shouldDeferCall())return this._q.push(["clearUserProperties"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("clearUserProperties()")){var t=new ot;t.clearAll(),this.identify(t)}};var Tt=function(t,e){for(var n=0;n<e._q.length;n++){var r=t[e._q[n][0]];"function"===S(r)&&r.apply(t,e._q[n].slice(1))}return t};gt.prototype.identify=function(t,e,n,r){if(this._shouldDeferCall())return this._q.push(["identify"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("identify()"))if("object"===S(t)&&Object.prototype.hasOwnProperty.call(t,"_q")&&(t=Tt(new ot,t)),t instanceof ot){if(Object.keys(t.userPropertiesOperations).length>0)return this._logEvent(v.IDENTIFY_EVENT,null,null,t.userPropertiesOperations,null,null,null,e,n,r);kt(e,n,0,"No request sent",{reason:"No user property operations"})}else x.log.error("Invalid identify input type. Expected Identify object but saw "+S(t)),kt(e,n,0,"No request sent",{reason:"Invalid identify input type"});else kt(e,n,0,"No request sent",{reason:"API key is not set"})},gt.prototype.groupIdentify=function(t,e,n,r,i,o){if(this._shouldDeferCall())return this._q.push(["groupIdentify"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("groupIdentify()"))if(x.validateInput(t,"group_type","string")&&!x.isEmptyString(t))if(null!=e)if("object"===S(n)&&Object.prototype.hasOwnProperty.call(n,"_q")&&(n=Tt(new ot,n)),n instanceof ot){if(Object.keys(n.userPropertiesOperations).length>0)return this._logEvent(v.GROUP_IDENTIFY_EVENT,null,null,null,f({},t,e),n.userPropertiesOperations,null,r,i,o);kt(r,i,0,"No request sent",{reason:"No group property operations"})}else x.log.error("Invalid identify input type. Expected Identify object but saw "+S(n)),kt(r,i,0,"No request sent",{reason:"Invalid identify input type"});else kt(r,i,0,"No request sent",{reason:"Invalid group name"});else kt(r,i,0,"No request sent",{reason:"Invalid group type"});else kt(r,i,0,"No request sent",{reason:"API key is not set"})},gt.prototype.setVersionName=function(t){if(this._shouldDeferCall())return this._q.push(["setVersionName"].concat(Array.prototype.slice.call(arguments,0)));x.validateInput(t,"versionName","string")&&(this.options.versionName=t)},gt.prototype._logEvent=function(t,e,n,r,i,o,s,a,c,u){if(yt(this),t)if(this.options.optOut)kt(a,c,0,"No request sent",{reason:"optOut is set to true"});else try{var l;l=t===v.IDENTIFY_EVENT||t===v.GROUP_IDENTIFY_EVENT?this.nextIdentifyId():this.nextEventId();var h=this.nextSequenceNumber(),d="number"===S(s)?s:(new Date).getTime();u?this._sessionId=-1:(!this._sessionId||!this._lastEventTime||d-this._lastEventTime>this.options.sessionTimeout)&&(this._sessionId=d,this._runNewSessionStartCallbacks()),this._lastEventTime=d,bt(this);var p=this._ua.browser.name,f=this._ua.browser.major,g=this._ua.device.model||this._ua.os.name,m=this._ua.device.vendor;r=r||{};var y=_({},this._apiPropertiesTrackingOptions);n=_({},n||{},y),e=e||{},i=i||{},o=o||{};var E={device_id:this.options.deviceId,user_id:this.options.userId,timestamp:d,event_id:l,session_id:this._sessionId||-1,event_type:t,version_name:this.options.versionName||null,platform:Ct(this,"platform")?this.options.platform:null,os_name:Ct(this,"os_name")&&p||null,os_version:Ct(this,"os_version")&&f||null,device_model:Ct(this,"device_model")&&g||null,device_manufacturer:Ct(this,"device_manufacturer")&&m||null,language:Ct(this,"language")?this.options.language:null,api_properties:n,event_properties:x.truncate(x.validateProperties(e)),user_properties:x.truncate(x.validateProperties(r)),uuid:ut(),library:this.options.library,sequence_number:h,groups:x.truncate(x.validateGroups(i)),group_properties:x.truncate(x.validateProperties(o)),user_agent:this._userAgent,partner_id:this.options.partnerId||null};return wt(this)&&(E.plan={branch:this.options.plan.branch||void 0,source:this.options.plan.source||void 0,version:this.options.plan.version||void 0,versionId:this.options.plan.versionId||void 0}),Ot(this)&&(E.ingestion_metadata={source_name:this.options.ingestionMetadata.sourceName||void 0,source_version:this.options.ingestionMetadata.sourceVersion||void 0}),t===v.IDENTIFY_EVENT||t===v.GROUP_IDENTIFY_EVENT?(this._unsentIdentifys.push({event:E,callback:a,errorCallback:c}),this._limitEventsQueued(this._unsentIdentifys)):(this._unsentEvents.push({event:E,callback:a,errorCallback:c}),this._limitEventsQueued(this._unsentEvents)),this.options.saveEvents&&this.saveEvents(),this._sendEventsIfReady(),t===v.IDENTIFY_EVENT&&this._connector&&this._connector.identityStore.editIdentity().updateUserProperties(x.truncate(x.validateProperties(r))).commit(),l}catch(t){x.log.error(t)}else kt(a,c,0,"No request sent",{reason:"Missing eventType"})};var wt=function(t){return t.options.plan&&(t.options.plan.source||t.options.plan.branch||t.options.plan.version||t.options.plan.versionId)},Ot=function(t){return t.options.ingestionMetadata&&(t.options.ingestionMetadata.sourceName||t.options.ingestionMetadata.sourceVersion)},Ct=function(t,e){return!!t.options.trackingOptions[e]},At=function(t){for(var e=["city","country","dma","ip_address","region"],n={},r=0;r<e.length;r++){var i=e[r];Ct(t,i)||(n[i]=!1)}return n};gt.prototype._limitEventsQueued=function(t){t.length>this.options.savedMaxCount&&t.splice(0,t.length-this.options.savedMaxCount).forEach((function(t){kt(t.callback,t.errorCallback,0,"No request sent",{reason:"Event dropped because options.savedMaxCount exceeded. User may be offline or have a content blocker"})}))},gt.prototype.logEvent=function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return this._shouldDeferCall()?this._q.push(["logEvent"].concat(Array.prototype.slice.call(arguments,0))):this.logEventWithTimestamp(t,e,null,n,r,i)},gt.prototype.logEventWithTimestamp=function(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return this._shouldDeferCall()?this._q.push(["logEventWithTimestamp"].concat(Array.prototype.slice.call(arguments,0))):this._apiKeySet("logEvent()")?x.validateInput(t,"eventType","string")?x.isEmptyString(t)?(kt(r,i,0,"No request sent",{reason:"Missing eventType"}),-1):(x.validateInput(o,"outOfSession","boolean")||kt(r,i,0,"No request sent",{reason:"Invalid outOfSession value"}),this._logEvent(t,e,null,null,null,null,n,r,i,o)):(kt(r,i,0,"No request sent",{reason:"Invalid type for eventType"}),-1):(kt(r,i,0,"No request sent",{reason:"API key not set"}),-1)},gt.prototype.logEventWithGroups=function(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return this._shouldDeferCall()?this._q.push(["logEventWithGroups"].concat(Array.prototype.slice.call(arguments,0))):this._apiKeySet("logEventWithGroups()")?x.validateInput(t,"eventType","string")?(x.validateInput(o,"outOfSession","boolean")||kt(event.callback,event.errorCallback,0,"No request sent",{reason:"Invalid outOfSession value"}),this._logEvent(t,e,null,null,n,null,null,r,i,o)):(kt(event.callback,event.errorCallback,0,"No request sent",{reason:"Invalid type for eventType"}),-1):(kt(event.callback,event.errorCallback,0,"No request sent",{reason:"API key not set"}),-1)};var Rt=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},kt=function(t,e,n,r,i){"function"===S(t)&&t(n,r,i),"function"===S(e)&&e(n,r,i)};gt.prototype.logRevenueV2=function(t){if(this._shouldDeferCall())return this._q.push(["logRevenueV2"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("logRevenueV2()"))if("object"===S(t)&&Object.prototype.hasOwnProperty.call(t,"_q")&&(t=Tt(new ct,t)),t instanceof ct){if(t&&t._isValidRevenue())return this.logEvent(v.REVENUE_EVENT,t._toJSONObject())}else x.log.error("Invalid revenue input type. Expected Revenue object but saw "+S(t))},gt.prototype.logRevenue=function(t,e,n){return this._shouldDeferCall()?this._q.push(["logRevenue"].concat(Array.prototype.slice.call(arguments,0))):this._apiKeySet("logRevenue()")&&Rt(t)&&(void 0===e||Rt(e))?this._logEvent(v.REVENUE_EVENT,{},{productId:n,special:"revenue_amount",quantity:e||1,price:t},null,null,null,null,null):-1},gt.prototype._logErrorsOnEvents=function(t,e,n,r){for(var i=["_unsentEvents","_unsentIdentifys"],o=0;o<i.length;o++)for(var s=i[o],a="_unsentEvents"===s?t:e,c=0;c<this[s].length;c++){var u=this[s][c];u.event.event_id<=a&&u.errorCallback&&u.errorCallback(n,r)}},gt.prototype.removeEvents=function(t,e,n,r){Dt(this,"_unsentEvents",t,n,r),Dt(this,"_unsentIdentifys",e,n,r)};var Dt=function(t,e,n,r,i){if(!(n<0)){for(var o=[],s=0;s<t[e].length;s++){var a=t[e][s];a.event.event_id>n?o.push(a):a.callback&&a.callback(r,i)}t[e]=o}};gt.prototype.sendEvents=function(){if(this._apiKeySet("sendEvents()")){if(this.options.optOut)this.removeEvents(1/0,1/0,0,"No request sent",{reason:"Opt out is set to true"});else if(0!==this._unsentCount()){if(this.options.transport!==v.TRANSPORT_BEACON){if(this._sending)return;this._sending=!0}var t=(this.options.forceHttps||"https:"===E.location.protocol?"https":"http")+"://"+this.options.apiEndpoint,e=Math.min(this._unsentCount(),this.options.uploadBatchSize),n=this._mergeEventsAndIdentifys(e),r=n.maxEventId,i=n.maxIdentifyId,s=JSON.stringify(n.eventsToSend.map((function(t){return t.event}))),a=(new Date).getTime(),c={client:this.options.apiKey,e:s,v:v.API_VERSION,upload_time:a,checksum:o()(v.API_VERSION+this.options.apiKey+s+a)};if(this.options.transport!==v.TRANSPORT_BEACON||"undefined"==typeof navigator){var u=this;try{new st(t,c,this.options.headers).send((function(t,n){u._sending=!1;try{200===t&&"success"===n?(u.removeEvents(r,i,t,n),u.options.saveEvents&&u.saveEvents(),u._sendEventsIfReady()):(u._logErrorsOnEvents(r,i,t,n),413===t&&(1===u.options.uploadBatchSize&&u.removeEvents(r,i,t,n),u.options.uploadBatchSize=Math.ceil(e/2),u.sendEvents()))}catch(t){}}))}catch(t){var l="Request failed to send";x.log.error(l),u._logErrorsOnEvents(r,i,0,l),u.removeEvents(r,i,0,l,{reason:t.message})}}else{navigator.sendBeacon(t,new URLSearchParams(c))?(this.removeEvents(r,i,200,"success"),this.options.saveEvents&&this.saveEvents()):this._logErrorsOnEvents(r,i,0,"")}}}else this.removeEvents(1/0,1/0,0,"No request sent",{reason:"API key not set"})},gt.prototype._mergeEventsAndIdentifys=function(t){for(var e=[],n=0,r=-1,i=0,o=-1;e.length<t;){var s=void 0,a=i>=this._unsentIdentifys.length,c=n>=this._unsentEvents.length;if(c&&a){x.log.error("Merging Events and Identifys, less events and identifys than expected");break}a?r=(s=this._unsentEvents[n++]).event.event_id:c?o=(s=this._unsentIdentifys[i++]).event.event_id:!("sequence_number"in this._unsentEvents[n].event)||this._unsentEvents[n].event.sequence_number<this._unsentIdentifys[i].event.sequence_number?r=(s=this._unsentEvents[n++]).event.event_id:o=(s=this._unsentIdentifys[i++]).event.event_id,e.push(s)}return{eventsToSend:e,maxEventId:r,maxIdentifyId:o}},gt.prototype.setGlobalUserProperties=function(t){this.setUserProperties(t)},gt.prototype.__VERSION__=function(){return this.options.library.version},gt.prototype.setLibrary=function(t,e){null!=t&&(this.options.library.name=t),null!=e&&(this.options.library.version=e)},gt.prototype._shouldDeferCall=function(){return this._pendingReadStorage||this._initializationDeferred},gt.prototype._deferInitialization=function(){this._initializationDeferred=!0,this._q.push(["init"].concat(Array.prototype.slice.call(arguments,0)))},gt.prototype.enableTracking=function(){this._initializationDeferred=!1,bt(this),this.runQueuedFunctions()},gt.prototype._refreshDynamicConfig=function(){this.options.useDynamicConfig&&_t.refresh(this.options.serverZone,this.options.forceHttps,function(){this.options.apiEndpoint=_t.ingestionEndpoint}.bind(this))},gt.prototype.getDeviceId=function(){return this.options.deviceId},gt.prototype.getUserId=function(){return this.options.userId},gt.prototype.setMinTimeBetweenSessionsMillis=function(t){if(x.validateInput(t,"timeInMillis","number")){if(this._shouldDeferCall())return this._q.push(["setMinTimeBetweenSessionsMillis"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.sessionTimeout=t}catch(t){x.log.error(t)}}},gt.prototype.setEventUploadThreshold=function(t){if(x.validateInput(t,"eventUploadThreshold","number")){if(this._shouldDeferCall())return this._q.push(["setEventUploadThreshold"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.eventUploadThreshold=t}catch(t){x.log.error(t)}}},gt.prototype.setUseDynamicConfig=function(t){if(x.validateInput(t,"useDynamicConfig","boolean")){if(this._shouldDeferCall())return this._q.push(["setUseDynamicConfig"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.useDynamicConfig=t,this._refreshDynamicConfig()}catch(t){x.log.error(t)}}},gt.prototype.setServerZone=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if((t===ht.EU||t===ht.US)&&x.validateInput(e,"serverZoneBasedApi","boolean")){if(this._shouldDeferCall())return this._q.push(["setServerZone"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.serverZone=t,this.options.serverZoneBasedApi=e,e&&(this.options.apiEndpoint=dt(this.options.serverZone))}catch(t){x.log.error(t)}}},gt.prototype.setServerUrl=function(t){if(x.validateInput(t,"serverUrl","string")){if(this._shouldDeferCall())return this._q.push(["setServerUrl"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.apiEndpoint=t}catch(t){x.log.error(t)}}};var Nt=function(){this.options=_({},ft),this._q=[],this._instances={}};Nt.prototype.Identify=ot,Nt.prototype.Revenue=ct,Nt.prototype.getInstance=function(t){t=x.isEmptyString(t)?v.DEFAULT_INSTANCE:t.toLowerCase();var e=this._instances[t];return void 0===e&&(e=new gt(t),this._instances[t]=e),e},Nt.prototype.init=function(t,e,n,r){this.getInstance().init(t,e,n,function(t){this.options=t.options,"function"===S(r)&&r(t)}.bind(this))},Nt.prototype.isNewSession=function(){return this.getInstance().isNewSession()},Nt.prototype.getSessionId=function(){return this.getInstance().getSessionId()},Nt.prototype.nextEventId=function(){return this.getInstance().nextEventId()},Nt.prototype.nextIdentifyId=function(){return this.getInstance().nextIdentifyId()},Nt.prototype.nextSequenceNumber=function(){return this.getInstance().nextSequenceNumber()},Nt.prototype.saveEvents=function(){this.getInstance().saveEvents()},Nt.prototype.setDomain=function(t){this.getInstance().setDomain(t)},Nt.prototype.setUserId=function(t){this.getInstance().setUserId(t)},Nt.prototype.setGroup=function(t,e){this.getInstance().setGroup(t,e)},Nt.prototype.setOptOut=function(t){this.getInstance().setOptOut(t)},Nt.prototype.regenerateDeviceId=function(){this.getInstance().regenerateDeviceId()},Nt.prototype.setDeviceId=function(t){this.getInstance().setDeviceId(t)},Nt.prototype.setUserProperties=function(t){this.getInstance().setUserProperties(t)},Nt.prototype.clearUserProperties=function(){this.getInstance().clearUserProperties()},Nt.prototype.identify=function(t,e){this.getInstance().identify(t,e)},Nt.prototype.setVersionName=function(t){this.getInstance().setVersionName(t)},Nt.prototype.logEvent=function(t,e,n){return this.getInstance().logEvent(t,e,n)},Nt.prototype.logEventWithGroups=function(t,e,n,r){return this.getInstance().logEventWithGroups(t,e,n,r)},Nt.prototype.logRevenueV2=function(t){return this.getInstance().logRevenueV2(t)},Nt.prototype.logRevenue=function(t,e,n){return this.getInstance().logRevenue(t,e,n)},Nt.prototype.removeEvents=function(t,e){this.getInstance().removeEvents(t,e)},Nt.prototype.sendEvents=function(t){this.getInstance().sendEvents(t)},Nt.prototype.setGlobalUserProperties=function(t){this.getInstance().setUserProperties(t)},Nt.prototype.__VERSION__=pt;var Pt=void 0!==E&&E.amplitude||{},Lt=new Nt;for(var xt in Lt._q=Pt._q||[],Pt._iq)Object.prototype.hasOwnProperty.call(Pt._iq,xt)&&(Lt.getInstance(xt)._q=Pt._iq[xt]._q||[])},9742:(t,e)=>{"use strict";e.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,o=c(t),s=o[0],a=o[1],u=new i(function(t,e,n){return 3*(e+n)/4-n}(0,s,a)),l=0,h=a>0?s-4:s;for(n=0;n<h;n+=4)e=r[t.charCodeAt(n)]<<18|r[t.charCodeAt(n+1)]<<12|r[t.charCodeAt(n+2)]<<6|r[t.charCodeAt(n+3)],u[l++]=e>>16&255,u[l++]=e>>8&255,u[l++]=255&e;2===a&&(e=r[t.charCodeAt(n)]<<2|r[t.charCodeAt(n+1)]>>4,u[l++]=255&e);1===a&&(e=r[t.charCodeAt(n)]<<10|r[t.charCodeAt(n+1)]<<4|r[t.charCodeAt(n+2)]>>2,u[l++]=e>>8&255,u[l++]=255&e);return u},e.fromByteArray=function(t){for(var e,r=t.length,i=r%3,o=[],s=16383,a=0,c=r-i;a<c;a+=s)o.push(u(t,a,a+s>c?c:a+s));1===i?(e=t[r-1],o.push(n[e>>2]+n[e<<4&63]+"==")):2===i&&(e=(t[r-2]<<8)+t[r-1],o.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"="));return o.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=o.length;s<a;++s)n[s]=o[s],r[o.charCodeAt(s)]=s;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function u(t,e,r){for(var i,o,s=[],a=e;a<r;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},9560:function(t,e,n){var r;!function(i){"use strict";function o(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function s(t,e,n,r,i,s){return o((a=o(o(e,t),o(r,s)))<<(c=i)|a>>>32-c,n);var a,c}function a(t,e,n,r,i,o,a){return s(e&n|~e&r,t,e,i,o,a)}function c(t,e,n,r,i,o,a){return s(e&r|n&~r,t,e,i,o,a)}function u(t,e,n,r,i,o,a){return s(e^n^r,t,e,i,o,a)}function l(t,e,n,r,i,o,a){return s(n^(e|~r),t,e,i,o,a)}function h(t,e){var n,r,i,s,h;t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var d=1732584193,p=-271733879,f=-1732584194,_=271733878;for(n=0;n<t.length;n+=16)r=d,i=p,s=f,h=_,d=a(d,p,f,_,t[n],7,-680876936),_=a(_,d,p,f,t[n+1],12,-389564586),f=a(f,_,d,p,t[n+2],17,606105819),p=a(p,f,_,d,t[n+3],22,-1044525330),d=a(d,p,f,_,t[n+4],7,-176418897),_=a(_,d,p,f,t[n+5],12,1200080426),f=a(f,_,d,p,t[n+6],17,-1473231341),p=a(p,f,_,d,t[n+7],22,-45705983),d=a(d,p,f,_,t[n+8],7,1770035416),_=a(_,d,p,f,t[n+9],12,-1958414417),f=a(f,_,d,p,t[n+10],17,-42063),p=a(p,f,_,d,t[n+11],22,-1990404162),d=a(d,p,f,_,t[n+12],7,1804603682),_=a(_,d,p,f,t[n+13],12,-40341101),f=a(f,_,d,p,t[n+14],17,-1502002290),d=c(d,p=a(p,f,_,d,t[n+15],22,1236535329),f,_,t[n+1],5,-165796510),_=c(_,d,p,f,t[n+6],9,-1069501632),f=c(f,_,d,p,t[n+11],14,643717713),p=c(p,f,_,d,t[n],20,-373897302),d=c(d,p,f,_,t[n+5],5,-701558691),_=c(_,d,p,f,t[n+10],9,38016083),f=c(f,_,d,p,t[n+15],14,-660478335),p=c(p,f,_,d,t[n+4],20,-405537848),d=c(d,p,f,_,t[n+9],5,568446438),_=c(_,d,p,f,t[n+14],9,-1019803690),f=c(f,_,d,p,t[n+3],14,-187363961),p=c(p,f,_,d,t[n+8],20,1163531501),d=c(d,p,f,_,t[n+13],5,-1444681467),_=c(_,d,p,f,t[n+2],9,-51403784),f=c(f,_,d,p,t[n+7],14,1735328473),d=u(d,p=c(p,f,_,d,t[n+12],20,-1926607734),f,_,t[n+5],4,-378558),_=u(_,d,p,f,t[n+8],11,-2022574463),f=u(f,_,d,p,t[n+11],16,1839030562),p=u(p,f,_,d,t[n+14],23,-35309556),d=u(d,p,f,_,t[n+1],4,-1530992060),_=u(_,d,p,f,t[n+4],11,1272893353),f=u(f,_,d,p,t[n+7],16,-155497632),p=u(p,f,_,d,t[n+10],23,-1094730640),d=u(d,p,f,_,t[n+13],4,681279174),_=u(_,d,p,f,t[n],11,-358537222),f=u(f,_,d,p,t[n+3],16,-722521979),p=u(p,f,_,d,t[n+6],23,76029189),d=u(d,p,f,_,t[n+9],4,-640364487),_=u(_,d,p,f,t[n+12],11,-421815835),f=u(f,_,d,p,t[n+15],16,530742520),d=l(d,p=u(p,f,_,d,t[n+2],23,-995338651),f,_,t[n],6,-198630844),_=l(_,d,p,f,t[n+7],10,1126891415),f=l(f,_,d,p,t[n+14],15,-1416354905),p=l(p,f,_,d,t[n+5],21,-57434055),d=l(d,p,f,_,t[n+12],6,1700485571),_=l(_,d,p,f,t[n+3],10,-1894986606),f=l(f,_,d,p,t[n+10],15,-1051523),p=l(p,f,_,d,t[n+1],21,-2054922799),d=l(d,p,f,_,t[n+8],6,1873313359),_=l(_,d,p,f,t[n+15],10,-30611744),f=l(f,_,d,p,t[n+6],15,-1560198380),p=l(p,f,_,d,t[n+13],21,1309151649),d=l(d,p,f,_,t[n+4],6,-145523070),_=l(_,d,p,f,t[n+11],10,-1120210379),f=l(f,_,d,p,t[n+2],15,718787259),p=l(p,f,_,d,t[n+9],21,-343485551),d=o(d,r),p=o(p,i),f=o(f,s),_=o(_,h);return[d,p,f,_]}function d(t){var e,n="",r=32*t.length;for(e=0;e<r;e+=8)n+=String.fromCharCode(t[e>>5]>>>e%32&255);return n}function p(t){var e,n=[];for(n[(t.length>>2)-1]=void 0,e=0;e<n.length;e+=1)n[e]=0;var r=8*t.length;for(e=0;e<r;e+=8)n[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return n}function f(t){var e,n,r="0123456789abcdef",i="";for(n=0;n<t.length;n+=1)e=t.charCodeAt(n),i+=r.charAt(e>>>4&15)+r.charAt(15&e);return i}function _(t){return unescape(encodeURIComponent(t))}function g(t){return function(t){return d(h(p(t),8*t.length))}(_(t))}function v(t,e){return function(t,e){var n,r,i=p(t),o=[],s=[];for(o[15]=s[15]=void 0,i.length>16&&(i=h(i,8*t.length)),n=0;n<16;n+=1)o[n]=909522486^i[n],s[n]=1549556828^i[n];return r=h(o.concat(p(e)),512+8*e.length),d(h(s.concat(r),640))}(_(t),_(e))}function m(t,e,n){return e?n?v(e,t):f(v(e,t)):n?g(t):f(g(t))}void 0===(r=function(){return m}.call(e,n,e,t))||(t.exports=r)}()},8764:(t,e,n)=>{"use strict";var r=n(9742),i=n(645),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.lW=c,e.h2=50;var s=2147483647;function a(t){if(t>s)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,c.prototype),e}function c(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return h(t)}return u(t,e,n)}function u(t,e,n){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!c.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var n=0|_(t,e),r=a(n),i=r.write(t,e);i!==n&&(r=r.slice(0,i));return r}(t,e);if(ArrayBuffer.isView(t))return function(t){if(B(t,Uint8Array)){var e=new Uint8Array(t);return p(e.buffer,e.byteOffset,e.byteLength)}return d(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(B(t,ArrayBuffer)||t&&B(t.buffer,ArrayBuffer))return p(t,e,n);if("undefined"!=typeof SharedArrayBuffer&&(B(t,SharedArrayBuffer)||t&&B(t.buffer,SharedArrayBuffer)))return p(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return c.from(r,e,n);var i=function(t){if(c.isBuffer(t)){var e=0|f(t.length),n=a(e);return 0===n.length||t.copy(n,0,0,e),n}if(void 0!==t.length)return"number"!=typeof t.length||G(t.length)?a(0):d(t);if("Buffer"===t.type&&Array.isArray(t.data))return d(t.data)}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return c.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function h(t){return l(t),a(t<0?0:0|f(t))}function d(t){for(var e=t.length<0?0:0|f(t.length),n=a(e),r=0;r<e;r+=1)n[r]=255&t[r];return n}function p(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(r,c.prototype),r}function f(t){if(t>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|t}function _(t,e){if(c.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||B(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return M(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(t).length;default:if(i)return r?-1:M(t).length;e=(""+e).toLowerCase(),i=!0}}function g(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return k(this,e,n);case"utf8":case"utf-8":return O(this,e,n);case"ascii":return A(this,e,n);case"latin1":case"binary":return R(this,e,n);case"base64":return w(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function v(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),G(n=+n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=c.from(e,r)),c.isBuffer(e))return 0===e.length?-1:y(t,e,n,r,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):y(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(t,e,n,r,i){var o,s=1,a=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var l=-1;for(o=n;o<a;o++)if(u(t,o)===u(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===c)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(n+c>a&&(n=a-c),o=n;o>=0;o--){for(var h=!0,d=0;d<c;d++)if(u(t,o+d)!==u(e,d)){h=!1;break}if(h)return o}return-1}function E(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(G(a))return s;t[n+s]=a}return s}function I(t,e,n,r){return j(M(e,t.length-n),t,n,r)}function b(t,e,n,r){return j(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function S(t,e,n,r){return j(H(e),t,n,r)}function T(t,e,n,r){return j(function(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=(n=t.charCodeAt(s))>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function w(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function O(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,c,u=t[i],l=null,h=u>239?4:u>223?3:u>191?2:1;if(i+h<=n)switch(h){case 1:u<128&&(l=u);break;case 2:128==(192&(o=t[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(c=(15&u)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,h=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return function(t){var e=t.length;if(e<=C)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=C));return n}(r)}c.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(t,e,n){return u(t,e,n)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(t,e,n){return function(t,e,n){return l(t),t<=0?a(t):void 0!==e?"string"==typeof n?a(t).fill(e,n):a(t).fill(e):a(t)}(t,e,n)},c.allocUnsafe=function(t){return h(t)},c.allocUnsafeSlow=function(t){return h(t)},c.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==c.prototype},c.compare=function(t,e){if(B(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),B(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=c.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var o=t[n];if(B(o,Uint8Array))i+o.length>r.length?c.from(o).copy(r,i):Uint8Array.prototype.set.call(r,o,i);else{if(!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i)}i+=o.length}return r},c.byteLength=_,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)v(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)v(this,e,e+3),v(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)v(this,e,e+7),v(this,e+1,e+6),v(this,e+2,e+5),v(this,e+3,e+4);return this},c.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?O(this,0,t):g.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",n=e.h2;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},o&&(c.prototype[o]=c.prototype.inspect),c.prototype.compare=function(t,e,n,r,i){if(B(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(o,s),u=this.slice(r,i),l=t.slice(e,n),h=0;h<a;++h)if(u[h]!==l[h]){o=u[h],s=l[h];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},c.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},c.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},c.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return E(this,t,e,n);case"utf8":case"utf-8":return I(this,t,e,n);case"ascii":case"latin1":case"binary":return b(this,t,e,n);case"base64":return S(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function A(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function R(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function k(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=W[t[o]];return i}function D(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length-1;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function N(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function P(t,e,n,r,i,o){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function L(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function x(t,e,n,r,o){return e=+e,n>>>=0,o||L(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function U(t,e,n,r,o){return e=+e,n>>>=0,o||L(t,0,n,8),i.write(t,e,n,r,52,8),n+8}c.prototype.slice=function(t,e){var n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var r=this.subarray(t,e);return Object.setPrototypeOf(r,c.prototype),r},c.prototype.readUintLE=c.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||N(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},c.prototype.readUintBE=c.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||N(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},c.prototype.readUint8=c.prototype.readUInt8=function(t,e){return t>>>=0,e||N(t,1,this.length),this[t]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(t,e){return t>>>=0,e||N(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(t,e){return t>>>=0,e||N(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(t,e){return t>>>=0,e||N(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(t,e){return t>>>=0,e||N(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||N(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},c.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||N(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},c.prototype.readInt8=function(t,e){return t>>>=0,e||N(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){t>>>=0,e||N(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(t,e){t>>>=0,e||N(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(t,e){return t>>>=0,e||N(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return t>>>=0,e||N(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return t>>>=0,e||N(t,4,this.length),i.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return t>>>=0,e||N(t,4,this.length),i.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return t>>>=0,e||N(t,8,this.length),i.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return t>>>=0,e||N(t,8,this.length),i.read(this,t,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e>>>=0,n>>>=0,r)||P(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e>>>=0,n>>>=0,r)||P(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},c.prototype.writeUint8=c.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||P(this,t,e,1,255,0),this[e]=255&t,e+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||P(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||P(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||P(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||P(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},c.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);P(this,t,e,n,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},c.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);P(this,t,e,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},c.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||P(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||P(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},c.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||P(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},c.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||P(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},c.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||P(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},c.prototype.writeFloatLE=function(t,e,n){return x(this,t,e,!0,n)},c.prototype.writeFloatBE=function(t,e,n){return x(this,t,e,!1,n)},c.prototype.writeDoubleLE=function(t,e,n){return U(this,t,e,!0,n)},c.prototype.writeDoubleBE=function(t,e,n){return U(this,t,e,!1,n)},c.prototype.copy=function(t,e,n,r){if(!c.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i=r-n;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,n,r):Uint8Array.prototype.set.call(t,this.subarray(n,r),e),i},c.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){var i=t.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(t=i)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=c.isBuffer(t)?t:c.from(t,r),a=s.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<n-e;++o)this[o+e]=s[o%a]}return this};var F=/[^+/0-9A-Za-z-_]/g;function M(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function H(t){return r.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(F,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function j(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function B(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function G(t){return t!=t}var W=function(){for(var t="0123456789abcdef",e=new Array(256),n=0;n<16;++n)for(var r=16*n,i=0;i<16;++i)e[r+i]=t[n]+t[i];return e}()},8767:t=>{function e(t){if(t)return function(t){for(var n in e.prototype)t[n]=e.prototype[n];return t}(t)}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},e.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;i<r.length;i++)if((n=r[i])===e||n.fn===e){r.splice(i,1);break}return this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks["$"+t];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,e);return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}},4020:t=>{"use strict";var e="%[a-f0-9]{2}",n=new RegExp("("+e+")|([^%]+?)","gi"),r=new RegExp("("+e+")+","gi");function i(t,e){try{return[decodeURIComponent(t.join(""))]}catch(t){}if(1===t.length)return t;e=e||1;var n=t.slice(0,e),r=t.slice(e);return Array.prototype.concat.call([],i(n),i(r))}function o(t){try{return decodeURIComponent(t)}catch(o){for(var e=t.match(n)||[],r=1;r<e.length;r++)e=(t=i(e,r).join("")).match(n)||[];return t}}t.exports=function(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch(e){return function(t){for(var e={"%FE%FF":"\ufffd\ufffd","%FF%FE":"\ufffd\ufffd"},n=r.exec(t);n;){try{e[n[0]]=decodeURIComponent(n[0])}catch(t){var i=o(n[0]);i!==n[0]&&(e[n[0]]=i)}n=r.exec(t)}e["%C2"]="\ufffd";for(var s=Object.keys(e),a=0;a<s.length;a++){var c=s[a];t=t.replace(new RegExp(c,"g"),e[c])}return t}(t)}}},6358:t=>{var e=function(t){"use strict";if("function"!=typeof t)return[];var e=t.toString().replace(/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,""),n=e.slice(e.indexOf("(")+1,e.indexOf(")")).match(/([^\s,]+)/g);return null===n?[]:n};void 0!==t.exports&&(t.exports=e),"undefined"!=typeof window&&(window.GetParams=e)},645:(t,e)=>{e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,u=c>>1,l=-7,h=n?i-1:0,d=n?-1:1,p=t[e+h];for(h+=d,o=p&(1<<-l)-1,p>>=-l,l+=a;l>0;o=256*o+t[e+h],h+=d,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+t[e+h],h+=d,l-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=u}return(p?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,c,u=8*o-i-1,l=(1<<u)-1,h=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,f=r?1:-1,_=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),(e+=s+h>=1?d/c:d*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(e*c-1)*Math.pow(2,i),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[n+p]=255&a,p+=f,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[n+p]=255&s,p+=f,s/=256,u-=8);t[n+p-f]|=128*_}},5369:(t,e,n)=>{"use strict";n.d(e,{D5:()=>xe,TS:()=>Te,WV:()=>dr,aV:()=>sn,d0:()=>mr,l4:()=>Fn});var r="delete",i=5,o=1<<i,s=o-1,a={};function c(t){t&&(t.value=!0)}function u(){}function l(t){return void 0===t.size&&(t.size=t.__iterate(d)),t.size}function h(t,e){if("number"!=typeof e){var n=e>>>0;if(""+n!==e||4294967295===n)return NaN;e=n}return e<0?l(t)+e:e}function d(){return!0}function p(t,e,n){return(0===t&&!v(t)||void 0!==n&&t<=-n)&&(void 0===e||void 0!==n&&e>=n)}function f(t,e){return g(t,e,0)}function _(t,e){return g(t,e,e)}function g(t,e,n){return void 0===t?n:v(t)?e===1/0?e:0|Math.max(0,e+t):void 0===e||e===t?t:0|Math.min(e,t)}function v(t){return t<0||0===t&&1/t==-1/0}var m="@@__IMMUTABLE_ITERABLE__@@";function y(t){return Boolean(t&&t[m])}var E="@@__IMMUTABLE_KEYED__@@";function I(t){return Boolean(t&&t[E])}var b="@@__IMMUTABLE_INDEXED__@@";function S(t){return Boolean(t&&t[b])}function T(t){return I(t)||S(t)}var w=function(t){return y(t)?t:J(t)},O=function(t){function e(t){return I(t)?t:X(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(w),C=function(t){function e(t){return S(t)?t:Z(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(w),A=function(t){function e(t){return y(t)&&!T(t)?t:tt(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(w);w.Keyed=O,w.Indexed=C,w.Set=A;var R="@@__IMMUTABLE_SEQ__@@";function k(t){return Boolean(t&&t[R])}var D="@@__IMMUTABLE_RECORD__@@";function N(t){return Boolean(t&&t[D])}function P(t){return y(t)||N(t)}var L="@@__IMMUTABLE_ORDERED__@@";function x(t){return Boolean(t&&t[L])}var U=0,F=1,M=2,H="function"==typeof Symbol&&Symbol.iterator,j="@@iterator",B=H||j,G=function(t){this.next=t};function W(t,e,n,r){var i=0===t?e:1===t?n:[e,n];return r?r.value=i:r={value:i,done:!1},r}function z(){return{value:void 0,done:!0}}function V(t){return!!Array.isArray(t)||!!Y(t)}function q(t){return t&&"function"==typeof t.next}function $(t){var e=Y(t);return e&&e.call(t)}function Y(t){var e=t&&(H&&t[H]||t[j]);if("function"==typeof e)return e}G.prototype.toString=function(){return"[Iterator]"},G.KEYS=U,G.VALUES=F,G.ENTRIES=M,G.prototype.inspect=G.prototype.toSource=function(){return this.toString()},G.prototype[B]=function(){return this};var K=Object.prototype.hasOwnProperty;function Q(t){return!(!Array.isArray(t)&&"string"!=typeof t)||t&&"object"==typeof t&&Number.isInteger(t.length)&&t.length>=0&&(0===t.length?1===Object.keys(t).length:t.hasOwnProperty(t.length-1))}var J=function(t){function e(t){return null==t?ot():P(t)?t.toSeq():function(t){var e=ct(t);if(e)return(r=Y(n=t))&&r===n.entries?e.fromEntrySeq():function(t){var e=Y(t);return e&&e===t.keys}(t)?e.toSetSeq():e;var n,r;if("object"==typeof t)return new nt(t);throw new TypeError("Expected Array or collection object of values, or keyed object: "+t)}(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toSeq=function(){return this},e.prototype.toString=function(){return this.__toString("Seq {","}")},e.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},e.prototype.__iterate=function(t,e){var n=this._cache;if(n){for(var r=n.length,i=0;i!==r;){var o=n[e?r-++i:i++];if(!1===t(o[1],o[0],this))break}return i}return this.__iterateUncached(t,e)},e.prototype.__iterator=function(t,e){var n=this._cache;if(n){var r=n.length,i=0;return new G((function(){if(i===r)return{value:void 0,done:!0};var o=n[e?r-++i:i++];return W(t,o[0],o[1])}))}return this.__iteratorUncached(t,e)},e}(w),X=function(t){function e(t){return null==t?ot().toKeyedSeq():y(t)?I(t)?t.toSeq():t.fromEntrySeq():N(t)?t.toSeq():st(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toKeyedSeq=function(){return this},e}(J),Z=function(t){function e(t){return null==t?ot():y(t)?I(t)?t.entrySeq():t.toIndexedSeq():N(t)?t.toSeq().entrySeq():at(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return e(arguments)},e.prototype.toIndexedSeq=function(){return this},e.prototype.toString=function(){return this.__toString("Seq [","]")},e}(J),tt=function(t){function e(t){return(y(t)&&!T(t)?t:Z(t)).toSetSeq()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return e(arguments)},e.prototype.toSetSeq=function(){return this},e}(J);J.isSeq=k,J.Keyed=X,J.Set=tt,J.Indexed=Z,J.prototype[R]=!0;var et=function(t){function e(t){this._array=t,this.size=t.length}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t,e){return this.has(t)?this._array[h(this,t)]:e},e.prototype.__iterate=function(t,e){for(var n=this._array,r=n.length,i=0;i!==r;){var o=e?r-++i:i++;if(!1===t(n[o],o,this))break}return i},e.prototype.__iterator=function(t,e){var n=this._array,r=n.length,i=0;return new G((function(){if(i===r)return{value:void 0,done:!0};var o=e?r-++i:i++;return W(t,o,n[o])}))},e}(Z),nt=function(t){function e(t){var e=Object.keys(t).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t):[]);this._object=t,this._keys=e,this.size=e.length}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t,e){return void 0===e||this.has(t)?this._object[t]:e},e.prototype.has=function(t){return K.call(this._object,t)},e.prototype.__iterate=function(t,e){for(var n=this._object,r=this._keys,i=r.length,o=0;o!==i;){var s=r[e?i-++o:o++];if(!1===t(n[s],s,this))break}return o},e.prototype.__iterator=function(t,e){var n=this._object,r=this._keys,i=r.length,o=0;return new G((function(){if(o===i)return{value:void 0,done:!0};var s=r[e?i-++o:o++];return W(t,s,n[s])}))},e}(X);nt.prototype[L]=!0;var rt,it=function(t){function e(t){this._collection=t,this.size=t.length||t.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.__iterateUncached=function(t,e){if(e)return this.cacheResult().__iterate(t,e);var n=$(this._collection),r=0;if(q(n))for(var i;!(i=n.next()).done&&!1!==t(i.value,r++,this););return r},e.prototype.__iteratorUncached=function(t,e){if(e)return this.cacheResult().__iterator(t,e);var n=$(this._collection);if(!q(n))return new G(z);var r=0;return new G((function(){var e=n.next();return e.done?e:W(t,r++,e.value)}))},e}(Z);function ot(){return rt||(rt=new et([]))}function st(t){var e=ct(t);if(e)return e.fromEntrySeq();if("object"==typeof t)return new nt(t);throw new TypeError("Expected Array or collection object of [k, v] entries, or keyed object: "+t)}function at(t){var e=ct(t);if(e)return e;throw new TypeError("Expected Array or collection object of values: "+t)}function ct(t){return Q(t)?new et(t):V(t)?new it(t):void 0}var ut="@@__IMMUTABLE_MAP__@@";function lt(t){return Boolean(t&&t[ut])}function ht(t){return lt(t)&&x(t)}function dt(t){return Boolean(t&&"function"==typeof t.equals&&"function"==typeof t.hashCode)}function pt(t,e){if(t===e||t!=t&&e!=e)return!0;if(!t||!e)return!1;if("function"==typeof t.valueOf&&"function"==typeof e.valueOf){if((t=t.valueOf())===(e=e.valueOf())||t!=t&&e!=e)return!0;if(!t||!e)return!1}return!!(dt(t)&&dt(e)&&t.equals(e))}var ft="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(t,e){var n=65535&(t|=0),r=65535&(e|=0);return n*r+((t>>>16)*r+n*(e>>>16)<<16>>>0)|0};function _t(t){return t>>>1&1073741824|3221225471&t}var gt=Object.prototype.valueOf;function vt(t){if(null==t)return mt(t);if("function"==typeof t.hashCode)return _t(t.hashCode(t));var e,n=(e=t).valueOf!==gt&&"function"==typeof e.valueOf?e.valueOf(e):e;if(null==n)return mt(n);switch(typeof n){case"boolean":return n?1108378657:1108378656;case"number":return function(t){if(t!=t||t===1/0)return 0;var e=0|t;e!==t&&(e^=4294967295*t);for(;t>4294967295;)e^=t/=4294967295;return _t(e)}(n);case"string":return n.length>At?function(t){var e=Dt[t];void 0===e&&(e=yt(t),kt===Rt&&(kt=0,Dt={}),kt++,Dt[t]=e);return e}(n):yt(n);case"object":case"function":return function(t){var e;if(Tt&&void 0!==(e=St.get(t)))return e;if(e=t[Ct],void 0!==e)return e;if(!It){if(void 0!==(e=t.propertyIsEnumerable&&t.propertyIsEnumerable[Ct]))return e;if(void 0!==(e=function(t){if(t&&t.nodeType>0)switch(t.nodeType){case 1:return t.uniqueID;case 9:return t.documentElement&&t.documentElement.uniqueID}}(t)))return e}if(e=bt(),Tt)St.set(t,e);else{if(void 0!==Et&&!1===Et(t))throw new Error("Non-extensible objects are not allowed as keys.");if(It)Object.defineProperty(t,Ct,{enumerable:!1,configurable:!1,writable:!1,value:e});else if(void 0!==t.propertyIsEnumerable&&t.propertyIsEnumerable===t.constructor.prototype.propertyIsEnumerable)t.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},t.propertyIsEnumerable[Ct]=e;else{if(void 0===t.nodeType)throw new Error("Unable to set a non-enumerable property on object.");t[Ct]=e}}return e}(n);case"symbol":return function(t){var e=wt[t];if(void 0!==e)return e;return e=bt(),wt[t]=e,e}(n);default:if("function"==typeof n.toString)return yt(n.toString());throw new Error("Value type "+typeof n+" cannot be hashed.")}}function mt(t){return null===t?1108378658:1108378659}function yt(t){for(var e=0,n=0;n<t.length;n++)e=31*e+t.charCodeAt(n)|0;return _t(e)}var Et=Object.isExtensible,It=function(){try{return Object.defineProperty({},"@",{}),!0}catch(t){return!1}}();function bt(){var t=++Ot;return 1073741824&Ot&&(Ot=0),t}var St,Tt="function"==typeof WeakMap;Tt&&(St=new WeakMap);var wt=Object.create(null),Ot=0,Ct="__immutablehash__";"function"==typeof Symbol&&(Ct=Symbol(Ct));var At=16,Rt=255,kt=0,Dt={},Nt=function(t){function e(t,e){this._iter=t,this._useKeys=e,this.size=t.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t,e){return this._iter.get(t,e)},e.prototype.has=function(t){return this._iter.has(t)},e.prototype.valueSeq=function(){return this._iter.valueSeq()},e.prototype.reverse=function(){var t=this,e=Mt(this,!0);return this._useKeys||(e.valueSeq=function(){return t._iter.toSeq().reverse()}),e},e.prototype.map=function(t,e){var n=this,r=Ft(this,t,e);return this._useKeys||(r.valueSeq=function(){return n._iter.toSeq().map(t,e)}),r},e.prototype.__iterate=function(t,e){var n=this;return this._iter.__iterate((function(e,r){return t(e,r,n)}),e)},e.prototype.__iterator=function(t,e){return this._iter.__iterator(t,e)},e}(X);Nt.prototype[L]=!0;var Pt=function(t){function e(t){this._iter=t,this.size=t.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.includes=function(t){return this._iter.includes(t)},e.prototype.__iterate=function(t,e){var n=this,r=0;return e&&l(this),this._iter.__iterate((function(i){return t(i,e?n.size-++r:r++,n)}),e)},e.prototype.__iterator=function(t,e){var n=this,r=this._iter.__iterator(F,e),i=0;return e&&l(this),new G((function(){var o=r.next();return o.done?o:W(t,e?n.size-++i:i++,o.value,o)}))},e}(Z),Lt=function(t){function e(t){this._iter=t,this.size=t.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.has=function(t){return this._iter.includes(t)},e.prototype.__iterate=function(t,e){var n=this;return this._iter.__iterate((function(e){return t(e,e,n)}),e)},e.prototype.__iterator=function(t,e){var n=this._iter.__iterator(F,e);return new G((function(){var e=n.next();return e.done?e:W(t,e.value,e.value,e)}))},e}(tt),xt=function(t){function e(t){this._iter=t,this.size=t.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.entrySeq=function(){return this._iter.toSeq()},e.prototype.__iterate=function(t,e){var n=this;return this._iter.__iterate((function(e){if(e){Yt(e);var r=y(e);return t(r?e.get(1):e[1],r?e.get(0):e[0],n)}}),e)},e.prototype.__iterator=function(t,e){var n=this._iter.__iterator(F,e);return new G((function(){for(;;){var e=n.next();if(e.done)return e;var r=e.value;if(r){Yt(r);var i=y(r);return W(t,i?r.get(0):r[0],i?r.get(1):r[1],e)}}}))},e}(X);function Ut(t){var e=Qt(t);return e._iter=t,e.size=t.size,e.flip=function(){return t},e.reverse=function(){var e=t.reverse.apply(this);return e.flip=function(){return t.reverse()},e},e.has=function(e){return t.includes(e)},e.includes=function(e){return t.has(e)},e.cacheResult=Jt,e.__iterateUncached=function(e,n){var r=this;return t.__iterate((function(t,n){return!1!==e(n,t,r)}),n)},e.__iteratorUncached=function(e,n){if(e===M){var r=t.__iterator(e,n);return new G((function(){var t=r.next();if(!t.done){var e=t.value[0];t.value[0]=t.value[1],t.value[1]=e}return t}))}return t.__iterator(e===F?U:F,n)},e}function Ft(t,e,n){var r=Qt(t);return r.size=t.size,r.has=function(e){return t.has(e)},r.get=function(r,i){var o=t.get(r,a);return o===a?i:e.call(n,o,r,t)},r.__iterateUncached=function(r,i){var o=this;return t.__iterate((function(t,i,s){return!1!==r(e.call(n,t,i,s),i,o)}),i)},r.__iteratorUncached=function(r,i){var o=t.__iterator(M,i);return new G((function(){var i=o.next();if(i.done)return i;var s=i.value,a=s[0];return W(r,a,e.call(n,s[1],a,t),i)}))},r}function Mt(t,e){var n=this,r=Qt(t);return r._iter=t,r.size=t.size,r.reverse=function(){return t},t.flip&&(r.flip=function(){var e=Ut(t);return e.reverse=function(){return t.flip()},e}),r.get=function(n,r){return t.get(e?n:-1-n,r)},r.has=function(n){return t.has(e?n:-1-n)},r.includes=function(e){return t.includes(e)},r.cacheResult=Jt,r.__iterate=function(n,r){var i=this,o=0;return r&&l(t),t.__iterate((function(t,s){return n(t,e?s:r?i.size-++o:o++,i)}),!r)},r.__iterator=function(r,i){var o=0;i&&l(t);var s=t.__iterator(M,!i);return new G((function(){var t=s.next();if(t.done)return t;var a=t.value;return W(r,e?a[0]:i?n.size-++o:o++,a[1],t)}))},r}function Ht(t,e,n,r){var i=Qt(t);return r&&(i.has=function(r){var i=t.get(r,a);return i!==a&&!!e.call(n,i,r,t)},i.get=function(r,i){var o=t.get(r,a);return o!==a&&e.call(n,o,r,t)?o:i}),i.__iterateUncached=function(i,o){var s=this,a=0;return t.__iterate((function(t,o,c){if(e.call(n,t,o,c))return a++,i(t,r?o:a-1,s)}),o),a},i.__iteratorUncached=function(i,o){var s=t.__iterator(M,o),a=0;return new G((function(){for(;;){var o=s.next();if(o.done)return o;var c=o.value,u=c[0],l=c[1];if(e.call(n,l,u,t))return W(i,r?u:a++,l,o)}}))},i}function jt(t,e,n,r){var i=t.size;if(p(e,n,i))return t;var o=f(e,i),s=_(n,i);if(o!=o||s!=s)return jt(t.toSeq().cacheResult(),e,n,r);var a,c=s-o;c==c&&(a=c<0?0:c);var u=Qt(t);return u.size=0===a?a:t.size&&a||void 0,!r&&k(t)&&a>=0&&(u.get=function(e,n){return(e=h(this,e))>=0&&e<a?t.get(e+o,n):n}),u.__iterateUncached=function(e,n){var i=this;if(0===a)return 0;if(n)return this.cacheResult().__iterate(e,n);var s=0,c=!0,u=0;return t.__iterate((function(t,n){if(!c||!(c=s++<o))return u++,!1!==e(t,r?n:u-1,i)&&u!==a})),u},u.__iteratorUncached=function(e,n){if(0!==a&&n)return this.cacheResult().__iterator(e,n);if(0===a)return new G(z);var i=t.__iterator(e,n),s=0,c=0;return new G((function(){for(;s++<o;)i.next();if(++c>a)return{value:void 0,done:!0};var t=i.next();return r||e===F||t.done?t:W(e,c-1,e===U?void 0:t.value[1],t)}))},u}function Bt(t,e,n,r){var i=Qt(t);return i.__iterateUncached=function(i,o){var s=this;if(o)return this.cacheResult().__iterate(i,o);var a=!0,c=0;return t.__iterate((function(t,o,u){if(!a||!(a=e.call(n,t,o,u)))return c++,i(t,r?o:c-1,s)})),c},i.__iteratorUncached=function(i,o){var s=this;if(o)return this.cacheResult().__iterator(i,o);var a=t.__iterator(M,o),c=!0,u=0;return new G((function(){var t,o,l;do{if((t=a.next()).done)return r||i===F?t:W(i,u++,i===U?void 0:t.value[1],t);var h=t.value;o=h[0],l=h[1],c&&(c=e.call(n,l,o,s))}while(c);return i===M?t:W(i,o,l,t)}))},i}function Gt(t,e,n){var r=Qt(t);return r.__iterateUncached=function(i,o){if(o)return this.cacheResult().__iterate(i,o);var s=0,a=!1;return function t(c,u){c.__iterate((function(o,c){return(!e||u<e)&&y(o)?t(o,u+1):(s++,!1===i(o,n?c:s-1,r)&&(a=!0)),!a}),o)}(t,0),s},r.__iteratorUncached=function(r,i){if(i)return this.cacheResult().__iterator(r,i);var o=t.__iterator(r,i),s=[],a=0;return new G((function(){for(;o;){var t=o.next();if(!1===t.done){var c=t.value;if(r===M&&(c=c[1]),e&&!(s.length<e)||!y(c))return n?t:W(r,a++,c,t);s.push(o),o=c.__iterator(r,i)}else o=s.pop()}return{value:void 0,done:!0}}))},r}function Wt(t,e,n){e||(e=Xt);var r=I(t),i=0,o=t.toSeq().map((function(e,r){return[r,e,i++,n?n(e,r,t):e]})).valueSeq().toArray();return o.sort((function(t,n){return e(t[3],n[3])||t[2]-n[2]})).forEach(r?function(t,e){o[e].length=2}:function(t,e){o[e]=t[1]}),r?X(o):S(t)?Z(o):tt(o)}function zt(t,e,n){if(e||(e=Xt),n){var r=t.toSeq().map((function(e,r){return[e,n(e,r,t)]})).reduce((function(t,n){return Vt(e,t[1],n[1])?n:t}));return r&&r[0]}return t.reduce((function(t,n){return Vt(e,t,n)?n:t}))}function Vt(t,e,n){var r=t(n,e);return 0===r&&n!==e&&(null==n||n!=n)||r>0}function qt(t,e,n,r){var i=Qt(t),o=new et(n).map((function(t){return t.size}));return i.size=r?o.max():o.min(),i.__iterate=function(t,e){for(var n,r=this.__iterator(F,e),i=0;!(n=r.next()).done&&!1!==t(n.value,i++,this););return i},i.__iteratorUncached=function(t,i){var o=n.map((function(t){return t=w(t),$(i?t.reverse():t)})),s=0,a=!1;return new G((function(){var n;return a||(n=o.map((function(t){return t.next()})),a=r?n.every((function(t){return t.done})):n.some((function(t){return t.done}))),a?{value:void 0,done:!0}:W(t,s++,e.apply(null,n.map((function(t){return t.value}))))}))},i}function $t(t,e){return t===e?t:k(t)?e:t.constructor(e)}function Yt(t){if(t!==Object(t))throw new TypeError("Expected [K, V] tuple: "+t)}function Kt(t){return I(t)?O:S(t)?C:A}function Qt(t){return Object.create((I(t)?X:S(t)?Z:tt).prototype)}function Jt(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):J.prototype.cacheResult.call(this)}function Xt(t,e){return void 0===t&&void 0===e?0:void 0===t?1:void 0===e?-1:t>e?1:t<e?-1:0}function Zt(t,e){e=e||0;for(var n=Math.max(0,t.length-e),r=new Array(n),i=0;i<n;i++)r[i]=t[i+e];return r}function te(t,e){if(!t)throw new Error(e)}function ee(t){te(t!==1/0,"Cannot perform this action with an infinite size.")}function ne(t){if(Q(t)&&"string"!=typeof t)return t;if(x(t))return t.toArray();throw new TypeError("Invalid keyPath: expected Ordered Collection or Array: "+t)}Pt.prototype.cacheResult=Nt.prototype.cacheResult=Lt.prototype.cacheResult=xt.prototype.cacheResult=Jt;var re=Object.prototype.toString;function ie(t){if(!t||"object"!=typeof t||"[object Object]"!==re.call(t))return!1;var e=Object.getPrototypeOf(t);if(null===e)return!0;for(var n=e,r=Object.getPrototypeOf(e);null!==r;)n=r,r=Object.getPrototypeOf(n);return n===e}function oe(t){return"object"==typeof t&&(P(t)||Array.isArray(t)||ie(t))}function se(t){try{return"string"==typeof t?JSON.stringify(t):String(t)}catch(e){return JSON.stringify(t)}}function ae(t,e){return P(t)?t.has(e):oe(t)&&K.call(t,e)}function ce(t,e,n){return P(t)?t.get(e,n):ae(t,e)?"function"==typeof t.get?t.get(e):t[e]:n}function ue(t){if(Array.isArray(t))return Zt(t);var e={};for(var n in t)K.call(t,n)&&(e[n]=t[n]);return e}function le(t,e){if(!oe(t))throw new TypeError("Cannot update non-data-structure value: "+t);if(P(t)){if(!t.remove)throw new TypeError("Cannot update immutable value without .remove() method: "+t);return t.remove(e)}if(!K.call(t,e))return t;var n=ue(t);return Array.isArray(n)?n.splice(e,1):delete n[e],n}function he(t,e,n){if(!oe(t))throw new TypeError("Cannot update non-data-structure value: "+t);if(P(t)){if(!t.set)throw new TypeError("Cannot update immutable value without .set() method: "+t);return t.set(e,n)}if(K.call(t,e)&&n===t[e])return t;var r=ue(t);return r[e]=n,r}function de(t,e,n,r){r||(r=n,n=void 0);var i=pe(P(t),t,ne(e),0,n,r);return i===a?n:i}function pe(t,e,n,r,i,o){var s=e===a;if(r===n.length){var c=s?i:e,u=o(c);return u===c?e:u}if(!s&&!oe(e))throw new TypeError("Cannot update within non-data-structure value in path ["+n.slice(0,r).map(se)+"]: "+e);var l=n[r],h=s?a:ce(e,l,a),d=pe(h===a?t:P(h),h,n,r+1,i,o);return d===h?e:d===a?le(e,l):he(s?t?$e():{}:e,l,d)}function fe(t,e,n){return de(t,e,a,(function(){return n}))}function _e(t,e){return fe(this,t,e)}function ge(t,e){return de(t,e,(function(){return a}))}function ve(t){return ge(this,t)}function me(t,e,n,r){return de(t,[e],n,r)}function ye(t,e,n){return 1===arguments.length?t(this):me(this,t,e,n)}function Ee(t,e,n){return de(this,t,e,n)}function Ie(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return Se(this,t)}function be(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];if("function"!=typeof t)throw new TypeError("Invalid merger function: "+t);return Se(this,e,t)}function Se(t,e,n){for(var r=[],i=0;i<e.length;i++){var o=O(e[i]);0!==o.size&&r.push(o)}return 0===r.length?t:0!==t.toSeq().size||t.__ownerID||1!==r.length?t.withMutations((function(t){for(var e=n?function(e,r){me(t,r,a,(function(t){return t===a?e:n(t,e,r)}))}:function(e,n){t.set(n,e)},i=0;i<r.length;i++)r[i].forEach(e)})):t.constructor(r[0])}function Te(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];return Oe(t,e)}function we(t,e,n){return Oe(t,e,function(t){function e(n,r,i){return oe(n)&&oe(r)&&(o=r,s=J(n),a=J(o),S(s)===S(a)&&I(s)===I(a))?Oe(n,[r],e):t?t(n,r,i):r;var o,s,a}return e}(n))}function Oe(t,e,n){if(!oe(t))throw new TypeError("Cannot merge into non-data-structure value: "+t);if(P(t))return"function"==typeof n&&t.mergeWith?t.mergeWith.apply(t,[n].concat(e)):t.merge?t.merge.apply(t,e):t.concat.apply(t,e);for(var r=Array.isArray(t),i=t,o=r?C:O,s=r?function(e){i===t&&(i=ue(i)),i.push(e)}:function(e,r){var o=K.call(i,r),s=o&&n?n(i[r],e,r):e;o&&s===i[r]||(i===t&&(i=ue(i)),i[r]=s)},a=0;a<e.length;a++)o(e[a]).forEach(s);return i}function Ce(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return we(this,t)}function Ae(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];return we(this,e,t)}function Re(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];return de(this,t,$e(),(function(t){return Oe(t,e)}))}function ke(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];return de(this,t,$e(),(function(t){return we(t,e)}))}function De(t){var e=this.asMutable();return t(e),e.wasAltered()?e.__ensureOwner(this.__ownerID):this}function Ne(){return this.__ownerID?this:this.__ensureOwner(new u)}function Pe(){return this.__ensureOwner()}function Le(){return this.__altered}var xe=function(t){function e(e){return null==e?$e():lt(e)&&!x(e)?e:$e().withMutations((function(n){var r=t(e);ee(r.size),r.forEach((function(t,e){return n.set(e,t)}))}))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return $e().withMutations((function(e){for(var n=0;n<t.length;n+=2){if(n+1>=t.length)throw new Error("Missing value for key: "+t[n]);e.set(t[n],t[n+1])}}))},e.prototype.toString=function(){return this.__toString("Map {","}")},e.prototype.get=function(t,e){return this._root?this._root.get(0,void 0,t,e):e},e.prototype.set=function(t,e){return Ye(this,t,e)},e.prototype.remove=function(t){return Ye(this,t,a)},e.prototype.deleteAll=function(t){var e=w(t);return 0===e.size?this:this.withMutations((function(t){e.forEach((function(e){return t.remove(e)}))}))},e.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):$e()},e.prototype.sort=function(t){return En(Wt(this,t))},e.prototype.sortBy=function(t,e){return En(Wt(this,e,t))},e.prototype.map=function(t,e){var n=this;return this.withMutations((function(r){r.forEach((function(i,o){r.set(o,t.call(e,i,o,n))}))}))},e.prototype.__iterator=function(t,e){return new We(this,t,e)},e.prototype.__iterate=function(t,e){var n=this,r=0;return this._root&&this._root.iterate((function(e){return r++,t(e[1],e[0],n)}),e),r},e.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?qe(this.size,this._root,t,this.__hash):0===this.size?$e():(this.__ownerID=t,this.__altered=!1,this)},e}(O);xe.isMap=lt;var Ue=xe.prototype;Ue[ut]=!0,Ue[r]=Ue.remove,Ue.removeAll=Ue.deleteAll,Ue.setIn=_e,Ue.removeIn=Ue.deleteIn=ve,Ue.update=ye,Ue.updateIn=Ee,Ue.merge=Ue.concat=Ie,Ue.mergeWith=be,Ue.mergeDeep=Ce,Ue.mergeDeepWith=Ae,Ue.mergeIn=Re,Ue.mergeDeepIn=ke,Ue.withMutations=De,Ue.wasAltered=Le,Ue.asImmutable=Pe,Ue["@@transducer/init"]=Ue.asMutable=Ne,Ue["@@transducer/step"]=function(t,e){return t.set(e[0],e[1])},Ue["@@transducer/result"]=function(t){return t.asImmutable()};var Fe=function(t,e){this.ownerID=t,this.entries=e};Fe.prototype.get=function(t,e,n,r){for(var i=this.entries,o=0,s=i.length;o<s;o++)if(pt(n,i[o][0]))return i[o][1];return r},Fe.prototype.update=function(t,e,n,r,i,o,s){for(var l=i===a,h=this.entries,d=0,p=h.length;d<p&&!pt(r,h[d][0]);d++);var f=d<p;if(f?h[d][1]===i:l)return this;if(c(s),(l||!f)&&c(o),!l||1!==h.length){if(!f&&!l&&h.length>=tn)return function(t,e,n,r){t||(t=new u);for(var i=new Be(t,vt(n),[n,r]),o=0;o<e.length;o++){var s=e[o];i=i.update(t,0,void 0,s[0],s[1])}return i}(t,h,r,i);var _=t&&t===this.ownerID,g=_?h:Zt(h);return f?l?d===p-1?g.pop():g[d]=g.pop():g[d]=[r,i]:g.push([r,i]),_?(this.entries=g,this):new Fe(t,g)}};var Me=function(t,e,n){this.ownerID=t,this.bitmap=e,this.nodes=n};Me.prototype.get=function(t,e,n,r){void 0===e&&(e=vt(n));var o=1<<((0===t?e:e>>>t)&s),a=this.bitmap;return 0==(a&o)?r:this.nodes[Xe(a&o-1)].get(t+i,e,n,r)},Me.prototype.update=function(t,e,n,r,c,u,l){void 0===n&&(n=vt(r));var h=(0===e?n:n>>>e)&s,d=1<<h,p=this.bitmap,f=0!=(p&d);if(!f&&c===a)return this;var _=Xe(p&d-1),g=this.nodes,v=f?g[_]:void 0,m=Ke(v,t,e+i,n,r,c,u,l);if(m===v)return this;if(!f&&m&&g.length>=en)return function(t,e,n,r,i){for(var s=0,a=new Array(o),c=0;0!==n;c++,n>>>=1)a[c]=1&n?e[s++]:void 0;return a[r]=i,new He(t,s+1,a)}(t,g,p,h,m);if(f&&!m&&2===g.length&&Qe(g[1^_]))return g[1^_];if(f&&m&&1===g.length&&Qe(m))return m;var y=t&&t===this.ownerID,E=f?m?p:p^d:p|d,I=f?m?Ze(g,_,m,y):function(t,e,n){var r=t.length-1;if(n&&e===r)return t.pop(),t;for(var i=new Array(r),o=0,s=0;s<r;s++)s===e&&(o=1),i[s]=t[s+o];return i}(g,_,y):function(t,e,n,r){var i=t.length+1;if(r&&e+1===i)return t[e]=n,t;for(var o=new Array(i),s=0,a=0;a<i;a++)a===e?(o[a]=n,s=-1):o[a]=t[a+s];return o}(g,_,m,y);return y?(this.bitmap=E,this.nodes=I,this):new Me(t,E,I)};var He=function(t,e,n){this.ownerID=t,this.count=e,this.nodes=n};He.prototype.get=function(t,e,n,r){void 0===e&&(e=vt(n));var o=(0===t?e:e>>>t)&s,a=this.nodes[o];return a?a.get(t+i,e,n,r):r},He.prototype.update=function(t,e,n,r,o,c,u){void 0===n&&(n=vt(r));var l=(0===e?n:n>>>e)&s,h=o===a,d=this.nodes,p=d[l];if(h&&!p)return this;var f=Ke(p,t,e+i,n,r,o,c,u);if(f===p)return this;var _=this.count;if(p){if(!f&&--_<nn)return function(t,e,n,r){for(var i=0,o=0,s=new Array(n),a=0,c=1,u=e.length;a<u;a++,c<<=1){var l=e[a];void 0!==l&&a!==r&&(i|=c,s[o++]=l)}return new Me(t,i,s)}(t,d,_,l)}else _++;var g=t&&t===this.ownerID,v=Ze(d,l,f,g);return g?(this.count=_,this.nodes=v,this):new He(t,_,v)};var je=function(t,e,n){this.ownerID=t,this.keyHash=e,this.entries=n};je.prototype.get=function(t,e,n,r){for(var i=this.entries,o=0,s=i.length;o<s;o++)if(pt(n,i[o][0]))return i[o][1];return r},je.prototype.update=function(t,e,n,r,i,o,s){void 0===n&&(n=vt(r));var u=i===a;if(n!==this.keyHash)return u?this:(c(s),c(o),Je(this,t,e,n,[r,i]));for(var l=this.entries,h=0,d=l.length;h<d&&!pt(r,l[h][0]);h++);var p=h<d;if(p?l[h][1]===i:u)return this;if(c(s),(u||!p)&&c(o),u&&2===d)return new Be(t,this.keyHash,l[1^h]);var f=t&&t===this.ownerID,_=f?l:Zt(l);return p?u?h===d-1?_.pop():_[h]=_.pop():_[h]=[r,i]:_.push([r,i]),f?(this.entries=_,this):new je(t,this.keyHash,_)};var Be=function(t,e,n){this.ownerID=t,this.keyHash=e,this.entry=n};Be.prototype.get=function(t,e,n,r){return pt(n,this.entry[0])?this.entry[1]:r},Be.prototype.update=function(t,e,n,r,i,o,s){var u=i===a,l=pt(r,this.entry[0]);return(l?i===this.entry[1]:u)?this:(c(s),u?void c(o):l?t&&t===this.ownerID?(this.entry[1]=i,this):new Be(t,this.keyHash,[r,i]):(c(o),Je(this,t,e,vt(r),[r,i])))},Fe.prototype.iterate=je.prototype.iterate=function(t,e){for(var n=this.entries,r=0,i=n.length-1;r<=i;r++)if(!1===t(n[e?i-r:r]))return!1},Me.prototype.iterate=He.prototype.iterate=function(t,e){for(var n=this.nodes,r=0,i=n.length-1;r<=i;r++){var o=n[e?i-r:r];if(o&&!1===o.iterate(t,e))return!1}},Be.prototype.iterate=function(t,e){return t(this.entry)};var Ge,We=function(t){function e(t,e,n){this._type=e,this._reverse=n,this._stack=t._root&&Ve(t._root)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){for(var t=this._type,e=this._stack;e;){var n=e.node,r=e.index++,i=void 0;if(n.entry){if(0===r)return ze(t,n.entry)}else if(n.entries){if(r<=(i=n.entries.length-1))return ze(t,n.entries[this._reverse?i-r:r])}else if(r<=(i=n.nodes.length-1)){var o=n.nodes[this._reverse?i-r:r];if(o){if(o.entry)return ze(t,o.entry);e=this._stack=Ve(o,e)}continue}e=this._stack=this._stack.__prev}return{value:void 0,done:!0}},e}(G);function ze(t,e){return W(t,e[0],e[1])}function Ve(t,e){return{node:t,index:0,__prev:e}}function qe(t,e,n,r){var i=Object.create(Ue);return i.size=t,i._root=e,i.__ownerID=n,i.__hash=r,i.__altered=!1,i}function $e(){return Ge||(Ge=qe(0))}function Ye(t,e,n){var r,i;if(t._root){var o={value:!1},s={value:!1};if(r=Ke(t._root,t.__ownerID,0,void 0,e,n,o,s),!s.value)return t;i=t.size+(o.value?n===a?-1:1:0)}else{if(n===a)return t;i=1,r=new Fe(t.__ownerID,[[e,n]])}return t.__ownerID?(t.size=i,t._root=r,t.__hash=void 0,t.__altered=!0,t):r?qe(i,r):$e()}function Ke(t,e,n,r,i,o,s,u){return t?t.update(e,n,r,i,o,s,u):o===a?t:(c(u),c(s),new Be(e,r,[i,o]))}function Qe(t){return t.constructor===Be||t.constructor===je}function Je(t,e,n,r,o){if(t.keyHash===r)return new je(e,r,[t.entry,o]);var a,c=(0===n?t.keyHash:t.keyHash>>>n)&s,u=(0===n?r:r>>>n)&s,l=c===u?[Je(t,e,n+i,r,o)]:(a=new Be(e,r,o),c<u?[t,a]:[a,t]);return new Me(e,1<<c|1<<u,l)}function Xe(t){return t=(t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135,t+=t>>8,127&(t+=t>>16)}function Ze(t,e,n,r){var i=r?t:Zt(t);return i[e]=n,i}var tn=o/4,en=o/2,nn=o/4,rn="@@__IMMUTABLE_LIST__@@";function on(t){return Boolean(t&&t[rn])}var sn=function(t){function e(e){var n=pn();if(null==e)return n;if(on(e))return e;var r=t(e),s=r.size;return 0===s?n:(ee(s),s>0&&s<o?dn(0,s,i,null,new cn(r.toArray())):n.withMutations((function(t){t.setSize(s),r.forEach((function(e,n){return t.set(n,e)}))})))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.prototype.toString=function(){return this.__toString("List [","]")},e.prototype.get=function(t,e){if((t=h(this,t))>=0&&t<this.size){var n=gn(this,t+=this._origin);return n&&n.array[t&s]}return e},e.prototype.set=function(t,e){return function(t,e,n){if(e=h(t,e),e!=e)return t;if(e>=t.size||e<0)return t.withMutations((function(t){e<0?vn(t,e).set(0,n):vn(t,0,e+1).set(e,n)}));e+=t._origin;var r=t._tail,i=t._root,o={value:!1};e>=mn(t._capacity)?r=fn(r,t.__ownerID,0,e,n,o):i=fn(i,t.__ownerID,t._level,e,n,o);if(!o.value)return t;if(t.__ownerID)return t._root=i,t._tail=r,t.__hash=void 0,t.__altered=!0,t;return dn(t._origin,t._capacity,t._level,i,r)}(this,t,e)},e.prototype.remove=function(t){return this.has(t)?0===t?this.shift():t===this.size-1?this.pop():this.splice(t,1):this},e.prototype.insert=function(t,e){return this.splice(t,0,e)},e.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=i,this._root=this._tail=this.__hash=void 0,this.__altered=!0,this):pn()},e.prototype.push=function(){var t=arguments,e=this.size;return this.withMutations((function(n){vn(n,0,e+t.length);for(var r=0;r<t.length;r++)n.set(e+r,t[r])}))},e.prototype.pop=function(){return vn(this,0,-1)},e.prototype.unshift=function(){var t=arguments;return this.withMutations((function(e){vn(e,-t.length);for(var n=0;n<t.length;n++)e.set(n,t[n])}))},e.prototype.shift=function(){return vn(this,1)},e.prototype.concat=function(){for(var e=arguments,n=[],r=0;r<arguments.length;r++){var i=e[r],o=t("string"!=typeof i&&V(i)?i:[i]);0!==o.size&&n.push(o)}return 0===n.length?this:0!==this.size||this.__ownerID||1!==n.length?this.withMutations((function(t){n.forEach((function(e){return e.forEach((function(e){return t.push(e)}))}))})):this.constructor(n[0])},e.prototype.setSize=function(t){return vn(this,0,t)},e.prototype.map=function(t,e){var n=this;return this.withMutations((function(r){for(var i=0;i<n.size;i++)r.set(i,t.call(e,r.get(i),i,n))}))},e.prototype.slice=function(t,e){var n=this.size;return p(t,e,n)?this:vn(this,f(t,n),_(e,n))},e.prototype.__iterator=function(t,e){var n=e?this.size:0,r=hn(this,e);return new G((function(){var i=r();return i===ln?{value:void 0,done:!0}:W(t,e?--n:n++,i)}))},e.prototype.__iterate=function(t,e){for(var n,r=e?this.size:0,i=hn(this,e);(n=i())!==ln&&!1!==t(n,e?--r:r++,this););return r},e.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?dn(this._origin,this._capacity,this._level,this._root,this._tail,t,this.__hash):0===this.size?pn():(this.__ownerID=t,this.__altered=!1,this)},e}(C);sn.isList=on;var an=sn.prototype;an[rn]=!0,an[r]=an.remove,an.merge=an.concat,an.setIn=_e,an.deleteIn=an.removeIn=ve,an.update=ye,an.updateIn=Ee,an.mergeIn=Re,an.mergeDeepIn=ke,an.withMutations=De,an.wasAltered=Le,an.asImmutable=Pe,an["@@transducer/init"]=an.asMutable=Ne,an["@@transducer/step"]=function(t,e){return t.push(e)},an["@@transducer/result"]=function(t){return t.asImmutable()};var cn=function(t,e){this.array=t,this.ownerID=e};cn.prototype.removeBefore=function(t,e,n){if(n===e?1<<e:0===this.array.length)return this;var r=n>>>e&s;if(r>=this.array.length)return new cn([],t);var o,a=0===r;if(e>0){var c=this.array[r];if((o=c&&c.removeBefore(t,e-i,n))===c&&a)return this}if(a&&!o)return this;var u=_n(this,t);if(!a)for(var l=0;l<r;l++)u.array[l]=void 0;return o&&(u.array[r]=o),u},cn.prototype.removeAfter=function(t,e,n){if(n===(e?1<<e:0)||0===this.array.length)return this;var r,o=n-1>>>e&s;if(o>=this.array.length)return this;if(e>0){var a=this.array[o];if((r=a&&a.removeAfter(t,e-i,n))===a&&o===this.array.length-1)return this}var c=_n(this,t);return c.array.splice(o+1),r&&(c.array[o]=r),c};var un,ln={};function hn(t,e){var n=t._origin,r=t._capacity,s=mn(r),a=t._tail;return c(t._root,t._level,0);function c(t,u,l){return 0===u?function(t,i){var c=i===s?a&&a.array:t&&t.array,u=i>n?0:n-i,l=r-i;l>o&&(l=o);return function(){if(u===l)return ln;var t=e?--l:u++;return c&&c[t]}}(t,l):function(t,s,a){var u,l=t&&t.array,h=a>n?0:n-a>>s,d=1+(r-a>>s);d>o&&(d=o);return function(){for(;;){if(u){var t=u();if(t!==ln)return t;u=null}if(h===d)return ln;var n=e?--d:h++;u=c(l&&l[n],s-i,a+(n<<s))}}}(t,u,l)}}function dn(t,e,n,r,i,o,s){var a=Object.create(an);return a.size=e-t,a._origin=t,a._capacity=e,a._level=n,a._root=r,a._tail=i,a.__ownerID=o,a.__hash=s,a.__altered=!1,a}function pn(){return un||(un=dn(0,0,i))}function fn(t,e,n,r,o,a){var u,l=r>>>n&s,h=t&&l<t.array.length;if(!h&&void 0===o)return t;if(n>0){var d=t&&t.array[l],p=fn(d,e,n-i,r,o,a);return p===d?t:((u=_n(t,e)).array[l]=p,u)}return h&&t.array[l]===o?t:(a&&c(a),u=_n(t,e),void 0===o&&l===u.array.length-1?u.array.pop():u.array[l]=o,u)}function _n(t,e){return e&&t&&e===t.ownerID?t:new cn(t?t.array.slice():[],e)}function gn(t,e){if(e>=mn(t._capacity))return t._tail;if(e<1<<t._level+i){for(var n=t._root,r=t._level;n&&r>0;)n=n.array[e>>>r&s],r-=i;return n}}function vn(t,e,n){void 0!==e&&(e|=0),void 0!==n&&(n|=0);var r=t.__ownerID||new u,o=t._origin,a=t._capacity,c=o+e,l=void 0===n?a:n<0?a+n:o+n;if(c===o&&l===a)return t;if(c>=l)return t.clear();for(var h=t._level,d=t._root,p=0;c+p<0;)d=new cn(d&&d.array.length?[void 0,d]:[],r),p+=1<<(h+=i);p&&(c+=p,o+=p,l+=p,a+=p);for(var f=mn(a),_=mn(l);_>=1<<h+i;)d=new cn(d&&d.array.length?[d]:[],r),h+=i;var g=t._tail,v=_<f?gn(t,l-1):_>f?new cn([],r):g;if(g&&_>f&&c<a&&g.array.length){for(var m=d=_n(d,r),y=h;y>i;y-=i){var E=f>>>y&s;m=m.array[E]=_n(m.array[E],r)}m.array[f>>>i&s]=g}if(l<a&&(v=v&&v.removeAfter(r,0,l)),c>=_)c-=_,l-=_,h=i,d=null,v=v&&v.removeBefore(r,0,c);else if(c>o||_<f){for(p=0;d;){var I=c>>>h&s;if(I!==_>>>h&s)break;I&&(p+=(1<<h)*I),h-=i,d=d.array[I]}d&&c>o&&(d=d.removeBefore(r,h,c-p)),d&&_<f&&(d=d.removeAfter(r,h,_-p)),p&&(c-=p,l-=p)}return t.__ownerID?(t.size=l-c,t._origin=c,t._capacity=l,t._level=h,t._root=d,t._tail=v,t.__hash=void 0,t.__altered=!0,t):dn(c,l,h,d,v)}function mn(t){return t<o?0:t-1>>>i<<i}var yn,En=function(t){function e(t){return null==t?bn():ht(t)?t:bn().withMutations((function(e){var n=O(t);ee(n.size),n.forEach((function(t,n){return e.set(n,t)}))}))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.prototype.toString=function(){return this.__toString("OrderedMap {","}")},e.prototype.get=function(t,e){var n=this._map.get(t);return void 0!==n?this._list.get(n)[1]:e},e.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this.__altered=!0,this):bn()},e.prototype.set=function(t,e){return Sn(this,t,e)},e.prototype.remove=function(t){return Sn(this,t,a)},e.prototype.__iterate=function(t,e){var n=this;return this._list.__iterate((function(e){return e&&t(e[1],e[0],n)}),e)},e.prototype.__iterator=function(t,e){return this._list.fromEntrySeq().__iterator(t,e)},e.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t),n=this._list.__ensureOwner(t);return t?In(e,n,t,this.__hash):0===this.size?bn():(this.__ownerID=t,this.__altered=!1,this._map=e,this._list=n,this)},e}(xe);function In(t,e,n,r){var i=Object.create(En.prototype);return i.size=t?t.size:0,i._map=t,i._list=e,i.__ownerID=n,i.__hash=r,i.__altered=!1,i}function bn(){return yn||(yn=In($e(),pn()))}function Sn(t,e,n){var r,i,s=t._map,c=t._list,u=s.get(e),l=void 0!==u;if(n===a){if(!l)return t;c.size>=o&&c.size>=2*s.size?(r=(i=c.filter((function(t,e){return void 0!==t&&u!==e}))).toKeyedSeq().map((function(t){return t[0]})).flip().toMap(),t.__ownerID&&(r.__ownerID=i.__ownerID=t.__ownerID)):(r=s.remove(e),i=u===c.size-1?c.pop():c.set(u,void 0))}else if(l){if(n===c.get(u)[1])return t;r=s,i=c.set(u,[e,n])}else r=s.set(e,c.size),i=c.set(c.size,[e,n]);return t.__ownerID?(t.size=r.size,t._map=r,t._list=i,t.__hash=void 0,t.__altered=!0,t):In(r,i)}En.isOrderedMap=ht,En.prototype[L]=!0,En.prototype[r]=En.prototype.remove;var Tn="@@__IMMUTABLE_STACK__@@";function wn(t){return Boolean(t&&t[Tn])}var On=function(t){function e(t){return null==t?kn():wn(t)?t:kn().pushAll(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.prototype.toString=function(){return this.__toString("Stack [","]")},e.prototype.get=function(t,e){var n=this._head;for(t=h(this,t);n&&t--;)n=n.next;return n?n.value:e},e.prototype.peek=function(){return this._head&&this._head.value},e.prototype.push=function(){var t=arguments;if(0===arguments.length)return this;for(var e=this.size+arguments.length,n=this._head,r=arguments.length-1;r>=0;r--)n={value:t[r],next:n};return this.__ownerID?(this.size=e,this._head=n,this.__hash=void 0,this.__altered=!0,this):Rn(e,n)},e.prototype.pushAll=function(e){if(0===(e=t(e)).size)return this;if(0===this.size&&wn(e))return e;ee(e.size);var n=this.size,r=this._head;return e.__iterate((function(t){n++,r={value:t,next:r}}),!0),this.__ownerID?(this.size=n,this._head=r,this.__hash=void 0,this.__altered=!0,this):Rn(n,r)},e.prototype.pop=function(){return this.slice(1)},e.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):kn()},e.prototype.slice=function(e,n){if(p(e,n,this.size))return this;var r=f(e,this.size);if(_(n,this.size)!==this.size)return t.prototype.slice.call(this,e,n);for(var i=this.size-r,o=this._head;r--;)o=o.next;return this.__ownerID?(this.size=i,this._head=o,this.__hash=void 0,this.__altered=!0,this):Rn(i,o)},e.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?Rn(this.size,this._head,t,this.__hash):0===this.size?kn():(this.__ownerID=t,this.__altered=!1,this)},e.prototype.__iterate=function(t,e){var n=this;if(e)return new et(this.toArray()).__iterate((function(e,r){return t(e,r,n)}),e);for(var r=0,i=this._head;i&&!1!==t(i.value,r++,this);)i=i.next;return r},e.prototype.__iterator=function(t,e){if(e)return new et(this.toArray()).__iterator(t,e);var n=0,r=this._head;return new G((function(){if(r){var e=r.value;return r=r.next,W(t,n++,e)}return{value:void 0,done:!0}}))},e}(C);On.isStack=wn;var Cn,An=On.prototype;function Rn(t,e,n,r){var i=Object.create(An);return i.size=t,i._head=e,i.__ownerID=n,i.__hash=r,i.__altered=!1,i}function kn(){return Cn||(Cn=Rn(0))}An[Tn]=!0,An.shift=An.pop,An.unshift=An.push,An.unshiftAll=An.pushAll,An.withMutations=De,An.wasAltered=Le,An.asImmutable=Pe,An["@@transducer/init"]=An.asMutable=Ne,An["@@transducer/step"]=function(t,e){return t.unshift(e)},An["@@transducer/result"]=function(t){return t.asImmutable()};var Dn="@@__IMMUTABLE_SET__@@";function Nn(t){return Boolean(t&&t[Dn])}function Pn(t){return Nn(t)&&x(t)}function Ln(t,e){if(t===e)return!0;if(!y(e)||void 0!==t.size&&void 0!==e.size&&t.size!==e.size||void 0!==t.__hash&&void 0!==e.__hash&&t.__hash!==e.__hash||I(t)!==I(e)||S(t)!==S(e)||x(t)!==x(e))return!1;if(0===t.size&&0===e.size)return!0;var n=!T(t);if(x(t)){var r=t.entries();return e.every((function(t,e){var i=r.next().value;return i&&pt(i[1],t)&&(n||pt(i[0],e))}))&&r.next().done}var i=!1;if(void 0===t.size)if(void 0===e.size)"function"==typeof t.cacheResult&&t.cacheResult();else{i=!0;var o=t;t=e,e=o}var s=!0,c=e.__iterate((function(e,r){if(n?!t.has(e):i?!pt(e,t.get(r,a)):!pt(t.get(r,a),e))return s=!1,!1}));return s&&t.size===c}function xn(t,e){var n=function(n){t.prototype[n]=e[n]};return Object.keys(e).forEach(n),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(e).forEach(n),t}function Un(t){if(!t||"object"!=typeof t)return t;if(!y(t)){if(!oe(t))return t;t=J(t)}if(I(t)){var e={};return t.__iterate((function(t,n){e[n]=Un(t)})),e}var n=[];return t.__iterate((function(t){n.push(Un(t))})),n}var Fn=function(t){function e(e){return null==e?Gn():Nn(e)&&!x(e)?e:Gn().withMutations((function(n){var r=t(e);ee(r.size),r.forEach((function(t){return n.add(t)}))}))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.fromKeys=function(t){return this(O(t).keySeq())},e.intersect=function(t){return(t=w(t).toArray()).length?Hn.intersect.apply(e(t.pop()),t):Gn()},e.union=function(t){return(t=w(t).toArray()).length?Hn.union.apply(e(t.pop()),t):Gn()},e.prototype.toString=function(){return this.__toString("Set {","}")},e.prototype.has=function(t){return this._map.has(t)},e.prototype.add=function(t){return jn(this,this._map.set(t,t))},e.prototype.remove=function(t){return jn(this,this._map.remove(t))},e.prototype.clear=function(){return jn(this,this._map.clear())},e.prototype.map=function(t,e){var n=this,r=!1,i=jn(this,this._map.mapEntries((function(i){var o=i[1],s=t.call(e,o,o,n);return s!==o&&(r=!0),[s,s]}),e));return r?i:this},e.prototype.union=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];return 0===(e=e.filter((function(t){return 0!==t.size}))).length?this:0!==this.size||this.__ownerID||1!==e.length?this.withMutations((function(n){for(var r=0;r<e.length;r++)"string"==typeof e[r]?n.add(e[r]):t(e[r]).forEach((function(t){return n.add(t)}))})):this.constructor(e[0])},e.prototype.intersect=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];if(0===e.length)return this;e=e.map((function(e){return t(e)}));var r=[];return this.forEach((function(t){e.every((function(e){return e.includes(t)}))||r.push(t)})),this.withMutations((function(t){r.forEach((function(e){t.remove(e)}))}))},e.prototype.subtract=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];if(0===e.length)return this;e=e.map((function(e){return t(e)}));var r=[];return this.forEach((function(t){e.some((function(e){return e.includes(t)}))&&r.push(t)})),this.withMutations((function(t){r.forEach((function(e){t.remove(e)}))}))},e.prototype.sort=function(t){return ar(Wt(this,t))},e.prototype.sortBy=function(t,e){return ar(Wt(this,e,t))},e.prototype.wasAltered=function(){return this._map.wasAltered()},e.prototype.__iterate=function(t,e){var n=this;return this._map.__iterate((function(e){return t(e,e,n)}),e)},e.prototype.__iterator=function(t,e){return this._map.__iterator(t,e)},e.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t);return t?this.__make(e,t):0===this.size?this.__empty():(this.__ownerID=t,this._map=e,this)},e}(A);Fn.isSet=Nn;var Mn,Hn=Fn.prototype;function jn(t,e){return t.__ownerID?(t.size=e.size,t._map=e,t):e===t._map?t:0===e.size?t.__empty():t.__make(e)}function Bn(t,e){var n=Object.create(Hn);return n.size=t?t.size:0,n._map=t,n.__ownerID=e,n}function Gn(){return Mn||(Mn=Bn($e()))}Hn[Dn]=!0,Hn[r]=Hn.remove,Hn.merge=Hn.concat=Hn.union,Hn.withMutations=De,Hn.asImmutable=Pe,Hn["@@transducer/init"]=Hn.asMutable=Ne,Hn["@@transducer/step"]=function(t,e){return t.add(e)},Hn["@@transducer/result"]=function(t){return t.asImmutable()},Hn.__empty=Gn,Hn.__make=Bn;var Wn,zn=function(t){function e(t,n,r){if(!(this instanceof e))return new e(t,n,r);if(te(0!==r,"Cannot step a Range by 0"),t=t||0,void 0===n&&(n=1/0),r=void 0===r?1:Math.abs(r),n<t&&(r=-r),this._start=t,this._end=n,this._step=r,this.size=Math.max(0,Math.ceil((n-t)/r-1)+1),0===this.size){if(Wn)return Wn;Wn=this}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(1!==this._step?" by "+this._step:"")+" ]"},e.prototype.get=function(t,e){return this.has(t)?this._start+h(this,t)*this._step:e},e.prototype.includes=function(t){var e=(t-this._start)/this._step;return e>=0&&e<this.size&&e===Math.floor(e)},e.prototype.slice=function(t,n){return p(t,n,this.size)?this:(t=f(t,this.size),(n=_(n,this.size))<=t?new e(0,0):new e(this.get(t,this._end),this.get(n,this._end),this._step))},e.prototype.indexOf=function(t){var e=t-this._start;if(e%this._step==0){var n=e/this._step;if(n>=0&&n<this.size)return n}return-1},e.prototype.lastIndexOf=function(t){return this.indexOf(t)},e.prototype.__iterate=function(t,e){for(var n=this.size,r=this._step,i=e?this._start+(n-1)*r:this._start,o=0;o!==n&&!1!==t(i,e?n-++o:o++,this);)i+=e?-r:r;return o},e.prototype.__iterator=function(t,e){var n=this.size,r=this._step,i=e?this._start+(n-1)*r:this._start,o=0;return new G((function(){if(o===n)return{value:void 0,done:!0};var s=i;return i+=e?-r:r,W(t,e?n-++o:o++,s)}))},e.prototype.equals=function(t){return t instanceof e?this._start===t._start&&this._end===t._end&&this._step===t._step:Ln(this,t)},e}(Z);function Vn(t,e,n){for(var r=ne(e),i=0;i!==r.length;)if((t=ce(t,r[i++],a))===a)return n;return t}function qn(t,e){return Vn(this,t,e)}function $n(t,e){return Vn(t,e,a)!==a}function Yn(){ee(this.size);var t={};return this.__iterate((function(e,n){t[n]=e})),t}w.isIterable=y,w.isKeyed=I,w.isIndexed=S,w.isAssociative=T,w.isOrdered=x,w.Iterator=G,xn(w,{toArray:function(){ee(this.size);var t=new Array(this.size||0),e=I(this),n=0;return this.__iterate((function(r,i){t[n++]=e?[i,r]:r})),t},toIndexedSeq:function(){return new Pt(this)},toJS:function(){return Un(this)},toKeyedSeq:function(){return new Nt(this,!0)},toMap:function(){return xe(this.toKeyedSeq())},toObject:Yn,toOrderedMap:function(){return En(this.toKeyedSeq())},toOrderedSet:function(){return ar(I(this)?this.valueSeq():this)},toSet:function(){return Fn(I(this)?this.valueSeq():this)},toSetSeq:function(){return new Lt(this)},toSeq:function(){return S(this)?this.toIndexedSeq():I(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return On(I(this)?this.valueSeq():this)},toList:function(){return sn(I(this)?this.valueSeq():this)},toString:function(){return"[Collection]"},__toString:function(t,e){return 0===this.size?t+e:t+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+e},concat:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return $t(this,function(t,e){var n=I(t),r=[t].concat(e).map((function(t){return y(t)?n&&(t=O(t)):t=n?st(t):at(Array.isArray(t)?t:[t]),t})).filter((function(t){return 0!==t.size}));if(0===r.length)return t;if(1===r.length){var i=r[0];if(i===t||n&&I(i)||S(t)&&S(i))return i}var o=new et(r);return n?o=o.toKeyedSeq():S(t)||(o=o.toSetSeq()),(o=o.flatten(!0)).size=r.reduce((function(t,e){if(void 0!==t){var n=e.size;if(void 0!==n)return t+n}}),0),o}(this,t))},includes:function(t){return this.some((function(e){return pt(e,t)}))},entries:function(){return this.__iterator(M)},every:function(t,e){ee(this.size);var n=!0;return this.__iterate((function(r,i,o){if(!t.call(e,r,i,o))return n=!1,!1})),n},filter:function(t,e){return $t(this,Ht(this,t,e,!0))},partition:function(t,e){return function(t,e,n){var r=I(t),i=[[],[]];t.__iterate((function(o,s){i[e.call(n,o,s,t)?1:0].push(r?[s,o]:o)}));var o=Kt(t);return i.map((function(e){return $t(t,o(e))}))}(this,t,e)},find:function(t,e,n){var r=this.findEntry(t,e);return r?r[1]:n},forEach:function(t,e){return ee(this.size),this.__iterate(e?t.bind(e):t)},join:function(t){ee(this.size),t=void 0!==t?""+t:",";var e="",n=!0;return this.__iterate((function(r){n?n=!1:e+=t,e+=null!=r?r.toString():""})),e},keys:function(){return this.__iterator(U)},map:function(t,e){return $t(this,Ft(this,t,e))},reduce:function(t,e,n){return Zn(this,t,e,n,arguments.length<2,!1)},reduceRight:function(t,e,n){return Zn(this,t,e,n,arguments.length<2,!0)},reverse:function(){return $t(this,Mt(this,!0))},slice:function(t,e){return $t(this,jt(this,t,e,!0))},some:function(t,e){return!this.every(nr(t),e)},sort:function(t){return $t(this,Wt(this,t))},values:function(){return this.__iterator(F)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some((function(){return!0}))},count:function(t,e){return l(t?this.toSeq().filter(t,e):this)},countBy:function(t,e){return function(t,e,n){var r=xe().asMutable();return t.__iterate((function(i,o){r.update(e.call(n,i,o,t),0,(function(t){return t+1}))})),r.asImmutable()}(this,t,e)},equals:function(t){return Ln(this,t)},entrySeq:function(){var t=this;if(t._cache)return new et(t._cache);var e=t.toSeq().map(er).toIndexedSeq();return e.fromEntrySeq=function(){return t.toSeq()},e},filterNot:function(t,e){return this.filter(nr(t),e)},findEntry:function(t,e,n){var r=n;return this.__iterate((function(n,i,o){if(t.call(e,n,i,o))return r=[i,n],!1})),r},findKey:function(t,e){var n=this.findEntry(t,e);return n&&n[0]},findLast:function(t,e,n){return this.toKeyedSeq().reverse().find(t,e,n)},findLastEntry:function(t,e,n){return this.toKeyedSeq().reverse().findEntry(t,e,n)},findLastKey:function(t,e){return this.toKeyedSeq().reverse().findKey(t,e)},first:function(t){return this.find(d,null,t)},flatMap:function(t,e){return $t(this,function(t,e,n){var r=Kt(t);return t.toSeq().map((function(i,o){return r(e.call(n,i,o,t))})).flatten(!0)}(this,t,e))},flatten:function(t){return $t(this,Gt(this,t,!0))},fromEntrySeq:function(){return new xt(this)},get:function(t,e){return this.find((function(e,n){return pt(n,t)}),void 0,e)},getIn:qn,groupBy:function(t,e){return function(t,e,n){var r=I(t),i=(x(t)?En():xe()).asMutable();t.__iterate((function(o,s){i.update(e.call(n,o,s,t),(function(t){return(t=t||[]).push(r?[s,o]:o),t}))}));var o=Kt(t);return i.map((function(e){return $t(t,o(e))})).asImmutable()}(this,t,e)},has:function(t){return this.get(t,a)!==a},hasIn:function(t){return $n(this,t)},isSubset:function(t){return t="function"==typeof t.includes?t:w(t),this.every((function(e){return t.includes(e)}))},isSuperset:function(t){return(t="function"==typeof t.isSubset?t:w(t)).isSubset(this)},keyOf:function(t){return this.findKey((function(e){return pt(e,t)}))},keySeq:function(){return this.toSeq().map(tr).toIndexedSeq()},last:function(t){return this.toSeq().reverse().first(t)},lastKeyOf:function(t){return this.toKeyedSeq().reverse().keyOf(t)},max:function(t){return zt(this,t)},maxBy:function(t,e){return zt(this,e,t)},min:function(t){return zt(this,t?rr(t):or)},minBy:function(t,e){return zt(this,e?rr(e):or,t)},rest:function(){return this.slice(1)},skip:function(t){return 0===t?this:this.slice(Math.max(0,t))},skipLast:function(t){return 0===t?this:this.slice(0,-Math.max(0,t))},skipWhile:function(t,e){return $t(this,Bt(this,t,e,!0))},skipUntil:function(t,e){return this.skipWhile(nr(t),e)},sortBy:function(t,e){return $t(this,Wt(this,e,t))},take:function(t){return this.slice(0,Math.max(0,t))},takeLast:function(t){return this.slice(-Math.max(0,t))},takeWhile:function(t,e){return $t(this,function(t,e,n){var r=Qt(t);return r.__iterateUncached=function(r,i){var o=this;if(i)return this.cacheResult().__iterate(r,i);var s=0;return t.__iterate((function(t,i,a){return e.call(n,t,i,a)&&++s&&r(t,i,o)})),s},r.__iteratorUncached=function(r,i){var o=this;if(i)return this.cacheResult().__iterator(r,i);var s=t.__iterator(M,i),a=!0;return new G((function(){if(!a)return{value:void 0,done:!0};var t=s.next();if(t.done)return t;var i=t.value,c=i[0],u=i[1];return e.call(n,u,c,o)?r===M?t:W(r,c,u,t):(a=!1,{value:void 0,done:!0})}))},r}(this,t,e))},takeUntil:function(t,e){return this.takeWhile(nr(t),e)},update:function(t){return t(this)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=function(t){if(t.size===1/0)return 0;var e=x(t),n=I(t),r=e?1:0;return function(t,e){return e=ft(e,3432918353),e=ft(e<<15|e>>>-15,461845907),e=ft(e<<13|e>>>-13,5),e=(e+3864292196|0)^t,e=ft(e^e>>>16,2246822507),e=ft(e^e>>>13,3266489909),e=_t(e^e>>>16),e}(t.__iterate(n?e?function(t,e){r=31*r+sr(vt(t),vt(e))|0}:function(t,e){r=r+sr(vt(t),vt(e))|0}:e?function(t){r=31*r+vt(t)|0}:function(t){r=r+vt(t)|0}),r)}(this))}});var Kn=w.prototype;Kn[m]=!0,Kn[B]=Kn.values,Kn.toJSON=Kn.toArray,Kn.__toStringMapper=se,Kn.inspect=Kn.toSource=function(){return this.toString()},Kn.chain=Kn.flatMap,Kn.contains=Kn.includes,xn(O,{flip:function(){return $t(this,Ut(this))},mapEntries:function(t,e){var n=this,r=0;return $t(this,this.toSeq().map((function(i,o){return t.call(e,[o,i],r++,n)})).fromEntrySeq())},mapKeys:function(t,e){var n=this;return $t(this,this.toSeq().flip().map((function(r,i){return t.call(e,r,i,n)})).flip())}});var Qn=O.prototype;Qn[E]=!0,Qn[B]=Kn.entries,Qn.toJSON=Yn,Qn.__toStringMapper=function(t,e){return se(e)+": "+se(t)},xn(C,{toKeyedSeq:function(){return new Nt(this,!1)},filter:function(t,e){return $t(this,Ht(this,t,e,!1))},findIndex:function(t,e){var n=this.findEntry(t,e);return n?n[0]:-1},indexOf:function(t){var e=this.keyOf(t);return void 0===e?-1:e},lastIndexOf:function(t){var e=this.lastKeyOf(t);return void 0===e?-1:e},reverse:function(){return $t(this,Mt(this,!1))},slice:function(t,e){return $t(this,jt(this,t,e,!1))},splice:function(t,e){var n=arguments.length;if(e=Math.max(e||0,0),0===n||2===n&&!e)return this;t=f(t,t<0?this.count():this.size);var r=this.slice(0,t);return $t(this,1===n?r:r.concat(Zt(arguments,2),this.slice(t+e)))},findLastIndex:function(t,e){var n=this.findLastEntry(t,e);return n?n[0]:-1},first:function(t){return this.get(0,t)},flatten:function(t){return $t(this,Gt(this,t,!1))},get:function(t,e){return(t=h(this,t))<0||this.size===1/0||void 0!==this.size&&t>this.size?e:this.find((function(e,n){return n===t}),void 0,e)},has:function(t){return(t=h(this,t))>=0&&(void 0!==this.size?this.size===1/0||t<this.size:-1!==this.indexOf(t))},interpose:function(t){return $t(this,function(t,e){var n=Qt(t);return n.size=t.size&&2*t.size-1,n.__iterateUncached=function(n,r){var i=this,o=0;return t.__iterate((function(t){return(!o||!1!==n(e,o++,i))&&!1!==n(t,o++,i)}),r),o},n.__iteratorUncached=function(n,r){var i,o=t.__iterator(F,r),s=0;return new G((function(){return(!i||s%2)&&(i=o.next()).done?i:s%2?W(n,s++,e):W(n,s++,i.value,i)}))},n}(this,t))},interleave:function(){var t=[this].concat(Zt(arguments)),e=qt(this.toSeq(),Z.of,t),n=e.flatten(!0);return e.size&&(n.size=e.size*t.length),$t(this,n)},keySeq:function(){return zn(0,this.size)},last:function(t){return this.get(-1,t)},skipWhile:function(t,e){return $t(this,Bt(this,t,e,!1))},zip:function(){return $t(this,qt(this,ir,[this].concat(Zt(arguments))))},zipAll:function(){return $t(this,qt(this,ir,[this].concat(Zt(arguments)),!0))},zipWith:function(t){var e=Zt(arguments);return e[0]=this,$t(this,qt(this,t,e))}});var Jn=C.prototype;Jn[b]=!0,Jn[L]=!0,xn(A,{get:function(t,e){return this.has(t)?t:e},includes:function(t){return this.has(t)},keySeq:function(){return this.valueSeq()}});var Xn=A.prototype;function Zn(t,e,n,r,i,o){return ee(t.size),t.__iterate((function(t,o,s){i?(i=!1,n=t):n=e.call(r,n,t,o,s)}),o),n}function tr(t,e){return e}function er(t,e){return[e,t]}function nr(t){return function(){return!t.apply(this,arguments)}}function rr(t){return function(){return-t.apply(this,arguments)}}function ir(){return Zt(arguments)}function or(t,e){return t<e?1:t>e?-1:0}function sr(t,e){return t^e+2654435769+(t<<6)+(t>>2)|0}Xn.has=Kn.includes,Xn.contains=Xn.includes,Xn.keys=Xn.values,xn(X,Qn),xn(Z,Jn),xn(tt,Xn);var ar=function(t){function e(t){return null==t?hr():Pn(t)?t:hr().withMutations((function(e){var n=A(t);ee(n.size),n.forEach((function(t){return e.add(t)}))}))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.fromKeys=function(t){return this(O(t).keySeq())},e.prototype.toString=function(){return this.__toString("OrderedSet {","}")},e}(Fn);ar.isOrderedSet=Pn;var cr,ur=ar.prototype;function lr(t,e){var n=Object.create(ur);return n.size=t?t.size:0,n._map=t,n.__ownerID=e,n}function hr(){return cr||(cr=lr(bn()))}ur[L]=!0,ur.zip=Jn.zip,ur.zipWith=Jn.zipWith,ur.zipAll=Jn.zipAll,ur.__empty=hr,ur.__make=lr;var dr=function(t,e){var n;!function(t){if(N(t))throw new Error("Can not call `Record` with an immutable Record as default values. Use a plain javascript object instead.");if(P(t))throw new Error("Can not call `Record` with an immutable Collection as default values. Use a plain javascript object instead.");if(null===t||"object"!=typeof t)throw new Error("Can not call `Record` with a non-object as default values. Use a plain javascript object instead.")}(t);var r=function(o){var s=this;if(o instanceof r)return o;if(!(this instanceof r))return new r(o);if(!n){n=!0;var a=Object.keys(t),c=i._indices={};i._name=e,i._keys=a,i._defaultValues=t;for(var u=0;u<a.length;u++){var l=a[u];c[l]=u,i[l]?"object"==typeof console&&console.warn&&console.warn("Cannot define "+_r(this)+' with property "'+l+'" since that property name is part of the Record API.'):vr(i,l)}}return this.__ownerID=void 0,this._values=sn().withMutations((function(t){t.setSize(s._keys.length),O(o).forEach((function(e,n){t.set(s._indices[n],e===s._defaultValues[n]?void 0:e)}))})),this},i=r.prototype=Object.create(pr);return i.constructor=r,e&&(r.displayName=e),r};dr.prototype.toString=function(){for(var t,e=_r(this)+" { ",n=this._keys,r=0,i=n.length;r!==i;r++)e+=(r?", ":"")+(t=n[r])+": "+se(this.get(t));return e+" }"},dr.prototype.equals=function(t){return this===t||N(t)&&gr(this).equals(gr(t))},dr.prototype.hashCode=function(){return gr(this).hashCode()},dr.prototype.has=function(t){return this._indices.hasOwnProperty(t)},dr.prototype.get=function(t,e){if(!this.has(t))return e;var n=this._indices[t],r=this._values.get(n);return void 0===r?this._defaultValues[t]:r},dr.prototype.set=function(t,e){if(this.has(t)){var n=this._values.set(this._indices[t],e===this._defaultValues[t]?void 0:e);if(n!==this._values&&!this.__ownerID)return fr(this,n)}return this},dr.prototype.remove=function(t){return this.set(t)},dr.prototype.clear=function(){var t=this._values.clear().setSize(this._keys.length);return this.__ownerID?this:fr(this,t)},dr.prototype.wasAltered=function(){return this._values.wasAltered()},dr.prototype.toSeq=function(){return gr(this)},dr.prototype.toJS=function(){return Un(this)},dr.prototype.entries=function(){return this.__iterator(M)},dr.prototype.__iterator=function(t,e){return gr(this).__iterator(t,e)},dr.prototype.__iterate=function(t,e){return gr(this).__iterate(t,e)},dr.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._values.__ensureOwner(t);return t?fr(this,e,t):(this.__ownerID=t,this._values=e,this)},dr.isRecord=N,dr.getDescriptiveName=_r;var pr=dr.prototype;function fr(t,e,n){var r=Object.create(Object.getPrototypeOf(t));return r._values=e,r.__ownerID=n,r}function _r(t){return t.constructor.displayName||t.constructor.name||"Record"}function gr(t){return st(t._keys.map((function(e){return[e,t.get(e)]})))}function vr(t,e){try{Object.defineProperty(t,e,{get:function(){return this.get(e)},set:function(t){te(this.__ownerID,"Cannot set on an immutable record."),this.set(e,t)}})}catch(t){}}pr[D]=!0,pr[r]=pr.remove,pr.deleteIn=pr.removeIn=ve,pr.getIn=qn,pr.hasIn=Kn.hasIn,pr.merge=Ie,pr.mergeWith=be,pr.mergeIn=Re,pr.mergeDeep=Ce,pr.mergeDeepWith=Ae,pr.mergeDeepIn=ke,pr.setIn=_e,pr.update=ye,pr.updateIn=Ee,pr.withMutations=De,pr.asMutable=Ne,pr.asImmutable=Pe,pr[B]=pr.entries,pr.toJSON=pr.toObject=Kn.toObject,pr.inspect=pr.toSource=function(){return this.toString()};function mr(t,e){return yr([],e||Er,t,"",e&&e.length>2?[]:void 0,{"":t})}function yr(t,e,n,r,i,o){if("string"!=typeof n&&!P(n)&&(Q(n)||V(n)||ie(n))){if(~t.indexOf(n))throw new TypeError("Cannot convert circular structure to Immutable");t.push(n),i&&""!==r&&i.push(r);var s=e.call(o,r,J(n).map((function(r,o){return yr(t,e,r,o,i,n)})),i&&i.slice());return t.pop(),i&&i.pop(),s}return n}function Er(t,e){return S(e)?e.toList():I(e)?e.toMap():e.toSet()}},5151:(t,e,n)=>{t.exports=n(9782)},8819:(t,e,n)=>{n(5346);var r=n(2521),i="undefined"!=typeof WeakMap?WeakMap:function(){var t=[],e=[];return{set:function(n,r){t.push(n),e.push(r)},get:function(n){for(var r=0;r<t.length;r++)if(t[r]===n)return e[r]}}};e.decycle=function t(e,n,o,s){"use strict";s=s||new i;var a=!Object.prototype.hasOwnProperty.call(n,"circular"),c=!1!==n.refs;return function e(i,u,l){var h,d,p,f="function"==typeof o?o(l||"",i):i;if(n.date&&f instanceof Date)return{$jsan:"d"+f.getTime()};if(n.regex&&f instanceof RegExp)return{$jsan:"r"+r.getRegexFlags(f)+","+f.source};if(n.function&&"function"==typeof f)return{$jsan:"f"+r.stringifyFunction(f,n.function)};if(n.nan&&"number"==typeof f&&isNaN(f))return{$jsan:"n"};if(n.infinity){if(Number.POSITIVE_INFINITY===f)return{$jsan:"i"};if(Number.NEGATIVE_INFINITY===f)return{$jsan:"y"}}if(n[void 0]&&void 0===f)return{$jsan:"u"};if(n.error&&f instanceof Error)return{$jsan:"e"+f.message};if(n.symbol&&"symbol"==typeof f){var _=Symbol.keyFor(f);return void 0!==_?{$jsan:"g"+_}:{$jsan:"s"+f.toString().slice(7,-1)}}if(n.map&&"function"==typeof Map&&f instanceof Map&&"function"==typeof Array.from)return{$jsan:"m"+JSON.stringify(t(Array.from(f),n,o,s))};if(n.set&&"function"==typeof Set&&f instanceof Set&&"function"==typeof Array.from)return{$jsan:"l"+JSON.stringify(t(Array.from(f),n,o,s))};if(f&&"function"==typeof f.toJSON)try{f=f.toJSON(l)}catch(t){var g=l||"$";return"toJSON failed for '"+(s.get(f)||g)+"'"}if(!("object"!=typeof f||null===f||f instanceof Boolean||f instanceof Date||f instanceof Number||f instanceof RegExp||f instanceof String||"symbol"==typeof f||f instanceof Error)){if("object"==typeof f){var v=s.get(f);if(v){if(a&&c)return{$jsan:v};if(0===u.split(".").slice(0,-1).join(".").indexOf(v))return a?{$jsan:v}:"function"==typeof n.circular?n.circular(f,u,v):n.circular;if(c)return{$jsan:v}}s.set(f,u)}if("[object Array]"===Object.prototype.toString.apply(f))for(p=[],h=0;h<f.length;h+=1)p[h]=e(f[h],u+"["+h+"]",h);else for(d in p={},f)if(Object.prototype.hasOwnProperty.call(f,d)){var m=/^\w+$/.test(d)?"."+d:"["+JSON.stringify(d)+"]";p[d]="$jsan"===d?[e(f[d],u+m)]:e(f[d],u+m,d)}return p}return f}(e,"$")},e.retrocycle=function(t){"use strict";return function e(n){var i,o,s;if(n&&"object"==typeof n)if("[object Array]"===Object.prototype.toString.apply(n))for(i=0;i<n.length;i+=1)(o=n[i])&&"object"==typeof o&&(o.$jsan?n[i]=r.restore(o.$jsan,t):e(o));else for(s in n){if("string"==typeof n[s]&&"$jsan"===s)return r.restore(n.$jsan,t);"$jsan"===s&&(n[s]=n[s][0]),"object"==typeof n[s]&&(o=n[s])&&"object"==typeof o&&(o.$jsan?n[s]=r.restore(o.$jsan,t):e(o))}return n}(t)}},9782:(t,e,n)=>{var r=n(8819);e.stringify=function(t,e,n,i){if(arguments.length<4)try{return 1===arguments.length?JSON.stringify(t):JSON.stringify.apply(JSON,arguments)}catch(t){}var o=i||!1;"boolean"==typeof o&&(o={date:o,function:o,regex:o,undefined:o,error:o,symbol:o,map:o,set:o,nan:o,infinity:o});var s=r.decycle(t,o,e);return 1===arguments.length?JSON.stringify(s):JSON.stringify(s,Array.isArray(e)?e:null,n)},e.parse=function(t,e){var n,i=/"\$jsan"/.test(t);return n=1===arguments.length?JSON.parse(t):JSON.parse(t,e),i&&(n=r.retrocycle(n)),n}},5346:t=>{t.exports=function(t,e){if("$"!==e)for(var n=function(t){var e,n=/(?:\.(\w+))|(?:\[(\d+)\])|(?:\["((?:[^\\"]|\\.)*)"\])/g,r=[];for(;e=n.exec(t);)r.push(e[1]||e[2]||e[3]);return r}(e),r=0;r<n.length;r++)void 0===t[e=n[r].toString().replace(/\\"/g,'"')]&&r!==n.length-1||(t=t[e]);return t}},2521:(t,e,n)=>{var r=n(5346),i=n(9782);e.getRegexFlags=function(t){var e="";return t.ignoreCase&&(e+="i"),t.global&&(e+="g"),t.multiline&&(e+="m"),e},e.stringifyFunction=function(t,e){if("function"==typeof e)return e(t);var n=t.toString(),r=n.match(/^[^{]*{|^[^=]*=>/),i=r?r[0]:"<function> ",o="}"===n[n.length-1]?"}":"";return i.replace(/\r\n|\n/g," ").replace(/\s+/g," ")+" /* ... */ "+o},e.restore=function(t,e){var n=t[0],o=t.slice(1);switch(n){case"$":return r(e,t);case"r":var s=o.indexOf(","),a=o.slice(0,s),c=o.slice(s+1);return RegExp(c,a);case"d":return new Date(+o);case"f":var u=function(){throw new Error("can't run jsan parsed function")};return u.toString=function(){return o},u;case"u":return;case"e":var l=new Error(o);return l.stack="Stack is unavailable for jsan parsed errors",l;case"s":return Symbol(o);case"g":return Symbol.for(o);case"m":return new Map(i.parse(o));case"l":return new Set(i.parse(o));case"n":return NaN;case"i":return 1/0;case"y":return-1/0;default:return console.warn("unknown type",t),t}}},3192:t=>{"use strict";t.exports=function(t){var e,n={};if(!(t instanceof Object)||Array.isArray(t))throw new Error("keyMirror(...): Argument must be an object.");for(e in t)t.hasOwnProperty(e)&&(n[e]=e);return n}},3661:t=>{"use strict";var e,n;function r(){if(arguments.length)return r.from(arguments)}function i(){}e="An argument without append, prepend, or detach methods was given to `List",n=r.prototype,r.of=function(){return r.from.call(this,arguments)},r.from=function(t){var e,n,r,i=new this;if(t&&(e=t.length))for(n=-1;++n<e;)null!=(r=t[n])&&i.append(r);return i},n.head=null,n.tail=null,n.toArray=function(){for(var t=this.head,e=[];t;)e.push(t),t=t.next;return e},n.prepend=function(t){if(!t)return!1;if(!t.append||!t.prepend||!t.detach)throw new Error(e+"#prepend`.");var n,r;return(r=(n=this).head)?r.prepend(t):(t.detach(),t.list=n,n.head=t,t)},n.append=function(t){if(!t)return!1;if(!t.append||!t.prepend||!t.detach)throw new Error(e+"#append`.");var n,r,i;return(i=(n=this).tail)?i.append(t):(r=n.head)?r.append(t):(t.detach(),t.list=n,n.head=t,t)},r.Item=i;var o=i.prototype;o.next=null,o.prev=null,o.list=null,o.detach=function(){var t=this,e=t.list,n=t.prev,r=t.next;return e?(e.tail===t&&(e.tail=n),e.head===t&&(e.head=r),e.tail===e.head&&(e.tail=null),n&&(n.next=r),r&&(r.prev=n),t.prev=t.next=t.list=null,t):t},o.prepend=function(t){if(!(t&&t.append&&t.prepend&&t.detach))throw new Error(e+"Item#prepend`.");var n=this,r=n.list,i=n.prev;return!!r&&(t.detach(),i&&(t.prev=i,i.next=t),t.next=n,t.list=r,n.prev=t,n===r.head&&(r.head=t),r.tail||(r.tail=n),t)},o.append=function(t){if(!(t&&t.append&&t.prepend&&t.detach))throw new Error(e+"Item#append`.");var n=this,r=n.list,i=n.next;return!!r&&(t.detach(),i&&(t.next=i,i.prev=t),t.prev=n,t.list=r,n.next=t,n!==r.tail&&r.tail||(r.tail=t),t)},t.exports=r},3357:(t,e,n)=>{"use strict";t.exports=n(3661)},5089:t=>{var e=9007199254740991,n="[object Arguments]",r="[object Function]",i="[object GeneratorFunction]",o=/^(?:0|[1-9]\d*)$/;var s=Object.prototype,a=s.hasOwnProperty,c=s.toString,u=s.propertyIsEnumerable,l=Math.max;function h(t,e){var r=g(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&v(t)}(t)&&a.call(t,"callee")&&(!u.call(t,"callee")||c.call(t)==n)}(t)?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],i=r.length,o=!!i;for(var s in t)!e&&!a.call(t,s)||o&&("length"==s||f(s,i))||r.push(s);return r}function d(t,e,n){var r=t[e];a.call(t,e)&&_(r,n)&&(void 0!==n||e in t)||(t[e]=n)}function p(t){if(!m(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e,n,r,i=(n=(e=t)&&e.constructor,r="function"==typeof n&&n.prototype||s,e===r),o=[];for(var c in t)("constructor"!=c||!i&&a.call(t,c))&&o.push(c);return o}function f(t,n){return!!(n=null==n?e:n)&&("number"==typeof t||o.test(t))&&t>-1&&t%1==0&&t<n}function _(t,e){return t===e||t!=t&&e!=e}var g=Array.isArray;function v(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=e}(t.length)&&!function(t){var e=m(t)?c.call(t):"";return e==r||e==i}(t)}function m(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var y,E,I,b=(y=function(t,e){!function(t,e,n,r){n||(n={});for(var i=-1,o=e.length;++i<o;){var s=e[i],a=r?r(n[s],t[s],s,n,t):void 0;d(n,s,void 0===a?t[s]:a)}}(e,function(t){return v(t)?h(t,!0):p(t)}(e),t)},E=function(t,e){var n=-1,r=e.length,i=r>1?e[r-1]:void 0,o=r>2?e[2]:void 0;for(i=y.length>3&&"function"==typeof i?(r--,i):void 0,o&&function(t,e,n){if(!m(n))return!1;var r=typeof e;return!!("number"==r?v(n)&&f(e,n.length):"string"==r&&e in n)&&_(n[e],t)}(e[0],e[1],o)&&(i=r<3?void 0:i,r=1),t=Object(t);++n<r;){var s=e[n];s&&y(t,s,n,i)}return t},I=l(void 0===I?E.length-1:I,0),function(){for(var t=arguments,e=-1,n=l(t.length-I,0),r=Array(n);++e<n;)r[e]=t[I+e];e=-1;for(var i=Array(I+1);++e<I;)i[e]=t[e];return i[I]=r,function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}(E,this,i)});t.exports=b},1478:(t,e,n)=>{var r=200,i="__lodash_hash_undefined__",o=9007199254740991,s="[object Arguments]",a="[object Function]",c="[object GeneratorFunction]",u=/^\[object .+?Constructor\]$/,l="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,h="object"==typeof self&&self&&self.Object===Object&&self,d=l||h||Function("return this")();function p(t,e){return!!(t?t.length:0)&&function(t,e,n){if(e!=e)return function(t,e,n,r){var i=t.length,o=n+(r?1:-1);for(;r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}(t,g,n);var r=n-1,i=t.length;for(;++r<i;)if(t[r]===e)return r;return-1}(t,e,0)>-1}function f(t,e,n){for(var r=-1,i=t?t.length:0;++r<i;)if(n(e,t[r]))return!0;return!1}function _(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function g(t){return t!=t}function v(t,e){return t.has(e)}var m,y=Array.prototype,E=Function.prototype,I=Object.prototype,b=d["__core-js_shared__"],S=(m=/[^.]+$/.exec(b&&b.keys&&b.keys.IE_PROTO||""))?"Symbol(src)_1."+m:"",T=E.toString,w=I.hasOwnProperty,O=I.toString,C=RegExp("^"+T.call(w).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),A=d.Symbol,R=I.propertyIsEnumerable,k=y.splice,D=A?A.isConcatSpreadable:void 0,N=Math.max,P=z(d,"Map"),L=z(Object,"create");function x(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function U(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function F(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function M(t){var e=-1,n=t?t.length:0;for(this.__data__=new F;++e<n;)this.add(t[e])}function H(t,e){for(var n,r,i=t.length;i--;)if((n=t[i][0])===(r=e)||n!=n&&r!=r)return i;return-1}function j(t,e,n,i){var o,s=-1,a=p,c=!0,u=t.length,l=[],h=e.length;if(!u)return l;n&&(e=function(t,e){for(var n=-1,r=t?t.length:0,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}(e,(o=n,function(t){return o(t)}))),i?(a=f,c=!1):e.length>=r&&(a=v,c=!1,e=new M(e));t:for(;++s<u;){var d=t[s],_=n?n(d):d;if(d=i||0!==d?d:0,c&&_==_){for(var g=h;g--;)if(e[g]===_)continue t;l.push(d)}else a(e,_,i)||l.push(d)}return l}function B(t,e,n,r,i){var o=-1,s=t.length;for(n||(n=V),i||(i=[]);++o<s;){var a=t[o];e>0&&n(a)?e>1?B(a,e-1,n,r,i):_(i,a):r||(i[i.length]=a)}return i}function G(t){if(!Z(t)||(e=t,S&&S in e))return!1;var e,n=X(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?C:u;return n.test(function(t){if(null!=t){try{return T.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function W(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function z(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return G(n)?n:void 0}function V(t){return K(t)||function(t){return J(t)&&w.call(t,"callee")&&(!R.call(t,"callee")||O.call(t)==s)}(t)||!!(D&&t&&t[D])}x.prototype.clear=function(){this.__data__=L?L(null):{}},x.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},x.prototype.get=function(t){var e=this.__data__;if(L){var n=e[t];return n===i?void 0:n}return w.call(e,t)?e[t]:void 0},x.prototype.has=function(t){var e=this.__data__;return L?void 0!==e[t]:w.call(e,t)},x.prototype.set=function(t,e){return this.__data__[t]=L&&void 0===e?i:e,this},U.prototype.clear=function(){this.__data__=[]},U.prototype.delete=function(t){var e=this.__data__,n=H(e,t);return!(n<0)&&(n==e.length-1?e.pop():k.call(e,n,1),!0)},U.prototype.get=function(t){var e=this.__data__,n=H(e,t);return n<0?void 0:e[n][1]},U.prototype.has=function(t){return H(this.__data__,t)>-1},U.prototype.set=function(t,e){var n=this.__data__,r=H(n,t);return r<0?n.push([t,e]):n[r][1]=e,this},F.prototype.clear=function(){this.__data__={hash:new x,map:new(P||U),string:new x}},F.prototype.delete=function(t){return W(this,t).delete(t)},F.prototype.get=function(t){return W(this,t).get(t)},F.prototype.has=function(t){return W(this,t).has(t)},F.prototype.set=function(t,e){return W(this,t).set(t,e),this},M.prototype.add=M.prototype.push=function(t){return this.__data__.set(t,i),this},M.prototype.has=function(t){return this.__data__.has(t)};var q,$,Y=(q=function(t,e){return J(t)?j(t,B(e,1,J,!0)):[]},$=N(void 0===$?q.length-1:$,0),function(){for(var t=arguments,e=-1,n=N(t.length-$,0),r=Array(n);++e<n;)r[e]=t[$+e];e=-1;for(var i=Array($+1);++e<$;)i[e]=t[e];return i[$]=r,function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}(q,this,i)});var K=Array.isArray;function Q(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=o}(t.length)&&!X(t)}function J(t){return function(t){return!!t&&"object"==typeof t}(t)&&Q(t)}function X(t){var e=Z(t)?O.call(t):"";return e==a||e==c}function Z(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}t.exports=Y},2307:(t,e,n)=>{t=n.nmd(t);var r=200,i="__lodash_hash_undefined__",o=1,s=2,a=9007199254740991,c="[object Arguments]",u="[object Array]",l="[object AsyncFunction]",h="[object Boolean]",d="[object Date]",p="[object Error]",f="[object Function]",_="[object GeneratorFunction]",g="[object Map]",v="[object Number]",m="[object Null]",y="[object Object]",E="[object Promise]",I="[object Proxy]",b="[object RegExp]",S="[object Set]",T="[object String]",w="[object Symbol]",O="[object Undefined]",C="[object WeakMap]",A="[object ArrayBuffer]",R="[object DataView]",k=/^\[object .+?Constructor\]$/,D=/^(?:0|[1-9]\d*)$/,N={};N["[object Float32Array]"]=N["[object Float64Array]"]=N["[object Int8Array]"]=N["[object Int16Array]"]=N["[object Int32Array]"]=N["[object Uint8Array]"]=N["[object Uint8ClampedArray]"]=N["[object Uint16Array]"]=N["[object Uint32Array]"]=!0,N[c]=N[u]=N[A]=N[h]=N[R]=N[d]=N[p]=N[f]=N[g]=N[v]=N[y]=N[b]=N[S]=N[T]=N[C]=!1;var P="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,L="object"==typeof self&&self&&self.Object===Object&&self,x=P||L||Function("return this")(),U=e&&!e.nodeType&&e,F=U&&t&&!t.nodeType&&t,M=F&&F.exports===U,H=M&&P.process,j=function(){try{return H&&H.binding&&H.binding("util")}catch(t){}}(),B=j&&j.isTypedArray;function G(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function W(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function z(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var V,q,$,Y=Array.prototype,K=Function.prototype,Q=Object.prototype,J=x["__core-js_shared__"],X=K.toString,Z=Q.hasOwnProperty,tt=(V=/[^.]+$/.exec(J&&J.keys&&J.keys.IE_PROTO||""))?"Symbol(src)_1."+V:"",et=Q.toString,nt=RegExp("^"+X.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),rt=M?x.Buffer:void 0,it=x.Symbol,ot=x.Uint8Array,st=Q.propertyIsEnumerable,at=Y.splice,ct=it?it.toStringTag:void 0,ut=Object.getOwnPropertySymbols,lt=rt?rt.isBuffer:void 0,ht=(q=Object.keys,$=Object,function(t){return q($(t))}),dt=jt(x,"DataView"),pt=jt(x,"Map"),ft=jt(x,"Promise"),_t=jt(x,"Set"),gt=jt(x,"WeakMap"),vt=jt(Object,"create"),mt=zt(dt),yt=zt(pt),Et=zt(ft),It=zt(_t),bt=zt(gt),St=it?it.prototype:void 0,Tt=St?St.valueOf:void 0;function wt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Ot(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Ct(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function At(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Ct;++e<n;)this.add(t[e])}function Rt(t){var e=this.__data__=new Ot(t);this.size=e.size}function kt(t,e){var n=$t(t),r=!n&&qt(t),i=!n&&!r&&Yt(t),o=!n&&!r&&!i&&Zt(t),s=n||r||i||o,a=s?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],c=a.length;for(var u in t)!e&&!Z.call(t,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Wt(u,c))||a.push(u);return a}function Dt(t,e){for(var n=t.length;n--;)if(Vt(t[n][0],e))return n;return-1}function Nt(t){return null==t?void 0===t?O:m:ct&&ct in Object(t)?function(t){var e=Z.call(t,ct),n=t[ct];try{t[ct]=void 0;var r=!0}catch(t){}var i=et.call(t);r&&(e?t[ct]=n:delete t[ct]);return i}(t):function(t){return et.call(t)}(t)}function Pt(t){return Xt(t)&&Nt(t)==c}function Lt(t,e,n,r,i){return t===e||(null==t||null==e||!Xt(t)&&!Xt(e)?t!=t&&e!=e:function(t,e,n,r,i,a){var l=$t(t),f=$t(e),_=l?u:Gt(t),m=f?u:Gt(e),E=(_=_==c?y:_)==y,I=(m=m==c?y:m)==y,O=_==m;if(O&&Yt(t)){if(!Yt(e))return!1;l=!0,E=!1}if(O&&!E)return a||(a=new Rt),l||Zt(t)?Ft(t,e,n,r,i,a):function(t,e,n,r,i,a,c){switch(n){case R:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case A:return!(t.byteLength!=e.byteLength||!a(new ot(t),new ot(e)));case h:case d:case v:return Vt(+t,+e);case p:return t.name==e.name&&t.message==e.message;case b:case T:return t==e+"";case g:var u=W;case S:var l=r&o;if(u||(u=z),t.size!=e.size&&!l)return!1;var f=c.get(t);if(f)return f==e;r|=s,c.set(t,e);var _=Ft(u(t),u(e),r,i,a,c);return c.delete(t),_;case w:if(Tt)return Tt.call(t)==Tt.call(e)}return!1}(t,e,_,n,r,i,a);if(!(n&o)){var C=E&&Z.call(t,"__wrapped__"),k=I&&Z.call(e,"__wrapped__");if(C||k){var D=C?t.value():t,N=k?e.value():e;return a||(a=new Rt),i(D,N,n,r,a)}}if(!O)return!1;return a||(a=new Rt),function(t,e,n,r,i,s){var a=n&o,c=Mt(t),u=c.length,l=Mt(e),h=l.length;if(u!=h&&!a)return!1;var d=u;for(;d--;){var p=c[d];if(!(a?p in e:Z.call(e,p)))return!1}var f=s.get(t);if(f&&s.get(e))return f==e;var _=!0;s.set(t,e),s.set(e,t);var g=a;for(;++d<u;){var v=t[p=c[d]],m=e[p];if(r)var y=a?r(m,v,p,e,t,s):r(v,m,p,t,e,s);if(!(void 0===y?v===m||i(v,m,n,r,s):y)){_=!1;break}g||(g="constructor"==p)}if(_&&!g){var E=t.constructor,I=e.constructor;E==I||!("constructor"in t)||!("constructor"in e)||"function"==typeof E&&E instanceof E&&"function"==typeof I&&I instanceof I||(_=!1)}return s.delete(t),s.delete(e),_}(t,e,n,r,i,a)}(t,e,n,r,Lt,i))}function xt(t){return!(!Jt(t)||function(t){return!!tt&&tt in t}(t))&&(Kt(t)?nt:k).test(zt(t))}function Ut(t){if(n=(e=t)&&e.constructor,r="function"==typeof n&&n.prototype||Q,e!==r)return ht(t);var e,n,r,i=[];for(var o in Object(t))Z.call(t,o)&&"constructor"!=o&&i.push(o);return i}function Ft(t,e,n,r,i,a){var c=n&o,u=t.length,l=e.length;if(u!=l&&!(c&&l>u))return!1;var h=a.get(t);if(h&&a.get(e))return h==e;var d=-1,p=!0,f=n&s?new At:void 0;for(a.set(t,e),a.set(e,t);++d<u;){var _=t[d],g=e[d];if(r)var v=c?r(g,_,d,e,t,a):r(_,g,d,t,e,a);if(void 0!==v){if(v)continue;p=!1;break}if(f){if(!G(e,(function(t,e){if(o=e,!f.has(o)&&(_===t||i(_,t,n,r,a)))return f.push(e);var o}))){p=!1;break}}else if(_!==g&&!i(_,g,n,r,a)){p=!1;break}}return a.delete(t),a.delete(e),p}function Mt(t){return function(t,e,n){var r=e(t);return $t(t)?r:function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}(r,n(t))}(t,te,Bt)}function Ht(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function jt(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return xt(n)?n:void 0}wt.prototype.clear=function(){this.__data__=vt?vt(null):{},this.size=0},wt.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},wt.prototype.get=function(t){var e=this.__data__;if(vt){var n=e[t];return n===i?void 0:n}return Z.call(e,t)?e[t]:void 0},wt.prototype.has=function(t){var e=this.__data__;return vt?void 0!==e[t]:Z.call(e,t)},wt.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=vt&&void 0===e?i:e,this},Ot.prototype.clear=function(){this.__data__=[],this.size=0},Ot.prototype.delete=function(t){var e=this.__data__,n=Dt(e,t);return!(n<0)&&(n==e.length-1?e.pop():at.call(e,n,1),--this.size,!0)},Ot.prototype.get=function(t){var e=this.__data__,n=Dt(e,t);return n<0?void 0:e[n][1]},Ot.prototype.has=function(t){return Dt(this.__data__,t)>-1},Ot.prototype.set=function(t,e){var n=this.__data__,r=Dt(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},Ct.prototype.clear=function(){this.size=0,this.__data__={hash:new wt,map:new(pt||Ot),string:new wt}},Ct.prototype.delete=function(t){var e=Ht(this,t).delete(t);return this.size-=e?1:0,e},Ct.prototype.get=function(t){return Ht(this,t).get(t)},Ct.prototype.has=function(t){return Ht(this,t).has(t)},Ct.prototype.set=function(t,e){var n=Ht(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},At.prototype.add=At.prototype.push=function(t){return this.__data__.set(t,i),this},At.prototype.has=function(t){return this.__data__.has(t)},Rt.prototype.clear=function(){this.__data__=new Ot,this.size=0},Rt.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Rt.prototype.get=function(t){return this.__data__.get(t)},Rt.prototype.has=function(t){return this.__data__.has(t)},Rt.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Ot){var i=n.__data__;if(!pt||i.length<r-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new Ct(i)}return n.set(t,e),this.size=n.size,this};var Bt=ut?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var s=t[n];e(s,n,t)&&(o[i++]=s)}return o}(ut(t),(function(e){return st.call(t,e)})))}:function(){return[]},Gt=Nt;function Wt(t,e){return!!(e=null==e?a:e)&&("number"==typeof t||D.test(t))&&t>-1&&t%1==0&&t<e}function zt(t){if(null!=t){try{return X.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Vt(t,e){return t===e||t!=t&&e!=e}(dt&&Gt(new dt(new ArrayBuffer(1)))!=R||pt&&Gt(new pt)!=g||ft&&Gt(ft.resolve())!=E||_t&&Gt(new _t)!=S||gt&&Gt(new gt)!=C)&&(Gt=function(t){var e=Nt(t),n=e==y?t.constructor:void 0,r=n?zt(n):"";if(r)switch(r){case mt:return R;case yt:return g;case Et:return E;case It:return S;case bt:return C}return e});var qt=Pt(function(){return arguments}())?Pt:function(t){return Xt(t)&&Z.call(t,"callee")&&!st.call(t,"callee")},$t=Array.isArray;var Yt=lt||function(){return!1};function Kt(t){if(!Jt(t))return!1;var e=Nt(t);return e==f||e==_||e==l||e==I}function Qt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=a}function Jt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Xt(t){return null!=t&&"object"==typeof t}var Zt=B?function(t){return function(e){return t(e)}}(B):function(t){return Xt(t)&&Qt(t.length)&&!!N[Nt(t)]};function te(t){return null!=(e=t)&&Qt(e.length)&&!Kt(e)?kt(t):Ut(t);var e}t.exports=function(t,e){return Lt(t,e)}},8552:(t,e,n)=>{var r=n(852)(n(5639),"DataView");t.exports=r},1989:(t,e,n)=>{var r=n(1789),i=n(401),o=n(7667),s=n(1327),a=n(1866);function c(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=s,c.prototype.set=a,t.exports=c},8407:(t,e,n)=>{var r=n(7040),i=n(4125),o=n(2117),s=n(7518),a=n(4705);function c(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=s,c.prototype.set=a,t.exports=c},7071:(t,e,n)=>{var r=n(852)(n(5639),"Map");t.exports=r},3369:(t,e,n)=>{var r=n(4785),i=n(1285),o=n(6e3),s=n(9916),a=n(5265);function c(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=s,c.prototype.set=a,t.exports=c},3818:(t,e,n)=>{var r=n(852)(n(5639),"Promise");t.exports=r},8525:(t,e,n)=>{var r=n(852)(n(5639),"Set");t.exports=r},8668:(t,e,n)=>{var r=n(3369),i=n(619),o=n(2385);function s(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new r;++e<n;)this.add(t[e])}s.prototype.add=s.prototype.push=i,s.prototype.has=o,t.exports=s},6384:(t,e,n)=>{var r=n(8407),i=n(7465),o=n(3779),s=n(7599),a=n(4758),c=n(4309);function u(t){var e=this.__data__=new r(t);this.size=e.size}u.prototype.clear=i,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=a,u.prototype.set=c,t.exports=u},2705:(t,e,n)=>{var r=n(5639).Symbol;t.exports=r},1149:(t,e,n)=>{var r=n(5639).Uint8Array;t.exports=r},577:(t,e,n)=>{var r=n(852)(n(5639),"WeakMap");t.exports=r},6874:t=>{t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},4963:t=>{t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var s=t[n];e(s,n,t)&&(o[i++]=s)}return o}},7443:(t,e,n)=>{var r=n(2118);t.exports=function(t,e){return!!(null==t?0:t.length)&&r(t,e,0)>-1}},1196:t=>{t.exports=function(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}},4636:(t,e,n)=>{var r=n(2545),i=n(5694),o=n(1469),s=n(4144),a=n(5776),c=n(6719),u=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=o(t),l=!n&&i(t),h=!n&&!l&&s(t),d=!n&&!l&&!h&&c(t),p=n||l||h||d,f=p?r(t.length,String):[],_=f.length;for(var g in t)!e&&!u.call(t,g)||p&&("length"==g||h&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||a(g,_))||f.push(g);return f}},9932:t=>{t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}},2488:t=>{t.exports=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}},2908:t=>{t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}},8470:(t,e,n)=>{var r=n(7813);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},9465:(t,e,n)=>{var r=n(8777);t.exports=function(t,e,n){"__proto__"==e&&r?r(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},731:(t,e,n)=>{var r=n(8668),i=n(7443),o=n(1196),s=n(9932),a=n(1717),c=n(4757),u=200;t.exports=function(t,e,n,l){var h=-1,d=i,p=!0,f=t.length,_=[],g=e.length;if(!f)return _;n&&(e=s(e,a(n))),l?(d=o,p=!1):e.length>=u&&(d=c,p=!1,e=new r(e));t:for(;++h<f;){var v=t[h],m=null==n?v:n(v);if(v=l||0!==v?v:0,p&&m==m){for(var y=g;y--;)if(e[y]===m)continue t;_.push(v)}else d(e,m,l)||_.push(v)}return _}},1848:t=>{t.exports=function(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}},1078:(t,e,n)=>{var r=n(2488),i=n(7285);t.exports=function t(e,n,o,s,a){var c=-1,u=e.length;for(o||(o=i),a||(a=[]);++c<u;){var l=e[c];n>0&&o(l)?n>1?t(l,n-1,o,s,a):r(a,l):s||(a[a.length]=l)}return a}},8483:(t,e,n)=>{var r=n(5063)();t.exports=r},7816:(t,e,n)=>{var r=n(8483),i=n(3674);t.exports=function(t,e){return t&&r(t,e,i)}},7786:(t,e,n)=>{var r=n(1811),i=n(327);t.exports=function(t,e){for(var n=0,o=(e=r(e,t)).length;null!=t&&n<o;)t=t[i(e[n++])];return n&&n==o?t:void 0}},8866:(t,e,n)=>{var r=n(2488),i=n(1469);t.exports=function(t,e,n){var o=e(t);return i(t)?o:r(o,n(t))}},4239:(t,e,n)=>{var r=n(2705),i=n(9607),o=n(2333),s="[object Null]",a="[object Undefined]",c=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?a:s:c&&c in Object(t)?i(t):o(t)}},13:t=>{t.exports=function(t,e){return null!=t&&e in Object(t)}},2118:(t,e,n)=>{var r=n(1848),i=n(2722),o=n(2351);t.exports=function(t,e,n){return e==e?o(t,e,n):r(t,i,n)}},9454:(t,e,n)=>{var r=n(4239),i=n(7005),o="[object Arguments]";t.exports=function(t){return i(t)&&r(t)==o}},939:(t,e,n)=>{var r=n(2492),i=n(7005);t.exports=function t(e,n,o,s,a){return e===n||(null==e||null==n||!i(e)&&!i(n)?e!=e&&n!=n:r(e,n,o,s,t,a))}},2492:(t,e,n)=>{var r=n(6384),i=n(7114),o=n(8351),s=n(6096),a=n(4160),c=n(1469),u=n(4144),l=n(6719),h=1,d="[object Arguments]",p="[object Array]",f="[object Object]",_=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,g,v,m){var y=c(t),E=c(e),I=y?p:a(t),b=E?p:a(e),S=(I=I==d?f:I)==f,T=(b=b==d?f:b)==f,w=I==b;if(w&&u(t)){if(!u(e))return!1;y=!0,S=!1}if(w&&!S)return m||(m=new r),y||l(t)?i(t,e,n,g,v,m):o(t,e,I,n,g,v,m);if(!(n&h)){var O=S&&_.call(t,"__wrapped__"),C=T&&_.call(e,"__wrapped__");if(O||C){var A=O?t.value():t,R=C?e.value():e;return m||(m=new r),v(A,R,n,g,m)}}return!!w&&(m||(m=new r),s(t,e,n,g,v,m))}},2958:(t,e,n)=>{var r=n(6384),i=n(939),o=1,s=2;t.exports=function(t,e,n,a){var c=n.length,u=c,l=!a;if(null==t)return!u;for(t=Object(t);c--;){var h=n[c];if(l&&h[2]?h[1]!==t[h[0]]:!(h[0]in t))return!1}for(;++c<u;){var d=(h=n[c])[0],p=t[d],f=h[1];if(l&&h[2]){if(void 0===p&&!(d in t))return!1}else{var _=new r;if(a)var g=a(p,f,d,t,e,_);if(!(void 0===g?i(f,p,o|s,a,_):g))return!1}}return!0}},2722:t=>{t.exports=function(t){return t!=t}},8458:(t,e,n)=>{var r=n(3560),i=n(7724),o=n(3218),s=n(346),a=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,l=c.toString,h=u.hasOwnProperty,d=RegExp("^"+l.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!o(t)||i(t))&&(r(t)?d:a).test(s(t))}},8749:(t,e,n)=>{var r=n(4239),i=n(1780),o=n(7005),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,t.exports=function(t){return o(t)&&i(t.length)&&!!s[r(t)]}},7206:(t,e,n)=>{var r=n(1573),i=n(6432),o=n(6557),s=n(1469),a=n(9601);t.exports=function(t){return"function"==typeof t?t:null==t?o:"object"==typeof t?s(t)?i(t[0],t[1]):r(t):a(t)}},280:(t,e,n)=>{var r=n(5726),i=n(6916),o=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return i(t);var e=[];for(var n in Object(t))o.call(t,n)&&"constructor"!=n&&e.push(n);return e}},1573:(t,e,n)=>{var r=n(2958),i=n(1499),o=n(2634);t.exports=function(t){var e=i(t);return 1==e.length&&e[0][2]?o(e[0][0],e[0][1]):function(n){return n===t||r(n,t,e)}}},6432:(t,e,n)=>{var r=n(939),i=n(7361),o=n(9095),s=n(5403),a=n(9162),c=n(2634),u=n(327),l=1,h=2;t.exports=function(t,e){return s(t)&&a(e)?c(u(t),e):function(n){var s=i(n,t);return void 0===s&&s===e?o(n,t):r(e,s,l|h)}}},371:t=>{t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},9152:(t,e,n)=>{var r=n(7786);t.exports=function(t){return function(e){return r(e,t)}}},5976:(t,e,n)=>{var r=n(6557),i=n(5357),o=n(61);t.exports=function(t,e){return o(i(t,e,r),t+"")}},6560:(t,e,n)=>{var r=n(5703),i=n(8777),o=n(6557),s=i?function(t,e){return i(t,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:o;t.exports=s},2545:t=>{t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},531:(t,e,n)=>{var r=n(2705),i=n(9932),o=n(1469),s=n(3448),a=1/0,c=r?r.prototype:void 0,u=c?c.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(o(e))return i(e,t)+"";if(s(e))return u?u.call(e):"";var n=e+"";return"0"==n&&1/e==-a?"-0":n}},1717:t=>{t.exports=function(t){return function(e){return t(e)}}},5652:(t,e,n)=>{var r=n(8668),i=n(7443),o=n(1196),s=n(4757),a=n(3593),c=n(1814),u=200;t.exports=function(t,e,n){var l=-1,h=i,d=t.length,p=!0,f=[],_=f;if(n)p=!1,h=o;else if(d>=u){var g=e?null:a(t);if(g)return c(g);p=!1,h=s,_=new r}else _=e?[]:f;t:for(;++l<d;){var v=t[l],m=e?e(v):v;if(v=n||0!==v?v:0,p&&m==m){for(var y=_.length;y--;)if(_[y]===m)continue t;e&&_.push(m),f.push(v)}else h(_,m,n)||(_!==f&&_.push(m),f.push(v))}return f}},4757:t=>{t.exports=function(t,e){return t.has(e)}},1811:(t,e,n)=>{var r=n(1469),i=n(5403),o=n(5514),s=n(9833);t.exports=function(t,e){return r(t)?t:i(t,e)?[t]:o(s(t))}},4429:(t,e,n)=>{var r=n(5639)["__core-js_shared__"];t.exports=r},5063:t=>{t.exports=function(t){return function(e,n,r){for(var i=-1,o=Object(e),s=r(e),a=s.length;a--;){var c=s[t?a:++i];if(!1===n(o[c],c,o))break}return e}}},3593:(t,e,n)=>{var r=n(8525),i=n(308),o=n(1814),s=r&&1/o(new r([,-0]))[1]==1/0?function(t){return new r(t)}:i;t.exports=s},8777:(t,e,n)=>{var r=n(852),i=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=i},7114:(t,e,n)=>{var r=n(8668),i=n(2908),o=n(4757),s=1,a=2;t.exports=function(t,e,n,c,u,l){var h=n&s,d=t.length,p=e.length;if(d!=p&&!(h&&p>d))return!1;var f=l.get(t),_=l.get(e);if(f&&_)return f==e&&_==t;var g=-1,v=!0,m=n&a?new r:void 0;for(l.set(t,e),l.set(e,t);++g<d;){var y=t[g],E=e[g];if(c)var I=h?c(E,y,g,e,t,l):c(y,E,g,t,e,l);if(void 0!==I){if(I)continue;v=!1;break}if(m){if(!i(e,(function(t,e){if(!o(m,e)&&(y===t||u(y,t,n,c,l)))return m.push(e)}))){v=!1;break}}else if(y!==E&&!u(y,E,n,c,l)){v=!1;break}}return l.delete(t),l.delete(e),v}},8351:(t,e,n)=>{var r=n(2705),i=n(1149),o=n(7813),s=n(7114),a=n(8776),c=n(1814),u=1,l=2,h="[object Boolean]",d="[object Date]",p="[object Error]",f="[object Map]",_="[object Number]",g="[object RegExp]",v="[object Set]",m="[object String]",y="[object Symbol]",E="[object ArrayBuffer]",I="[object DataView]",b=r?r.prototype:void 0,S=b?b.valueOf:void 0;t.exports=function(t,e,n,r,b,T,w){switch(n){case I:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case E:return!(t.byteLength!=e.byteLength||!T(new i(t),new i(e)));case h:case d:case _:return o(+t,+e);case p:return t.name==e.name&&t.message==e.message;case g:case m:return t==e+"";case f:var O=a;case v:var C=r&u;if(O||(O=c),t.size!=e.size&&!C)return!1;var A=w.get(t);if(A)return A==e;r|=l,w.set(t,e);var R=s(O(t),O(e),r,b,T,w);return w.delete(t),R;case y:if(S)return S.call(t)==S.call(e)}return!1}},6096:(t,e,n)=>{var r=n(8234),i=1,o=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,s,a,c){var u=n&i,l=r(t),h=l.length;if(h!=r(e).length&&!u)return!1;for(var d=h;d--;){var p=l[d];if(!(u?p in e:o.call(e,p)))return!1}var f=c.get(t),_=c.get(e);if(f&&_)return f==e&&_==t;var g=!0;c.set(t,e),c.set(e,t);for(var v=u;++d<h;){var m=t[p=l[d]],y=e[p];if(s)var E=u?s(y,m,p,e,t,c):s(m,y,p,t,e,c);if(!(void 0===E?m===y||a(m,y,n,s,c):E)){g=!1;break}v||(v="constructor"==p)}if(g&&!v){var I=t.constructor,b=e.constructor;I==b||!("constructor"in t)||!("constructor"in e)||"function"==typeof I&&I instanceof I&&"function"==typeof b&&b instanceof b||(g=!1)}return c.delete(t),c.delete(e),g}},1957:(t,e,n)=>{var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;t.exports=r},8234:(t,e,n)=>{var r=n(8866),i=n(9551),o=n(3674);t.exports=function(t){return r(t,o,i)}},5050:(t,e,n)=>{var r=n(7019);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},1499:(t,e,n)=>{var r=n(9162),i=n(3674);t.exports=function(t){for(var e=i(t),n=e.length;n--;){var o=e[n],s=t[o];e[n]=[o,s,r(s)]}return e}},852:(t,e,n)=>{var r=n(8458),i=n(7801);t.exports=function(t,e){var n=i(t,e);return r(n)?n:void 0}},5924:(t,e,n)=>{var r=n(5569)(Object.getPrototypeOf,Object);t.exports=r},9607:(t,e,n)=>{var r=n(2705),i=Object.prototype,o=i.hasOwnProperty,s=i.toString,a=r?r.toStringTag:void 0;t.exports=function(t){var e=o.call(t,a),n=t[a];try{t[a]=void 0;var r=!0}catch(t){}var i=s.call(t);return r&&(e?t[a]=n:delete t[a]),i}},9551:(t,e,n)=>{var r=n(4963),i=n(479),o=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(t){return null==t?[]:(t=Object(t),r(s(t),(function(e){return o.call(t,e)})))}:i;t.exports=a},4160:(t,e,n)=>{var r=n(8552),i=n(7071),o=n(3818),s=n(8525),a=n(577),c=n(4239),u=n(346),l="[object Map]",h="[object Promise]",d="[object Set]",p="[object WeakMap]",f="[object DataView]",_=u(r),g=u(i),v=u(o),m=u(s),y=u(a),E=c;(r&&E(new r(new ArrayBuffer(1)))!=f||i&&E(new i)!=l||o&&E(o.resolve())!=h||s&&E(new s)!=d||a&&E(new a)!=p)&&(E=function(t){var e=c(t),n="[object Object]"==e?t.constructor:void 0,r=n?u(n):"";if(r)switch(r){case _:return f;case g:return l;case v:return h;case m:return d;case y:return p}return e}),t.exports=E},7801:t=>{t.exports=function(t,e){return null==t?void 0:t[e]}},222:(t,e,n)=>{var r=n(1811),i=n(5694),o=n(1469),s=n(5776),a=n(1780),c=n(327);t.exports=function(t,e,n){for(var u=-1,l=(e=r(e,t)).length,h=!1;++u<l;){var d=c(e[u]);if(!(h=null!=t&&n(t,d)))break;t=t[d]}return h||++u!=l?h:!!(l=null==t?0:t.length)&&a(l)&&s(d,l)&&(o(t)||i(t))}},1789:(t,e,n)=>{var r=n(4536);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},401:t=>{t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},7667:(t,e,n)=>{var r=n(4536),i="__lodash_hash_undefined__",o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return n===i?void 0:n}return o.call(e,t)?e[t]:void 0}},1327:(t,e,n)=>{var r=n(4536),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:i.call(e,t)}},1866:(t,e,n)=>{var r=n(4536),i="__lodash_hash_undefined__";t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?i:e,this}},7285:(t,e,n)=>{var r=n(2705),i=n(5694),o=n(1469),s=r?r.isConcatSpreadable:void 0;t.exports=function(t){return o(t)||i(t)||!!(s&&t&&t[s])}},5776:t=>{var e=9007199254740991,n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,r){var i=typeof t;return!!(r=null==r?e:r)&&("number"==i||"symbol"!=i&&n.test(t))&&t>-1&&t%1==0&&t<r}},5403:(t,e,n)=>{var r=n(1469),i=n(3448),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;t.exports=function(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!i(t))||(s.test(t)||!o.test(t)||null!=e&&t in Object(e))}},7019:t=>{t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},7724:(t,e,n)=>{var r,i=n(4429),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(t){return!!o&&o in t}},5726:t=>{var e=Object.prototype;t.exports=function(t){var n=t&&t.constructor;return t===("function"==typeof n&&n.prototype||e)}},9162:(t,e,n)=>{var r=n(3218);t.exports=function(t){return t==t&&!r(t)}},7040:t=>{t.exports=function(){this.__data__=[],this.size=0}},4125:(t,e,n)=>{var r=n(8470),i=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0)&&(n==e.length-1?e.pop():i.call(e,n,1),--this.size,!0)}},2117:(t,e,n)=>{var r=n(8470);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},7518:(t,e,n)=>{var r=n(8470);t.exports=function(t){return r(this.__data__,t)>-1}},4705:(t,e,n)=>{var r=n(8470);t.exports=function(t,e){var n=this.__data__,i=r(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}},4785:(t,e,n)=>{var r=n(1989),i=n(8407),o=n(7071);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},1285:(t,e,n)=>{var r=n(5050);t.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}},6e3:(t,e,n)=>{var r=n(5050);t.exports=function(t){return r(this,t).get(t)}},9916:(t,e,n)=>{var r=n(5050);t.exports=function(t){return r(this,t).has(t)}},5265:(t,e,n)=>{var r=n(5050);t.exports=function(t,e){var n=r(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}},8776:t=>{t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}},2634:t=>{t.exports=function(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}},4523:(t,e,n)=>{var r=n(8306),i=500;t.exports=function(t){var e=r(t,(function(t){return n.size===i&&n.clear(),t})),n=e.cache;return e}},4536:(t,e,n)=>{var r=n(852)(Object,"create");t.exports=r},6916:(t,e,n)=>{var r=n(5569)(Object.keys,Object);t.exports=r},1167:(t,e,n)=>{t=n.nmd(t);var r=n(1957),i=e&&!e.nodeType&&e,o=i&&t&&!t.nodeType&&t,s=o&&o.exports===i&&r.process,a=function(){try{var t=o&&o.require&&o.require("util").types;return t||s&&s.binding&&s.binding("util")}catch(t){}}();t.exports=a},2333:t=>{var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},5569:t=>{t.exports=function(t,e){return function(n){return t(e(n))}}},5357:(t,e,n)=>{var r=n(6874),i=Math.max;t.exports=function(t,e,n){return e=i(void 0===e?t.length-1:e,0),function(){for(var o=arguments,s=-1,a=i(o.length-e,0),c=Array(a);++s<a;)c[s]=o[e+s];s=-1;for(var u=Array(e+1);++s<e;)u[s]=o[s];return u[e]=n(c),r(t,this,u)}}},5639:(t,e,n)=>{var r=n(1957),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();t.exports=o},619:t=>{var e="__lodash_hash_undefined__";t.exports=function(t){return this.__data__.set(t,e),this}},2385:t=>{t.exports=function(t){return this.__data__.has(t)}},1814:t=>{t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}},61:(t,e,n)=>{var r=n(6560),i=n(1275)(r);t.exports=i},1275:t=>{var e=800,n=16,r=Date.now;t.exports=function(t){var i=0,o=0;return function(){var s=r(),a=n-(s-o);if(o=s,a>0){if(++i>=e)return arguments[0]}else i=0;return t.apply(void 0,arguments)}}},7465:(t,e,n)=>{var r=n(8407);t.exports=function(){this.__data__=new r,this.size=0}},3779:t=>{t.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},7599:t=>{t.exports=function(t){return this.__data__.get(t)}},4758:t=>{t.exports=function(t){return this.__data__.has(t)}},4309:(t,e,n)=>{var r=n(8407),i=n(7071),o=n(3369),s=200;t.exports=function(t,e){var n=this.__data__;if(n instanceof r){var a=n.__data__;if(!i||a.length<s-1)return a.push([t,e]),this.size=++n.size,this;n=this.__data__=new o(a)}return n.set(t,e),this.size=n.size,this}},2351:t=>{t.exports=function(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}},5514:(t,e,n)=>{var r=n(4523),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,s=r((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(i,(function(t,n,r,i){e.push(r?i.replace(o,"$1"):n||t)})),e}));t.exports=s},327:(t,e,n)=>{var r=n(3448),i=1/0;t.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-i?"-0":e}},346:t=>{var e=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return e.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},5703:t=>{t.exports=function(t){return function(){return t}}},1966:(t,e,n)=>{var r=n(731),i=n(1078),o=n(5976),s=n(9246),a=o((function(t,e){return s(t)?r(t,i(e,1,s,!0)):[]}));t.exports=a},7813:t=>{t.exports=function(t,e){return t===e||t!=t&&e!=e}},7361:(t,e,n)=>{var r=n(7786);t.exports=function(t,e,n){var i=null==t?void 0:r(t,e);return void 0===i?n:i}},9095:(t,e,n)=>{var r=n(13),i=n(222);t.exports=function(t,e){return null!=t&&i(t,e,r)}},6557:t=>{t.exports=function(t){return t}},5694:(t,e,n)=>{var r=n(9454),i=n(7005),o=Object.prototype,s=o.hasOwnProperty,a=o.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(t){return i(t)&&s.call(t,"callee")&&!a.call(t,"callee")};t.exports=c},1469:t=>{var e=Array.isArray;t.exports=e},8612:(t,e,n)=>{var r=n(3560),i=n(1780);t.exports=function(t){return null!=t&&i(t.length)&&!r(t)}},9246:(t,e,n)=>{var r=n(8612),i=n(7005);t.exports=function(t){return i(t)&&r(t)}},4144:(t,e,n)=>{t=n.nmd(t);var r=n(5639),i=n(5062),o=e&&!e.nodeType&&e,s=o&&t&&!t.nodeType&&t,a=s&&s.exports===o?r.Buffer:void 0,c=(a?a.isBuffer:void 0)||i;t.exports=c},3560:(t,e,n)=>{var r=n(4239),i=n(3218),o="[object AsyncFunction]",s="[object Function]",a="[object GeneratorFunction]",c="[object Proxy]";t.exports=function(t){if(!i(t))return!1;var e=r(t);return e==s||e==a||e==o||e==c}},1780:t=>{var e=9007199254740991;t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=e}},3218:t=>{t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},7005:t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},8630:(t,e,n)=>{var r=n(4239),i=n(5924),o=n(7005),s="[object Object]",a=Function.prototype,c=Object.prototype,u=a.toString,l=c.hasOwnProperty,h=u.call(Object);t.exports=function(t){if(!o(t)||r(t)!=s)return!1;var e=i(t);if(null===e)return!0;var n=l.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&u.call(n)==h}},3448:(t,e,n)=>{var r=n(4239),i=n(7005),o="[object Symbol]";t.exports=function(t){return"symbol"==typeof t||i(t)&&r(t)==o}},6719:(t,e,n)=>{var r=n(8749),i=n(1717),o=n(1167),s=o&&o.isTypedArray,a=s?i(s):r;t.exports=a},3674:(t,e,n)=>{var r=n(4636),i=n(280),o=n(8612);t.exports=function(t){return o(t)?r(t):i(t)}},6604:(t,e,n)=>{var r=n(9465),i=n(7816),o=n(7206);t.exports=function(t,e){var n={};return e=o(e,3),i(t,(function(t,i,o){r(n,i,e(t,i,o))})),n}},8306:(t,e,n)=>{var r=n(3369),i="Expected a function";function o(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(i);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=t.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(o.Cache||r),n}o.Cache=r,t.exports=o},308:t=>{t.exports=function(){}},9601:(t,e,n)=>{var r=n(371),i=n(9152),o=n(5403),s=n(327);t.exports=function(t){return o(t)?r(s(t)):i(t)}},479:t=>{t.exports=function(){return[]}},5062:t=>{t.exports=function(){return!1}},9833:(t,e,n)=>{var r=n(531);t.exports=function(t){return null==t?"":r(t)}},3386:(t,e,n)=>{var r=n(1078),i=n(5976),o=n(5652),s=n(9246),a=i((function(t){return o(r(t,1,s,!0))}));t.exports=a},7418:t=>{"use strict";var e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,i){for(var o,s,a=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),c=1;c<arguments.length;c++){for(var u in o=Object(arguments[c]))n.call(o,u)&&(a[u]=o[u]);if(e){s=e(o);for(var l=0;l<s.length;l++)r.call(o,s[l])&&(a[s[l]]=o[s[l]])}}return a}},7563:(t,e,n)=>{"use strict";var r=n(610),i=n(7418),o=n(4020);function s(t,e){return e.encode?e.strict?r(t):encodeURIComponent(t):t}function a(t){return Array.isArray(t)?t.sort():"object"==typeof t?a(Object.keys(t)).sort((function(t,e){return Number(t)-Number(e)})).map((function(e){return t[e]})):t}function c(t){var e=t.indexOf("?");return-1===e?"":t.slice(e+1)}function u(t,e){var n=function(t){var e;switch(t.arrayFormat){case"index":return function(t,n,r){e=/\[(\d*)\]$/.exec(t),t=t.replace(/\[\d*\]$/,""),e?(void 0===r[t]&&(r[t]={}),r[t][e[1]]=n):r[t]=n};case"bracket":return function(t,n,r){e=/(\[\])$/.exec(t),t=t.replace(/\[\]$/,""),e?void 0!==r[t]?r[t]=[].concat(r[t],n):r[t]=[n]:r[t]=n};default:return function(t,e,n){void 0!==n[t]?n[t]=[].concat(n[t],e):n[t]=e}}}(e=i({arrayFormat:"none"},e)),r=Object.create(null);return"string"!=typeof t?r:(t=t.trim().replace(/^[?#&]/,""))?(t.split("&").forEach((function(t){var e=t.replace(/\+/g," ").split("="),i=e.shift(),s=e.length>0?e.join("="):void 0;s=void 0===s?null:o(s),n(o(i),s,r)})),Object.keys(r).sort().reduce((function(t,e){var n=r[e];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?t[e]=a(n):t[e]=n,t}),Object.create(null))):r}e.extract=c,e.parse=u,e.stringify=function(t,e){!1===(e=i({encode:!0,strict:!0,arrayFormat:"none"},e)).sort&&(e.sort=function(){});var n=function(t){switch(t.arrayFormat){case"index":return function(e,n,r){return null===n?[s(e,t),"[",r,"]"].join(""):[s(e,t),"[",s(r,t),"]=",s(n,t)].join("")};case"bracket":return function(e,n){return null===n?s(e,t):[s(e,t),"[]=",s(n,t)].join("")};default:return function(e,n){return null===n?s(e,t):[s(e,t),"=",s(n,t)].join("")}}}(e);return t?Object.keys(t).sort(e.sort).map((function(r){var i=t[r];if(void 0===i)return"";if(null===i)return s(r,e);if(Array.isArray(i)){var o=[];return i.slice().forEach((function(t){void 0!==t&&o.push(n(r,t,o.length))})),o.join("&")}return s(r,e)+"="+s(i,e)})).filter((function(t){return t.length>0})).join("&"):""},e.parseUrl=function(t,e){return{url:t.split("?")[0]||"",query:u(c(t),e)}}},2885:(t,e,n)=>{"use strict";e.__esModule=!0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.default=function(t){"object"===("undefined"==typeof window?"undefined":i(window))&&"object"===i(window.onerror)?window.onerror=function(e,n,r,i,s){var a={type:o,message:e,url:n,lineNo:r,columnNo:i};return s&&s.stack&&(a.stack=s.stack),t(a),!1}:void 0!==n.g&&n.g.ErrorUtils&&n.g.ErrorUtils.setGlobalHandler((function(e,n){t({type:o,error:e,isFatal:n})}));"object"!==("undefined"==typeof console?"undefined":i(console))||"function"!=typeof console.error||console.beforeRemotedev||(console.beforeRemotedev=console.error.bind(console),console.error=function(){var e={type:o},n=arguments[0];e.message=n.message?n.message:n,n.sourceURL&&(e=r({},e,{sourceURL:n.sourceURL,line:n.line,column:n.column})),n.stack&&(e.stack=n.stack),t(e),console.beforeRemotedev.apply(null,arguments)})};var o="@@remotedev/ERROR"},1601:(t,e,n)=>{"use strict";e.__esModule=!0,e.FilterState=void 0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};e.arrToRegex=function(t){return"string"==typeof t?t:t.join("|")},e.getLocalFilter=function(t){if(t.actionsBlacklist||t.actionsWhitelist)return{whitelist:t.actionsWhitelist&&t.actionsWhitelist.join("|"),blacklist:t.actionsBlacklist&&t.actionsBlacklist.join("|")};return},e.isFiltered=h,e.filterStagedActions=function(t,e){if(!e)return t;var n=[],i=[];return t.stagedActionIds.forEach((function(r,o){h(t.actionsById[r],e)||(n.push(r),i.push(t.computedStates[o]))})),r({},t,{stagedActionIds:n,computedStates:i})},e.filterState=function(t,e,n,i,o,s,d){if("ACTION"===e)return i?i(t,s-1):t;if("STATE"!==e)return t;var p=l().filter;if(d||n||p&&p!==a.DO_NOT_FILTER){var f=[],_=[],g=o&&{},v=t.actionsById,m=t.computedStates;return t.stagedActionIds.forEach((function(t,e){var s=v[t],a=s.action,c=m[e],u=c.state;if(e){if(d&&!d(u,a))return;if(h(a,n))return}f.push(t),_.push(i?r({},c,{state:i(u,e)}):c),o&&(g[t]=r({},s,{action:o(a,t)}))})),r({},t,{actionsById:g||v,stagedActionIds:f,computedStates:_})}return i||o?r({},t,{actionsById:c(t.actionsById,o),computedStates:u(t.computedStates,i)}):t};var i,o=n(6604),s=(i=o)&&i.__esModule?i:{default:i};var a=e.FilterState={DO_NOT_FILTER:"DO_NOT_FILTER",BLACKLIST_SPECIFIC:"BLACKLIST_SPECIFIC",WHITELIST_SPECIFIC:"WHITELIST_SPECIFIC"};function c(t,e){return e?(0,s.default)(t,(function(t,n){return r({},t,{action:e(t.action,n)})})):t}function u(t,e){return e?t.map((function(t,n){return r({},t,{state:e(t.state,n)})})):t}function l(){return"undefined"!=typeof window&&window.devToolsOptions||{}}function h(t,e){var n=(t.action||t).type,r=l();if(!e&&r.filter&&r.filter===a.DO_NOT_FILTER||n&&"function"!=typeof n.match)return!1;var i=e||r,o=i.whitelist,s=i.blacklist;return o&&!n.match(o)||s&&n.match(s)}},704:(t,e,n)=>{"use strict";e.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.generateId=function(t){return t||(0,s.default)(7)},e.getMethods=function(t){if("object"!==(void 0===t?"undefined":r(t)))return;var e=void 0,n=void 0;t.__proto__&&(n=t.__proto__.__proto__);n||(n=t);return Object.getOwnPropertyNames(n).forEach((function(t){var r=Object.getOwnPropertyDescriptor(n,t);if(r&&!("get"in r)&&!("set"in r)){var o=n[t];"function"==typeof o&&"constructor"!==t&&(e||(e=[]),e.push({name:t||o.name||"anonymous",args:(0,i.default)(o)}))}})),e},e.getActionsArray=function(t){return Array.isArray(t)?t:u(t)},e.evalAction=function(t,e){if("string"==typeof t)return new Function("return "+t)();var n=e[t.selected].func,r=h(t.args,t.rest);return n.apply(void 0,r)},e.evalMethod=function(t,e){if("string"==typeof t)return new Function("return "+t).call(e);var n=h(t.args,t.rest);return new Function("args","return this."+t.name+"(args)").apply(e,n)},e.stringify=function(t,e){if(void 0===e)return function(t){try{return JSON.stringify(t)}catch(e){return o.default.stringify(t,null,null,{circular:"[CIRCULAR]"})}}(t);if(!0===e)return o.default.stringify(t,(function(t,e){return e&&"function"==typeof e.toJS?e.toJS():e}),null,!0);return o.default.stringify(t,e.replacer,null,e.options)},e.getSeralizeParameter=function(t,e){var n=t.serialize;if(n)return!0===n?{options:!0}:n.immutable?{replacer:(0,a.default)(n.immutable,n.refs).replacer,options:n.options||!0}:n.replacer?{replacer:n.replacer,options:n.options||!0}:{options:n.options};var r=t[e];return void 0===r?void 0:(console.warn("`"+e+"` parameter for Redux DevTools Extension is deprecated. Use `serialize` parameter instead: https://github.com/zalmoxisus/redux-devtools-extension/releases/tag/v2.12.1"),"boolean"==typeof serializeState?{options:r}:"function"==typeof serializeState?{replacer:r}:r)},e.getStackTrace=function(t,e){if(!t.trace)return;if("function"==typeof t.trace)return t.trace();var n=void 0,r=0,i=void 0,o=t.traceLimit,s=Error();Error.captureStackTrace?(Error.stackTraceLimit<o&&(i=Error.stackTraceLimit,Error.stackTraceLimit=o),Error.captureStackTrace(s,e)):r=3;n=s.stack,i&&(Error.stackTraceLimit=i);if(r||"number"!=typeof Error.stackTraceLimit||Error.stackTraceLimit>o){var a=n.split("\n");a.length>o&&(n=a.slice(0,o+r+("Error"===a[0]?1:0)).join("\n"))}return n};var i=c(n(6358)),o=c(n(5151)),s=c(n(4680)),a=c(n(5301));function c(t){return t&&t.__esModule?t:{default:t}}function u(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=[];return Object.keys(t).forEach((function(o){var s=t[o];"function"==typeof s?n.push({name:e+(o||s.name||"anonymous"),func:s,args:(0,i.default)(s)}):"object"===(void 0===s?"undefined":r(s))&&(n=n.concat(u(s,e+o+".")))})),n}var l=function(t){return new Function("return "+t)()};function h(t,e){var n=t.map(l);if(!e)return n;var r=l(e);if(Array.isArray(r))return n.concat.apply(n,r);throw new Error("rest must be an array")}},4680:t=>{for(var e="-_",n=36;n--;)e+=n.toString(36);for(n=36;n---10;)e+=n.toString(36).toUpperCase();t.exports=function(t){var r="";for(n=t||21;n--;)r+=e[64*Math.random()|0];return r}},6399:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.liftAction=I,e.liftReducerWith=b,e.unliftState=S,e.unliftStore=T,e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return null},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("number"==typeof e.maxAge&&e.maxAge<2)throw new Error("DevTools.instrument({ maxAge }) option, if specified, may not be less than 2.");return function(n){return function(r,i){function o(n){if("function"!=typeof n){if(n&&"function"==typeof n.default)throw new Error('Expected the reducer to be a function. Instead got an object with a "default" field. Did you pass a module instead of the default export? Try passing require(...).default instead.');throw new Error("Expected the reducer to be a function.")}return b(n,i,t,e)}var s=n(o(r));if(s.liftedStore)throw new Error("DevTools instrumentation should not be applied more than once. Check your store configuration.");return T(s,o,e)}}},e.INIT_ACTION=e.ActionCreators=e.ActionTypes=void 0;var r=a(n(1966)),i=a(n(3386)),o=a(n(8630)),s=a(n(1771));function a(t){return t&&t.__esModule?t:{default:t}}function c(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){d(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}var f={PERFORM_ACTION:"PERFORM_ACTION",RESET:"RESET",ROLLBACK:"ROLLBACK",COMMIT:"COMMIT",SWEEP:"SWEEP",TOGGLE_ACTION:"TOGGLE_ACTION",SET_ACTIONS_ACTIVE:"SET_ACTIONS_ACTIVE",JUMP_TO_STATE:"JUMP_TO_STATE",JUMP_TO_ACTION:"JUMP_TO_ACTION",REORDER_ACTION:"REORDER_ACTION",IMPORT_STATE:"IMPORT_STATE",LOCK_CHANGES:"LOCK_CHANGES",PAUSE_RECORDING:"PAUSE_RECORDING"};e.ActionTypes=f;var _="object"===("undefined"==typeof window?"undefined":p(window))&&(void 0!==window.chrome||void 0!==window.process&&"renderer"===window.process.type),g=_||"undefined"!=typeof process&&process.release&&"node"===process.release.name,v={performAction:function(t,e,n,r){if(!(0,o.default)(t))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===t.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');var i;if(e){var s=0;if("function"==typeof e)i=e(t);else{var a,c=Error();if(Error.captureStackTrace&&g?(n&&Error.stackTraceLimit<n&&(a=Error.stackTraceLimit,Error.stackTraceLimit=n),Error.captureStackTrace(c,r)):s=3,i=c.stack,a&&(Error.stackTraceLimit=a),(s||"number"!=typeof Error.stackTraceLimit||n&&Error.stackTraceLimit>n)&&null!=i){var u=i.split("\n");n&&u.length>n&&(i=u.slice(0,n+s+(u[0].startsWith("Error")?1:0)).join("\n"))}}}return{type:f.PERFORM_ACTION,action:t,timestamp:Date.now(),stack:i}},reset:function(){return{type:f.RESET,timestamp:Date.now()}},rollback:function(){return{type:f.ROLLBACK,timestamp:Date.now()}},commit:function(){return{type:f.COMMIT,timestamp:Date.now()}},sweep:function(){return{type:f.SWEEP}},toggleAction:function(t){return{type:f.TOGGLE_ACTION,id:t}},setActionsActive:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return{type:f.SET_ACTIONS_ACTIVE,start:t,end:e,active:n}},reorderAction:function(t,e){return{type:f.REORDER_ACTION,actionId:t,beforeActionId:e}},jumpToState:function(t){return{type:f.JUMP_TO_STATE,index:t}},jumpToAction:function(t){return{type:f.JUMP_TO_ACTION,actionId:t}},importState:function(t,e){return{type:f.IMPORT_STATE,nextLiftedState:t,noRecompute:e}},lockChanges:function(t){return{type:f.LOCK_CHANGES,status:t}},pauseRecording:function(t){return{type:f.PAUSE_RECORDING,status:t}}};e.ActionCreators=v;var m={type:"@@INIT"};function y(t,e,n,r){return r?function(t,e,n){var r,i=n;try{i=t(n,e)}catch(t){r=t.toString(),_?setTimeout((function(){throw t})):console.error(t)}return{state:i,error:r}}(t,e,n):{state:t(n,e)}}function E(t,e,n,r,i,o,s,a){if(!t||-1===e||e>=t.length&&t.length===o.length)return t;for(var c=t.slice(0,e),u=e;u<o.length;u++){var l=o[u],h=i[l].action,d=c[u-1],p=d?d.state:r,f=void 0;f=s.indexOf(l)>-1?d:a&&d&&d.error?{state:p,error:"Interrupted by an error up the chain"}:y(n,h,p,a),c.push(f)}return c}function I(t,e,n,r){return v.performAction(t,e,n,r)}function b(t,e,n,o){var s={monitorState:n(void 0,{}),nextActionId:1,actionsById:{0:I(m)},stagedActionIds:[0],skippedActionIds:[],committedState:e,currentStateIndex:0,computedStates:[],isLocked:!0===o.shouldStartLocked,isPaused:!1===o.shouldRecordChanges};return function(a,u){var l=a||s,p=l.monitorState,_=l.actionsById,g=l.nextActionId,v=l.stagedActionIds,b=l.skippedActionIds,S=l.committedState,T=l.currentStateIndex,w=l.computedStates,O=l.isLocked,C=l.isPaused;function A(t){for(var e=t,n=v.slice(1,e+1),r=0;r<n.length;r++){if(w[r+1].error){e=r,n=v.slice(1,e+1);break}delete _[n[r]]}b=b.filter((function(t){return-1===n.indexOf(t)})),v=[0].concat(c(v.slice(e+1))),S=w[e].state,w=w.slice(e),T=T>e?T-e:0}function R(e){var r;return e?(r=w[T],p=n(p,u)):r=y(t,u.action,w[T].state,!1),o.pauseActionType&&1!==g?(e&&(T===v.length-1&&T++,v=[].concat(c(v),[g]),g++),{monitorState:p,actionsById:h(h({},_),{},d({},g-1,I({type:o.pauseActionType}))),nextActionId:g,stagedActionIds:v,skippedActionIds:b,committedState:S,currentStateIndex:T,computedStates:[].concat(c(w.slice(0,v.length-1)),[r]),isLocked:O,isPaused:!0}):{monitorState:p,actionsById:{0:I(m)},nextActionId:1,stagedActionIds:[0],skippedActionIds:[],committedState:r.state,currentStateIndex:0,computedStates:[r],isLocked:O,isPaused:!0}}a||(_=h({},_));var k,D=0,N=o.maxAge;if("function"==typeof N&&(N=N(u,a)),/^@@redux\/(INIT|REPLACE)/.test(u.type))!1===o.shouldHotReload&&(_={0:I(m)},g=1,v=[0],b=[],S=0===w.length?e:w[T].state,T=0,w=[]),D=0,N&&v.length>N&&(w=E(w,D,t,S,_,v,b,o.shouldCatchErrors),A(v.length-N),D=1/0);else switch(u.type){case f.PERFORM_ACTION:if(O)return a||s;if(C)return R();N&&v.length>=N&&A(v.length-N+1),T===v.length-1&&T++;var P=g++;_[P]=u,D=(v=[].concat(c(v),[P])).length-1;break;case f.RESET:_={0:I(m)},g=1,v=[0],b=[],S=e,T=0,w=[];break;case f.COMMIT:_={0:I(m)},g=1,v=[0],b=[],S=w[T].state,T=0,w=[];break;case f.ROLLBACK:_={0:I(m)},g=1,v=[0],b=[],T=0,w=[];break;case f.TOGGLE_ACTION:var L=u.id,x=b.indexOf(L);b=-1===x?[L].concat(c(b)):b.filter((function(t){return t!==L})),D=v.indexOf(L);break;case f.SET_ACTIONS_ACTIVE:for(var U=u.start,F=u.end,M=u.active,H=[],j=U;j<F;j++)H.push(j);b=M?(0,r.default)(b,H):(0,i.default)(b,H),D=v.indexOf(U);break;case f.JUMP_TO_STATE:T=u.index,D=1/0;break;case f.JUMP_TO_ACTION:var B=v.indexOf(u.actionId);-1!==B&&(T=B),D=1/0;break;case f.SWEEP:v=(0,r.default)(v,b),b=[],T=Math.min(T,v.length-1);break;case f.REORDER_ACTION:var G=u.actionId,W=v.indexOf(G);if(W<1)break;var z=u.beforeActionId,V=v.indexOf(z);if(V<1){var q=v.length;V=z>v[q-1]?q:1}var $=W-V;$>0?(v=[].concat(c(v.slice(0,V)),[G],c(v.slice(V,W)),c(v.slice(W+1))),D=V):$<0&&(v=[].concat(c(v.slice(0,W)),c(v.slice(W+1,V)),[G],c(v.slice(V))),D=W);break;case f.IMPORT_STATE:if(k=u.nextLiftedState,Array.isArray(k))_={0:I(m)},g=1,v=[0],b=[],T=u.nextLiftedState.length,w=[],S=u.preloadedState,D=0,u.nextLiftedState.forEach((function(t){_[g]=I(t,o.trace||o.shouldIncludeCallstack),v.push(g),g++}));else{var Y=u.nextLiftedState;p=Y.monitorState,_=Y.actionsById,g=Y.nextActionId,v=Y.stagedActionIds,b=Y.skippedActionIds,S=Y.committedState,T=Y.currentStateIndex,w=Y.computedStates,u.noRecompute&&(D=1/0)}break;case f.LOCK_CHANGES:O=u.status,D=1/0;break;case f.PAUSE_RECORDING:if(C=u.status)return R(!0);_={0:I(m)},g=1,v=[0],b=[],S=w[T].state,T=0,w=[];break;default:D=1/0}return w=E(w,D,t,S,_,v,b,o.shouldCatchErrors),{monitorState:p=n(p,u),actionsById:_,nextActionId:g,stagedActionIds:v,skippedActionIds:b,committedState:S,currentStateIndex:T,computedStates:w,isLocked:O,isPaused:C}}}function S(t){return t.computedStates[t.currentStateIndex].state}function T(t,e,n){var r,i=n.trace||n.shouldIncludeCallstack,o=n.traceLimit||10;function a(){var e=S(t.getState());return void 0!==e&&(r=e),r}return h(h({},t),{},d({liftedStore:t,dispatch:function e(n){return t.dispatch(I(n,i,o,e)),n},getState:a,replaceReducer:function(n){t.replaceReducer(e(n))}},s.default,(function(){return h(h({},t[s.default]()),{},d({subscribe:function(e){if("object"!==p(e))throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(a())}return n(),{unsubscribe:t.subscribe(n)}}},s.default,(function(){return this})))})))}e.INIT_ACTION=m},1771:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r}),t=n.hmd(t);const r=function(t){var e,n=t.Symbol;return"function"==typeof n?n.observable?e=n.observable:(e=n("observable"),n.observable=e):e="@@observable",e}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:t)},3894:(t,e,n)=>{"use strict";function r(t){return function(e){var n=e.dispatch,r=e.getState;return function(e){return function(i){return"function"==typeof i?i(n,r,t):e(i)}}}}n.d(e,{Z:()=>o});var i=r();i.withExtraArgument=r;const o=i},4791:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t){var e=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===r(e)?e:String(e)}function o(t,e,n){return(e=i(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}n.d(e,{md:()=>g,UY:()=>f,MT:()=>p});var u="function"==typeof Symbol&&Symbol.observable||"@@observable",l=function(){return Math.random().toString(36).substring(7).split("").join(".")},h={INIT:"@@redux/INIT"+l(),REPLACE:"@@redux/REPLACE"+l(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+l()}};function d(t){if("object"!=typeof t||null===t)return!1;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function p(t,e,n){var r;if("function"==typeof e&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(c(0));if("function"==typeof e&&void 0===n&&(n=e,e=void 0),void 0!==n){if("function"!=typeof n)throw new Error(c(1));return n(p)(t,e)}if("function"!=typeof t)throw new Error(c(2));var i=t,o=e,s=[],a=s,l=!1;function f(){a===s&&(a=s.slice())}function _(){if(l)throw new Error(c(3));return o}function g(t){if("function"!=typeof t)throw new Error(c(4));if(l)throw new Error(c(5));var e=!0;return f(),a.push(t),function(){if(e){if(l)throw new Error(c(6));e=!1,f();var n=a.indexOf(t);a.splice(n,1),s=null}}}function v(t){if(!d(t))throw new Error(c(7));if(void 0===t.type)throw new Error(c(8));if(l)throw new Error(c(9));try{l=!0,o=i(o,t)}finally{l=!1}for(var e=s=a,n=0;n<e.length;n++){(0,e[n])()}return t}return v({type:h.INIT}),(r={dispatch:v,subscribe:g,getState:_,replaceReducer:function(t){if("function"!=typeof t)throw new Error(c(10));i=t,v({type:h.REPLACE})}})[u]=function(){var t,e=g;return(t={subscribe:function(t){if("object"!=typeof t||null===t)throw new Error(c(11));function n(){t.next&&t.next(_())}return n(),{unsubscribe:e(n)}}})[u]=function(){return this},t},r}function f(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++){var i=e[r];0,"function"==typeof t[i]&&(n[i]=t[i])}var o,s=Object.keys(n);try{!function(t){Object.keys(t).forEach((function(e){var n=t[e];if(void 0===n(void 0,{type:h.INIT}))throw new Error(c(12));if(void 0===n(void 0,{type:h.PROBE_UNKNOWN_ACTION()}))throw new Error(c(13))}))}(n)}catch(t){o=t}return function(t,e){if(void 0===t&&(t={}),o)throw o;for(var r=!1,i={},a=0;a<s.length;a++){var u=s[a],l=n[u],h=t[u],d=l(h,e);if(void 0===d){e&&e.type;throw new Error(c(14))}i[u]=d,r=r||d!==h}return(r=r||s.length!==Object.keys(t).length)?i:t}}function _(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return 0===e.length?function(t){return t}:1===e.length?e[0]:e.reduce((function(t,e){return function(){return t(e.apply(void 0,arguments))}}))}function g(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return function(){var n=t.apply(void 0,arguments),r=function(){throw new Error(c(15))},i={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},o=e.map((function(t){return t(i)}));return r=_.apply(void 0,o)(n.dispatch),a(a({},n),{},{dispatch:r})}}}},9222:(t,e,n)=>{"use strict";e.__esModule=!0,e.default=function(t,e,n){return(0,o.default)(e,n)(t)};var r,i=n(6399),o=(r=i)&&r.__esModule?r:{default:r}},8429:(t,e)=>{"use strict";e.__esModule=!0;e.defaultSocketOptions={secure:!0,hostname:"remotedev.io",port:443,autoReconnect:!0,autoReconnectOptions:{randomness:3e4}}},8534:(t,e,n)=>{"use strict";e.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};e.default=K,e.preEnhancer=Q,e.composeWithDevTools=function(){if(0===arguments.length)return K();if(1===arguments.length&&"object"===r(arguments.length<=0?void 0:arguments[0]))return J(arguments.length<=0?void 0:arguments[0]);return J({}).apply(void 0,arguments)};var o=n(5151),s=p(n(1827)),a=p(n(9222)),c=n(8429),u=p(n(6954)),l=n(704),h=p(n(2885)),d=n(1601);function p(t){return t&&t.__esModule?t:{default:t}}var f=void 0,_=void 0,g=void 0,v={},m=void 0,y=void 0,E=void 0,I={},b=void 0,S=void 0,T=void 0,w=void 0,O=void 0,C=void 0,A=void 0,R=void 0,k=void 0,D=void 0,N=void 0,P=void 0,L=void 0,x=void 0,U=void 0,F=void 0;function M(){return(0,d.filterStagedActions)(I.liftedStore.getState(),S)}function H(){f||(f=y&&y.id||Math.random().toString(36).substr(2));try{fetch(D,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({type:"STATE",id:f,name:_,payload:(0,o.stringify)(M())})}).catch((function(t){console.log(t)}))}catch(t){console.log(t)}}function j(t,e,n,r){var i={type:t,id:y.id,name:_};e&&(i.payload="ERROR"===t?e:(0,o.stringify)((0,d.filterState)(e,t,S,U,F,r))),"ACTION"===t?(i.action=(0,o.stringify)(F?F(n.action,r-1):n),i.isExcess=T,i.nextActionId=r):n&&(i.action=n),y.emit(y.id?"log":"log-noid",i)}function B(t){"IMPORT"===t.type||"SYNC"===t.type&&y.id&&t.id!==y.id?I.liftedStore.dispatch({type:"IMPORT_STATE",nextLiftedState:(0,o.parse)(t.state)}):"UPDATE"===t.type?j("STATE",M()):"START"===t.type?(w=!0,"function"==typeof x&&(x=x()),j("STATE",M(),x)):"STOP"===t.type||"DISCONNECTED"===t.type?(w=!1,j("STOP")):"ACTION"===t.type?function(t){try{var e=(0,l.evalAction)(t,x);I.dispatch(e)}catch(t){j("ERROR",t.message)}}(t.action):"DISPATCH"===t.type&&I.liftedStore.dispatch(t.action)}function G(t){setTimeout(t,0)}function W(t){t.message&&t.message===N||(N=t.message,G((function(){I.dispatch(t),O||H()})))}function z(t){return"string"==typeof t?[t]:t&&t.length}function V(t){O=!1,w=!1,y&&(y.destroyChannel(E),t?y.off(E,B):(y.off(),y.disconnect()))}function q(){O||y&&y.getState()===y.CONNECTING||((y=s.default.connect(m)).on("error",(function(t){v[t.name]=v.hasOwnProperty(t.name)?v[t.name]+1:1,g?1===v[t.name]&&(console.log("remote-redux-devtools: Socket connection errors are being suppressed. \nThis can be disabled by setting suppressConnectErrors to 'false'."),console.log(t)):console.log(t)})),y.on("connect",(function(){console.log("connected to remotedev-server"),v={},y.emit("login","master",(function(t,e){t?console.log(t):(E=e,y.subscribe(e).watch(B),y.on(e,B))})),O=!0,j("START")})),y.on("disconnect",(function(){V(!0)})))}function $(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I.liftedStore.getState();return!!t.computedStates[t.currentStateIndex].error&&(O?j("STATE",(0,d.filterStagedActions)(t,S)):H(),!0)}function Y(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];return b=e.type,!O&&2===k&&I.liftedStore?G($):e.action&&(C&&!O&&-1!==C.indexOf(e.action.type)?G(q):A&&O&&-1!==A.indexOf(e.action.type)?G(V):R&&!O&&-1!==R.indexOf(e.action.type)&&G(H)),t}function K(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t){_=t.name;var e=t.filters||{},n=e.blacklist,r=e.whitelist;S=(0,d.getLocalFilter)({actionsBlacklist:n||t.actionsBlacklist,actionsWhitelist:r||t.actionsWhitelist}),m=t.port?{port:t.port,hostname:t.hostname||"localhost",secure:t.secure}:c.defaultSocketOptions,g=void 0===t.suppressConnectErrors||t.suppressConnectErrors,C=z(t.startOn),A=z(t.stopOn),R=z(t.sendOn),k=t.sendOnError,(R||k)&&(D=t.sendTo||(m.secure?"https":"http")+"://"+m.hostname+":"+m.port,f=t.id),1===k&&(0,h.default)(W),t.actionCreators&&(x=function(){return(0,l.getActionsArray)(t.actionCreators)}),U=t.stateSanitizer,F=t.actionSanitizer}(i({},t,{hostname:(0,u.default)(t.hostname||"localhost")}));var e=void 0!==t.realtime&&t.realtime;if(!e&&!(C||R||k))return function(t){return t};var n=t.maxAge||30;return function(r){return function(i,o){return I=(0,a.default)(r,Y,{maxAge:n,trace:t.trace,traceLimit:t.traceLimit,shouldCatchErrors:!!k,shouldHotReload:t.shouldHotReload,shouldRecordChanges:t.shouldRecordChanges,shouldStartLocked:t.shouldStartLocked,pauseActionType:t.pauseActionType||"@@PAUSED"})(i,o),e&&q(),I.subscribe((function(){w&&function(t,e,n){if(!$(e))if("PERFORM_ACTION"===b){var r=e.nextActionId,i=e.actionsById[r-1];if((0,d.isFiltered)(i.action,S))return;j("ACTION",t,i,r),!T&&n&&(T=e.stagedActionIds.length>=n)}else{if("JUMP_TO_STATE"===b)return;if("PAUSE_RECORDING"===b?L=e.isPaused:"LOCK_CHANGES"===b&&(P=e.isLocked),L||P){if(!b)return;b=void 0}j("STATE",(0,d.filterStagedActions)(e,S))}}(I.getState(),I.liftedStore.getState(),n)})),I}}}function Q(t){return function(e,n,r){return I=t(e,n,r),i({},I,{dispatch:function(t){return P?t:I.dispatch(t)}})}}K.updateStore=function(t){console.warn("devTools.updateStore is deprecated use composeWithDevTools instead: https://github.com/zalmoxisus/remote-redux-devtools#use-devtools-compose-helper"),I=t};var J=function(t){return function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(){return[Q].concat(n).reduceRight((function(t,e){return e(t)}),K(t).apply(void 0,arguments))}}}},1937:(t,e,n)=>{"use strict";var r,i=n(8534);((r=i)&&r.__esModule?r:{default:r}).default},5932:t=>{var e=function(){"use strict";function t(t,e){return null!=e&&t instanceof e}var e,n,r;try{e=Map}catch(t){e=function(){}}try{n=Set}catch(t){n=function(){}}try{r=Promise}catch(t){r=function(){}}function i(o,a,c,u,l){"object"==typeof a&&(c=a.depth,u=a.prototype,l=a.includeNonEnumerable,a=a.circular);var h=[],d=[],p="undefined"!=typeof Buffer;return void 0===a&&(a=!0),void 0===c&&(c=1/0),function o(c,f){if(null===c)return null;if(0===f)return c;var _,g;if("object"!=typeof c)return c;if(t(c,e))_=new e;else if(t(c,n))_=new n;else if(t(c,r))_=new r((function(t,e){c.then((function(e){t(o(e,f-1))}),(function(t){e(o(t,f-1))}))}));else if(i.__isArray(c))_=[];else if(i.__isRegExp(c))_=new RegExp(c.source,s(c)),c.lastIndex&&(_.lastIndex=c.lastIndex);else if(i.__isDate(c))_=new Date(c.getTime());else{if(p&&Buffer.isBuffer(c))return _=new Buffer(c.length),c.copy(_),_;t(c,Error)?_=Object.create(c):void 0===u?(g=Object.getPrototypeOf(c),_=Object.create(g)):(_=Object.create(u),g=u)}if(a){var v=h.indexOf(c);if(-1!=v)return d[v];h.push(c),d.push(_)}for(var m in t(c,e)&&c.forEach((function(t,e){var n=o(e,f-1),r=o(t,f-1);_.set(n,r)})),t(c,n)&&c.forEach((function(t){var e=o(t,f-1);_.add(e)})),c){var y;g&&(y=Object.getOwnPropertyDescriptor(g,m)),y&&null==y.set||(_[m]=o(c[m],f-1))}if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(c);for(m=0;m<E.length;m++){var I=E[m];(!(S=Object.getOwnPropertyDescriptor(c,I))||S.enumerable||l)&&(_[I]=o(c[I],f-1),S.enumerable||Object.defineProperty(_,I,{enumerable:!1}))}}if(l){var b=Object.getOwnPropertyNames(c);for(m=0;m<b.length;m++){var S,T=b[m];(S=Object.getOwnPropertyDescriptor(c,T))&&S.enumerable||(_[T]=o(c[T],f-1),Object.defineProperty(_,T,{enumerable:!1}))}}return _}(o,c)}function o(t){return Object.prototype.toString.call(t)}function s(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return i.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},i.__objToStr=o,i.__isDate=function(t){return"object"==typeof t&&"[object Date]"===o(t)},i.__isArray=function(t){return"object"==typeof t&&"[object Array]"===o(t)},i.__isRegExp=function(t){return"object"==typeof t&&"[object RegExp]"===o(t)},i.__getRegExpFlags=s,i}();t.exports&&(t.exports=e)},5454:t=>{"use strict";function e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,n,r,i){n=n||"&",r=r||"=";var o={};if("string"!=typeof t||0===t.length)return o;var s=/\+/g;t=t.split(n);var a=1e3;i&&"number"==typeof i.maxKeys&&(a=i.maxKeys);var c=t.length;a>0&&c>a&&(c=a);for(var u=0;u<c;++u){var l,h,d,p,f=t[u].replace(s,"%20"),_=f.indexOf(r);_>=0?(l=f.substr(0,_),h=f.substr(_+1)):(l=f,h=""),d=decodeURIComponent(l),p=decodeURIComponent(h),e(o,d)?Array.isArray(o[d])?o[d].push(p):o[d]=[o[d],p]:o[d]=p}return o}},7270:t=>{"use strict";var e=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,n,r,i){return n=n||"&",r=r||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map((function(i){var o=encodeURIComponent(e(i))+r;return Array.isArray(t[i])?t[i].map((function(t){return o+encodeURIComponent(e(t))})).join(n):o+encodeURIComponent(e(t[i]))})).join(n):i?encodeURIComponent(e(i))+r+encodeURIComponent(e(t)):""}},7865:(t,e,n)=>{"use strict";e.decode=e.parse=n(5454),e.encode=e.stringify=n(7270)},8645:t=>{t.exports=function(t){var e=[],n=[];return function t(r,i){var o,s,a;if(!("object"!=typeof r||null===r||r instanceof Boolean||r instanceof Date||r instanceof Number||r instanceof RegExp||r instanceof String)){for(o=0;o<e.length;o+=1)if(e[o]===r)return{$ref:n[o]};if(e.push(r),n.push(i),"[object Array]"===Object.prototype.toString.apply(r))for(a=[],o=0;o<r.length;o+=1)a[o]=t(r[o],i+"["+o+"]");else for(s in a={},r)Object.prototype.hasOwnProperty.call(r,s)&&(a[s]=t(r[s],i+"["+JSON.stringify(s)+"]"));return a}return r}(t,"$")}},3418:(t,e,n)=>{var r=n(8645),i=function(){return!this}();function o(t,e){this.name="AuthTokenExpiredError",this.message=t,this.expiry=e,Error.captureStackTrace&&!i?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function s(t){this.name="AuthTokenInvalidError",this.message=t,Error.captureStackTrace&&!i?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function a(t,e){this.name="AuthTokenNotBeforeError",this.message=t,this.date=e,Error.captureStackTrace&&!i?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function c(t){this.name="AuthTokenError",this.message=t,Error.captureStackTrace&&!i?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function u(t){this.name="AuthError",this.message=t,Error.captureStackTrace&&!i?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function l(t,e){this.name="SilentMiddlewareBlockedError",this.message=t,this.type=e,Error.captureStackTrace&&!i?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function h(t){this.name="InvalidActionError",this.message=t,Error.captureStackTrace&&!i?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function d(t){this.name="InvalidArgumentsError",this.message=t,Error.captureStackTrace&&!i?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function p(t){this.name="InvalidOptionsError",this.message=t,Error.captureStackTrace&&!i?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function f(t){this.name="InvalidMessageError",this.message=t,Error.captureStackTrace&&!i?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function _(t,e){this.name="SocketProtocolError",this.message=t,this.code=e,Error.captureStackTrace&&!i?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function g(t){this.name="ServerProtocolError",this.message=t,Error.captureStackTrace&&!i?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function v(t){this.name="HTTPServerError",this.message=t,Error.captureStackTrace&&!i?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function m(t){this.name="ResourceLimitError",this.message=t,Error.captureStackTrace&&!i?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function y(t){this.name="TimeoutError",this.message=t,Error.captureStackTrace&&!i?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function E(t,e){this.name="BadConnectionError",this.message=t,this.type=e,Error.captureStackTrace&&!i?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function I(t){this.name="BrokerError",this.message=t,Error.captureStackTrace&&!i?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function b(t,e){this.name="ProcessExitError",this.message=t,this.code=e,Error.captureStackTrace&&!i?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function S(t){this.name="UnknownError",this.message=t,Error.captureStackTrace&&!i?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}o.prototype=Object.create(Error.prototype),s.prototype=Object.create(Error.prototype),a.prototype=Object.create(Error.prototype),c.prototype=Object.create(Error.prototype),u.prototype=Object.create(Error.prototype),l.prototype=Object.create(Error.prototype),h.prototype=Object.create(Error.prototype),d.prototype=Object.create(Error.prototype),p.prototype=Object.create(Error.prototype),f.prototype=Object.create(Error.prototype),_.prototype=Object.create(Error.prototype),g.prototype=Object.create(Error.prototype),v.prototype=Object.create(Error.prototype),m.prototype=Object.create(Error.prototype),y.prototype=Object.create(Error.prototype),E.prototype=Object.create(Error.prototype),I.prototype=Object.create(Error.prototype),b.prototype=Object.create(Error.prototype),S.prototype=Object.create(Error.prototype),t.exports={AuthTokenExpiredError:o,AuthTokenInvalidError:s,AuthTokenNotBeforeError:a,AuthTokenError:c,AuthError:u,SilentMiddlewareBlockedError:l,InvalidActionError:h,InvalidArgumentsError:d,InvalidOptionsError:p,InvalidMessageError:f,SocketProtocolError:_,ServerProtocolError:g,HTTPServerError:v,ResourceLimitError:m,TimeoutError:y,BadConnectionError:E,BrokerError:I,ProcessExitError:b,UnknownError:S},t.exports.socketProtocolErrorStatuses={1001:"Socket was disconnected",1002:"A WebSocket protocol error was encountered",1003:"Server terminated socket because it received invalid data",1005:"Socket closed without status code",1006:"Socket hung up",1007:"Message format was incorrect",1008:"Encountered a policy violation",1009:"Message was too big to process",1010:"Client ended the connection because the server did not comply with extension requirements",1011:"Server encountered an unexpected fatal condition",4e3:"Server ping timed out",4001:"Client pong timed out",4002:"Server failed to sign auth token",4003:"Failed to complete handshake",4004:"Client failed to save auth token",4005:"Did not receive #handshake from client before timeout",4006:"Failed to bind socket to message broker",4007:"Client connection establishment timed out",4008:"Server rejected handshake from client",4009:"Server received a message before the client handshake"},t.exports.socketProtocolIgnoreStatuses={1e3:"Socket closed normally",1001:"Socket hung up"};var T={domain:1,domainEmitter:1,domainThrown:1};t.exports.dehydrateError=function(t,e){var n;if(t&&"object"==typeof t)for(var i in n={message:t.message},e&&(n.stack=t.stack),t)T[i]||(n[i]=t[i]);else n="function"==typeof t?"[function "+(t.name||"anonymous")+"]":t;return r(n)},t.exports.hydrateError=function(t){var e=null;if(null!=t)if("object"==typeof t)for(var n in e=new Error(t.message),t)t.hasOwnProperty(n)&&(e[n]=t[n]);else e=t;return e},t.exports.decycle=r},1827:(t,e,n)=>{var r=n(6859),i=n(8422);t.exports.factory=i,t.exports.SCClientSocket=r,t.exports.Emitter=n(8767),t.exports.create=function(t){return i.create(t)},t.exports.connect=t.exports.create,t.exports.destroy=function(t){return i.destroy(t)},t.exports.clients=i.clients,t.exports.version="14.3.1"},7407:(t,e,n)=>{var r=function(){this._internalStorage={},this.isLocalStorageEnabled=this._checkLocalStorageEnabled()};r.prototype._checkLocalStorageEnabled=function(){var t;try{n.g.localStorage,n.g.localStorage.setItem("__scLocalStorageTest",1),n.g.localStorage.removeItem("__scLocalStorageTest")}catch(e){t=e}return!t},r.prototype.saveToken=function(t,e,r,i){this.isLocalStorageEnabled&&n.g.localStorage?n.g.localStorage.setItem(t,e):this._internalStorage[t]=e,i&&i(null,e)},r.prototype.removeToken=function(t,e){var r;this.loadToken(t,(function(t,e){r=e})),this.isLocalStorageEnabled&&n.g.localStorage?n.g.localStorage.removeItem(t):delete this._internalStorage[t],e&&e(null,r)},r.prototype.loadToken=function(t,e){e(null,this.isLocalStorageEnabled&&n.g.localStorage?n.g.localStorage.getItem(t):this._internalStorage[t]||null)},t.exports.K=r},8422:(t,e,n)=>{var r=n(6859),i=n(3418),o=n(1475),s=i.InvalidArgumentsError,a={};function c(t,e){var r=null==t.secure?e:t.secure;return t.port||(n.g.location&&location.port?location.port:r?443:80)}t.exports={create:function(t){if((t=t||{}).host&&!t.host.match(/[^:]+:\d{2,5}/))throw new s('The host option should include both the hostname and the port number in the format "hostname:port"');if(t.host&&t.hostname)throw new s('The host option should already include the hostname and the port number in the format "hostname:port" - Because of this, you should never use host and hostname options together');if(t.host&&t.port)throw new s('The host option should already include the hostname and the port number in the format "hostname:port" - Because of this, you should never use host and port options together');var e=n.g.location&&"https:"===location.protocol,i={port:c(t,e),hostname:n.g.location&&location.hostname||"localhost",path:"/socketcluster/",secure:e,autoConnect:!0,autoReconnect:!0,autoSubscribeOnConnect:!0,connectTimeout:2e4,ackTimeout:1e4,timestampRequests:!1,timestampParam:"t",authEngine:null,authTokenName:"socketCluster.authToken",binaryType:"arraybuffer",multiplex:!0,pubSubBatchDuration:null,cloneData:!1};for(var u in t)t.hasOwnProperty(u)&&(i[u]=t[u]);if(i.clientMap=a,!1===i.multiplex){i.clientId=o.v4();var l=new r(i);return a[i.clientId]=l,l}return i.clientId=function(t){var e=t.secure?"https://":"http://",n="";if(t.query)if("string"==typeof t.query)n=t.query;else{var r=[],i=t.query;for(var o in i)i.hasOwnProperty(o)&&r.push(o+"="+i[o]);r.length&&(n="?"+r.join("&"))}return e+(t.host?t.host:t.hostname+":"+t.port)+t.path+n}(i),a[i.clientId]?i.autoConnect&&a[i.clientId].connect():a[i.clientId]=new r(i),a[i.clientId]},destroy:function(t){t.destroy()},clients:a}},4625:(t,e,n)=>{var r=n(3418),i=r.InvalidActionError,o=function(t,e){this.socket=t,this.id=e,this.sent=!1};o.prototype._respond=function(t){if(this.sent)throw new i("Response "+this.id+" has already been sent");this.sent=!0,this.socket.send(this.socket.encode(t))},o.prototype.end=function(t){if(this.id){var e={rid:this.id};void 0!==t&&(e.data=t),this._respond(e)}},o.prototype.error=function(t,e){if(this.id){var n=r.dehydrateError(t),i={rid:this.id,error:n};void 0!==e&&(i.data=e),this._respond(i)}},o.prototype.callback=function(t,e){t?this.error(t,e):this.end(e)},t.exports.H=o},6859:(t,e,n)=>{var r=n(8767),i=n(7010).X,o=(n(4625).H,n(7407).K),s=n(5556),a=n(6622).U,c=n(7865),u=n(3357),l=n(8764).lW,h=n(5932),d=n(3418),p=d.InvalidArgumentsError,f=d.InvalidMessageError,_=d.InvalidActionError,g=d.SocketProtocolError,v=d.TimeoutError,m=d.BadConnectionError,y="undefined"!=typeof window,E=function(t){var e=this;r.call(this),this.id=null,this.state=this.CLOSED,this.authState=this.UNAUTHENTICATED,this.signedAuthToken=null,this.authToken=null,this.pendingReconnect=!1,this.pendingReconnectTimeout=null,this.preparingPendingSubscriptions=!1,this.clientId=t.clientId,this.connectTimeout=t.connectTimeout,this.ackTimeout=t.ackTimeout,this.channelPrefix=t.channelPrefix||null,this.disconnectOnUnload=null==t.disconnectOnUnload||t.disconnectOnUnload,this.authTokenName=t.authTokenName,this.pingTimeout=this.ackTimeout,this.pingTimeoutDisabled=!!t.pingTimeoutDisabled,this.active=!0,this._clientMap=t.clientMap||{};var i=Math.pow(2,31)-1,a=function(t){if(e[t]>i)throw new p("The "+t+" value provided exceeded the maximum amount allowed")};if(a("connectTimeout"),a("ackTimeout"),this._localEvents={connect:1,connectAbort:1,close:1,disconnect:1,message:1,error:1,raw:1,kickOut:1,subscribe:1,unsubscribe:1,subscribeStateChange:1,authStateChange:1,authenticate:1,deauthenticate:1,removeAuthToken:1,subscribeRequest:1},this.connectAttempts=0,this._emitBuffer=new u,this.channels={},this.options=t,this._cid=1,this.options.callIdGenerator=function(){return e._cid++},this.options.autoReconnect){null==this.options.autoReconnectOptions&&(this.options.autoReconnectOptions={});var l=this.options.autoReconnectOptions;null==l.initialDelay&&(l.initialDelay=1e4),null==l.randomness&&(l.randomness=1e4),null==l.multiplier&&(l.multiplier=1.5),null==l.maxDelay&&(l.maxDelay=6e4)}if(null==this.options.subscriptionRetryOptions&&(this.options.subscriptionRetryOptions={}),this.options.authEngine?this.auth=this.options.authEngine:this.auth=new o,this.options.codecEngine?this.codec=this.options.codecEngine:this.codec=s,this.options.protocol){var h=new p('The "protocol" option does not affect socketcluster-client. If you want to utilize SSL/TLS - use "secure" option instead');this._onSCError(h)}this.options.path=this.options.path.replace(/\/$/,"")+"/",this.options.query=t.query||{},"string"==typeof this.options.query&&(this.options.query=c.parse(this.options.query)),this._channelEmitter=new r,this._unloadHandler=function(){e.disconnect()},y&&this.disconnectOnUnload&&n.g.addEventListener&&n.g.addEventListener("beforeunload",this._unloadHandler,!1),this._clientMap[this.clientId]=this,this.options.autoConnect&&this.connect()};E.prototype=Object.create(r.prototype),E.CONNECTING=E.prototype.CONNECTING=a.prototype.CONNECTING,E.OPEN=E.prototype.OPEN=a.prototype.OPEN,E.CLOSED=E.prototype.CLOSED=a.prototype.CLOSED,E.AUTHENTICATED=E.prototype.AUTHENTICATED="authenticated",E.UNAUTHENTICATED=E.prototype.UNAUTHENTICATED="unauthenticated",E.PENDING=E.prototype.PENDING="pending",E.ignoreStatuses=d.socketProtocolIgnoreStatuses,E.errorStatuses=d.socketProtocolErrorStatuses,E.prototype._privateEventHandlerMap={"#publish":function(t){var e=this._undecorateChannelName(t.channel);this.isSubscribed(e,!0)&&this._channelEmitter.emit(e,t.data)},"#kickOut":function(t){var e=this._undecorateChannelName(t.channel),n=this.channels[e];n&&(r.prototype.emit.call(this,"kickOut",t.message,e),n.emit("kickOut",t.message,e),this._triggerChannelUnsubscribe(n))},"#setAuthToken":function(t,e){var n=this;if(t){this.auth.saveToken(this.authTokenName,t.token,{},(function(r){r?(e.error(r),n._onSCError(r)):(n._changeToAuthenticatedState(t.token),e.end())}))}else e.error(new f("No token data provided by #setAuthToken event"))},"#removeAuthToken":function(t,e){var n=this;this.auth.removeToken(this.authTokenName,(function(t,i){t?(e.error(t),n._onSCError(t)):(r.prototype.emit.call(n,"removeAuthToken",i),n._changeToUnauthenticatedStateAndClearTokens(),e.end())}))},"#disconnect":function(t){this.transport.close(t.code,t.data)}},E.prototype.getState=function(){return this.state},E.prototype.getBytesReceived=function(){return this.transport.getBytesReceived()},E.prototype.deauthenticate=function(t){var e=this;this.auth.removeToken(this.authTokenName,(function(n,i){n?e._onSCError(n):(r.prototype.emit.call(e,"removeAuthToken",i),e.state!==e.CLOSED&&e.emit("#removeAuthToken"),e._changeToUnauthenticatedStateAndClearTokens()),t&&t(n)}))},E.prototype.connect=E.prototype.open=function(){var t=this;if(this.active)this.state===this.CLOSED&&(this.pendingReconnect=!1,this.pendingReconnectTimeout=null,clearTimeout(this._reconnectTimeoutRef),this.state=this.CONNECTING,r.prototype.emit.call(this,"connecting"),this.transport&&this.transport.off(),this.transport=new a(this.auth,this.codec,this.options),this.transport.on("open",(function(e){t.state=t.OPEN,t._onSCOpen(e)})),this.transport.on("error",(function(e){t._onSCError(e)})),this.transport.on("close",(function(e,n){t.state=t.CLOSED,t._onSCClose(e,n)})),this.transport.on("openAbort",(function(e,n){t.state=t.CLOSED,t._onSCClose(e,n,!0)})),this.transport.on("event",(function(e,n,r){t._onSCEvent(e,n,r)})));else{var e=new _("Cannot connect a destroyed client");this._onSCError(e)}},E.prototype.reconnect=function(t,e){this.disconnect(t,e),this.connect()},E.prototype.disconnect=function(t,e){if("number"!=typeof(t=t||1e3))throw new p("If specified, the code argument must be a number");this.state===this.OPEN||this.state===this.CONNECTING?this.transport.close(t,e):(this.pendingReconnect=!1,this.pendingReconnectTimeout=null,clearTimeout(this._reconnectTimeoutRef))},E.prototype.destroy=function(t,e){y&&n.g.removeEventListener&&n.g.removeEventListener("beforeunload",this._unloadHandler,!1),this.active=!1,this.disconnect(t,e),delete this._clientMap[this.clientId]},E.prototype._changeToUnauthenticatedStateAndClearTokens=function(){if(this.authState!==this.UNAUTHENTICATED){var t=this.authState,e=this.signedAuthToken;this.authState=this.UNAUTHENTICATED,this.signedAuthToken=null,this.authToken=null;var n={oldState:t,newState:this.authState};r.prototype.emit.call(this,"authStateChange",n),r.prototype.emit.call(this,"deauthenticate",e)}},E.prototype._changeToAuthenticatedState=function(t){if(this.signedAuthToken=t,this.authToken=this._extractAuthTokenData(t),this.authState!==this.AUTHENTICATED){var e=this.authState;this.authState=this.AUTHENTICATED;var n={oldState:e,newState:this.authState,signedAuthToken:t,authToken:this.authToken};this.preparingPendingSubscriptions||this.processPendingSubscriptions(),r.prototype.emit.call(this,"authStateChange",n)}r.prototype.emit.call(this,"authenticate",t)},E.prototype.decodeBase64=function(t){return l.from(t,"base64").toString("utf8")},E.prototype.encodeBase64=function(t){return l.from(t,"utf8").toString("base64")},E.prototype._extractAuthTokenData=function(t){var e=(t||"").split(".")[1];if(null!=e){var n=e;try{return n=this.decodeBase64(n),JSON.parse(n)}catch(t){return n}}return null},E.prototype.getAuthToken=function(){return this.authToken},E.prototype.getSignedAuthToken=function(){return this.signedAuthToken},E.prototype.authenticate=function(t,e){var n=this;this.emit("#authenticate",t,(function(r,i){i&&null!=i.isAuthenticated?i.authError&&(i.authError=d.hydrateError(i.authError)):i={isAuthenticated:n.authState,authError:null},r?("BadConnectionError"!==r.name&&"TimeoutError"!==r.name&&n._changeToUnauthenticatedStateAndClearTokens(),e&&e(r,i)):n.auth.saveToken(n.authTokenName,t,{},(function(r){r&&n._onSCError(r),i.isAuthenticated?n._changeToAuthenticatedState(t):n._changeToUnauthenticatedStateAndClearTokens(),e&&e(r,i)}))}))},E.prototype._tryReconnect=function(t){var e,n=this,r=this.connectAttempts++,i=this.options.autoReconnectOptions;if(null==t||r>0){var o=Math.round(i.initialDelay+(i.randomness||0)*Math.random());e=Math.round(o*Math.pow(i.multiplier,r))}else e=t;e>i.maxDelay&&(e=i.maxDelay),clearTimeout(this._reconnectTimeoutRef),this.pendingReconnect=!0,this.pendingReconnectTimeout=e,this._reconnectTimeoutRef=setTimeout((function(){n.connect()}),e)},E.prototype._onSCOpen=function(t){var e=this;this.preparingPendingSubscriptions=!0,t?(this.id=t.id,this.pingTimeout=t.pingTimeout,this.transport.pingTimeout=this.pingTimeout,t.isAuthenticated?this._changeToAuthenticatedState(t.authToken):this._changeToUnauthenticatedStateAndClearTokens()):this._changeToUnauthenticatedStateAndClearTokens(),this.connectAttempts=0,this.options.autoSubscribeOnConnect&&this.processPendingSubscriptions(),r.prototype.emit.call(this,"connect",t,(function(){e.processPendingSubscriptions()})),this.state===this.OPEN&&this._flushEmitBuffer()},E.prototype._onSCError=function(t){var e=this;setTimeout((function(){if(e.listeners("error").length<1)throw t;r.prototype.emit.call(e,"error",t)}),0)},E.prototype._suspendSubscriptions=function(){var t,e;for(var n in this.channels)this.channels.hasOwnProperty(n)&&(e=(t=this.channels[n]).state===t.SUBSCRIBED||t.state===t.PENDING?t.PENDING:t.UNSUBSCRIBED,this._triggerChannelUnsubscribe(t,e))},E.prototype._abortAllPendingEventsDueToBadConnection=function(t){for(var e,n=this._emitBuffer.head;n;){e=n.next;var r=n.data;clearTimeout(r.timeout),delete r.timeout,n.detach(),n=e;var i=r.callback;if(i){delete r.callback;var o="Event '"+r.event+"' was aborted due to a bad connection",s=new m(o,t);i.call(r,s,r)}r.cid&&this.transport.cancelPendingResponse(r.cid)}},E.prototype._onSCClose=function(t,e,n){var i=this;if(this.id=null,this.transport&&this.transport.off(),this.pendingReconnect=!1,this.pendingReconnectTimeout=null,clearTimeout(this._reconnectTimeoutRef),this._suspendSubscriptions(),this._abortAllPendingEventsDueToBadConnection(n?"connectAbort":"disconnect"),this.options.autoReconnect&&(4e3===t||4001===t||1005===t?this._tryReconnect(0):1e3!==t&&t<4500&&this._tryReconnect()),n?r.prototype.emit.call(i,"connectAbort",t,e):r.prototype.emit.call(i,"disconnect",t,e),r.prototype.emit.call(i,"close",t,e),!E.ignoreStatuses[t]){var o;o=e?"Socket connection closed with status code "+t+" and reason: "+e:"Socket connection closed with status code "+t;var s=new g(E.errorStatuses[t]||o,t);this._onSCError(s)}},E.prototype._onSCEvent=function(t,e,n){var i=this._privateEventHandlerMap[t];i?i.call(this,e,n):r.prototype.emit.call(this,t,e,(function(){n&&n.callback.apply(n,arguments)}))},E.prototype.decode=function(t){return this.transport.decode(t)},E.prototype.encode=function(t){return this.transport.encode(t)},E.prototype._flushEmitBuffer=function(){for(var t,e=this._emitBuffer.head;e;){t=e.next;var n=e.data;e.detach(),this.transport.emitObject(n),e=t}},E.prototype._handleEventAckTimeout=function(t,e){e&&e.detach(),delete t.timeout;var n=t.callback;if(n){delete t.callback;var r=new v("Event response for '"+t.event+"' timed out");n.call(t,r,t)}t.cid&&this.transport.cancelPendingResponse(t.cid)},E.prototype._emit=function(t,e,n){var r=this;this.state===this.CLOSED&&this.connect();var i={event:t,callback:n},o=new u.Item;this.options.cloneData?i.data=h(e):i.data=e,o.data=i,i.timeout=setTimeout((function(){r._handleEventAckTimeout(i,o)}),this.ackTimeout),this._emitBuffer.append(o),this.state===this.OPEN&&this._flushEmitBuffer()},E.prototype.send=function(t){this.transport.send(t)},E.prototype.emit=function(t,e,n){if(null==this._localEvents[t])this._emit(t,e,n);else if("error"===t)r.prototype.emit.call(this,t,e);else{var i=new _('The "'+t+'" event is reserved and cannot be emitted on a client socket');this._onSCError(i)}},E.prototype.publish=function(t,e,n){var r={channel:this._decorateChannelName(t),data:e};this.emit("#publish",r,n)},E.prototype._triggerChannelSubscribe=function(t,e){var n=t.name;if(t.state!==t.SUBSCRIBED){var i=t.state;t.state=t.SUBSCRIBED;var o={channel:n,oldState:i,newState:t.state,subscriptionOptions:e};t.emit("subscribeStateChange",o),t.emit("subscribe",n,e),r.prototype.emit.call(this,"subscribeStateChange",o),r.prototype.emit.call(this,"subscribe",n,e)}},E.prototype._triggerChannelSubscribeFail=function(t,e,n){var i=e.name,o=!e.waitForAuth||this.authState===this.AUTHENTICATED;e.state!==e.UNSUBSCRIBED&&o&&(e.state=e.UNSUBSCRIBED,e.emit("subscribeFail",t,i,n),r.prototype.emit.call(this,"subscribeFail",t,i,n))},E.prototype._cancelPendingSubscribeCallback=function(t){null!=t._pendingSubscriptionCid&&(this.transport.cancelPendingResponse(t._pendingSubscriptionCid),delete t._pendingSubscriptionCid)},E.prototype._decorateChannelName=function(t){return this.channelPrefix&&(t=this.channelPrefix+t),t},E.prototype._undecorateChannelName=function(t){return this.channelPrefix&&0===t.indexOf(this.channelPrefix)?t.replace(this.channelPrefix,""):t},E.prototype._trySubscribe=function(t){var e=this,n=!t.waitForAuth||this.authState===this.AUTHENTICATED;if(this.state===this.OPEN&&!this.preparingPendingSubscriptions&&null==t._pendingSubscriptionCid&&n){var i={noTimeout:!0},o={channel:this._decorateChannelName(t.name)};t.waitForAuth&&(i.waitForAuth=!0,o.waitForAuth=i.waitForAuth),t.data&&(o.data=t.data),t.batch&&(i.batch=!0,o.batch=!0),t._pendingSubscriptionCid=this.transport.emit("#subscribe",o,i,(function(n){delete t._pendingSubscriptionCid,n?e._triggerChannelSubscribeFail(n,t,o):e._triggerChannelSubscribe(t,o)})),r.prototype.emit.call(this,"subscribeRequest",t.name,o)}},E.prototype.subscribe=function(t,e){var n=this.channels[t];return n?e&&n.setOptions(e):(n=new i(t,this,e),this.channels[t]=n),n.state===n.UNSUBSCRIBED&&(n.state=n.PENDING,this._trySubscribe(n)),n},E.prototype._triggerChannelUnsubscribe=function(t,e){var n=t.name,i=t.state;if(t.state=e||t.UNSUBSCRIBED,this._cancelPendingSubscribeCallback(t),i===t.SUBSCRIBED){var o={channel:n,oldState:i,newState:t.state};t.emit("subscribeStateChange",o),t.emit("unsubscribe",n),r.prototype.emit.call(this,"subscribeStateChange",o),r.prototype.emit.call(this,"unsubscribe",n)}},E.prototype._tryUnsubscribe=function(t){if(this.state===this.OPEN){var e={noTimeout:!0};t.batch&&(e.batch=!0),this._cancelPendingSubscribeCallback(t);var n=this._decorateChannelName(t.name);this.transport.emit("#unsubscribe",n,e)}},E.prototype.unsubscribe=function(t){var e=this.channels[t];e&&e.state!==e.UNSUBSCRIBED&&(this._triggerChannelUnsubscribe(e),this._tryUnsubscribe(e))},E.prototype.channel=function(t,e){var n=this.channels[t];return n||(n=new i(t,this,e),this.channels[t]=n),n},E.prototype.destroyChannel=function(t){var e=this.channels[t];e&&(e.unwatch(),e.unsubscribe(),delete this.channels[t])},E.prototype.subscriptions=function(t){var e,n=[];for(var r in this.channels)this.channels.hasOwnProperty(r)&&(e=this.channels[r],(t?e&&(e.state===e.SUBSCRIBED||e.state===e.PENDING):e&&e.state===e.SUBSCRIBED)&&n.push(r));return n},E.prototype.isSubscribed=function(t,e){var n=this.channels[t];return e?!!n&&(n.state===n.SUBSCRIBED||n.state===n.PENDING):!!n&&n.state===n.SUBSCRIBED},E.prototype.processPendingSubscriptions=function(){var t=this;this.preparingPendingSubscriptions=!1;var e=[];for(var n in this.channels)if(this.channels.hasOwnProperty(n)){var r=this.channels[n];r.state===r.PENDING&&e.push(r)}e.sort((function(t,e){var n=t.priority||0,r=e.priority||0;return n>r?-1:n<r?1:0})),e.forEach((function(e){t._trySubscribe(e)}))},E.prototype.watch=function(t,e){if("function"!=typeof e)throw new p("No handler function was provided");this._channelEmitter.on(t,e)},E.prototype.unwatch=function(t,e){e?this._channelEmitter.removeListener(t,e):this._channelEmitter.removeAllListeners(t)},E.prototype.watchers=function(t){return this._channelEmitter.listeners(t)},t.exports=E},6622:(t,e,n)=>{var r,i,o=n(8767),s=n(4625).H,a=n(7865);n.g.WebSocket?(r=n.g.WebSocket,i=function(t,e){return new r(t)}):(r=n(7787),i=function(t,e){return new r(t,null,e)});var c=n(3418),u=c.TimeoutError,l=c.BadConnectionError,h=function(t,e,n){var r=this;this.state=this.CLOSED,this.auth=t,this.codec=e,this.options=n,this.connectTimeout=n.connectTimeout,this.pingTimeout=n.ackTimeout,this.pingTimeoutDisabled=!!n.pingTimeoutDisabled,this.callIdGenerator=n.callIdGenerator,this.authTokenName=n.authTokenName,this._pingTimeoutTicker=null,this._callbackMap={},this._batchSendList=[],this.state=this.CONNECTING;var o=this.uri(),s=i(o,this.options);s.binaryType=this.options.binaryType,this.socket=s,s.onopen=function(){r._onOpen()},s.onclose=function(t){var e;e=null==t.code?1005:t.code,r._onClose(e,t.reason)},s.onmessage=function(t,e){r._onMessage(t.data)},s.onerror=function(t){r.state===r.CONNECTING&&r._onClose(1006)},this._connectTimeoutRef=setTimeout((function(){r._onClose(4007),r.socket.close(4007)}),this.connectTimeout)};h.prototype=Object.create(o.prototype),h.CONNECTING=h.prototype.CONNECTING="connecting",h.OPEN=h.prototype.OPEN="open",h.CLOSED=h.prototype.CLOSED="closed",h.prototype.uri=function(){var t,e=this.options.query||{},n=this.options.secure?"wss":"ws";if(this.options.timestampRequests&&(e[this.options.timestampParam]=(new Date).getTime()),(e=a.encode(e)).length&&(e="?"+e),this.options.host)t=this.options.host;else{var r="";this.options.port&&("wss"===n&&443!==this.options.port||"ws"===n&&80!==this.options.port)&&(r=":"+this.options.port),t=this.options.hostname+r}return n+"://"+t+this.options.path+e},h.prototype._onOpen=function(){var t=this;clearTimeout(this._connectTimeoutRef),this._resetPingTimeout(),this._handshake((function(e,n){var r;e?(r=n&&n.code?n.code:4003,t._onError(e),t._onClose(r,e.toString()),t.socket.close(r)):(t.state=t.OPEN,o.prototype.emit.call(t,"open",n),t._resetPingTimeout())}))},h.prototype._handshake=function(t){var e=this;this.auth.loadToken(this.authTokenName,(function(n,r){if(n)t(n);else{e.emit("#handshake",{authToken:r},{force:!0},(function(e,n){n&&(n.authToken=r,n.authError&&(n.authError=c.hydrateError(n.authError))),t(e,n)}))}}))},h.prototype._abortAllPendingEventsDueToBadConnection=function(t){for(var e in this._callbackMap)if(this._callbackMap.hasOwnProperty(e)){var n=this._callbackMap[e];delete this._callbackMap[e],clearTimeout(n.timeout),delete n.timeout;var r="Event '"+n.event+"' was aborted due to a bad connection",i=new l(r,t),o=n.callback;delete n.callback,o.call(n,i,n)}},h.prototype._onClose=function(t,e){delete this.socket.onopen,delete this.socket.onclose,delete this.socket.onmessage,delete this.socket.onerror,clearTimeout(this._connectTimeoutRef),clearTimeout(this._pingTimeoutTicker),clearTimeout(this._batchTimeout),this.state===this.OPEN?(this.state=this.CLOSED,o.prototype.emit.call(this,"close",t,e),this._abortAllPendingEventsDueToBadConnection("disconnect")):this.state===this.CONNECTING&&(this.state=this.CLOSED,o.prototype.emit.call(this,"openAbort",t,e),this._abortAllPendingEventsDueToBadConnection("connectAbort"))},h.prototype._handleEventObject=function(t,e){if(t&&null!=t.event){var n=new s(this,t.cid);o.prototype.emit.call(this,"event",t.event,t.data,n)}else if(t&&null!=t.rid){var r=this._callbackMap[t.rid];if(r&&(clearTimeout(r.timeout),delete r.timeout,delete this._callbackMap[t.rid],r.callback)){var i=c.hydrateError(t.error);r.callback(i,t.data)}}else o.prototype.emit.call(this,"event","raw",e)},h.prototype._onMessage=function(t){o.prototype.emit.call(this,"event","message",t);var e=this.decode(t);if("#1"===e)this._resetPingTimeout(),this.socket.readyState===this.socket.OPEN&&this.sendObject("#2");else if(Array.isArray(e))for(var n=e.length,r=0;r<n;r++)this._handleEventObject(e[r],t);else this._handleEventObject(e,t)},h.prototype._onError=function(t){o.prototype.emit.call(this,"error",t)},h.prototype._resetPingTimeout=function(){if(!this.pingTimeoutDisabled){var t=this;(new Date).getTime();clearTimeout(this._pingTimeoutTicker),this._pingTimeoutTicker=setTimeout((function(){t._onClose(4e3),t.socket.close(4e3)}),this.pingTimeout)}},h.prototype.getBytesReceived=function(){return this.socket.bytesReceived},h.prototype.close=function(t,e){if(t=t||1e3,this.state===this.OPEN){var n={code:t,data:e};this.emit("#disconnect",n),this._onClose(t,e),this.socket.close(t)}else this.state===this.CONNECTING&&(this._onClose(t,e),this.socket.close(t))},h.prototype.emitObject=function(t,e){var n={event:t.event,data:t.data};return t.callback&&(n.cid=t.cid=this.callIdGenerator(),this._callbackMap[t.cid]=t),this.sendObject(n,e),t.cid||null},h.prototype._handleEventAckTimeout=function(t){t.cid&&delete this._callbackMap[t.cid],delete t.timeout;var e=t.callback;if(e){delete t.callback;var n=new u("Event response for '"+t.event+"' timed out");e.call(t,n,t)}},h.prototype.emit=function(t,e,n,r){var i,o,s=this;r?(o=n,i=r):n instanceof Function?(o={},i=n):o=n;var a={event:t,data:e,callback:i};i&&!o.noTimeout&&(a.timeout=setTimeout((function(){s._handleEventAckTimeout(a)}),this.options.ackTimeout));var c=null;return(this.state===this.OPEN||o.force)&&(c=this.emitObject(a,o)),c},h.prototype.cancelPendingResponse=function(t){delete this._callbackMap[t]},h.prototype.decode=function(t){return this.codec.decode(t)},h.prototype.encode=function(t){return this.codec.encode(t)},h.prototype.send=function(t){this.socket.readyState!==this.socket.OPEN?this._onClose(1005):this.socket.send(t)},h.prototype.serializeObject=function(t){var e,n;try{e=this.encode(t)}catch(t){n=t,this._onError(n)}return n?null:e},h.prototype.sendObjectBatch=function(t){var e=this;this._batchSendList.push(t),this._batchTimeout||(this._batchTimeout=setTimeout((function(){if(delete e._batchTimeout,e._batchSendList.length){var t=e.serializeObject(e._batchSendList);null!=t&&e.send(t),e._batchSendList=[]}}),this.options.pubSubBatchDuration||0))},h.prototype.sendObjectSingle=function(t){var e=this.serializeObject(t);null!=e&&this.send(e)},h.prototype.sendObject=function(t,e){e&&e.batch?this.sendObjectBatch(t):this.sendObjectSingle(t)},t.exports.U=h},7787:t=>{var e,n=(e="undefined"!=typeof WorkerGlobalScope?self:"undefined"!=typeof window&&window||function(){return this}()).WebSocket||e.MozWebSocket;function r(t,e,r){return e?new n(t,e):new n(t)}n&&(r.prototype=n.prototype),t.exports=n?r:null},1475:(t,e,n)=>{var r=n(5304),i=n(1016),o=i;o.v1=r,o.v4=i,t.exports=o},5608:t=>{for(var e=[],n=0;n<256;++n)e[n]=(n+256).toString(16).substr(1);t.exports=function(t,n){var r=n||0,i=e;return i[t[r++]]+i[t[r++]]+i[t[r++]]+i[t[r++]]+"-"+i[t[r++]]+i[t[r++]]+"-"+i[t[r++]]+i[t[r++]]+"-"+i[t[r++]]+i[t[r++]]+"-"+i[t[r++]]+i[t[r++]]+i[t[r++]]+i[t[r++]]+i[t[r++]]+i[t[r++]]}},5048:t=>{var e="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(e){var n=new Uint8Array(16);t.exports=function(){return e(n),n}}else{var r=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),r[e]=t>>>((3&e)<<3)&255;return r}}},5304:(t,e,n)=>{var r,i,o=n(5048),s=n(5608),a=0,c=0;t.exports=function(t,e,n){var u=e&&n||0,l=e||[],h=(t=t||{}).node||r,d=void 0!==t.clockseq?t.clockseq:i;if(null==h||null==d){var p=o();null==h&&(h=r=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==d&&(d=i=16383&(p[6]<<8|p[7]))}var f=void 0!==t.msecs?t.msecs:(new Date).getTime(),_=void 0!==t.nsecs?t.nsecs:c+1,g=f-a+(_-c)/1e4;if(g<0&&void 0===t.clockseq&&(d=d+1&16383),(g<0||f>a)&&void 0===t.nsecs&&(_=0),_>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=f,c=_,i=d;var v=(1e4*(268435455&(f+=122192928e5))+_)%4294967296;l[u++]=v>>>24&255,l[u++]=v>>>16&255,l[u++]=v>>>8&255,l[u++]=255&v;var m=f/4294967296*1e4&268435455;l[u++]=m>>>8&255,l[u++]=255&m,l[u++]=m>>>24&15|16,l[u++]=m>>>16&255,l[u++]=d>>>8|128,l[u++]=255&d;for(var y=0;y<6;++y)l[u+y]=h[y];return e||s(l)}},1016:(t,e,n)=>{var r=n(5048),i=n(5608);t.exports=function(t,e,n){var o=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var a=0;a<16;++a)e[o+a]=s[a];return e||i(s)}},4159:t=>{t.exports={refs:!1,date:!0,function:!0,regex:!0,undefined:!0,error:!0,symbol:!0,map:!0,set:!0,nan:!0,infinity:!0}},823:t=>{function e(t,e,n){return{data:n?t[n]():t,__serializedType__:e}}t.exports={mark:e,extract:function(t,e){return{data:Object.assign({},t),__serializedType__:e}},refer:function(t,n,r,i){var o=e(t,n,r);if(!i)return o;for(var s=0;s<i.length;s++){var a=i[s];if("function"==typeof a&&t instanceof a)return o.__serializedRef__=s,o}return o}}},5301:(t,e,n)=>{var r=n(823),i=r.mark,o=r.extract,s=r.refer,a=n(4159);t.exports=function(t,e,n,r){function c(n,r){return r instanceof t.Record?s(r,"ImmutableRecord","toObject",e):r instanceof t.Range?o(r,"ImmutableRange"):r instanceof t.Repeat?o(r,"ImmutableRepeat"):t.OrderedMap.isOrderedMap(r)?i(r,"ImmutableOrderedMap","toObject"):t.Map.isMap(r)?i(r,"ImmutableMap","toObject"):t.List.isList(r)?i(r,"ImmutableList","toArray"):t.OrderedSet.isOrderedSet(r)?i(r,"ImmutableOrderedSet","toArray"):t.Set.isSet(r)?i(r,"ImmutableSet","toArray"):t.Seq.isSeq(r)?i(r,"ImmutableSeq","toArray"):t.Stack.isStack(r)?i(r,"ImmutableStack","toArray"):r}function u(n,r){if("object"==typeof r&&null!==r&&"__serializedType__"in r){var i=r.data;switch(r.__serializedType__){case"ImmutableMap":return t.Map(i);case"ImmutableOrderedMap":return t.OrderedMap(i);case"ImmutableList":return t.List(i);case"ImmutableRange":return t.Range(i._start,i._end,i._step);case"ImmutableRepeat":return t.Repeat(i._value,i.size);case"ImmutableSet":return t.Set(i);case"ImmutableOrderedSet":return t.OrderedSet(i);case"ImmutableSeq":return t.Seq(i);case"ImmutableStack":return t.Stack(i);case"ImmutableRecord":return e&&e[r.__serializedRef__]?new e[r.__serializedRef__](i):t.Map(i);default:return i}}return r}return{replacer:n?function(t,e){return n(t,e,c)}:c,reviver:r?function(t,e){return r(t,e,u)}:u,options:a}}},573:(t,e,n)=>{"use strict";n.d(e,{P1:()=>a});var r="NOT_FOUND";var i=function(t,e){return t===e};function o(t,e){var n,o,s="object"==typeof e?e:{equalityCheck:e},a=s.equalityCheck,c=void 0===a?i:a,u=s.maxSize,l=void 0===u?1:u,h=s.resultEqualityCheck,d=function(t){return function(e,n){if(null===e||null===n||e.length!==n.length)return!1;for(var r=e.length,i=0;i<r;i++)if(!t(e[i],n[i]))return!1;return!0}}(c),p=1===l?(n=d,{get:function(t){return o&&n(o.key,t)?o.value:r},put:function(t,e){o={key:t,value:e}},getEntries:function(){return o?[o]:[]},clear:function(){o=void 0}}):function(t,e){var n=[];function i(t){var i=n.findIndex((function(n){return e(t,n.key)}));if(i>-1){var o=n[i];return i>0&&(n.splice(i,1),n.unshift(o)),o.value}return r}return{get:i,put:function(e,o){i(e)===r&&(n.unshift({key:e,value:o}),n.length>t&&n.pop())},getEntries:function(){return n},clear:function(){n=[]}}}(l,d);function f(){var e=p.get(arguments);if(e===r){if(e=t.apply(null,arguments),h){var n=p.getEntries().find((function(t){return h(t.value,e)}));n&&(e=n.value)}p.put(arguments,e)}return e}return f.clearCache=function(){return p.clear()},f}function s(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];var o,s=0,a={memoizeOptions:void 0},c=r.pop();if("object"==typeof c&&(a=c,c=r.pop()),"function"!=typeof c)throw new Error("createSelector expects an output function after the inputs, but received: ["+typeof c+"]");var u=a.memoizeOptions,l=void 0===u?n:u,h=Array.isArray(l)?l:[l],d=function(t){var e=Array.isArray(t[0])?t[0]:t;if(!e.every((function(t){return"function"==typeof t}))){var n=e.map((function(t){return"function"==typeof t?"function "+(t.name||"unnamed")+"()":typeof t})).join(", ");throw new Error("createSelector expects all input-selectors to be functions, but received the following types: ["+n+"]")}return e}(r),p=t.apply(void 0,[function(){return s++,c.apply(null,arguments)}].concat(h)),f=t((function(){for(var t=[],e=d.length,n=0;n<e;n++)t.push(d[n].apply(null,arguments));return o=p.apply(null,t)}));return Object.assign(f,{resultFunc:c,memoizedResultFunc:p,dependencies:d,lastResult:function(){return o},recomputations:function(){return s},resetRecomputations:function(){return s=0}}),f}}var a=s(o)},6954:t=>{"use strict";t.exports=function(t){if("object"!=typeof __fbBatchedBridgeConfig||"localhost"!==t&&"127.0.0.1"!==t)return t;var e=function(t){var e="undefined"!=typeof window&&window.__fbBatchedBridgeConfig&&window.__fbBatchedBridgeConfig.remoteModuleConfig;if(!Array.isArray(e)||"localhost"!==t&&"127.0.0.1"!==t)return{hostname:t,passed:!1};var n=t,r=!1;return e.some((function(t){if(!t)return!1;var e=t[0],i=t[1];return("AndroidConstants"===e||"PlatformConstants"===e)&&i&&i.ServerHost?(n=i.ServerHost.split(":")[0],r=!0,!0):!("SourceCode"!==e||!i||!i.scriptURL||(n=i.scriptURL.replace(/https?:\/\//,"").split(":")[0],r=!0,0))})),{hostname:n,passed:r}}(t);return e.passed?e.hostname:function(t){var e,n,r,i=console.warn;if("undefined"==typeof window||!window.__DEV__||"function"!=typeof window.require||"metroRequire"===window.require.name)return t;console.warn=function(){if(!(arguments[0]&&"function"==typeof arguments[0].indexOf&&arguments[0].indexOf("Requiring module 'NativeModules' by name")>-1))return i.apply(console,arguments)};try{e=window.require("NativeModules")}catch(t){}return console.warn=i,e?(n=e.PlatformConstants||e.AndroidConstants,r=e.SourceCode,n&&n.ServerHost?n.ServerHost.split(":")[0]:r&&r.scriptURL?r.scriptURL.replace(/https?:\/\//,"").split(":")[0]:t):t}(t)}},7010:(t,e,n)=>{var r=n(8767),i=function(t,e,n){r.call(this),this.PENDING="pending",this.SUBSCRIBED="subscribed",this.UNSUBSCRIBED="unsubscribed",this.name=t,this.state=this.UNSUBSCRIBED,this.client=e,this.options=n||{},this.setOptions(this.options)};(i.prototype=Object.create(r.prototype)).setOptions=function(t){t||(t={}),this.waitForAuth=t.waitForAuth||!1,this.batch=t.batch||!1,void 0!==t.data&&(this.data=t.data)},i.prototype.getState=function(){return this.state},i.prototype.subscribe=function(t){this.client.subscribe(this.name,t)},i.prototype.unsubscribe=function(){this.client.unsubscribe(this.name)},i.prototype.isSubscribed=function(t){return this.client.isSubscribed(this.name,t)},i.prototype.publish=function(t,e){this.client.publish(this.name,t,e)},i.prototype.watch=function(t){this.client.watch(this.name,t)},i.prototype.unwatch=function(t){this.client.unwatch(this.name,t)},i.prototype.watchers=function(){return this.client.watchers(this.name)},i.prototype.destroy=function(){this.client.destroyChannel(this.name)},t.exports.X=i},5556:(t,e,n)=>{const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=/^[ \n\r\t]*[{\[]/;let o=function(t){let e=new Uint8Array(t),n=e.length,i="";for(let t=0;t<n;t+=3)i+=r[e[t]>>2],i+=r[(3&e[t])<<4|e[t+1]>>4],i+=r[(15&e[t+1])<<2|e[t+2]>>6],i+=r[63&e[t+2]];return n%3==2?i=i.substring(0,i.length-1)+"=":n%3==1&&(i=i.substring(0,i.length-2)+"=="),i},s=function(t,e){if(n.g.ArrayBuffer&&e instanceof n.g.ArrayBuffer)return{base64:!0,data:o(e)};if(n.g.Buffer){if(e instanceof n.g.Buffer)return{base64:!0,data:e.toString("base64")};if(e&&"Buffer"===e.type&&Array.isArray(e.data)){let t;return t=n.g.Buffer.from?n.g.Buffer.from(e.data):new n.g.Buffer(e.data),{base64:!0,data:t.toString("base64")}}}return e};t.exports.decode=function(t){if(null==t)return null;if("#1"===t||"#2"===t)return t;let e=t.toString();if(!i.test(e))return e;try{return JSON.parse(e)}catch(t){}return e},t.exports.encode=function(t){return"#1"===t||"#2"===t?t:JSON.stringify(t,s)}},610:t=>{"use strict";t.exports=function(t){return encodeURIComponent(t).replace(/[!'()*]/g,(function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()}))}},550:(t,e,n)=>{"use strict";n.d(e,{LA:()=>m,Ve:()=>y,a1:()=>g,jo:()=>v});var r=n(70),i=n(3431),o=n(2154),s=n(1368),a=n(8082),c=n(4310),u=n(2960);const l=`chrome-extension://${o.Wd}/${o.XV}?file=`,h=`chrome-extension://${o.hf}/${o.XV}?file=`,d=["runtime","polyfills","main"],p="styles.css",f=t=>{const[e]=t.split("?file=");return 0===l.indexOf(e)||0===h.indexOf(e)},_=t=>{const[,e]=t.split("?file=");return f(t)&&-1!==(null==e?void 0:e.indexOf("apis/pdfstorage"))},g=async(t,e,n)=>{const o=null==n?void 0:n.highlightId,s=o&&o.length>0?t=>{const{pdfPageNumberCallback:e,highlightCallback:r}=n;e&&e(t),r&&r(t)}:null==n?void 0:n.pdfPageNumberCallback;c.o.logFromBackgroundScript("openOrSwitchToUrl","Create or Open New Tab",e,o),chrome.tabs.query({lastFocusedWindow:!0},(async n=>{c.o.logFromBackgroundScript("openOrSwitchToUrl","Current Tabs",n);let l=!0;for(const i in n){const h=n[i];if(u.V8.normalizeUrl(e)===u.V8.normalizeUrl(h.url)){if(o){const t={type:a.iz.SCROLL_TO_HIGHLIGHT,payload:{highlightId:o,url:e}};chrome.tabs.sendMessage(h.id,t,(t=>{chrome.runtime.lastError&&c.o.errorFromBackgroundScript("openOrSwitchToUrl","Error in sending scroll command:",chrome.runtime.lastError)}))}if(_(e)&&-1===e.indexOf("?token=")){let n=await(0,r.Nh)(t,!1);n&&(n=encodeURIComponent(n),e=`${e}?token=${n}`,chrome.tabs.update(h.id,{active:!0,url:e},s))}else chrome.tabs.update(h.id,{active:!0},s);l=!1;break}}if(l){if(_(e)&&-1===e.indexOf("?token=")){let n=await(0,r.Nh)(t,!1);n&&(n=encodeURIComponent(n),e=`${e}?token=${n}`)}else if((t=>{const[,e]=t.split("?file=");return f(t)&&0===(null==e?void 0:e.indexOf(i.u$))})(e)){const[,t]=e.split(i.sS);e=t}chrome.tabs.create({url:e},s)}}))},v=t=>new Promise(((e,n)=>{chrome.tabs.query({active:!0,status:"complete",currentWindow:!0,url:o.db},(r=>{var o,a;if(chrome.runtime.lastError&&c.o.errorFromBackgroundScript("enableScriptOnActiveTab","Error in enabling active tab.",chrome.runtime.lastError.message),!(null==r?void 0:r.length))return c.o.logFromBackgroundScript("enableScriptOnActiveTab","No matching tabs. Skip injecting content script"),void e(!1);const u=r.filter((e=>e.id===t&&e.url&&!(0,s.fP)(e.url)));if(u.length>0){const t=i.n$.test(u[0].url),r=null!==(a=null===(o=u[0])||void 0===o?void 0:o.id)&&void 0!==a?a:0;m(r,t).then(e,n)}else e(!1)}))})),m=(t,e=!1)=>new Promise(((n,r)=>{if(0===t){const t="Can't enable a tab with no id.";return c.o.errorFromBackgroundScript("injectScriptsOnTab",t),void r(new Error(t))}chrome.tabs.sendMessage(t,{type:a.iz.ENABLE_ACTIVE_TAB,payload:{tabId:t}},(i=>{if(chrome.runtime.lastError)return c.o.errorFromBackgroundScript("injectScriptsOnTab",`Error in injecting script on tab ${t}:`,i,chrome.runtime.lastError),void(e&&-1!==chrome.runtime.lastError.message.indexOf("Could not establish connection")?(E(t),c.o.logFromBackgroundScript("injectScriptsOnTab",`[Workaround]: Inserted content scripts and CSS on ${t}.`),n(!0)):r(new Error(chrome.runtime.lastError.message)));i?(chrome.scripting.removeCSS({target:{tabId:t},files:[p]}),E(t),c.o.logFromBackgroundScript("injectScriptsOnTab",`Inserted content scripts and CSS on ${t}.`),n(!0)):(c.o.logFromBackgroundScript("injectScriptsOnTab: scripts are already injected on "+t),n(!1))}))})),y=t=>{switch(t){case"local":return{extensionId:o.Wd,server:o.nN[t],type:o.t9.LOCAL};case"testing":return{extensionId:o.Wd,server:o.nN[t],type:o.t9.TESTING};case"staging":return{extensionId:o.hf,server:o.nN[t],type:o.t9.STAGING};case"prod":return{extensionId:o.Wd,server:o.nN[t],type:o.t9.PRODUCTION};default:return{extensionId:o.Wd,server:o.nN[t],type:o.t9.ALL}}};function E(t){chrome.scripting.executeScript({target:{tabId:t},files:d.map((t=>`${t}.js`))}),chrome.scripting.insertCSS({target:{tabId:t},files:[p]})}},2867:(t,e,n)=>{"use strict";n.d(e,{C_:()=>s,TZ:()=>o});var r=n(3431),i=n(2154);const o=t=>`${chrome.runtime.getURL(i.XV)}${r.sS}${t}`,s=t=>{var e;const n=a(t.responseHeaders,"content-type");if(n){const r=null===(e=null==n?void 0:n.value)||void 0===e?void 0:e.toLowerCase().split(";",1)[0].trim();if("application/pdf"===r)return!0;if("application/octet-stream"===r){if(t.url.toLowerCase().indexOf(".pdf")>0)return!0;const e=a(t.responseHeaders||[],"content-disposition");if(e&&/\.pdf(["']|$)/i.test(e.value||""))return!0}}return!1},a=(t=[],e)=>{for(let n=0;n<t.length;++n){const r=t[n];if(r.name.toLowerCase()===e.toLowerCase())return r}return null}},7348:(t,e,n)=>{"use strict";n.a(t,(async(t,e)=>{try{var r=n(8141),i=n(3941),o=n(3977),s=n(77),a=n(8679),c=n(4791),u=n(3894),l=(n(1937),n(1378)),h=n(3431),d=n(143),p=n(1202),f=n(7600),_=n(179),g=n(4178),v=n(141),m=n(3985),y=n(3420),E=n(9922),I=n(250),b=n(1705),S=n(306),T=n(8532),w=n(2410),O=n(4577),C=n(691),A=n(2154),R=n(4310),k=n(550),D=n(5708),N=n(6050),P=n(3052),L=n(1181);const t=L["prod"].analytics.amplitude,x=()=>L.prod;let U=!1;(0,l.HG)(R.o),chrome.action.onClicked.addListener((t=>{var e,n;const r=null!==(e=t.url)&&void 0!==e?e:"",i=null!==(n=t.id)&&void 0!==n?n:0,o=(0,A.fP)(r);if(!U){if(o)return void chrome.notifications.create("",{title:"Weava Disabled On This Site",message:"Go to other websites to start highlighting!",iconUrl:"assets/images/logo/48.png",type:"basic"},(()=>{chrome.runtime.lastError&&R.o.errorFromBackgroundScript("ChromeIconHandler",`Cannot show notification: ${chrome.runtime.lastError.message}`)}));chrome.tabs.sendMessage(i,{type:A.iz.BROADCAST_TOGGLE_SIDEBAR},(0,l.h6)(R.o))}})),d.E.init(t),(0,l.$y)(R.o);const F=chrome.runtime.getManifest().version,M=(0,k.Ve)("prod"),H=(0,o.ZF)(x()),j=(0,s.v0)(H),B={app:H,db:(0,a.N8)(H),auth:j},G={logger:R.o,tracker:d.E,environment:M,version:F,fbInstance:B},W=M.server.appPath;(0,l.Kc)(W,F),(0,l.eu)(W),chrome.runtime.onMessage.addListener(((t,e,n)=>{var r;if(!U)return R.o.logFromBackgroundScript("Service worker","Resending message from content script"),chrome.tabs.sendMessage((null===(r=e.tab)||void 0===r?void 0:r.id)||0,{type:A.iz.BROADCAST_RESEND_MESSAGE,payload:t},(t=>{const e=chrome.runtime.lastError;e?(R.o.errorFromBackgroundScript("Service worker",`Unexpected error: ${e.message}`),n({errorMessage:e.message})):(null==t?void 0:t.errorMessage)?(R.o.errorFromBackgroundScript("Service worker",`Received error from content script message handler: ${t.errorMessage}`),n({errorMessage:t.errorMessage})):n(t)})),!0})),console.log("Background Page Weava init:",F,M);const z=(0,c.UY)({chromeIconReducer:v.B,dataReducer:f.I,folderStateReducer:_.u,hotkeyStateReducer:g.k,optionsStateReducer:y.H,notificationsReducer:m.e,pdfReducer:E.p,popoverStateReducer:I.K,sidebarStateReducer:b.B,stripeReducer:S.R9,uiStateReducer:T.c,urlReducer:w.Y,userStateReducer:O.n});let V=null;const q=[u.Z.withExtraArgument(G),C.z],$=[...q],Y=await(0,p.mk)(),K=(0,p.Hi)(Y);V=(0,c.MT)(z,K,(0,c.md)(...$)),d.E.enableTracking=!0,d.E.app="CHROME_EXTENSION",(0,r.IF)(V,{diffStrategy:i.Z,portName:A.IB}),await(0,p.k6)(!1,[h.LL.rateUsBannerResponse]),U=!0,R.o.logFromBackgroundScript("Service Worker","Redux is initialized");const Q=V.getState(),J=(0,p.hk)(Q);await(0,p.Ph)(J),V.subscribe((async()=>{const t=V.getState(),e=(0,p.hk)(t);await(0,p.Ph)(e)})),await chrome.storage.local.set({noActiveFolderListener:!0});const X=new D.X(R.o);new N.Bp(V,F,x(),R.o,B),new N.AT(V),new N.pd(V,B),new N.OJ(V,R.o,X),new N.VL(V,G,B),new N.os(V,B),new P.X(V,R.o,X),e()}catch(t){e(t)}}),1)},5708:(t,e,n)=>{"use strict";n.d(e,{X:()=>i});var r=n(9533);class i{constructor(t){this.logger=t}sendTabMessage(t,e,n){try{n||(n=e=>{var n;(null===(n=chrome.runtime)||void 0===n?void 0:n.lastError)&&this.logger.errorFromBackgroundScript(`${this.constructor.name}`,`Send tab ${t} message callback has an error:`,chrome.runtime.lastError,e)}),chrome.tabs.sendMessage(t,e,n)}catch(e){this.logger.errorFromBackgroundScript(`${this.constructor.name}::sendTabMessage[${t}]`,"Failure in sending message:",e)}}setTabHighlightMode(t,e){e>0?this.sendTabMessage(e,{type:r.iz.BROADCAST_SET_HIGHLIGHT_MODE,payload:{enabled:t}}):chrome.tabs.query({active:!0,currentWindow:!0},(e=>{const n=e[0];if(n){const e=n.id;this.sendTabMessage(e,{type:r.iz.BROADCAST_SET_HIGHLIGHT_MODE,payload:{enabled:t}})}}))}}},6050:(t,e,n)=>{"use strict";n.d(e,{pd:()=>d,OJ:()=>Q,AT:()=>E,VL:()=>D,os:()=>Z,Bp:()=>W});var r=n(2035),i=n(9956),o=n(9158),s=n(6670),a=n(4366),c=n(866),u=n(9817),l=n(8082),h=n(550);class d extends c.Hd{constructor(t,e){super(t),this.fbInstance=e,this.bindListeners(),this.createContextMenus()}createContextMenus(){const t="context-menu-root";chrome.contextMenus.create({id:t,title:"Weava Highlighter",contexts:["all"]}),chrome.contextMenus.create({id:"context-menu-redirect-to-chrome-store",title:"Weava Highlighter - PDF and Web",contexts:["action"]}),chrome.contextMenus.create({id:"context-menu-read-later",title:"Read Later",contexts:["all"],parentId:t}),chrome.contextMenus.create({id:"context-menu-browse-highlights",title:"Browse highlights",contexts:["all"],parentId:t}),chrome.contextMenus.create({id:"context-menu-update-hotkeys",title:"Update hotkeys",contexts:["all"],parentId:t}),chrome.contextMenus.create({id:"context-menu-highlight-toggle",title:(0,o.Bo)(this.currentState)?"Disable Highlighter":"Enable Highlighter",contexts:["all"],parentId:t}),chrome.contextMenus.create({id:"context-menu-highlight",title:"Highlight",contexts:["selection"],enabled:(0,o.Bo)(this.currentState),parentId:t})}bindListeners(){chrome.contextMenus.onClicked.removeListener(this.contextMenuClicked.bind(this)),chrome.contextMenus.onClicked.addListener(this.contextMenuClicked.bind(this)),chrome.runtime.onMessage.addListener(this.contextMenuMessage.bind(this));const t=(0,o.Bo)(this.currentState);this.updateToggledMenus(t)}handleStoreChange(){}contextMenuClicked(t,e){switch(t.menuItemId){case"context-menu-browse-highlights":this.store.dispatch((0,s.S)(e.id.toString(),!0)),this.store.dispatch(a.t.trackEvent(r.l.CONTEXT_MENU_SIDEBAR,"background"));break;case"context-menu-highlight":(0,o.Bo)(this.currentState)&&t.selectionText&&t.selectionText.length&&(this.store.dispatch((0,i.HN)(e.id.toString(),"1")),this.store.dispatch(a.t.trackEvent(r.l.CONTEXT_MENU_CREATE_HIGHLIGHT,"background")));break;case"context-menu-read-later":this.store.dispatch((0,i.vY)(!0)),this.store.dispatch(a.t.trackEvent(r.l.CONTEXT_MENU_READ_LATER,"background"));break;case"context-menu-highlight-toggle":{const t=(0,o.Bo)(this.currentState),e=!t;this.store.dispatch((0,i.gP)(e)),this.updateToggledMenus(e),t?this.store.dispatch(a.t.trackEvent(r.l.CONTEXT_MENU_DISABLE_WEAVA,"background")):this.store.dispatch(a.t.trackEvent(r.l.CONTEXT_MENU_ENABLE_WEAVA,"background"));break}case"context-menu-update-hotkeys":(0,h.a1)(this.fbInstance.auth,u.bN),this.store.dispatch(a.t.trackEvent(r.l.CONTEXT_MENU_UPDATE_HOTKEYS,"content"));break;case"context-menu-redirect-to-chrome-store":chrome.tabs.create({url:`https://chromewebstore.google.com/detail/weava-highlighter-pdf-web/${chrome.runtime.id}`})}}updateToggledMenus(t){const e="context-menu-root";chrome.contextMenus.update("context-menu-highlight-toggle",{title:t?"Disable Highlighter":"Enable Highlighter",contexts:["all"],parentId:e}),chrome.contextMenus.update("context-menu-highlight",{title:"Highlight",contexts:["selection"],enabled:t,parentId:e})}updateReadLaterMenu(t){const e="context-menu-root";t?chrome.contextMenus.update("context-menu-read-later",{title:"Read Later",contexts:["all"],enabled:!1,parentId:e}):chrome.contextMenus.update("context-menu-read-later",{title:"Read Later",contexts:["all"],enabled:!0,parentId:e})}contextMenuMessage(t,e,n){if(t.type===l.Ti.SET_HIGHLIGHT_MODE){const{enabled:e}=t.payload;this.updateToggledMenus(e),n()}if(t.type===l.Ti.SET_IS_WEBSITE_SAVED_MODE){const{enabled:e}=t.payload;this.updateReadLaterMenu(e),n()}}}var p=n(3312);const f=(t,e,n)=>({type:p.BT.UPDATE_ICON,enabled:n,icon:{tabId:t,isBanned:e}});var _=n(1856);const g=t=>{var e;return null!==(e=null==t?void 0:t.notificationsReducer.get(_.Y.notificationCount))&&void 0!==e?e:0};var v=n(5369);var m=n(8723),y=n(9600);class E extends c.Hd{constructor(t){super(t),this.bindListeners()}bindListeners(){chrome.tabs.onUpdated.addListener(((t,e,n)=>{"complete"===e.status&&(this.store.dispatch(f(t.toString(),(0,m.fP)(n.url),(0,o.Bo)(this.currentState))),this.updateIconBadges([n],g(this.currentState)))}))}handleStoreChange(){const t=g(this.previousState),e=g(this.currentState),n=(0,y.y6)(this.previousState),r=(0,y.y6)(this.currentState),i=(0,o.Bo)(this.previousState),s=(0,o.Bo)(this.currentState);e===t&&n===r&&i===s||chrome.tabs.query({currentWindow:!0},(t=>this.updateIconBadges(t,e)))}updateIconBadges(t,e){const n=[];t.forEach((t=>{t.id&&(n.push(t.id),this.store.dispatch(f(t.id.toString(),(0,m.fP)(t.url),(0,o.Bo)(this.currentState))))}));const r=(i=this.currentState,null!==(s=null==i?void 0:i.chromeIconReducer.get(p.Yh.iconPathStatus))&&void 0!==s?s:(0,v.D5)());var i,s;this.updateCurrentIconStatus(r.filter(((t,e)=>n.includes(parseInt(e)||0))),e,(0,y.y6)(this.currentState))}updateCurrentIconStatus(t,e,n){t.forEach(((t,r)=>{const i=parseInt(r)||0;if(chrome.action.setIcon({tabId:i,path:t},(()=>{chrome.runtime.lastError&&this.store.dispatch((t=>({type:p.BT.REMOVE_ICON_STATUS,icon:{tabId:t}}))(r))})),n&&t===u.qP.ON){const t=e>99?"99+":e.toString();e>0?chrome.action.setBadgeBackgroundColor({tabId:i,color:"#fa3e3e"}):chrome.action.setBadgeBackgroundColor({tabId:i,color:"#9f9f9f"}),chrome.action.setBadgeText({tabId:i,text:t})}else chrome.action.setBadgeText({tabId:i,text:""})}))}}var I=n(806),b=n(4510),S=n(8880),T=n(6533),w=n(5944),O=n(634),C=n(1376),A=n(3815);var R=n(569),k=n(7259);class D extends c.Hd{constructor(t,e,n){super(t),this.fbInstance=n,this.param=e,this.appPath=e.environment.server.appPath,this.bindListeners()}bindListeners(){chrome.runtime.onMessage.addListener(((t,e,n)=>{switch(t.type){case l.Ti.QUERY_TAB:n({tabId:e.tab.id,tabUrl:e.tab.url});break;case l.Ti.GET_ACTIVE_TAB_URL:return(0,I.t)().then((t=>{n({tabId:e.tab.id,tabUrl:t})})).catch((t=>{this.param.logger.errorFromBackgroundScript("ChromeMessageHandler","Get active tab url","Something went wrong while querying current active tab url",t),n({message:`Error querying current active tab url: ${null==t?void 0:t.message}`,success:!1})})),!0;case l.Ti.OPEN_OR_SWITCH_URL:{const{websiteUrl:e,highlightId:r,pageNumber:i}=t.payload,o=i?t=>{this.store.dispatch((0,T.xp)(t.id.toString(),i))}:void 0,s=t=>{this.store.dispatch((0,R.Jm)(t.id.toString(),r))};(0,h.a1)(this.fbInstance.auth,e,{highlightId:r,pdfPageNumberCallback:o,highlightCallback:s}),n();break}case l.Ti.COUNT_TABS:return(0,I.n)().then((t=>{(0,y.y6)(this.currentState)&&this.param.tracker.trackNumberOfTabs(t),n({message:`Total tabs: ${t}`,success:!0})})).catch((t=>{this.param.logger.errorFromBackgroundScript("ChromeMessageHandler","Count tabs","Something went wrong while querying total opened tabs",t),n({message:`Error counting total tabs: ${null==t?void 0:t.message}`,success:!1})})),!0;case l.Ti.CHECK_SITE_ACCESS:return chrome.permissions.contains({origins:u.u3},(t=>{const r=e.tab.id||0;0===r&&n(new Error("Error in checking site access on tab without id.")),t?n("Default Weava site access is granted."):(0,h.jo)(r).then((t=>{n(`Custom site access detected. Enabling content script on tabId ${r} ${t?"is successful":"failed"}.`)})).catch((t=>n(t)))})),!0}})),chrome.runtime.onMessageExternal.addListener(((t,e,n)=>{this.handleExternalMessage(t,e,n)})),chrome.tabs.onActivated.addListener((t=>{const e=t.tabId;(0,h.jo)(e).then((t=>{this.param.logger.logFromBackgroundScript("ChromeMessageHandler","Tab activated",`Enabling script on ${e}`,t)})).catch((t=>{this.param.logger.errorFromBackgroundScript("ChromeMessageHandler","Tab activated",`Error on enabling script on ${e}`,t)}))}))}handleExternalMessage(t,e,n){var r;switch(t.id){case l.Op.SIGN_IN:if(t.payload){const{customToken:e}=t.payload;this.store.dispatch((0,O.eD)(e))}else{const e=t.customToken;this.store.dispatch((0,O.eD)(e))}n();break;case l.Op.SIGN_OUT:this.store.dispatch((0,O.Tz)()),n();break;case l.Op.CHECK_VERSION:n({version:this.param.version,environment:this.param.environment.type});break;case l.Op.EMAIL_VERIFIED:this.store.dispatch((0,O.e4)()),n();break;case l.Op.STRIPE_UPDATE:this.store.dispatch((0,w.eY)()),n();break;case l.Op.DELETE_HIGHLIGHT:{const{folderId:e,websiteId:r,highlightId:i}=t.payload;this.store.dispatch((0,S.Sn)(e,r,i)),n();break}case l.Op.DELETE_MULTIPLE_HIGHLIGHTS:{const{folderId:e,deletedIds:r}=t.payload;this.store.dispatch((0,S.lD)(e,r)),n();break}case l.Op.ADD_HIGHLIGHT_NOTE:{const{websiteId:e,highlightId:r,note:i}=t.payload;this.store.dispatch((0,S.Th)(e,r,i)),n();break}case l.Op.DELETE_HIGHLIGHT_NOTE:{const{websiteId:e,highlightId:r}=t.payload;this.store.dispatch((0,S.WC)(e,r)),n();break}case l.Op.DELETE_PDF:{const{url:e}=t.payload;chrome.tabs.query({currentWindow:!0},(t=>{t.forEach((t=>{(t.url===e||t.url.startsWith(e))&&chrome.tabs.remove(t.id)}))})),n();break}case l.Op.MOVE_HIGHLIGHT:{const{highlightId:e,websiteId:r,highlight:i}=t.payload;this.store.dispatch((0,b.KT)(e,r,(0,k.rr)(i))),n();break}case l.Op.UPDATE_WEBSITE:{const{folderId:e,websiteIds:r}=t.payload;this.store.dispatch((0,C.rN)(e,r)),n();break}case l.Op.DELETE_WEBSITE:{const{folderId:e,websiteIds:r}=t.payload;this.store.dispatch((0,C.rN)(e,r)),n();break}case l.Op.OPEN_CHROME_EXTENSION_SHORTCUTS:this.store.dispatch((0,A.S)(u.bN)),n();break;case l.Op.OPEN_CHROME_NOTIFICATION_SETTINGS:this.store.dispatch((0,A.S)(u.Qj)),n();break;case l.Op.OPEN_OR_SWITCH_URL:{const{websiteUrl:e,highlightId:r,pageNumber:i}=t.payload,o=i?t=>{this.store.dispatch((0,T.xp)(t.id.toString(),i))}:void 0,s=t=>{this.store.dispatch((0,R.Jm)(t.id.toString(),r))};(0,h.a1)(this.fbInstance.auth,e,{highlightId:r,pdfPageNumberCallback:o,highlightCallback:s}),n();break}case l.Op.SCROLL_TO_HIGHLIGHT:{const i=null===(r=null==e?void 0:e.tab)||void 0===r?void 0:r.id;if(i){const{pageNumber:e}=t.payload;e&&this.store.dispatch((0,T.xp)(i.toString(),e)),chrome.tabs.sendMessage(i,{type:l.iz.SCROLL_TO_HIGHLIGHT,payload:Object.assign(Object.assign({},t.payload),{tabId:i})},n)}break}}}async handleStoreChange(){const t=(e=this.currentState,null!==(n=null==e?void 0:e.urlReducer.get(p.Yh.openTabQueue))&&void 0!==n?n:(0,v.aV)());var e,n;if(t&&t.size>0){const e=null==t?void 0:t.get(0);(null==e?void 0:e.url)&&((0,h.a1)(this.fbInstance.auth,e.url),this.store.dispatch((0,A.X)()))}}}var N=n(77),P=n(70),L=n(2960),x=n(9297),U=n(2461),F=n(8679),M=n(9845),H=n(4743);const j=()=>async(t,e,{environment:n,logger:r,fbInstance:i})=>{try{t((0,H.oU)(!0));const e=await(0,P.Nh)(i.auth,!0);if(!e)return r.errorFromBackgroundScript("queryNotificationCount","Unable to fetch token"),void t((0,H.oU)(!1));const o=await(async(t,e,n)=>{const r=`${t}/users/notifications/count?token=${e}&environment=${n}`;return await fetch(r,{method:"GET",headers:{"Content-Type":"application/json"}})})(n.server.apiPath,e,n.type);if(o.ok){const e=await o.json();t((0,H.d2)(e.count)),t((0,H.Io)(e.updateCountAfter))}else r.errorFromBackgroundScript("queryNotificationCount","Response is not okay:",o.status),t((0,H.Io)(Date.now()+M.RF))}catch(e){r.errorFromBackgroundScript("Error fetching notification count:",e),t((0,H.Io)(Date.now()+M.RF))}finally{t((0,H.oU)(!1))}};var B=n(251),G=n(143);class W extends c.Hd{constructor(t,e,n,r,i){super(t),this.version=e,this.config=n,this.logger=r,this.fbInstance=i,this.unsubscribe=null,this.initializeFirebase(),this.bindListeners(),this.syncFromStorage()}bindListeners(){chrome.runtime.onMessage.addListener(((t,e,n)=>{this.logger.logFromBackgroundScript("FirebaseHandler","onMessage",t.type,t.payload),this.handleFirebaseMessage(t,e,n),this.handleFoldersMessage(t,e,n),this.handleHighlightsMessage(t,e,n),this.handlePopoverMessage(t,e,n),this.handleWebsiteMessage(t,e,n),this.handleSubscriptionMessage(t,e,n)})),this.unsubscribe=(0,N.Aj)(this.fbInstance.auth,(t=>{if(t){const{uid:e,displayName:n,email:r,emailVerified:i,photoURL:o,metadata:s,providerId:a}=t;this.logger.logFromBackgroundScript("FirebaseHandler","user is logged in:",e),t.getIdTokenResult(!0).then((t=>{const c={uid:e,displayName:n,email:r,emailVerified:i,photoURL:o,providerId:a,createdAt:s.creationTime};this.store.dispatch((0,O.CO)(c))}));const c=this.version,l=`${u.nN.prod.appPath}/log-redirect;email=${t.email};name=${t.displayName};uid=${t.uid};version=${c}`;chrome.runtime.setUninstallURL(l),this.unsubscribe()}this.syncFromStorage()}))}handleStoreChange(){const t=(0,y.y6)(this.previousState),e=(0,y.y6)(this.currentState);if(t!==e){this.logger.logFromBackgroundScript("FirebaseHandler","handleStoreChange: change in login state",e);const t=this.fbInstance.auth.currentUser;this.handleUserStateChangeAsync(t)}}initializeFirebase(){const t=(0,y.PR)(this.currentState);if(t){const e=t.toJS();this.handleUserStateChangeAsync(e)}}handleUserStateChangeAsync(t){var e;const n=this.fbInstance.auth.currentUser,r=null!==(e=null==t?void 0:t.uid)&&void 0!==e?e:null==n?void 0:n.uid;if(t&&r&&n&&n.email===t.email){const{displayName:e,emailVerified:i,email:o,photoURL:s}=t,a={providerData:(0,P.Wi)(n.providerData),extensionVersion:this.version,uid:r,displayName:e||"Anonymous",email:o||"Anonymous",emailVerified:i,photoURL:s||"",environment:"prod"};G.E.trackUserId(r),G.E.trackUserProfile(a)}r?this.sync(r):this.unSync(this.userId),this.syncFromStorage(),this.userId=null==t?void 0:t.uid}sync(t){this.store.dispatch((0,U.t)(t)),this.store.dispatch((t=>(e,n,{logger:r,environment:i,fbInstance:o})=>{const s=`users/${t}/properties/notifications/${i.type}/count`;r.logFromBackgroundScript("User action","user notification count subscription started:",t);const a=(0,F.iH)(o.db,s);(0,F.jM)(a,(t=>{const n=t.val()||0;r.logFromBackgroundScript("User action","User notification count:",n),e((0,H.d2)(n))}))})(t)),this.store.dispatch((0,w.eY)()),this.store.dispatch(j())}unSync(t){var e;if(t){const n=null!==(e=(0,x.f$)(this.previousState))&&void 0!==e?e:(0,x.f$)(this.currentState);n?this.store.dispatch((0,U.o5)(n)):this.logger.errorFromBackgroundScript("FirebaseHandler","Error on unSync: activeFolderId cannot be undefined."),this.store.dispatch((t=>(e,n,{logger:r,environment:i,fbInstance:o})=>{r.logFromBackgroundScript("User action","user notification count subscription stopped:",t);const s=`users/${t}/properties/notifications/${i.type}/count`;(0,F.S1)((0,F.iH)(o.db,s))})(t)),this.store.dispatch((0,U.M8)(t)),this.userId=null}}handleSubscriptionMessage(t,e,n){if(t.type===l.yj.GET_SUBSCRIPTION)this.store.dispatch((0,w.eY)()),n()}handleHighlightsMessage(t,e,n){var r;switch(t.type){case l.yj.SAVE_HIGHLIGHT:{const{folderId:r,website:i,highlightId:o,highlight:s}=t.payload;this.store.dispatch((0,S.nm)(r,L.V8.normalizeUrl(i.url)||i.url,i.title,o,s,this.getFavicon(e))),n();break}case l.yj.SAVE_IMAGE_HIGHLIGHT_TO_STORAGE:{const{highlightId:r,base64Url:i,activeFolderId:o,website:s,highlight:a}=t.payload;this.store.dispatch((0,S.Am)(r,i,o,s,a,this.getFavicon(e))),n();break}case l.yj.DELETE_IMAGE_HIGHLIGHT_TO_STORAGE:{const{restPath:e,highlightId:r}=t.payload;this.store.dispatch((0,S.CO)(e,r)),n();break}case l.yj.UPDATE_HIGHLIGHT:{const i=(null===(r=e.tab)||void 0===r?void 0:r.id.toString())||"0",{folderId:o,websiteId:s,highlightId:a,colorNum:c}=t.payload;this.store.dispatch((0,S.uP)(i.toString(),o,s,a,c)),n();break}case l.yj.DELETE_HIGHLIGHT:{const{folderId:e,websiteId:r,highlightId:i,isImage:o}=t.payload;this.store.dispatch((0,S.c5)(e,r,i,o)),n();break}case l.yj.SAVE_HIGHLIGHT_NOTE:{const{websiteId:e,highlightId:r,note:i}=t.payload;this.store.dispatch((0,S.W$)(e,r,i)),n();break}case l.yj.DELETE_HIGHLIGHT_NOTE:{const{websiteId:e,highlightId:r}=t.payload;this.store.dispatch((0,S.YJ)(e,r)),n();break}}}handleFirebaseMessage(t,e,n){switch(t.type){case l.yj.GENERATE_NEW_PUSH_ID:{const t=(0,P.HC)(this.fbInstance.db);n(t);break}case l.yj.GENERATE_TOKEN:return(0,P.Nh)(this.fbInstance.auth,!1).then((t=>n(t))),!0}}handleFoldersMessage(t,e,n){var r,i,o,s,a,c;switch(t.type){case l.yj.SWITCH_ACTIVE_FOLDER:{const e=t.payload.folderId;this.store.dispatch((0,U.A1)(e)),n();break}case l.yj.CREATE_NEW_FOLDER:{const{folderId:i,folderName:o}=t.payload,s=(null===(r=e.tab)||void 0===r?void 0:r.id)||0;this.store.dispatch((0,U.L6)(s.toString(),i,o)),n();break}case l.yj.DELETE_FOLDER:{const{restPath:e,folderId:r}=t.payload;this.store.dispatch((0,U.Go)(e,r)),n();break}case l.yj.EDIT_FOLDER:{const{restPath:e,folder:r}=t.payload;this.store.dispatch((0,U.tb)(e,r)),n();break}case l.yj.FETCH_EDIT_FOLDER:{const{folderId:r,isSharedFolder:o}=t.payload,s=(null===(i=e.tab)||void 0===i?void 0:i.id)||0;this.store.dispatch((0,U.m5)(s.toString(),r,o)),n();break}case l.yj.GET_FOLDER_ACCESS_FOR_DELETE:{const{restPath:r,folderId:i}=t.payload,s=(null===(o=e.tab)||void 0===o?void 0:o.id)||0;this.store.dispatch((0,U.Sf)(r,s.toString(),i)),n();break}case l.yj.GET_FOLDER_HIGHLIGHTS:{const{restPath:e,folderId:r}=t.payload;this.store.dispatch((0,U.b9)(e,r)),n();break}case l.yj.MOVE_FOLDER:{const{restPath:e,sourceFolderId:r,destinationFolderId:i}=t.payload;this.store.dispatch((0,U.J1)(e,r,i)),n();break}case l.yj.FETCH_SHARE_FOLDER:{const{restPath:r,folderId:i,folderName:o}=t.payload,a=(null===(s=e.tab)||void 0===s?void 0:s.id)||0;this.store.dispatch((0,U.g8)(r,a.toString(),i,o)),n();break}case l.yj.ADD_INVITE_SHARE_FOLDER:{const{restPath:r,environment:i,folderId:o,folderName:s,email:c,senderDisplayName:u}=t.payload,l=(null===(a=e.tab)||void 0===a?void 0:a.id)||0;this.store.dispatch((0,U.l4)(r,i,o,s,c,u,l.toString())),n();break}case l.yj.REMOVE_COLLABORATOR_SHARE_FOLDER:{const{restPath:r,environment:i,folderId:o,isOwner:s,userIds:a,emails:u}=t.payload,l=(null===(c=e.tab)||void 0===c?void 0:c.id)||0;this.store.dispatch((0,U.mt)(r,i,o,s,a,u,l.toString())),n();break}case l.yj.MOVE_WEBSITE:{const{restPath:e,sourceFolderId:r,destinationFolderId:i,websiteId:o}=t.payload;this.store.dispatch((0,U.wI)(e,r,i,o)),n();break}case l.yj.MOVE_HIGHLIGHT:{const{sourceFolderId:e,destinationFolderId:r,websiteId:i,highlightId:o}=t.payload;this.store.dispatch((0,U.Rl)(e,r,i,o)),n();break}}}handlePopoverMessage(t,e,n){switch(t.type){case l.yj.UPDATE_FOLDER_COLORS:{const{restPath:e,folder:r}=t.payload;this.store.dispatch((0,B.t2)(e,r)),n();break}}}handleWebsiteMessage(t,e,n){switch(t.type){case l.yj.CREATE_WEBSITE:{const{folderId:r,website:i}=t.payload;this.store.dispatch((0,C.fe)(r,L.V8.normalizeUrl(i.url)||i.url,i.title,this.getFavicon(e))),n();break}case l.yj.DELETE_WEBSITE:{const{folderId:e,websiteId:r}=t.payload;this.store.dispatch((0,C.hz)(e,r)),n();break}case l.yj.DELETE_PDF_FROM_STORAGE:{const{folderId:e,websiteId:r,isHostedPdf:i}=t.payload;this.store.dispatch((0,T.wK)(e,r,i)),n();break}}}getFavicon(t){return 0===t.frameId&&t.tab.favIconUrl?t.tab.favIconUrl:""}syncFromStorage(){this.store.dispatch((0,T.W)()),this.store.dispatch((0,O.Xb)())}}var z=n(3431);var V=n(578),q=n(9533),$=n(3501),Y=n(9896);var K=n(9776);class Q extends q.Hd{constructor(t,e,n){super(t),this.logger=e,this.messenger=n,this.bindListeners()}bindListeners(){this.setHotkeyState(),chrome.commands.onCommand.addListener((t=>{switch(this.logger.logFromBackgroundScript("ChromeHotkeyActionHandler","Hotkey has been triggered",t),t){case V.aK.TOGGLE_HIGHLIGHT_MODE_BY_SHORTCUT:{const t=(0,o.Bo)(this.currentState),e=!t;this.logger.logFromBackgroundScript("ChromeHotkeyActionHandler",`Toggling Highlight Mode from ${t} to ${e}`),e?this.store.dispatch(a.t.trackEvent(r.l.HOTKEY_DISABLE_HIGHLIGHT_MODE,"background")):this.store.dispatch(a.t.trackEvent(r.l.HOTKEY_ENABLE_HIGHLIGHT_MODE,"background")),this.store.dispatch((0,i.gP)(e)),this.messenger.setTabHighlightMode(e);break}case V.aK.READ_LATER:this.store.dispatch((0,i.vY)(!0)),this.store.dispatch(a.t.trackEvent(r.l.CONTEXT_MENU_READ_LATER,"background"));break;case V.aK.TOGGLE_WEAVA_SIDEBAR:chrome.tabs.query({active:!0,currentWindow:!0},(t=>{const e=t[0];if(e){const t=e.id.toString(),n=(0,K.$O)(this.currentState,t);n?this.store.dispatch(a.t.trackEvent(r.l.HOTKEY_CLOSE_SIDEBAR,"background")):this.store.dispatch(a.t.trackEvent(r.l.HOTKEY_OPEN_SIDEBAR,"background")),this.store.dispatch((0,$.Sl)(t,!n))}}));break;case V.aK.HIGHLIGHT_COLOR_01:case V.aK.HIGHLIGHT_COLOR_02:case V.aK.HIGHLIGHT_COLOR_03:case V.aK.HIGHLIGHT_COLOR_04:case V.aK.HIGHLIGHT_COLOR_05:case V.aK.HIGHLIGHT_COLOR_06:case V.aK.HIGHLIGHT_COLOR_07:case V.aK.HIGHLIGHT_COLOR_08:case V.aK.HIGHLIGHT_COLOR_09:case V.aK.HIGHLIGHT_COLOR_10:chrome.tabs.query({active:!0,currentWindow:!0},(e=>{var n,r;const i=e[0],s=(0,o.Bo)(this.currentState),a=(0,x.XW)(this.currentState);if(s&&a&&i){const e=t.split("_").slice(-1)[0],o=parseInt(e)||0,s=((t=z.Wy,e=[])=>{const n=e;return t.filter((t=>t&&t.length>0)).map(((t,e)=>({code:t,name:n[e]||""})))})(null===(n=a.colorCodes)||void 0===n?void 0:n.toArray(),null===(r=a.colorTags)||void 0===r?void 0:r.toArray());0<o&&o<=s.length&&this.store.dispatch((0,Y.lS)(i.id.toString(),o))}}))}}))}setHotkeyState(){chrome.runtime.getPlatformInfo((t=>{chrome.commands.getAll((e=>{e.forEach((e=>{this.updateHotkey(e.name,e.shortcut,t.os)}))}))}))}updateHotkey(t,e,n){if(t===V.aK.TOGGLE_HIGHLIGHT_MODE_BY_SHORTCUT){const i=e||V.Rs.enableHighlightMode,o="mac"===n?this.changeMacSymbol(i):i,s=null==(r=this.currentState)?void 0:r.hotkeyStateReducer.get(p.Yh.enableHighlightMode);s!==o&&(this.logger.logFromBackgroundScript("ChromeHotkeyActionHandler","updating mapping",t,s,o),this.store.dispatch((0,Y.RN)(o)))}var r}changeMacSymbol(t){let e=t;return e=e.replace(/\+/g,""),e=e.replace(/Alt/g,"\u2325"),e=e.replace(/Command/g,"\u2318"),e=e.replace(/Shift/g,"\u21e7"),e=e.replace(/Ctrl/g,"\u2303"),e}handleStoreChange(){this.setHotkeyState()}}const J=t=>{var e;return null!==(e=null==t?void 0:t.pdfReducer.get(p.Yh.autoPdf))&&void 0!==e&&e};var X=n(2867);class Z extends c.Hd{constructor(t,e){super(t),this.fbInstance=e,this.localPdfRedirectionRulesetId="local_pdf_ruleset",this.bindListeners()}bindListeners(){chrome.runtime.onMessage.addListener(((t,e,n)=>{if(t.type===l.Ti.OPEN_VIA_DEFAULT_PDF_VIEWER){const{websiteUrl:e}=t.payload;(0,h.a1)(this.fbInstance.auth,e),n()}else if(t.type===l.Ti.OPEN_VIA_WEAVA_PDF_VIEWER){const r=e.tab.id,{websiteUrl:i}=t.payload;chrome.tabs.update(r,{url:chrome.runtime.getURL(u.XV)+z.sS+i.replace(z.Oc,"")}),n()}else{if(t.type===l.Ti.GET_FILE_SCHEME_ACCESS)return chrome.extension.isAllowedFileSchemeAccess((t=>{n(t)})),!0;if(t.type===l.Ti.SET_AUTO_PDF){const{value:e}=t.payload;return e?this.enableLocalPDFRule().then(n):this.disableLocalPDFRule().then(n),!0}}})),this.handleOnlinePdfDetection(),this.handleLocalPdfRedirection()}handleStoreChange(){const t=J(this.previousState),e=J(this.currentState);e!==t&&(e?this.enableLocalPDFRule():this.disableLocalPDFRule())}handleLocalPdfRedirection(){chrome.webNavigation.onBeforeNavigate.addListener((async t=>{await this.onBeforeRequestLocal(t)}),{url:[{originAndPathMatches:"file://*.*.pdf",schemes:["file"]}]})}handleOnlinePdfDetection(){chrome.webRequest.onHeadersReceived.addListener((t=>this.onHeadersReceivedListener(t)),{urls:["<all_urls>"],types:["main_frame"]},["responseHeaders"])}onHeadersReceivedListener(t){if("GET"!==t.method||-1!==t.url.indexOf("mail-attachment")||-1!==t.url.indexOf("attachment.outlook.office.net")||!(0,X.C_)(t))return void this.store.dispatch((0,T.PS)(t.tabId.toString(),p.FO.FALSE));const e=J(this.currentState);!(0,X.C_)(t)&&-1===t.url.indexOf(z.Oc)&&e?this.store.dispatch((0,T.PS)(t.tabId.toString(),p.FO.PDF_JS)):this.store.dispatch((0,T.PS)(t.tabId.toString(),p.FO.DEFAULT))}async onBeforeRequestLocal(t){const e=J(this.currentState);e&&-1===t.url.indexOf(z.Oc)&&e||this.store.dispatch((0,T.PS)(t.tabId.toString(),p.FO.DEFAULT))}async enableLocalPDFRule(){await chrome.declarativeNetRequest.updateEnabledRulesets({enableRulesetIds:[this.localPdfRedirectionRulesetId],disableRulesetIds:[]})}async disableLocalPDFRule(){await chrome.declarativeNetRequest.updateEnabledRulesets({enableRulesetIds:[],disableRulesetIds:[this.localPdfRedirectionRulesetId]})}}},3052:(t,e,n)=>{"use strict";n.d(e,{X:()=>v});var r=n(3431),i=n(866),o=n(9817),s=n(8082),a=n(8723),c=n(2035),u=n(9956),l=n(9158),h=n(5241),d=n(3501),p=n(9776),f=n(4366),_=n(550),g=n(2867);class v extends i.Hd{constructor(t,e,n){super(t),this.logger=e,this.messenger=n,this.bindListeners()}bindListeners(){chrome.runtime.onMessage.addListener(((t,e,n)=>{var r,i;if(t.type===s.Ti.TOGGLE_SIDEBAR){const t=null!==(r=e.tab.id)&&void 0!==r?r:0,o=null!==(i=e.tab.url)&&void 0!==i?i:"";return o&&this.logIconClick(o),this.shouldRedirectToPdfViewer(o,t)?void this.handleRedirectToPdfViewer(o,t):(this.changeStateOnIconClick(t,o),this.injectScript(t,e.tab.url,e.tab).then((()=>{n({message:"success"})})).catch((t=>{n({errorMessage:t.message})})),!0)}})),chrome.webNavigation.onCompleted.addListener((t=>{const{tabId:e}=t;"active"!==t.documentLifecycle||"outermost_frame"!==t.frameType||(0,a.fP)(t.url)||this.setSidebar(e)}),{url:[{schemes:["http","https","chrome-extension"]}]}),chrome.tabs.onUpdated.addListener(((t,e,n)=>{(0,a.fP)(n.url)||("loading"===e.status?this.setSidebar(t):"complete"===e.status&&(0,_.jo)(t).then((e=>{e&&this.store.dispatch((0,h.e3)(t.toString(),!1))})).catch((e=>this.logger.errorFromBackgroundScript("ChromeIconHandler",`Tab ${t} loading is complete, error in enabling script`,e))))})),chrome.action.onClicked.addListener((t=>{var e,n;const r=null!==(e=t.url)&&void 0!==e?e:"",i=null!==(n=t.id)&&void 0!==n?n:0;(0,a.fP)(r)?chrome.notifications.create("",{title:"Weava Disabled On This Site",message:"Go to other websites to start highlighting!",iconUrl:"assets/images/logo/48.png",type:"basic"},(()=>{chrome.runtime.lastError&&this.logger.errorFromBackgroundScript("ChromeIconHandler",`Cannot show notification: ${chrome.runtime.lastError.message}`)})):(r&&this.logIconClick(r),this.shouldRedirectToPdfViewer(r,i)?this.handleRedirectToPdfViewer(r,i):(this.changeStateOnIconClick(i,r),this.injectScript(i,r,t)))}))}handleStoreChange(){}injectScript(t,e,n){const i=r.n$.test(e);return(0,_.LA)(t,i).then((e=>{this.logger.logFromBackgroundScript("ChromeIconHandler",`Extension button clicked on tab ${t}, is script injected?`,e)})).catch((e=>{throw this.logger.errorFromBackgroundScript("ChromeIconHandler",`Extension button clicked on tab ${t}, error in injecting script`,e),e}))}setSidebar(t){const e=(0,p.eP)(this.currentState,t.toString()),n=(0,p.$O)(this.currentState,t.toString());e?n||this.store.dispatch((0,d.Sl)(t.toString(),!0)):n&&this.store.dispatch((0,d.Sl)(t.toString(),!1))}shouldRedirectToPdfViewer(t,e){return 0===t.indexOf(r.u$)?(this.logger.logFromBackgroundScript("ChromeBrowserActionHandler","Redirect to Pdf viewer from local"),!0):!(!t.toLowerCase().endsWith(".pdf")&&!t.toLowerCase().endsWith(`.pdf${r.Oc}`)||t.startsWith(chrome.runtime.getURL(o.XV)))&&(this.logger.logFromBackgroundScript("ChromeBrowserActionHandler","Redirect to Pdf viewer from online"),!0)}handleToggleSidebar(t,e){if((0,a.fP)(t))return;const n=(0,p.$O)(this.currentState,e.toString());this.store.dispatch((0,d.Sl)(e.toString(),!n)),this.store.dispatch(f.t.trackEvent(c.l.TOGGLE_SIDEBAR,"background",{isSidebarShown:!n}))}enableHighlightModeOnIconClick(t){(0,l.Bo)(this.currentState)||(this.store.dispatch((0,u.gP)(!0)),this.messenger.setTabHighlightMode(!0,t),this.store.dispatch(f.t.trackEvent(c.l.HIGHLIGHT_MODE_TOGGLE_SWITCHED_ON_VIA_ICON_CLICK,"background",{toggle:!0})))}logIconClick(t){this.store.dispatch(f.t.trackEvent(c.l.CHROME_ICON_CLICK,"content",{url:t}))}handleRedirectToPdfViewer(t,e){const n=(0,g.TZ)(t.replace(r.Oc,""));chrome.tabs.update(e,{url:n})}changeStateOnIconClick(t,e){this.handleToggleSidebar(e,t),this.enableHighlightModeOnIconClick(t)}}},1378:(t,e,n)=>{"use strict";n.d(e,{$y:()=>i,HG:()=>a,eu:()=>s,Kc:()=>o,h6:()=>c});var r=n(2154);const i=t=>chrome.contextMenus.removeAll((()=>{t.logFromBackgroundScript("Context Menus","Remove all previous context menus")})),o=(t,e)=>chrome.runtime.setUninstallURL(`${t}/log-redirect;email=Anonymous;name=Anonymous;uid=Anonymous;version=${e}`),s=t=>chrome.runtime.onInstalled.addListener((e=>{const n=r.kk.SIGN_UP,i=r.kk.CONTRIBUTE;e.reason===chrome.runtime.OnInstalledReason.INSTALL?chrome.tabs.create({url:`${t}/${n}`,active:!0}):e.reason===chrome.runtime.OnInstalledReason.UPDATE&&(chrome.tabs.query({currentWindow:!0},(t=>{t.forEach((t=>{var e;chrome.tabs.reload(null!==(e=t.id)&&void 0!==e?e:0)}))})),chrome.tabs.create({url:`${t}/${i}`,active:!0}))})),a=t=>{self.addEventListener("install",(()=>{self.skipWaiting(),t.logFromBackgroundScript("Service worker","Service worker is installed and waiting event is skipped")}))},c=t=>e=>{var n;const r=(null===(n=chrome.runtime.lastError)||void 0===n?void 0:n.message)||(null==e?void 0:e.errorMessage);r?t.errorFromBackgroundScript("Service worker: [Toggle Sidebar]",r):t.logFromBackgroundScript("Service worker: [Toggle Sidebar]","Toggle sidebar success",{response:e})}},70:(t,e,n)=>{"use strict";n.d(e,{HC:()=>s,Nh:()=>o,Wi:()=>a});var r=n(77),i=n(8679);const o=async(t,e=!0)=>{const n=t.currentUser;let i=null;if(n)try{if(i=await(0,r.wU)(n,e),i)return i}catch(t){return null}let o=()=>{};const s=new Promise((n=>{o=(0,r.Aj)(t,(async t=>{try{if(t){const i=await(0,r.wU)(t,e);n(i)}else n(null)}catch(t){n(null)}o()}))})),a=await s;return null!=a?a:null},s=t=>(0,i.VF)((0,i.iH)(t)).key,a=t=>t.map((t=>null==t?void 0:t.providerId)).filter((t=>void 0!==t))},2938:(t,e,n)=>{"use strict";n.d(e,{$r:()=>r,I5:()=>i});n(3431);const r=t=>"Premium (Beta)"===t||"Premium (Referral)"===t,i=t=>"Annually"===t||"Monthly"===t||"School Subscription Pricing"===t||"Daily Testing Plan"===t},3431:(t,e,n)=>{"use strict";n.d(e,{LL:()=>i.L,Oc:()=>o.Oc,Q:()=>r.Q,Wy:()=>r.Wy,n$:()=>o.n$,sS:()=>o.sS,u$:()=>o.u$});var r=n(5441),i=n(9769),o=n(1305)},1305:(t,e,n)=>{"use strict";n.d(e,{Oc:()=>i,n$:()=>s,sS:()=>o,u$:()=>r});const r="file:///",i="?forcedefault=true",o="?file=",s=new RegExp("^"+r+".*.pdf.*");var a,c;!function(t){t.Local="Local",t.Uploaded="Uploaded",t.Online="Online"}(a||(a={})),function(t){t.InvalidPDFException="InvalidPDFException",t.MissingPDFException="MissingPDFException",t.UnexpectedResponseException="UnexpectedResponseException"}(c||(c={}))},9769:(t,e,n)=>{"use strict";n.d(e,{L:()=>i});var r=n(3192);const i=n.n(r)()({rateUsBannerResponse:null,onboardingStatus:null,autoPdf:null})},5441:(t,e,n)=>{"use strict";n.d(e,{Q:()=>r,Wy:()=>i});var r;!function(t){t[t.Default=0]="Default",t[t.Loading=1]="Loading",t[t.Success=2]="Success",t[t.Fail=3]="Fail"}(r||(r={}));const i=["#FFCAD7","#FFDE70","#FFFB78","#D1FF61","#B4FFEB","#F8CEFF","#A9DFFF","#B9BEFF","#FFA4BE","#DADADA"].slice(0,5);var o,s;!function(t){t.Daily="Daily",t.Monthly="Monthly",t.Annually="Annually"}(o||(o={})),function(t){t.Daily="day",t.Monthly="month",t.Annually="year"}(s||(s={}));o.Daily,s.Daily,o.Monthly,s.Monthly,o.Annually,s.Annually},8805:(t,e,n)=>{"use strict";n.d(e,{$:()=>s});var r,i=n(3192),o=n.n(i);!function(t){t.TOP="TOP",t.BOTTOM="BOTTOM"}(r||(r={}));const s=o()({SHOW_COLOR_POPOVER:null,SHOW_COLOR_SETTINGS:null,SHOW_SELECTION_ALERT:null,UPDATE_METADATA:null,UPDATE_ACTIVE_HIGHLIGHT:null})},8785:(t,e,n)=>{"use strict";n.d(e,{jp:()=>s,lw:()=>o});var r=n(3192),i=n.n(r);const o=i()({SWITCH_FOLDER:null,UPDATE_ACTIVE_FOLDER:null,UPDATE_USER_FOLDERS:null,UNSUBSCRIBE_FOLDERS:null,UNSUBSCRIBE_ACTIVE_FOLDER:null,CREATE_FOLDER:null,DELETE_FOLDER:null,EDIT_FOLDER:null,UPDATE_FOLDER_COLORS:null,GET_ALL_HIGHLIGHTS:null,MOVE_FOLDER:null,MOVE_WEBSITE:null,MOVE_HIGHLIGHT:null,FOLDER_UPDATE_ACCESS_RIGHTS:null}),s=i()({FOLDER_LOADING:null,FOLDER_FAILED:null,FOLDER_SUCCESS:null,FOLDER_RESET:null,FOLDER_EDIT_SHOW_MODAL:null,FOLDER_EDIT_HIDE_MODAL:null,FOLDER_SHARE_SHOW_MODAL:null,FOLDER_SHARE_HIDE_MODAL:null,FOLDER_SHARE_ADD_INVITED:null,FOLDER_SHARE_REMOVE_COLLABORATORS:null,FOLDER_SHOW_CREATE_FIELD:null,FOLDER_HIDE_CREATE_FIELD:null,FOLDER_SHARE_SHOW_DELETE_MODAL:null,FOLDER_SHARE_HIDE_DELETE_MODAL:null})},758:(t,e,n)=>{"use strict";n.d(e,{jp:()=>r.jp,lw:()=>r.lw});var r=n(8785)},5910:(t,e,n)=>{"use strict";n.d(e,{gB:()=>c,li:()=>a,vQ:()=>s});var r,i=n(3192),o=n.n(i);!function(t){t.Asc="Asc",t.Desc="Desc"}(r||(r={}));r.Asc;const s=o()({ADD_HIGHLIGHT:null,ADD_IMAGE_HIGHLIGHT:null,DELETE_IMAGE_HIGHLIGHT:null,UPDATE_HIGHLIGHT_COLOR:null,COPY_HIGHLIGHT:null,DELETE_HIGHLIGHT:null,SEARCH_HIGHLIGHTS:null,RESET_HIGHLIGHTS:null,NOT_FOUND_HIGHLIGHTS:null,TOGGLE_SEARCH_MODE:null,ADD_HIGHLIGHT_NOTE:null,DELETE_HIGHLIGHT_NOTE:null,DELETE_MULTIPLE_HIGHLIGHTS:null}),a=o()({NOTE_FAILED:null,NOTE_SUCCESS:null}),c=o()({HIGHLIGHT_SUCCESS:null,HIGHLIGHT_FAILED:null,HIGHLIGHT_RESET:null,HIGHLIGHT_LOADING:null})},578:(t,e,n)=>{"use strict";n.d(e,{Rs:()=>a,aK:()=>o,xs:()=>s});var r=n(3192),i=n.n(r);const o=i()({TOGGLE_HIGHLIGHT_MODE_BY_SHORTCUT:null,TOGGLE_WEAVA_SIDEBAR:null,CREATE_HIGHLIGHT:null,READ_LATER:null,HIGHLIGHT_COLOR_01:null,HIGHLIGHT_COLOR_02:null,HIGHLIGHT_COLOR_03:null,HIGHLIGHT_COLOR_04:null,HIGHLIGHT_COLOR_05:null,HIGHLIGHT_COLOR_06:null,HIGHLIGHT_COLOR_07:null,HIGHLIGHT_COLOR_08:null,HIGHLIGHT_COLOR_09:null,HIGHLIGHT_COLOR_10:null}),s=i()({UPDATE_HIGHLIGHT_MODE_SHORTCUT:null,UPDATE_HIGHLIGHT_COLOR_SHORTCUT:null}),a={enableHighlightMode:"Alt+S",toggleWeavaSidebar:"Alt+W",readLater:"Alt+R"}},7752:(t,e,n)=>{"use strict";n.d(e,{B:()=>s,K:()=>o});var r=n(3192),i=n.n(r);const o=i()({ENABLE_HIGHLIGHT_MODE:null,CREATE_HIGHLIGHT:null,RESET_HIGHLIGHT_COLOR:null,READ_LATER:null,SHOW_FOLDER_PANE:null}),s=i()({ICON_CLICKED:null,UPDATE_ICON:null,REMOVE_ICON_STATUS:null})},3312:(t,e,n)=>{"use strict";n.d(e,{lw:()=>r.lw,vQ:()=>i.vQ,xs:()=>o.xs,BT:()=>s.B,uA:()=>u.u,KE:()=>s.K,XO:()=>l.X,FO:()=>l.F,Yh:()=>c.Y,$k:()=>a.$,xf:()=>h.x,TQ:()=>d.T});n(8805);var r=n(758),i=n(5910),o=n(578),s=n(7752);n(9845);var a=n(3799),c=n(1856),u=(n(3760),n(1882)),l=(n(2035),n(5112),n(8558)),h=n(1316),d=n(6885)},9845:(t,e,n)=>{"use strict";n.d(e,{RF:()=>o,iv:()=>i});var r=n(3192);const i=n.n(r)()({LOADING:null,CHANGE_TAB:null,REMOVE:null,COUNT:null,UPDATE_TIME:null,INFO:null,MARK_READ:null,SUBSCRIBE:null,SUBSCRIBE_FAILED:null,SELECTED:null,FOLDER_SELECTED:null}),o=3e4},8558:(t,e,n)=>{"use strict";n.d(e,{F:()=>r,X:()=>s});var r,i=n(3192),o=n.n(i);!function(t){t.FALSE="FALSE",t.DEFAULT="DEFAULT",t.PDF_JS="PDF_JS"}(r||(r={}));const s=o()({AUTO_PDF:null,PDF_MODE:null,PDF_PAGE_NUMBER:null,PDF_RENDER_HIGHLIGHT:null,PDF_RESET_RENDER_HIGHLIGHT:null,DELETE_PDF_FROM_STORAGE:null})},3799:(t,e,n)=>{"use strict";n.d(e,{$:()=>i});var r=n(3192);const i=n.n(r)()({SHOW_SIDEBAR:null,TOGGLE_PINNED_SIDEBAR:null})},1856:(t,e,n)=>{"use strict";n.d(e,{Y:()=>i});var r=n(3192);const i=n.n(r)()({showSidebar:null,showFolderPane:null,isPinned:null,popoverMetadata:null,activeHighlightMetadata:null,iconPathStatus:null,enableHighlightMode:null,highlightColor:null,readLaterClicked:null,sortHighlightsOption:null,isLoggedIn:null,user:null,authError:null,customToken:null,authStatus:null,onboardingStatus:null,notificationLoading:null,notificationInfo:null,notificationActiveTab:null,notificationRemove:null,notificationSubscribe:null,notificationSubscribeError:null,notificationSelected:null,notificationFolderSelected:null,notificationCount:null,notificationUpdateTime:null,openTabQueue:null,showAccountDetails:null,showPopover:null,showEditColorModePopover:null,showColorSettingsModePopover:null,folderAPIActionStatus:null,highlightAPIActionStatus:null,notesAPIActionStatus:null,websiteAPIActionStatus:null,folderMetadataMap:null,activeFolderMap:null,activeFolderPath:null,highlightsVisibility:null,activeHighlightIdMap:null,nonActiveWebsiteBodyMap:null,showSelectionAlert:null,websiteStatus:null,searchParameters:null,notFoundFolderHighlights:null,showFolderEditPanel:null,showFolderSharePanel:null,showFolderCreateField:null,showFolderShareDeleteModal:null,nonActiveFolderHighlights:null,dragAction:null,autoPdf:null,pdfMode:null,pdfPageNumber:null,pdfRender:null,stripeData:null})},3760:(t,e,n)=>{"use strict";n.d(e,{_:()=>i});var r=n(3192);const i=n.n(r)()({STRIPE_UPDATED:null,STRIPE_RESET:null,STRIPE_FETCHING_STATUS:null})},1882:(t,e,n)=>{"use strict";n.d(e,{u:()=>i});var r=n(3192);const i=n.n(r)()({OPEN_TAB:null,OPEN_TAB_SUCCESS:null})},2035:(t,e,n)=>{"use strict";var r;n.d(e,{l:()=>r}),function(t){t.TOGGLE_SIDEBAR="[SB] TOGGLE SIDEBAR",t.PIN_SIDEBAR="[SB] PIN_WCE_ON_CHROME_TOOLBAR",t.UNPIN_SIDEBAR="[SB] UNPIN_WCE_ON_CHROME_TOOLBAR",t.RENAME_FOLDER="[SB] RENAME_FOLDER",t.SWITCH_FOLDER="[SB] SWITCH_FOLDER",t.CREATE_FOLDER="[SB] CREATE_FOLDER",t.CREATE_FOLDER_FAIL="[SB] CREATE_FOLDER_FAIL",t.CREATE_NESTED_FOLDER_FAIL_UNPAID="[SB] CREATE_NESTED_FOLDER_FAIL_UNPAID",t.DELETE_FOLDER="[SB] DELETE_FOLDER",t.CANCEL_DELETE_FOLDER="[SB] CANCEL_DELETE_FOLDER",t.DELETE_FOLDER_FAIL="[SB] DELETE_FOLDER",t.EDIT_FOLDER_CLICKED="[SB] EDIT_FOLDER_CLICKED",t.HIDE_FOLDER_EDIT_PANEL="[SB] HIDE_FOLDER_EDIT_PANEL",t.CREATE_NESTED_FOLDER="[SB] CREATE_NESTED_FOLDER",t.DRAG_FOLDER="[SB] DRAG_FOLDER",t.DROP_FOLDER="[SB] DROP_FOLDER",t.CLICK_PREMIUM_ADVERTISEMENT="[SB] CLICK_PREMIUM_ADVERTISEMENT",t.EXIT_PREMIUM_ADVERTISEMENT="[SB] EXIT_PREMIUM_ADVERTISEMENT",t.HIDE_FOLDER_SHARE_PANEL="[SB] HIDE_FOLDER_SHARE_PANEL",t.CANCEL_COLLABORATION_UNSAVED="[SB] CANCEL_COLLABORATION_UNSAVED",t.SHOW_COLLABORATION_FOLDER_POPUP="[SB] COLLABORATION_FOLDER_POP_UP",t.SHARE_COLLECTION="[SB] SHARE_COLLECTION",t.SHARE_COLLECTION_UNPAID_FAILED="[SB] SHARE_COLLECTION_FAILED _UNPAID",t.SHARE_COLLECTION_SUCCESSFUL="[SB] SHARE_COLLECTION_SUCCESSFUL",t.VERIFY_COLLABORATION_SUCCESFUL="[SB] VERIFY_COLLABORATION_SUCCESFUL",t.COLLABORATION_FAIL="[SB] COLLABORATION_FAIL",t.REMOVE_COLLABORATORS_SUBMITTED="[SB] REMOVE_COLLABORATOR_SUBMITTED",t.REMOVE_INVITED_SUBMITTED="[SB] REMOVE_INVITED_SUBMITTED",t.DELETE_IMAGE="[SB] DELETE_IMAGE",t.DELETE_IMAGE_SUCCESS="[SB] DELETE_IMAGE_SUCCESS",t.DELETE_IMAGE_FAIL="[SB] DELETE_IMAGE_FAIL",t.ADD_NEW_COLOR="[SB] ADD_NEW_COLOR",t.ADD_NEW_COLOR_SUCCESS="[SB] ADD_NEW_COLOR_SUCCESS",t.ADD_NEW_COLOR_VIA_POPOVER="[HP] ADD_NEW_COLOR",t.ADD_NEW_COLOR_VIA_POPOVER_SUCCESS="[HP] ADD_NEW_COLOR_SUCCESS",t.ADD_COLOR_UNPAID_VIA_POPOVER="[HP] ADD_NEW_COLOR_FAILED_UNPAID",t.READ_LATER_UNPAID_VIA_POPOVER="[HP] READ_LATER_FAILED_UNPAID",t.EDIT_COLOR_UNPAID_VIA_POPOVER="[HP] EDIT_COLOR_UNPAID",t.EDIT_COLOR_UNPAID="[SB] EDIT_COLOR_UNPAID",t.ADD_COLOR_UNPAID="[SB] ADD_NEW_COLOR_FAILED_UNPAID",t.CANCEL_EDIT_UNSAVED="[SB] CANCEL_EDIT_UNSAVED",t.CANCEL_EDIT_UNSAVED_VIA_POPOVER="[HP] CANCEL_EDIT_UNSAVED",t.DELETE_COLOR_VIA_POPOVER="[HP] DELETE_COLOR",t.DELETE_COLOR="[SB] DELETE_COLOR",t.CREATE_HIGHLIGHT_PDF="[HP] CREATE_HIGHLIGHT_PDF",t.CREATE_HIGHLIGHT_PDF_ERROR="[HP] CREATE_HIGHLIGHT_PDF_ERROR",t.DRAG_HIGHLIGHT="[SB] DRAG_HIGHLIGHT",t.DROP_HIGHLIGHT="[SB] DROP_HIGHLIGHT",t.COPY_HIGHLIGHT="[SB] COPY_HIGHLIGHT",t.DELETE_HIGHLIGHT="[SB] DELETE_HIGHLIGHT",t.HIGHLIGHT_MODE_TOGGLE_SWITCHED_ON_VIA_BUTTON="[SB] HIGHLIGHT_MODE_TOGGLE_SWITCHED_ON",t.HIGHLIGHT_MODE_TOGGLE_SWITCHED_ON_VIA_ICON_CLICK="[SB] HIGHLIGHT_MODE_TOGGLE_SWITCHED_ON",t.HIGHLIGHT_MODE_TOGGLE_SWITCHED_ON_VIA_CONTEXT_MENU="[CM] HIGHLIGHT_MODE_TOGGLE_SWITCHED_ON",t.CREATE_HIGHLIGHT="[HP] CREATE_HIGHLIGHT_WEBSITE",t.CREATE_HIGHLIGHT_SUCCESS="[HP] CREATE_HIGHLIGHT_SUCCESS",t.CREATE_HIGHLIGHT_ERROR="[HP] CREATE_HIGHLIGHT_ERROR",t.HIDE_ALL_HIGHLIGHTS="[SB] HIDE_ALL_HIGHLIGHTS",t.SHOW_ALL_HIGHLIGHTS="[SB] SHOW_ALL_HIGHLIGHTS",t.DROP_IMAGE="[HP] DROP_IMAGE",t.DROP_IMAGE_SUCCESS="[HP] DROP_IMAGE_SUCCESS",t.DROP_IMAGE_FAIL="[HP] IMAGE_FAIL_TO_CLIP",t.EDIT_COLOR_VIA_POPOVER="[HP] EDIT_COLOR",t.EDIT_COLOR="[SB] EDIT_COLOR",t.SAVE_EDIT_COLOR_SETTINGS="[HP] SAVE_EDIT_COLOR_SETTINGS",t.SAVE_EDIT_COLOR_SETTINGS_VIA_FOLDER_PANEL="[SB] SAVE_EDIT_COLOR_SETTINGS",t.SAVE_EDIT_COLOR_SETTINGS_SUCCESS="[SB] ADD_NEW_COLOR_SUCCESS",t.SAVE_COLOR_FAIL="[SB] ADD_NEW_COLOR_FAIL",t.SAVE_COLOR_FAIL_UNPAID="[SB] ADD_NEW_COLOR_FAILED_UNPAID",t.DELETE_HIGHLIGHT_VIA_POPOVER="[HP] DELETE_HIGHLIGHT",t.DELETE_NOTE="[SB] DELETE_NOTE",t.EDIT_NOTE="[SB] EDIT_NOTE",t.EDIT_NOTE_VIA_POPOVER="[HP] EDIT_NOTE",t.UPDATE_HIGHLIGHT_COLOR_VIA_POPOVER="[HP] UPDATE_HIGHLIGHT_COLOR",t.CLEAR_SEARCH="[SB] CLEAR_SEARCH",t.SEARCH_IN_FOLDER="[SB] SEARCH_IN_FOLDER",t.SEARCH_FILTER_BY_COLOR="[SB] SEARCH_FILTER_BY_COLOR",t.CONTEXT_MENU_PIN_SIDEBAR="[CM] PIN_SIDEBAR",t.CONTEXT_MENU_SIDEBAR="[CM] SIDEBAR_BROWSE_HIGHLIGHTS",t.CONTEXT_MENU_ENABLE_WEAVA="[CM] RIGHT_CLICK_ENABLE_WEAVA",t.CONTEXT_MENU_DISABLE_WEAVA="[CM] RIGHT_CLICK_DISABLE_WEAVA",t.CONTEXT_MENU_CREATE_HIGHLIGHT="[CM] CREATE_HIGHLIGHT",t.CONTEXT_MENU_UPDATE_HOTKEYS="[CM] UPDATE_HOTKEYS",t.CONTEXT_MENU_READ_LATER="[CM] CONTEXT_MENU_READ_LATER",t.HOTKEY_OPEN_SIDEBAR="[KS] OPEN_WEAVA_SIDEBAR_SHORTCUT",t.HOTKEY_CLOSE_SIDEBAR="[KS] CLOSE_WEAVA_SIDEBAR_SHORTCUT",t.HOTKEY_ENABLE_HIGHLIGHT_MODE="[KS] HIGHLIGHT_SHORTCUT_FOR_DEACTIVATING_WEAVA",t.HOTKEY_DISABLE_HIGHLIGHT_MODE="[KS] HIGHLIGHT_SHORTCUT_FOR_ACTIVATING_WEAVA",t.HOTKEY_CREATE_HIGHLIGHT="[KS] CREATE_HIGHLIGHT",t.CHANGE_WEBSITE_ORDER="[SB] CHANGE_WEBSITE_ORDER",t.DELETE_WEBSITE="[SB] DELETE_WEBSITE",t.DRAG_WEBSITE="[SB] DRAG_WEBSITE",t.DRAG_PDF="[SB] DRAG_PDF",t.DROP_WEBSITE="[SB] DROP_WEBSITE",t.DROP_PDF="[SB] DROP_PDF",t.OPEN_ACCOUNT_SETTINGS="[SB] OPEN_ACCOUNT_SETTINGS",t.VIEW_ACCOUNT_DETAILS="[SB] VIEW_ACCOUNT_DETAILS",t.SIGNOUT="[SB] SIGNOUT",t.SIGNOUT_ERROR="[SB] SIGNOUT_ERROR",t.INSTALL_SIGNUP_PAGE="[SB] INSTALL_SIGNUP_PAGE_CLOSED_IMMEDIATELY",t.RELOAD_WCE="[SB] RELOAD_WCE",t.LOGIN_USER_IN_EXTENSION="[SB] LOGIN USER IN EXTENSION",t.LOGIN_USER_IN_EXTENSION_FAIL="[SB] LOGIN USER IN EXTENSION ERROR",t.UPLOAD_PDF_BUTTON_CLICKED="[SB] UPLOAD_PDF_BUTTON_CLICKED",t.GO_TO_DASHBOARD_BUTTON_CLICKED="[SB] GO_TO_DASHBOARD_BUTTON_CLICKED",t.HOME_BUTTON_CLICKED="[SB] HOME_BUTTON_CLICKED",t.CLOSE_DISCOUNT_MODAL="[SB] CLOSE_DISCOUNT_MODAL",t.CHROME_ICON_CLICK="[SB] CHROME_ICON_CLICK",t.RATE_US_BANNER_CLICKED="[SB] RATE_US_BANNER_CLICKED",t.RATE_US_BANNER_CLOSED="[SB] RATE_US_BANNER_CLOSED",t.CLICK_CONTACT_SUPPORT="[SB] CLICK_CONTACT_SUPPORT",t.CLICK_REQUEST_FEATURE="[SB] CLICK_REQUEST_FEATURE",t.CLICK_KEYBOARD_SHORTCUTS="[SB] CLICK_KEYBOARD_SHORTCUTS",t.DELETE_PDF="[SB] DELETE_PDF",t.DOWNLOAD_ORIGINA_PDF="[PDF_VIEWER] DOWNLOAD ORIGINAL PDF",t.PRINT_ORIGINAL_PDF="[PDF_VIEWER] PRINT_ORIGINAL_PDF",t.ENABLE_PDF_VIEWER_VIA_ICON_CLICK="[SB] ENABLE_WEAVA_PDF_VIEWER_VIA_ICON_CLICK",t.ENABLE_PDF_VIEWER_VIA_HIGHLIGHT_BUTTON="[SB] ENABLE_WEAVA_PDF_VIEWER_VIA_HIGHLIGHT_BUTTON",t.ENABLE_PDF_VIEWER="[SB] ENABLE_WEAVA_PDF_VIEWER",t.DISABLE_PDF_VIEWER="[SB] DISABLE_WEAVA_PDF_VIEWER",t.ENABLE_PDF_VIEWER_VIA_PDF_MENU="[SB] ENABLE_WEAVA_PDF_VIEWER_VIA_PDF_MENU",t.DISABLE_PDF_VIEWER_VIA_PDF_MENU="[SB] DISABLE_WEAVA_PDF_VIEWER_VIA_PDF_MENU",t.PRINT_PDF_WITH_HIGHLIGHTS="[PDF_VIEWER] PRINT_PDF_WITH_HIGHLIGHTS",t.DOWNLOAD_PDF_WITH_HIGHLIGHTS="[PDF_VIEWER] DOWNLOAD_PDF_WITH_HIGHLIGHTS",t.UPLOAD_PDF_SUCCESS="[PDF_STORAGE] UPLOAD_PDF_FILE_SUCCESS",t.WEB_APP_OPEN_VIEWER_FAIL="[WA] OPEN_VIEWER_FAIL",t.WEB_APP_ENTER_SUBFOLDER="[WA] ENTER_SUBFOLDER",t.WEB_APP_CLICKED_PDF_VIEWER="[WA] PDF_CLICKED_VIEWER",t.WEB_APP_DISABLE_PDF_VIEWER="[WA] DISABLE_WEAVA_PDF_VIEWER",t.WEB_APP_ENABLE_PDF_VIEWER="[WA] ENABLE_WEAVA_PDF_VIEWER"}(r||(r={}))},5112:(t,e,n)=>{"use strict";n.d(e,{As:()=>u,Gg:()=>s,KA:()=>c,Zk:()=>a,fx:()=>l});var r=n(3192),i=n.n(r),o=n(5441);const s=i()({DRAG_ACTION_START:null,DRAG_ACTION_END:null,TOGGLE_HIGHLIGHTS_VISIBILITY:null,RESET_HIGHLIGHTS_VISIBILITY:null,SORT_HIGHLIGHTS:null,WEBSITES_FETCH_SUCCESS:null,WEBSITES_FETCH_ERROR:null,SET_ACTIVE_HIGHLIGHT_ID:null,RESET_ACTIVE_HIGHLIGHT_ID:null}),a={folderId:null,operation:null,status:o.Q.Default,type:"folder"},c={websiteId:null,highlightId:null,operation:null,status:o.Q.Default,toFolderId:null,fromFolderId:null,type:"highlight"},u={websiteId:null,highlightId:null,operation:null,status:o.Q.Default,type:"note"},l={websiteId:null,operation:null,status:o.Q.Default,toFolderId:null,fromFolderId:null,type:"website"}},1316:(t,e,n)=>{"use strict";n.d(e,{Q:()=>o,x:()=>i});var r=n(3192);const i=n.n(r)()({USER_LOGGED_IN_REQUEST:null,USER_LOGGED_IN_SUCCESS:null,USER_LOGGED_IN_ERROR:null,USER_LOGGED_OUT_REQUEST:null,USER_LOGGED_OUT_SUCCESS:null,USER_LOGGED_OUT_ERROR:null,USER_LOGGED_IN_WITH_CUSTOM_TOKEN:null,USER_ONBOARDING_STATUS:null,USER_RELOAD_REQUEST:null});var o;!function(t){t[t.DEFAULT=0]="DEFAULT",t[t.LOADED=1]="LOADED",t[t.STARTED=2]="STARTED",t[t.DONE=3]="DONE"}(o||(o={}))},6885:(t,e,n)=>{"use strict";n.d(e,{T:()=>i});var r=n(3192);const i=n.n(r)()({WEBSITE_LOADING_REQUEST:null,WEBSITE_LOADING_SUCCESS:null,WEBSITE_LOADING_ERROR:null,WEBSITE_SAVED:null,WEBSITE_UPDATE_ALL:null,WEBSITE_UPDATE:null,WEBSITE_RESET_ALL:null,WEBSITE_DELETED:null,WEBSITE_SUCCESS:null,WEBSITE_FAILED:null,WEBSITE_RESET:null})},974:(t,e,n)=>{"use strict";n.d(e,{$I:()=>i,_b:()=>s,d5:()=>o});var r=n(5369);const i={folderMetadataMap:(0,r.D5)(),activeFolderMap:(0,r.D5)(),activeFolderPath:"",nonActiveWebsiteBodyMap:(0,r.D5)(),nonActiveFolderHighlights:(0,r.D5)(),notFoundFolderHighlights:(0,r.D5)(),searchParameters:(0,r.D5)()},o={folderMetadataMap:(0,r.D5)(),activeFolderMap:(0,r.D5)(),activeFolderPath:"",nonActiveWebsiteBodyMap:(0,r.D5)(),nonActiveFolderHighlights:(0,r.D5)(),notFoundFolderHighlights:(0,r.D5)(),searchParameters:(0,r.D5)()};class s extends((0,r.WV)(o)){}},1313:(t,e,n)=>{"use strict";n.d(e,{uY:()=>o,_b:()=>c._b,Tt:()=>s,sH:()=>a,qF:()=>p,Bz:()=>f.B,UR:()=>d});var r=n(5369);const i={title:null,creator:null,accessRight:(0,r.D5)(),colorCodes:null,colorTags:null,createDate:null,updateDate:null,lastModifiedDate:null,websiteIds:(0,r.D5)(),invited:(0,r.D5)()};class o extends((0,r.WV)(i)){constructor(t){super(t)}}const s=t=>{const e=Array.isArray(t.colorCodes)?(0,r.aV)(t.colorCodes):(0,r.D5)(t.colorCodes||{}).toList(),n=Array.isArray(t.colorTags)?(0,r.aV)(t.colorTags):(0,r.D5)(t.colorTags||{}).toList();return new o({title:t.title,creator:t.creator,accessRight:(0,r.d0)(t.accessRight),colorCodes:0===e.size?i.colorCodes:e,colorTags:0===n.size?i.colorTags:n,createDate:t.createDate||i.createDate,updateDate:t.updateDate||i.updateDate,lastModifiedDate:t.lastModifiedDate||i.lastModifiedDate,websiteIds:(0,r.d0)(t.websiteIds)||i.websiteIds,invited:(0,r.d0)(t.invited)})},a=()=>(0,r.D5)();var c=n(974);const u={title:null,colorCodes:null,colorTags:null,createDate:null,updateDate:null,lastModifiedDate:null,folderMetaMap:null,shared:!1,accessRight:(0,r.D5)()};class l extends((0,r.WV)(u)){constructor(t){super(t)}}const h=(t,e,n=null)=>new l({title:t.title,colorCodes:(0,r.d0)(t.colorCodes)||u.colorCodes,colorTags:(0,r.d0)(t.colorTags)||u.colorTags,createDate:t.createDate||u.createDate,updateDate:t.updateDate||u.updateDate,lastModifiedDate:t.lastModifiedDate||u.lastModifiedDate,folderMetaMap:d(t.folderIds,n),shared:t.shared,accessRight:(0,r.d0)(t.accessRight)}),d=(t,e)=>{if(t){let n=(0,r.D5)();for(const r in t){const i=h(t[r],0,e);n=n.set(r,i)}return n=n.sortBy((t=>t.get("createDate"))),n}return(0,r.D5)()},p=()=>(0,r.D5)();var f=n(695)},695:(t,e,n)=>{"use strict";n.d(e,{B:()=>s,k:()=>o});var r=n(5369);const i={accessRight:(0,r.D5)(),createDate:null,creator:null,favIconUrl:null,title:null,url:null,localUrls:null,highlights:(0,r.D5)()};class o extends((0,r.WV)(i)){constructor(t){super(t)}}const s=()=>(0,r.D5)()},691:(t,e,n)=>{"use strict";n.d(e,{z:()=>s});var r=n(3312),i=n(5181),o=n(2714);const s=t=>e=>n=>{const s=e(n);return n.type===r.xf.USER_ONBOARDING_STATUS?t.dispatch((0,o.p)(n.status)):n.type===r.XO.AUTO_PDF&&t.dispatch((0,i.sT)(n.enabled)),s}},7600:(t,e,n)=>{"use strict";n.d(e,{I:()=>l});var r=n(5369),i=n(3312),o=n(6885),s=n(1316),a=n(1313),c=n(2482);const u=new a._b,l=(t=u,e)=>{let n=t;switch(e.type){case i.lw.UPDATE_USER_FOLDERS:{const t=(0,a.UR)(e.folders,e.activeFolderId);return n.set(i.Yh.folderMetadataMap,t)}case i.lw.UPDATE_ACTIVE_FOLDER:{const t=(0,a.Tt)(e.activeFolder);return n=n.set(i.Yh.activeFolderMap,(0,r.D5)({[e.folderId]:t})),n.set(i.Yh.activeFolderPath,e.activeFolderPath)}case i.lw.UNSUBSCRIBE_FOLDERS:{const t=(0,a.qF)();return n.set(i.Yh.folderMetadataMap,t)}case i.lw.UNSUBSCRIBE_ACTIVE_FOLDER:return n.removeIn([i.Yh.activeFolderMap,e.activeFolderId]);case i.lw.GET_ALL_HIGHLIGHTS:{const{folderId:t,highlights:r}=e;return n.setIn([i.Yh.nonActiveFolderHighlights,t],r)}case i.lw.MOVE_WEBSITE:{const{colorCodes:t,colorTags:r,destinationFolderId:o,websiteId:s}=e,a=n.get(i.Yh.folderMetadataMap),u=(0,c.CP)(a,o);if(u){const e=u.toArray();return e.splice(0,1),n=n.removeIn([i.Yh.nonActiveWebsiteBodyMap,s]),n=n.setIn([i.Yh.folderMetadataMap,...e,"colorCodes"],t),n.setIn([i.Yh.folderMetadataMap,...e,"colorTags"],r)}return n=n.removeIn([i.Yh.nonActiveWebsiteBodyMap,s]),n=n.setIn([i.Yh.folderMetadataMap,o,"colorCodes"],t),n.setIn([i.Yh.folderMetadataMap,o,"colorTags"],r)}case i.lw.MOVE_HIGHLIGHT:{const{highlightId:t,websiteId:r}=e;return n.removeIn([i.Yh.nonActiveWebsiteBodyMap,r,"highlights",t])}case o.T.WEBSITE_UPDATE_ALL:return n.set(i.Yh.nonActiveWebsiteBodyMap,e.websiteBodyMap);case o.T.WEBSITE_UPDATE:return e.websiteBodyMap.toSeq().forEach(((t,e)=>{n=t&&t.title&&t.url?n.setIn([i.Yh.nonActiveWebsiteBodyMap,e],t):n.removeIn([i.Yh.nonActiveWebsiteBodyMap,e])})),n;case o.T.WEBSITE_RESET_ALL:{const t=(0,a.Bz)();return n.set(i.Yh.nonActiveWebsiteBodyMap,t)}case o.T.WEBSITE_DELETED:case i.XO.DELETE_PDF_FROM_STORAGE:{const{websiteId:t,folderId:r}=e;return n=n.removeIn([i.Yh.nonActiveWebsiteBodyMap,t]),n.removeIn([i.Yh.activeFolderMap,r,"websiteIds",t])}case i.vQ.ADD_HIGHLIGHT:{const{folderId:t,websiteId:r,highlightId:o,highlight:s}=e;return n=n=n.setIn([i.Yh.nonActiveWebsiteBodyMap,r,"highlights",o],s),n.setIn([i.Yh.nonActiveFolderHighlights,t,o],s)}case i.vQ.UPDATE_HIGHLIGHT_COLOR:{const{folderId:t,websiteId:r,highlightId:o,colorNum:s}=e;return n=n.setIn([i.Yh.nonActiveWebsiteBodyMap,r,"highlights",o,"colorNum"],s),n.setIn([i.Yh.nonActiveFolderHighlights,t,o,"colorNum"],s)}case i.vQ.DELETE_HIGHLIGHT:{const{folderId:t,websiteId:r,highlightId:o}=e;return n=n.removeIn([i.Yh.nonActiveWebsiteBodyMap,r,"highlights",o]),n.removeIn([i.Yh.nonActiveFolderHighlights,t,o])}case i.vQ.DELETE_MULTIPLE_HIGHLIGHTS:{const{folderId:t,deletedIds:r}=e;return r.forEach((e=>{const r=e.websiteId;e.highlightIds.forEach((e=>{n=n.removeIn([i.Yh.nonActiveWebsiteBodyMap,r,"highlights",e]),n=n.removeIn([i.Yh.nonActiveFolderHighlights,t,e])}))})),n}case i.vQ.SEARCH_HIGHLIGHTS:{const{tabId:t,colorNumArray:r,text:o}=e;return n.setIn([i.Yh.searchParameters,t.toString()],{colorNumArray:r,text:o,searchMode:!0})}case i.vQ.RESET_HIGHLIGHTS:{const{tabId:t}=e;return n.setIn([i.Yh.searchParameters,t.toString()],{colorNumArray:null,text:null,searchMode:!1})}case i.vQ.TOGGLE_SEARCH_MODE:{const{tabId:t}=e,r=n.getIn([i.Yh.searchParameters,t.toString()]),o=(null==r?void 0:r.searchMode)||!1;return n.setIn([i.Yh.searchParameters,t.toString(),"searchMode"],!o)}case i.vQ.NOT_FOUND_HIGHLIGHTS:{const{websiteId:t,highlightIds:r}=e;return n.setIn([i.Yh.notFoundFolderHighlights,t],r)}case i.vQ.ADD_HIGHLIGHT_NOTE:{const{websiteId:t,highlightId:r,note:o}=e;return n.setIn([i.Yh.nonActiveWebsiteBodyMap,t,"highlights",r,"note"],o)}case i.vQ.DELETE_HIGHLIGHT_NOTE:{const{websiteId:t,highlightId:r}=e;return n.removeIn([i.Yh.nonActiveWebsiteBodyMap,t,"highlights",r,"note"])}case s.x.USER_LOGGED_OUT_SUCCESS:return u;default:return n}}},4510:(t,e,n)=>{"use strict";n.d(e,{Ac:()=>l,Bb:()=>d,Ed:()=>h,Er:()=>s,Gx:()=>i,IP:()=>p,KT:()=>u,O9:()=>g,Yi:()=>_,dQ:()=>f,h:()=>c,iL:()=>o,kt:()=>a});var r=n(758);const i=(t,e,n)=>({type:r.lw.UPDATE_USER_FOLDERS,userId:t,folders:n,activeFolderId:e}),o=(t,e,n)=>({type:r.lw.UPDATE_ACTIVE_FOLDER,activeFolder:e,folderId:t,activeFolderPath:n}),s=t=>({type:r.lw.UNSUBSCRIBE_FOLDERS,userId:t}),a=t=>({type:r.lw.UNSUBSCRIBE_ACTIVE_FOLDER,activeFolderId:t}),c=(t,e,n,i,o)=>({type:r.lw.MOVE_WEBSITE,colorCodes:n,colorTags:i,sourceFolderId:t,destinationFolderId:e,websiteId:o}),u=(t,e,n)=>({type:r.lw.MOVE_HIGHLIGHT,highlightId:t,websiteId:e,highlight:n}),l=(t,e)=>({type:r.lw.GET_ALL_HIGHLIGHTS,folderId:t,highlights:e}),h=t=>({type:r.jp.FOLDER_HIDE_CREATE_FIELD,tabId:t}),d=(t,e)=>({type:r.jp.FOLDER_EDIT_SHOW_MODAL,tabId:t,folder:e}),p=(t,e)=>({type:r.jp.FOLDER_SHARE_SHOW_MODAL,tabId:t,folder:e}),f=(t,e,n)=>({type:r.jp.FOLDER_SHARE_ADD_INVITED,tabId:t,folderId:e,invitedProfile:n}),_=(t,e,n,i)=>({type:r.jp.FOLDER_SHARE_REMOVE_COLLABORATORS,tabId:t,folderId:e,removedUids:n,removedEmail:i}),g=(t,e,n)=>({type:r.jp.FOLDER_SHARE_SHOW_DELETE_MODAL,tabId:t,folderId:e,isOwner:n})},2461:(t,e,n)=>{"use strict";n.d(e,{L6:()=>R,Go:()=>N,tb:()=>k,m5:()=>x,g8:()=>U,Sf:()=>D,b9:()=>P,J1:()=>L,Rl:()=>j,wI:()=>H,mt:()=>M,l4:()=>F,t:()=>T,A1:()=>A,o5:()=>C,M8:()=>w});var r=n(5369),i=n(1478),o=n.n(i),s=n(4510),a=n(9297),c=n(5764),u=n(4366),l=n(2714),h=n(9545),d=n(1376),p=n(1856),f=n(1313);const _=(t,e)=>(t=>{var e;return null!==(e=(0,r.D5)(null==t?void 0:t.dataReducer.get(p.Y.nonActiveWebsiteBodyMap)))&&void 0!==e?e:(0,f.Bz)()})(t).get(e);var g=n(3312),v=n(758),m=n(2035),y=n(8880),E=n(8082),I=n(70),b=n(5441),S=n(545);const T=t=>(e,n,{fbInstance:i})=>{(0,c.d0)(i.db,t,(n=>{if(n&&Object.keys(n).length){const i=n.activeFolderPath;if(delete n.activeFolderPath,i&&e((0,s.Gx)(t,i,n)),i&&i.length){const t=(0,r.aV)(i.split("/")).last();if(t){const n=i.replace(/folderIds/g,"folderMetaMap");e(O(t,n))}}}}))},w=t=>(e,n,{fbInstance:r})=>{(0,c.fk)(r.db,t),e((0,s.Er)(t))},O=(t,e)=>async(n,i,{logger:u,fbInstance:l})=>{let h="";if(h=i().dataReducer.get(g.Yh.activeFolderMap).keySeq().first(),h){const t=(0,r.aV)(h.split("/"));h=t.last()}const p=(await chrome.storage.local.get(["noActiveFolderListener"])).noActiveFolderListener;p&&await chrome.storage.local.set({noActiveFolderListener:!1}),h&&h!==t&&n(C(h));h&&h===t&&!(p&&h===t)||(0,c.NE)(l.db,t,(c=>{var l;if(c){let a=i().dataReducer.get(g.Yh.activeFolderPath);const u=i().dataReducer.get(g.Yh.nonActiveWebsiteBodyMap);if(a){const t=(0,r.aV)(a.split("/"));a=t.last()}n((0,s.iL)(t,c,e));const h=Object.keys(null!==(l=null==c?void 0:c.websiteIds)&&void 0!==l?l:{});if(h.length){const e=o()(h,u.keySeq().toArray());if(e.length)n(t===a?(0,d.z0)(e,u):(0,d.z0)(e,(0,r.D5)()));else if(t===a){const t=u.filter(((t,e)=>h.includes(e)));t.count()!==u.count()&&n((0,d.$h)(t))}}else n((0,d.uh)())}else{const t=(0,a.Qq)(i()).keySeq().first();t?n(A(t)):u.errorFromBackgroundScript("subscribeActiveFolderSync",`Failure in setting new active folder: new id is ${t}`)}}))},C=t=>(e,n,{fbInstance:r})=>{(0,c.Yz)(r.db,t),e((0,s.kt)(t))},A=t=>async(e,n,{logger:r,environment:i,fbInstance:o})=>{var s,d;e((0,h.uM)(t,"switch"));try{const p=await(0,I.Nh)(o.auth,!1);if(p){const o=await(0,c.Aw)(i.server.apiPath,p,t);if(o.ok){const r=(0,a.f$)(n());return r!==t&&r&&e(C(r)),e(u.t.trackEvent(m.l.SWITCH_FOLDER,"background",{folderId:t})),void e((0,h.vj)(t,"switch"))}{const{message:n,metadata:{error:i}}=await o.json();return r.logFromBackgroundScript("switchFolder","Failure in switching folder",null!==(s=null==i?void 0:i.message)&&void 0!==s?s:n),e((0,h.RQ)(t,"switch",n)),void(401===o.status&&(r.logFromBackgroundScript("switchFolder","Force logout",null!==(d=null==i?void 0:i.message)&&void 0!==d?d:n),e((0,l.UN)(n))))}}}catch(n){r.errorFromBackgroundScript("switchFolder","Failure in switching folder",n),e((0,h.RQ)(t,"switch"))}},R=(t,e,n)=>async(r,i,{logger:o,environment:a,fbInstance:u})=>{var d,p,f,_;r((0,h.uM)(e,"add"));try{const i=await(0,I.Nh)(u.auth,!1);if(i){const u=await(0,c.OI)(a.server.apiPath,i,e,n);if(u.ok)return r((0,s.Ed)(t)),void r((0,h.vj)(e,"add"));if(400!==u.status){const{message:t,metadata:{error:n}}=await u.json();return o.logFromBackgroundScript("createFolder","Failure in creating folder",null!==(f=null==n?void 0:n.message)&&void 0!==f?f:t),r((0,h.RQ)(e,"add",t)),void(401===u.status&&(o.logFromBackgroundScript("createFolder","Force logout",null!==(_=null==n?void 0:n.message)&&void 0!==_?_:t),r((0,l.UN)(t))))}{const{message:t,metadata:{error:n}}=await u.json();if("MAX_SUBFOLDER_FOR_FREE_USER"===(null==n?void 0:n.code))return o.logFromBackgroundScript("createFolder","Failure in creating folder",null!==(d=null==n?void 0:n.message)&&void 0!==d?d:t),void r((0,h.RQ)(e,"add",null!==(p=null==n?void 0:n.message)&&void 0!==p?p:t))}}}catch(t){o.errorFromBackgroundScript("createFolder","Failure in creating folder",t),r((0,h.RQ)(e,"add"))}},k=(t,e)=>async(n,r,{logger:i,fbInstance:o})=>{var s,a;n((0,h.uM)(e.id,"edit"));try{const r=await(0,I.Nh)(o.auth,!1);if(r){const o=await(0,c.X5)(t,r,e.id,e);if(o.ok)return void n((0,h.vj)(e.id,"edit"));{const{message:t,metadata:{error:r}}=await o.json();return i.logFromBackgroundScript("editFolder","Failure in editing folder",null!==(s=null==r?void 0:r.message)&&void 0!==s?s:t),n((0,h.RQ)(e.id,"edit",t)),void(401===o.status&&(i.logFromBackgroundScript("editFolder","Force logout",null!==(a=null==r?void 0:r.message)&&void 0!==a?a:t),n((0,l.UN)(t))))}}}catch(t){i.errorFromBackgroundScript("editFolder","Failure in editing folder",t),n((0,h.RQ)(e.id,"edit"))}},D=(t,e,n)=>async(r,i,{logger:o,fbInstance:a})=>{var u,d;try{const i=await(0,I.Nh)(a.auth,!1);if(i){const a=await(0,c.bg)(t,i,n);if(a.ok){const{isOwnFolder:t}=await a.json();return void r((0,s.O9)(e,n,t))}{const{message:t,metadata:{error:e}}=await a.json();return o.logFromBackgroundScript("getFolderAccessForDeleteShared","Failure in fetching folder",null!==(u=null==e?void 0:e.message)&&void 0!==u?u:t),r((0,h.RQ)(n,"delete",t)),void(401===a.status&&(o.logFromBackgroundScript("getFolderAccessForDeleteShared","Force logout",null!==(d=null==e?void 0:e.message)&&void 0!==d?d:t),r((0,l.UN)(t))))}}}catch(t){o.errorFromBackgroundScript("getFolderAccessForDeleteShared","Failure in fetching folder access",t),r((0,h.RQ)(n,"delete"))}},N=(t,e)=>async(n,r,{logger:i,fbInstance:o})=>{var s,d;n((0,h.uM)(e,"delete"));try{const u=await(0,I.Nh)(o.auth,!1);if(u){const o=await(0,c.Qi)(t,u,e);if(o.ok){if((0,a.f$)(r())===e){const t=(0,a.Qq)(r()).keySeq().first();t?n(A(t)):i.errorFromBackgroundScript("deleteFolder",`Failure in setting new active folder: new id is ${t}`)}return void n((0,h.vj)(e,"delete"))}{const{message:t,metadata:{error:r}}=await o.json();return i.logFromBackgroundScript("deleteFolder","Failure in deleting folder",null!==(s=null==r?void 0:r.message)&&void 0!==s?s:t),n((0,h.RQ)(e,"delete",t)),void(401===o.status&&(i.logFromBackgroundScript("deleteFolder","Force logout",null!==(d=null==r?void 0:r.message)&&void 0!==d?d:t),n((0,l.UN)(t))))}}}catch(t){n((0,h.RQ)(e,"delete")),i.errorFromBackgroundScript("deleteFolder","Failure in deleting folder",t);const r=(0,S.ro)(t);n(u.t.trackEvent(m.l.DELETE_FOLDER_FAIL,"background",r))}},P=(t,e)=>async(n,r,{logger:i,fbInstance:o})=>{var a,u;try{const r=await(0,I.Nh)(o.auth,!1);if(r){const o=await(0,c.pS)(t,r,e);if(!o.ok){const{message:t,metadata:{error:e}}=await o.json();return i.errorFromBackgroundScript("getFolderHighlightsApi","Failure in fetching highlights",null!==(a=null==e?void 0:e.message)&&void 0!==a?a:t),void(401===o.status&&(i.logFromBackgroundScript("getFolderHighlightsApi","Force logout",null!==(u=null==e?void 0:e.message)&&void 0!==u?u:t),n((0,l.UN)(t))))}{const{highlights:t}=await o.json();if(t){const r=Object.entries(t).map((([t,e])=>{const n=(0,S.rr)(e);return n.id=t,n}));n((0,s.Ac)(e,r))}}}}catch(t){i.errorFromBackgroundScript("getFolderHighlightsApi","Failure in fetching highlights",t)}},L=(t,e,n)=>async(r,i,{logger:o,fbInstance:s})=>{var a,u;r((0,h.iv)()),r((0,h.uM)(e,"move"));try{const i=await(0,I.Nh)(s.auth,!1);if(i){const s=await(0,c.FE)(t,i,e,n);if(s.ok)return void r((0,h.vj)(e,"move"));{const{message:t,metadata:{error:n}}=await s.json();return o.errorFromBackgroundScript("moveFolder","Failure in moving folder",null!==(a=null==n?void 0:n.message)&&void 0!==a?a:t),r((0,h.RQ)(e,"move",t)),void(401===s.status&&(o.logFromBackgroundScript("moveFolder","Force logout",null!==(u=null==n?void 0:n.message)&&void 0!==u?u:t),r((0,l.UN)(t))))}}}catch(t){o.errorFromBackgroundScript("moveFolder","Failure in moving folder",t),r((0,h.RQ)(e,"move"))}},x=(t,e,n)=>async(r,i,{logger:o,environment:a,fbInstance:u})=>{var d,p,f,_;r((0,h.uM)(e,"get_edit"));try{const i=await(0,I.Nh)(u.auth,!1);if(i){const u=await(0,c.YM)(a.server.apiPath,i,e);if(u.ok){const i=await u.json();if(i){const o=(null===(d=i.colorCodes)||void 0===d?void 0:d.length)?i.colorCodes:b.Wy,a=(null===(p=i.colorTags)||void 0===p?void 0:p.length)?i.colorTags:[],c=o.map(((t,e)=>({code:t,name:null!==t?a[e]||"":null}))),u={id:e,title:(null==i?void 0:i.title)||"",colors:c,isShared:n};r((0,s.Bb)(t,u)),r((0,h.vj)(e,"get_edit")),r((0,h.aZ)())}else r((0,h.RQ)(e,"get_edit"));return}{const{message:t,metadata:{error:n}}=await u.json();return o.errorFromBackgroundScript("fetchEditFolder","Failure in fetching edit folder details",null!==(f=null==n?void 0:n.message)&&void 0!==f?f:t),r((0,h.RQ)(e,"get_edit",t)),void(401===u.status&&(o.logFromBackgroundScript("fetchEditFolder","Force logout",null!==(_=null==n?void 0:n.message)&&void 0!==_?_:t),r((0,l.UN)(t))))}}}catch(t){o.errorFromBackgroundScript("fetchEditFolder","Failure in fetching edit folder details",t),r((0,h.RQ)(e,"get_edit"))}},U=(t,e,n,r)=>async(i,o,{logger:a,fbInstance:u})=>{var d,p;i((0,h.uM)(n,"get_share"));try{const o=await(0,I.Nh)(u.auth,!1);if(o){const u=await(0,c.U9)(t,o,n);if(u.ok){const t=await u.json();return i((0,s.IP)(e,{folderId:n,folderTitle:r,collaboratorDetails:t})),i((0,h.vj)(n,"get_share")),void i((0,h.aZ)())}{const{message:t,metadata:{error:e}}=await u.json();return a.errorFromBackgroundScript("fetchShareFolder","Failure in fetching share folder info",null!==(d=null==e?void 0:e.message)&&void 0!==d?d:t),i((0,h.RQ)(n,"get_share",t)),void(401===u.status&&(a.logFromBackgroundScript("fetchShareFolder","Force logout",null!==(p=null==e?void 0:e.message)&&void 0!==p?p:t),i((0,l.UN)(t))))}}}catch(t){a.errorFromBackgroundScript("fetchShareFolder","Failure in fetching share folder info",t),i((0,h.RQ)(n,"get_share"))}},F=(t,e,n,r,i,o,a)=>async(d,p,{logger:f,fbInstance:_})=>{var g,v;d((0,h.uM)(n,"invite_share"));try{const p=await(0,I.Nh)(_.auth,!1);if(!p)return void f.logFromBackgroundScript("sendInviteShareFolder","Unable to fetch token");const y=await(0,c.oc)(t,e,p,n,r,i,o);if(y.ok){const t=await y.json();return d((0,s.dQ)(a,n,t.data)),d((0,h.vj)(n,"invite_share")),void d(u.t.trackEvent(m.l.SHARE_COLLECTION_SUCCESSFUL,"background",{folderId:n,folderName:r,email:i,sender:o}))}{const{message:t,metadata:{error:e}}=await y.json();return f.errorFromBackgroundScript("sendInviteShareFolder","Failure in fetching share folder info",null!==(g=null==e?void 0:e.message)&&void 0!==g?g:t),d((0,h.RQ)(n,"invite_share",t)),void(401===y.status&&(f.logFromBackgroundScript("sendInviteShareFolder","Force logout",null!==(v=null==e?void 0:e.message)&&void 0!==v?v:t),d((0,l.UN)(t))))}}catch(t){f.errorFromBackgroundScript("sendInviteShareFolder","Failure in fetching share folder info",t);const e=(0,S.ro)(t);d(u.t.trackEvent(m.l.COLLABORATION_FAIL,"background",e)),d((0,h.RQ)(n,"invite_share"))}},M=(t,e,n,r,i,o,u)=>async(d,p,{logger:f,fbInstance:_})=>{d((0,h.uM)(n,"remove_share"));try{const g=await(0,I.Nh)(_.auth,!1);if(g){const _=[];i.length>0&&_.push((0,c.BX)(t,e,g,n,i)),o.length>0&&_.push((0,c.Sf)(t,e,g,n,o));const v=await Promise.all(_);if(v.every((t=>t.ok))){d((0,s.Yi)(u,n,i,o)),d((0,h.vj)(n,"remove_share"));const t=(0,a.f$)(p());if(n===t&&!r){const t=(0,a.Qq)(p()).keySeq().filter((t=>t!=n)).first();t&&(d(A(t)),d((0,y.Xg)(u)))}return}{const t=v[0],{message:e,metadata:{error:r}}=await t.json();return f.errorFromBackgroundScript("removeCollaboratorsShareFolder","Failure in removing collaborator in the folder",r),d((0,h.RQ)(n,"remove_share",e)),void(401===t.status&&(f.logFromBackgroundScript("remove_share","Force logout",r),d((0,l.UN)(e))))}}}catch(t){f.errorFromBackgroundScript("removeCollaboratorsShareFolder","Failure in removing collaborator in the folder",t),d((0,h.RQ)(n,"remove_share"))}},H=(t,e,n,r)=>async(i,o,{logger:a,fbInstance:u})=>{var d,p;i((0,h.iv)());try{const f=await(0,I.Nh)(u.auth,!1),g=_(o(),r),v=null==g?void 0:g.toJS().url,m=(0,S.Ze)(v||"")?"pdf":"website";if(f){const o=await(0,c.d7)(t,f,e,n,r);if(o.ok){const{colorTags:t,colorCodes:a}=await o.json();return i((0,s.h)(e,n,a,t,r)),void i((0,h.Gf)(m,r,e,n,"move"))}{const{message:t,metadata:{error:e}}=await o.json();return a.errorFromBackgroundScript("moveWebsite","Failure in moving website",null!==(d=null==e?void 0:e.message)&&void 0!==d?d:t),i((0,h.yt)("website",r,"move",t)),void(401===o.status&&(a.logFromBackgroundScript("moveWebsite","Force logout",null!==(p=null==e?void 0:e.message)&&void 0!==p?p:t),i((0,l.UN)(t))))}}}catch(t){a.errorFromBackgroundScript("moveWebsite","Failure in moving website",t),i((0,h.yt)("website",r,"move"))}},j=(t,e,n,r)=>async(i,o,{logger:a,environment:u,fbInstance:d})=>{var p,f;i((0,h.iv)());try{const o=await(0,I.Nh)(d.auth,!1);if(o){const d=await(0,c.Rn)(u.server.apiPath,o,t,e,n,r);if(d.ok){const{highlight:o}=await d.json();i((0,s.KT)(r,n,(0,S.rr)(o))),i((0,h.zU)(r,t,e,n,"move","highlight"));const a={type:E.iz.SEND_MESSAGE_TO_IFRAME_IN_WEBAPP,action:v.lw.MOVE_HIGHLIGHT,payload:{websiteId:n,highlight:o,highlightId:r}};return void(0,S.lH)(a)}{const{message:t,metadata:{error:e}}=await d.json();return a.errorFromBackgroundScript("moveHighlight","Failure in moving highlight",null!==(p=null==e?void 0:e.message)&&void 0!==p?p:t),i((0,h.IT)(r,"move",t)),void(401===d.status&&(a.logFromBackgroundScript("moveHighlight","Force logout",null!==(f=null==e?void 0:e.message)&&void 0!==f?f:t),i((0,l.UN)(t))))}}}catch(t){a.errorFromBackgroundScript("moveHighlight","Failure in moving highlight",t),i((0,h.IT)(r,"move"))}}},9297:(t,e,n)=>{"use strict";n.d(e,{Qq:()=>c,XW:()=>a,f$:()=>s});var r=n(1856),i=n(1313);const o=t=>{var e,n;return null!==(n=null===(e=null==t?void 0:t.dataReducer)||void 0===e?void 0:e.get(r.Y.activeFolderMap,(0,i.sH)()))&&void 0!==n?n:(0,i.sH)()},s=t=>{var e;return null===(e=o(t))||void 0===e?void 0:e.keySeq().first()},a=t=>o(t).toSeq().first(),c=t=>{var e;return null!==(e=null==t?void 0:t.dataReducer.get(r.Y.folderMetadataMap))&&void 0!==e?e:(0,i.qF)()}},5764:(t,e,n)=>{"use strict";n.d(e,{Aw:()=>c,BX:()=>y,FE:()=>f,NE:()=>s,OI:()=>u,Qi:()=>h,Rn:()=>I,Sf:()=>m,U9:()=>g,X5:()=>l,YM:()=>_,Yz:()=>a,bg:()=>d,d0:()=>i,d7:()=>E,fk:()=>o,oc:()=>v,pS:()=>p});var r=n(8679);n(3877);const i=(t,e,n)=>{const i=`users/${e}/folderIds/`;(0,r.jM)((0,r.iH)(t,i),(t=>{n(t.val())}))},o=(t,e)=>{const n=`users/${e}/folderIds/`;(0,r.S1)((0,r.iH)(t,n))},s=(t,e,n)=>{const i=`folders/${e}/`;(0,r.jM)((0,r.iH)(t,i),(t=>{n(t.val())}))},a=(t,e)=>{const n=`folders/${e}/`;(0,r.S1)((0,r.iH)(t,n))},c=async(t,e,n)=>{const r={token:e};return await fetch(`${t}/users/folders/switch/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})},u=async(t,e,n,i)=>{const o={token:e,data:{title:i,createDate:(0,r.Bt)()}},s=n&&n.length>0?`${t}/2/folders/${n}`:`${t}/2/folders`;return await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})},l=async(t,e,n,r)=>{const i=[],o=[];r.colors.forEach(((t,e)=>{i[e]=t.code,o[e]=t.name}));const s={token:e,title:r.title,colorCodes:i,colorTags:o},a=`${t}/2/folders/${n}`;return await fetch(a,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})},h=async(t,e,n)=>{const r=`${t}/2/folders/${n}?token=${e}`;return await fetch(r,{method:"DELETE",headers:{"Content-Type":"application/json"}})},d=async(t,e,n)=>{const r=`${t}/2/folders/${n}/access?token=${e}`;return await fetch(r,{method:"GET",headers:{"Content-Type":"application/json"}})},p=async(t,e,n)=>{const r=`${t}/2/folders/${n}/highlights?token=${e}`;return await fetch(r,{method:"GET",headers:{"Content-Type":"application/json"}})},f=async(t,e,n,r)=>{const i={token:e},o=`${t}/2/folders/${n}/move/${r}`;return await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})},_=async(t,e,n)=>{const r=`${t}/2/folders/${n}/details?token=${e}`;return await fetch(r,{method:"GET",headers:{"Content-Type":"application/json"}})},g=async(t,e,n)=>{const r=`${t}/2/folders/${n}/collaboration?token=${e}`;return await fetch(r,{method:"GET",headers:{"Content-Type":"application/json"}})},v=async(t,e,n,r,i,o,s)=>{const a={email:o,collectionTitle:i,senderDisplayName:s,environment:e,token:n},c=`${t}/2/folders/${r}/collaboration/invite`;return await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})},m=async(t,e,n,r,i)=>{const o={emails:i,environment:e,token:n},s=`${t}/2/folders/${r}/collaboration/invite`;return await fetch(s,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})},y=async(t,e,n,r,i)=>{const o={uids:i,environment:e,token:n},s=`${t}/2/folders/${r}/collaboration`;return await fetch(s,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})},E=async(t,e,n,r,i)=>{const o={token:e},s=`${t}/2/folders/${n}/move/${r}/websites/${i}`;return await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})},I=async(t,e,n,r,i,o)=>{const s={token:e},a=`${t}/2/folders/${n}/move/${r}/websites/${i}/highlights/${o}`;return await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})}},179:(t,e,n)=>{"use strict";n.d(e,{p:()=>a,u:()=>u});var r=n(5369),i=n(8785),o=n(1856),s=n(1316);const a={showFolderCreateField:(0,r.D5)(),showFolderEditPanel:(0,r.D5)(),showFolderSharePanel:(0,r.D5)(),showFolderShareDeleteModal:(0,r.D5)()},c=(0,r.d0)(a),u=(t=c,e)=>{const n=t;switch(e.type){case i.jp.FOLDER_EDIT_SHOW_MODAL:return n.setIn([o.Y.showFolderEditPanel,e.tabId.toString()],e.folder);case i.jp.FOLDER_EDIT_HIDE_MODAL:return n.removeIn([o.Y.showFolderEditPanel,e.tabId.toString()]);case i.jp.FOLDER_SHARE_SHOW_MODAL:return n.setIn([o.Y.showFolderSharePanel,e.tabId.toString()],e.folder);case i.jp.FOLDER_SHARE_ADD_INVITED:{const t=n.getIn([o.Y.showFolderSharePanel,e.tabId.toString()]),i=(0,r.D5)(t).toJS();return i.folderId===e.folderId&&i.collaboratorDetails.invited.push(e.invitedProfile),n.setIn([o.Y.showFolderSharePanel,e.tabId.toString()],Object.assign({},i))}case i.jp.FOLDER_SHARE_REMOVE_COLLABORATORS:{const t=n.getIn([o.Y.showFolderSharePanel,e.tabId.toString()]),i=(0,r.D5)(t).toJS();return i&&i.folderId===e.folderId&&(e.removedUids.forEach((t=>{const e=i.collaboratorDetails.profiles.findIndex((e=>e.uid===t));e>-1&&i.collaboratorDetails.profiles.splice(e,1)})),e.removedEmail.forEach((t=>{const e=i.collaboratorDetails.invited.findIndex((e=>e.email===t));e>-1&&i.collaboratorDetails.invited.splice(e,1)}))),n.setIn([o.Y.showFolderSharePanel,e.tabId.toString()],Object.assign({},i))}case i.jp.FOLDER_SHARE_HIDE_MODAL:return n.removeIn([o.Y.showFolderSharePanel,e.tabId.toString()]);case i.jp.FOLDER_SHOW_CREATE_FIELD:return n.setIn([o.Y.showFolderCreateField,e.tabId.toString()],e.folderId);case i.jp.FOLDER_HIDE_CREATE_FIELD:return n.removeIn([o.Y.showFolderCreateField,e.tabId.toString()]);case i.jp.FOLDER_SHARE_SHOW_DELETE_MODAL:return n.setIn([o.Y.showFolderShareDeleteModal,e.tabId.toString()],{folderId:e.folderId,isOwner:e.isOwner});case i.jp.FOLDER_SHARE_HIDE_DELETE_MODAL:return n.removeIn([o.Y.showFolderShareDeleteModal,e.tabId.toString()]);case s.x.USER_LOGGED_OUT_SUCCESS:return c;default:return n}}},841:(t,e,n)=>{"use strict";n.d(e,{pd:()=>r.p});n(4510),n(2461),n(5764);var r=n(179),i=n(573),o=n(5369);const s=t=>t?(0,o.D5)(t.dataReducer.folderMetadataMap):(0,o.D5)(),a=t=>{if(!t||!t.folderMetaMap)return[];const e=t=>{const n=Object.keys(t),r=Object.values(t);let i=n;return r.forEach((t=>{const n=t.folderMetaMap;i=i.concat(e(n))})),i};return e(t.folderMetaMap)};(0,i.P1)(s,(t=>{let e=[];const n=t.keys();e=e.concat([...n]);for(const n of t.values())e=e.concat(a(n));return e})),(0,i.P1)(s,(t=>{let e=[];for(const n of t.values())e=e.concat(a(n));return e.length}))},8880:(t,e,n)=>{"use strict";n.d(e,{Am:()=>O,nm:()=>S,Sn:()=>_,c5:()=>b,WC:()=>y,YJ:()=>I,CO:()=>C,lD:()=>g,Xg:()=>v,Th:()=>m,W$:()=>E,uP:()=>A});var r=n(5369);var i=n(9297),o=n(4366),s=n(9545),a=n(9600),c=n(2714),u=n(1376),l=n(3312),h=n(2035),d=n(9533),p=n(70),f=n(545);const _=(t,e,n)=>({type:l.vQ.DELETE_HIGHLIGHT,folderId:t,websiteId:e,highlightId:n}),g=(t,e)=>({type:l.vQ.DELETE_MULTIPLE_HIGHLIGHTS,folderId:t,deletedIds:e}),v=t=>({type:l.vQ.RESET_HIGHLIGHTS,tabId:t}),m=(t,e,n)=>({type:l.vQ.ADD_HIGHLIGHT_NOTE,websiteId:t,highlightId:e,note:n}),y=(t,e)=>({type:l.vQ.DELETE_HIGHLIGHT_NOTE,websiteId:t,highlightId:e}),E=(t,e,n)=>async(r,i,{logger:o,environment:a,fbInstance:u})=>{var h,_;try{const i=await(0,p.Nh)(u.auth,!1);if(i){const u=await(async(t,e,n,r,i)=>{const o=`${t}/2/websites/${n}/highlights/${r}/note?token=${e}`,s={data:{note:i}};return await fetch(o,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})})(a.server.apiPath,i,t,e,n);if(u.ok){r(m(t,e,n)),r((0,s.XE)(t,e,"add"));const i={type:d.iz.SEND_MESSAGE_TO_IFRAME_IN_WEBAPP,action:l.vQ.ADD_HIGHLIGHT_NOTE,payload:{websiteId:t,highlightId:e,note:n}};return void(0,f.lH)(i)}{const{message:n,metadata:{error:i}}=await u.json();return o.logFromBackgroundScript("saveHighlightNoteApi","Failure in saving highlight note",null!==(h=null==i?void 0:i.message)&&void 0!==h?h:n),r((0,s.yw)(t,e,"add",n)),void(401===u.status&&(o.logFromBackgroundScript("saveHighlightNoteApi","Force logout",null!==(_=null==i?void 0:i.message)&&void 0!==_?_:n),r((0,c.UN)(n))))}}}catch(t){o.logFromBackgroundScript("saveHighlightNoteApi","Failure in saving highlight note",t)}r((0,s.yw)(t,e,"add"))},I=(t,e)=>async(n,r,{logger:i,environment:o,fbInstance:a})=>{try{const r=await(0,p.Nh)(a.auth,!1);if(r){const a=await(async(t,e,n,r)=>{const i=`${t}/2/websites/${n}/highlights/${r}/note?token=${e}`;return await fetch(i,{method:"DELETE",headers:{"Content-Type":"application/json"}})})(o.server.apiPath,r,t,e);if(a.ok){n(y(t,e)),n((0,s.zU)(e,null,null,t,"delete","note"));const r={type:d.iz.SEND_MESSAGE_TO_IFRAME_IN_WEBAPP,action:l.vQ.DELETE_HIGHLIGHT_NOTE,payload:{websiteId:t,highlightId:e}};return void(0,f.lH)(r)}{const{message:r,metadata:{error:o}}=await a.json();return i.logFromBackgroundScript("deleteHighlightNoteApi","Failure in deleting highlight note",o),n((0,s.yw)(t,e,"delete",r)),void(401===a.status&&(i.logFromBackgroundScript("deleteHighlightNoteApi","Force logout",o),n((0,c.UN)(r))))}}}catch(t){i.logFromBackgroundScript("deleteHighlightNoteApi","Failure in deleting highlight note",t)}n((0,s.yw)(t,e,"delete"))},b=(t,e,n,r=!1)=>async(i,o,{logger:a,environment:u,fbInstance:h})=>{i((0,s.bz)(n,"delete","highlight"));let g=`Delete ${r?"image":"highlight"}`;try{const r=await(0,p.Nh)(h.auth,!1);if(r){const o=await(async(t,e,n,r)=>{const i=`${t}/2/websites/${n}/highlights/${r}?token=${e}`;return await fetch(i,{method:"DELETE",headers:{"Content-Type":"application/json"}})})(u.server.apiPath,r,e,n);if(o.ok){i(_(t,e,n)),g=`${g} successfully.`,i((0,s.zU)(n,t,t,e,"delete","highlight",g));const r={type:d.iz.SEND_MESSAGE_TO_IFRAME_IN_WEBAPP,action:l.vQ.DELETE_HIGHLIGHT,payload:{folderId:t,websiteId:e,highlightId:n}};return void(0,f.lH)(r)}{const{message:t,metadata:{error:e}}=await o.json();return a.logFromBackgroundScript("deleteHighlightApi","Failure in deleting highlight",e),i((0,s.IT)(n,"delete",t)),void(401===o.status&&(a.logFromBackgroundScript("deleteHighlightApi","Force logout",e),i((0,c.UN)(t))))}}}catch(t){a.logFromBackgroundScript("deleteHighlightApi","Failure in deleting highlight",t)}i((0,s.IT)(n,"delete",`${g} Failed`))},S=(t,e,n,o,s,c)=>async(l,h,{fbInstance:d})=>{var _,g;const v=h(),m=v.dataReducer,y=(0,i.XW)(v),E=(0,f.fX)(m);if(E){let i=(0,f.dY)(m,e),v=!1;if(i||(v=!0,i=(0,p.HC)(d.db)),s.creator=(0,a.n5)(h()),v)l((0,u.Sn)(E,e,n,c,i,o,s));else{const e=(null===(g=null===(_=(0,r.D5)(y).get("websiteIds"))||void 0===_?void 0:_.get(i))||void 0===g?void 0:g.get("url"))||"";l(w(t,i,o,s,e))}}},T=(t,e)=>{const n=new Error(e||t.statusText);return n.status=t.status,(0,f.ro)(n)},w=(t,e,n,r,i)=>async(a,u,{logger:_,environment:g,fbInstance:v})=>{a((0,s.bz)(n,"add","highlight"));try{const u=await(0,p.Nh)(v.auth,!1);if(u){const p=await(async(t,e,n,r,i,o,s)=>{const a=`${t}/2/websites/${r}/highlights/${i}?token=${e}`,c={data:{folderId:n,websiteUrl:s,highlight:o}};return await fetch(a,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})})(g.server.apiPath,u,t,e,n,r,i),v=await p.json();if(p.ok){a(((t,e,n,r)=>({type:l.vQ.ADD_HIGHLIGHT,folderId:t,websiteId:e,highlightId:n,highlight:r}))(t,e,n,r));const i={type:d.iz.SEND_MESSAGE_TO_IFRAME_IN_WEBAPP,action:l.vQ.ADD_HIGHLIGHT,payload:Object.assign({folderId:t},v)};return(0,f.lH)(i),void a((0,s.rp)())}{const{message:t,metadata:{error:e}}=await p.json();return _.logFromBackgroundScript("createHighlightApi","Failure in saving highlight",e),a(o.t.trackEvent(h.l.CREATE_HIGHLIGHT_ERROR,"background",T(p,t))),a((0,s.rp)()),void(401===p.status&&(_.logFromBackgroundScript("createHighlightApi","Force logout",e),a((0,c.UN)(t))))}}}catch(t){_.logFromBackgroundScript("createHighlightApi","Failure in saving highlight",t);const e=(0,f.ro)(t);o.t.trackEvent(h.l.CREATE_HIGHLIGHT_ERROR,"background",e)}a((0,s.rp)())},O=(t,e,n,r,i,s)=>async(a,u,{logger:d,environment:_,fbInstance:g})=>{try{const u=await(0,p.Nh)(g.auth,!1);if(u){const p=await(async(t,e,n,r)=>{const i=`${t}/2/image?token=${e}`,o={data:{imageId:n,base64String:r}};return await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})})(_.server.apiPath,u,t,e);if(p.ok)return a((t=>({type:l.vQ.ADD_IMAGE_HIGHLIGHT,highlightId:t}))(t)),a(S(n,f.V8.normalizeUrl(r.url)||r.url,r.title,t,i,s)),void a(o.t.trackEvent(h.l.DROP_IMAGE_SUCCESS,"background"));{const{message:t,metadata:{error:e}}=await p.json();return d.logFromBackgroundScript("createImageHighlightApi","Failure in saving image highlight to cloudstorage",e),a(o.t.trackEvent(h.l.DROP_IMAGE_FAIL,"background",T(p,t))),void(401===p.status&&(d.logFromBackgroundScript("createImageHighlightApi","Force logout",e),a((0,c.UN)(t))))}}a(o.t.trackEvent(h.l.DROP_IMAGE_FAIL,"background",{error:"Unable to get token"}))}catch(t){d.logFromBackgroundScript("createImageHighlightApi","Failure in saving image highlight to cloudstorage",t);const e=(0,f.ro)(t);a(o.t.trackEvent(h.l.DROP_IMAGE_FAIL,"background",e))}},C=(t,e)=>async(n,r,{logger:i,fbInstance:s})=>{try{const r=await(0,p.Nh)(s.auth,!1);if(r){const s=await(async(t,e,n)=>{const r=`${t}/2/image/delete?token=${e}`,i={data:{imageId:[n]}};return await fetch(r,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})})(t,r,e);if(s.ok)return n((t=>({type:l.vQ.DELETE_IMAGE_HIGHLIGHT,highlightId:t}))(e)),void n(o.t.trackEvent(h.l.DELETE_IMAGE_SUCCESS,"background"));{const{message:t,metadata:{error:e}}=await s.json();return i.logFromBackgroundScript("deleteImageHighlightToStorage","Failure in deleting image highlight from googlecloud storage",e),n(o.t.trackEvent(h.l.DELETE_IMAGE_FAIL,"background",T(s,t))),void(401===s.status&&(i.logFromBackgroundScript("deleteImageHighlightToStorage","Force logout",e),n((0,c.UN)(t))))}}n(o.t.trackEvent(h.l.DELETE_IMAGE_FAIL,"background",{error:"Unable to get token"}))}catch(t){i.logFromBackgroundScript("deleteImageHighlightToStorage","Failure in deleting image highlight from googlecloud storage",t);const e=(0,f.ro)(t);n(o.t.trackEvent(h.l.DELETE_IMAGE_FAIL,"background",e))}},A=(t,e,n,r,i)=>async(o,a,{logger:u,environment:h,fbInstance:_})=>{o((0,s.bz)(r,"edit","highlight"));try{const a=await(0,p.Nh)(_.auth,!1);if(!a)return u.logFromBackgroundScript("updateHighlightApi","Unable to fetch token"),void o((0,s.IT)(r,"edit"));const g=await(async(t,e,n,r,i,o)=>{const s=`${t}/2/websites/${r}/highlights/${i}?token=${e}`,a={data:{highlight:{colorNum:o}}};return await fetch(s,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})})(h.server.apiPath,a,0,n,r,i);if(g.ok){o(((t,e,n,r,i)=>({type:l.vQ.UPDATE_HIGHLIGHT_COLOR,tabId:t,folderId:e,websiteId:n,highlightId:r,colorNum:i}))(t,e,n,r,i));const a={type:d.iz.SEND_MESSAGE_TO_IFRAME_IN_WEBAPP,action:l.vQ.UPDATE_HIGHLIGHT_COLOR,payload:{folderId:e,websiteId:n,highlightId:r,colorNum:i}};return(0,f.lH)(a),void o((0,s.rp)())}{const{message:t,metadata:{error:e}}=await g.json();return u.logFromBackgroundScript("updateHighlightApi","Failure in updating highlight",e),o((0,s.IT)(r,"edit",t)),void(401===g.status&&(u.logFromBackgroundScript("updateHighlightApi","Force logout",e),o((0,c.UN)(t))))}}catch(t){u.logFromBackgroundScript("updateHighlightApi","Failure in updating highlight",t),o((0,s.IT)(r,"edit"))}}},4178:(t,e,n)=>{"use strict";n.d(e,{k:()=>u,l:()=>a});var r=n(5369),i=n(1316),o=n(578),s=n(1856);const a={enableHighlightMode:o.Rs.enableHighlightMode,highlightColor:(0,r.D5)()},c=(0,r.d0)(a).toMap(),u=(t=c,e)=>{const n=t;switch(e.type){case o.xs.UPDATE_HIGHLIGHT_MODE_SHORTCUT:return n.set(s.Y.enableHighlightMode,e.keyMap);case o.xs.UPDATE_HIGHLIGHT_COLOR_SHORTCUT:return n.setIn([s.Y.highlightColor,e.tabId.toString()],e.colorNum);case i.x.USER_LOGGED_OUT_SUCCESS:return c;default:return n}}},9896:(t,e,n)=>{"use strict";n.d(e,{lP:()=>s.l,RN:()=>i,lS:()=>o});var r=n(3312);const i=t=>({type:r.xs.UPDATE_HIGHLIGHT_MODE_SHORTCUT,keyMap:t}),o=(t,e)=>({type:r.xs.UPDATE_HIGHLIGHT_COLOR_SHORTCUT,colorNum:e,tabId:t});var s=n(4178)},141:(t,e,n)=>{"use strict";n.d(e,{B:()=>l,W:()=>c});var r=n(5369),i=n(9817),o=n(1316),s=n(7752),a=n(1856);const c={iconPathStatus:(0,r.D5)()},u=(0,r.d0)(c).toMap(),l=(t=u,e)=>{const n=(0,r.D5)(t),c=n.get(a.Y.iconPathStatus);switch(e.type){case s.B.UPDATE_ICON:return e.icon.isBanned?n.setIn([a.Y.iconPathStatus,e.icon.tabId.toString()],i.qP.BANNED):e.enabled?n.setIn([a.Y.iconPathStatus,e.icon.tabId.toString()],i.qP.ON):n.setIn([a.Y.iconPathStatus,e.icon.tabId.toString()],i.qP.OFF);case s.K.ENABLE_HIGHLIGHT_MODE:return e.enabled||void 0===e.enabled?n.set(a.Y.iconPathStatus,c.map((()=>i.qP.ON))):n.set(a.Y.iconPathStatus,c.map((()=>i.qP.OFF)));case s.B.REMOVE_ICON_STATUS:return n.deleteIn([a.Y.iconPathStatus,e.icon.tabId.toString()]);case o.x.USER_LOGGED_OUT_SUCCESS:return u;default:return n}}},4743:(t,e,n)=>{"use strict";n.d(e,{Io:()=>s,d2:()=>o,oU:()=>i});var r=n(9845);const i=t=>({type:r.iv.LOADING,loading:t}),o=t=>({type:r.iv.COUNT,count:t}),s=t=>({type:r.iv.UPDATE_TIME,updateCountAfter:t})},3985:(t,e,n)=>{"use strict";n.d(e,{G:()=>a,e:()=>u});var r=n(5369),i=n(9845),o=n(1316),s=n(1856);const a={notificationCount:0,notificationUpdateTime:0,notificationLoading:!1,notificationInfo:[],notificationActiveTab:1,notificationRemove:null,notificationSubscribe:!1,notificationSubscribeError:null,notificationSelected:null,notificationFolderSelected:null},c=(0,r.d0)(a).toMap(),u=(t=c,e)=>{let n=t;switch(e.type){case i.iv.LOADING:return n.set(s.Y.notificationLoading,e.loading);case i.iv.CHANGE_TAB:return n.set(s.Y.notificationActiveTab,e.activeTab||1);case i.iv.REMOVE:{let t=(0,r.aV)(n.get(s.Y.notificationInfo));return t=t.filter((t=>t.id!==e.id)),n=n.set(s.Y.notificationInfo,t),n}case i.iv.MARK_READ:{let t=(0,r.aV)(n.get(s.Y.notificationInfo));const i=t.find((t=>t.id===e.id));if(i){let t=n.get(s.Y.notificationCount,0);!i.read&&e.read?t--:i.read&&!e.read&&t++,t<0&&(t=0),n=n.set(s.Y.notificationCount,t)}return t=t.map((t=>t.id===e.id?Object.assign(Object.assign({},t),{read:e.read}):t)),n.set(s.Y.notificationInfo,t)}case i.iv.SUBSCRIBE:return n.set(s.Y.notificationSubscribe,e.subscribe);case i.iv.SUBSCRIBE_FAILED:return n.set(s.Y.notificationSubscribeError,e.error);case i.iv.SELECTED:return n.set(s.Y.notificationSelected,e.selected);case i.iv.FOLDER_SELECTED:return n.set(s.Y.notificationFolderSelected,e.selected);case i.iv.COUNT:return n.set(s.Y.notificationCount,e.count);case i.iv.UPDATE_TIME:return n.set(s.Y.notificationUpdateTime,e.updateCountAfter||Date.now()+i.RF);case i.iv.INFO:if(e.info){const t=e.info;return n=n.set(s.Y.notificationInfo,t.info),n=n.set(s.Y.notificationUpdateTime,t.updateCountAfter||Date.now()+i.RF),n.set(s.Y.notificationCount,t.count)}return n;case o.x.USER_LOGGED_OUT_SUCCESS:return c;default:return n}}},9158:(t,e,n)=>{"use strict";n.d(e,{Bo:()=>i});var r=n(3312);const i=t=>{var e;return null!==(e=null==t?void 0:t.optionsStateReducer.get(r.Yh.enableHighlightMode))&&void 0!==e&&e}},9956:(t,e,n)=>{"use strict";n.d(e,{HN:()=>r.HN,gP:()=>r.gP,pG:()=>i.p,vY:()=>r.vY});var r=n(3569),i=n(3420)},3569:(t,e,n)=>{"use strict";n.d(e,{HN:()=>o,gP:()=>i,vY:()=>s});var r=n(3312);const i=t=>({type:r.KE.ENABLE_HIGHLIGHT_MODE,enabled:t}),o=(t,e)=>({type:r.KE.CREATE_HIGHLIGHT,tabId:t,colorNum:e}),s=t=>({type:r.KE.READ_LATER,enabled:t})},3420:(t,e,n)=>{"use strict";n.d(e,{H:()=>u,p:()=>a});var r=n(5369),i=n(7752),o=n(1856),s=n(1316);const a={enableHighlightMode:!0,showFolderPane:!1,highlightColor:(0,r.D5)(),readLaterClicked:!1},c=(0,r.d0)(a).toMap(),u=(t=c,e)=>{const n=t;switch(e.type){case i.K.ENABLE_HIGHLIGHT_MODE:return n.set(o.Y.enableHighlightMode,e.enabled);case i.K.SHOW_FOLDER_PANE:return n.set(o.Y.showFolderPane,e.enabled);case i.K.CREATE_HIGHLIGHT:return n.setIn([o.Y.highlightColor,e.tabId.toString()],e.colorNum);case i.K.RESET_HIGHLIGHT_COLOR:return n.setIn([o.Y.highlightColor,e.tabId.toString()],null);case i.K.READ_LATER:return n.set(o.Y.readLaterClicked,e.enabled);case s.x.USER_LOGGED_OUT_SUCCESS:return c;default:return n}}},5181:(t,e,n)=>{"use strict";n.d(e,{c7:()=>i.c,sT:()=>r.sT});var r=n(6533),i=n(9922)},6533:(t,e,n)=>{"use strict";n.d(e,{wK:()=>f,W:()=>d,sT:()=>p,PS:()=>l,xp:()=>h});var r=n(9545),i=n(2714),o=n(3312),s=n(9533),a=n(9769),c=n(70),u=n(545);const l=(t,e)=>({type:o.XO.PDF_MODE,tabId:t,mode:e}),h=(t,e)=>({type:o.XO.PDF_PAGE_NUMBER,tabId:t,pdfPageNumber:e}),d=()=>(t,e,{logger:n})=>{chrome.storage.sync.get([a.L.autoPdf],(r=>{var i,s,a;if(chrome.runtime.lastError)n.errorFromBackgroundScript("getAutoPdfFromStorage","Error getting autoPdf from chrome.storage.sync",null===(i=chrome.runtime.lastError)||void 0===i?void 0:i.message);else{const i=null!==(s=r.autoPdf)&&void 0!==s?s:e().pdfReducer.get(o.Yh.autoPdf);n.logFromBackgroundScript("getAutoPdfFromStorage","setting autopdf in store",i),t((a=i,{type:o.XO.AUTO_PDF,enabled:a})),n.logFromBackgroundScript("getAutoPdfFromStorage","Getting autopdf from chrome.storage",i)}}))},p=t=>(e,n,{logger:r})=>{const i={[a.L.autoPdf]:t};return new Promise(((t,e)=>{chrome.storage.sync.set(i,(()=>{var n;chrome.runtime.lastError?(r.errorFromBackgroundScript("setAndSaveAutoPdfToStorage","Error saving autoPdf to chrome.storage.sync but it was updated in redux store",null===(n=chrome.runtime.lastError)||void 0===n?void 0:n.message),e()):(r.logFromBackgroundScript("setAndSaveAutoPdfToStorage","Save autopdf to chrome.storage",i),t())}))}))},f=(t,e,n)=>async(a,l,{logger:h,environment:d,fbInstance:p})=>{try{const l=await(0,c.Nh)(p.auth,!1);if(l){const c=await(async(t,e,n,r,i)=>{const o={token:e,data:{websiteId:r,folderId:n,isHostedPdf:i}},s=`${t}/2/users/storage/pdf`;return await fetch(s,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})})(d.server.apiPath,l,t,e,n);if(c.ok){a(((t,e)=>({type:o.XO.DELETE_PDF_FROM_STORAGE,folderId:t,websiteId:e}))(t,e));const n={type:s.iz.SEND_MESSAGE_TO_IFRAME_IN_WEBAPP,action:o.TQ.WEBSITE_UPDATE,payload:{folderId:t,websiteIds:[e]}};return(0,u.lH)(n),void a((0,r.Gf)("pdf",e,t,"","delete"))}{const{message:t,metadata:{error:n}}=await c.json();h.logFromBackgroundScript("deletePdfFromStorageApi","Failure in deleting PDF from storage",n),a((0,r.yt)("pdf",e,"delete",t,+c.status)),401===c.status&&(h.logFromBackgroundScript("deletePdfFromStorageApi","Force logout",n),a((0,i.UN)(t)))}}}catch(t){h.logFromBackgroundScript("deletePdfFromStorageApi","Failure in deleting PDF from storage"),a((0,r.yt)("pdf",e,"delete","Failed to delete PDF"))}}},9922:(t,e,n)=>{"use strict";n.d(e,{c:()=>s,p:()=>c});var r=n(5369),i=n(8558),o=n(1856);const s={autoPdf:!0,pdfMode:(0,r.D5)(),pdfPageNumber:(0,r.D5)(),pdfRender:(0,r.D5)()},a=(0,r.d0)(s).toMap(),c=(t=a,e)=>{var n;const s=t;switch(e.type){case i.X.AUTO_PDF:return s.set(o.Y.autoPdf,e.enabled);case i.X.PDF_MODE:return s.setIn([o.Y.pdfMode,e.tabId.toString()],e.mode);case i.X.PDF_PAGE_NUMBER:return s.setIn([o.Y.pdfPageNumber,e.tabId.toString()],e.pdfPageNumber);case i.X.PDF_RENDER_HIGHLIGHT:{const{tabId:t,pageRendered:i}=e;let a=null!==(n=s.getIn([o.Y.pdfRender,t.toString()]))&&void 0!==n?n:(0,r.l4)();return a.has(i)||(a=a.add(i)),s.setIn([o.Y.pdfRender,e.tabId.toString()],a)}case i.X.PDF_RESET_RENDER_HIGHLIGHT:return s.setIn([o.Y.pdfRender,e.tabId.toString()],(0,r.l4)());default:return s}}},5241:(t,e,n)=>{"use strict";n.d(e,{xr:()=>i.x,e3:()=>r.e3});var r=n(251),i=n(250),o=n(5369);(0,n(573).P1)([t=>t?(0,o.D5)(t.popoverStateReducer.showPopover):(0,o.D5)(),(t,e)=>e],((t,e)=>t.get(e)))},251:(t,e,n)=>{"use strict";n.d(e,{e3:()=>c,t2:()=>u});var r=n(5764),i=(n(3569),n(6670),n(569)),o=n(2714),s=n(8805),a=n(70);const c=(t,e)=>({type:s.$.SHOW_COLOR_POPOVER,tabId:t,show:e}),u=(t,e)=>async(n,s,{logger:c,fbInstance:u})=>{n((0,i.uM)(e.id,"edit"));try{const s=await(0,a.Nh)(u.auth,!1);if(s){const a=await(0,r.X5)(t,s,e.id,e);if(a.ok)return void n((0,i.vj)(e.id,"edit"));{const{message:t,metadata:{error:r}}=await a.json();return c.logFromBackgroundScript("updateColorsFromPopover","Failure in editing folder",r),n((0,i.RQ)(e.id,"edit",t)),void(401===a.status&&(c.logFromBackgroundScript("updateColorsFromPopover","Force logout",r),n((0,o.UN)(t))))}}}catch(t){c.logFromBackgroundScript("updateColorsFromPopover","Failure in updating colors",t)}n((0,i.RQ)(e.id,"edit"))}},250:(t,e,n)=>{"use strict";n.d(e,{K:()=>h,x:()=>u});var r=n(5369),i=n(8805),o=n(7752),s=n(5910),a=n(1316),c=n(1856);const u={showPopover:(0,r.D5)(),showEditColorModePopover:(0,r.D5)(),showSettingsModePopover:(0,r.D5)(),showSelectionAlert:(0,r.D5)(),popoverMetadata:(0,r.D5)(),activeHighlightMetadata:(0,r.D5)()},l=(0,r.d0)(u).toMap(),h=(t=l,e)=>{const n=t;switch(e.type){case i.$.SHOW_COLOR_POPOVER:return n.setIn([c.Y.showPopover,e.tabId.toString()],e.show);case i.$.SHOW_COLOR_SETTINGS:return n.setIn([c.Y.showColorSettingsModePopover,e.tabId.toString()],e.show);case i.$.SHOW_SELECTION_ALERT:return n.setIn([c.Y.showSelectionAlert,e.tabId.toString()],e.show);case i.$.UPDATE_METADATA:return n.setIn([c.Y.popoverMetadata,e.tabId.toString()],e.metadata);case i.$.UPDATE_ACTIVE_HIGHLIGHT:return n.setIn([c.Y.activeHighlightMetadata,e.tabId.toString()],e.metadata);case s.vQ.UPDATE_HIGHLIGHT_COLOR:{const t={colorNum:e.colorNum,highlightId:e.highlightId};return n.setIn([c.Y.activeHighlightMetadata,e.tabId.toString()],t)}case o.K.RESET_HIGHLIGHT_COLOR:{const t={colorNum:null,highlightId:null};return n.setIn([c.Y.activeHighlightMetadata,e.tabId.toString()],t)}case a.x.USER_LOGGED_OUT_SUCCESS:return l;default:return n}}},9776:(t,e,n)=>{"use strict";n.d(e,{$O:()=>s,eP:()=>a});var r=n(5369),i=n(573),o=n(3312);const s=(0,i.P1)([t=>t?(0,r.D5)(t.sidebarStateReducer.get(o.Yh.showSidebar)):(0,r.D5)(),(t,e)=>e],((t,e)=>{var n;return null!==(n=t.get(e))&&void 0!==n&&n})),a=(t,e)=>{var n,r;return null!==(r=null===(n=null==t?void 0:t.sidebarStateReducer.get(o.Yh.isPinned))||void 0===n?void 0:n.get(e))&&void 0!==r&&r}},3501:(t,e,n)=>{"use strict";n.d(e,{PK:()=>i.P,Sl:()=>r.S});var r=n(6670),i=n(1705),o=n(5369);(0,n(573).P1)([t=>t?(0,o.D5)(t.sidebarStateReducer.showSidebar):(0,o.D5)(),(t,e)=>e],((t,e)=>{var n;return null!==(n=t.get(e))&&void 0!==n&&n}))},6670:(t,e,n)=>{"use strict";n.d(e,{S:()=>i});var r=n(3312);const i=(t,e)=>({type:r.$k.SHOW_SIDEBAR,tabId:t,show:e})},1705:(t,e,n)=>{"use strict";n.d(e,{B:()=>u,P:()=>a});var r=n(5369),i=n(3799),o=n(1856),s=n(1316);const a={showSidebar:(0,r.D5)(),isPinned:(0,r.D5)()},c=(0,r.d0)(a).toMap(),u=(t=c,e)=>{const n=t;switch(e.type){case i.$.SHOW_SIDEBAR:return n.setIn([o.Y.showSidebar,e.tabId.toString()],e.show);case i.$.TOGGLE_PINNED_SIDEBAR:return n.setIn([o.Y.isPinned,e.tabId.toString()],e.pinned);case s.x.USER_LOGGED_OUT_SUCCESS:return c;default:return n}}},5944:(t,e,n)=>{"use strict";n.d(e,{eY:()=>u});var r=n(2714),i=n(3760),o=n(70),s=n(3431);const a=(t,e)=>({type:i._.STRIPE_UPDATED,stripeData:{customerId:t,subscription:e}}),c=t=>({type:i._.STRIPE_FETCHING_STATUS,status:t}),u=()=>async(t,e,{logger:n,environment:i,tracker:u,fbInstance:l})=>{var h,d,p;try{t(c(s.Q.Loading));const e=await(0,o.Nh)(l.auth,!1);if(e){const o=await(async(t,e)=>{const n=`${t}/stripe/subscription?token=${e}`;return await fetch(n,{method:"GET",headers:{"Content-Type":"application/json"}})})(i.server.apiPath,e);if(o.ok){const{customerId:e,subscription:n}=await o.json();t(a(e,n)),t(c(s.Q.Success));const r=n,i=(null===(h=null==r?void 0:r.plan)||void 0===h?void 0:h.name)||(null===(d=null==r?void 0:r.plan)||void 0===d?void 0:d.nickname);return void u.trackStripe(i)}if(400===o.status)return t(a(null,null)),t(c(s.Q.Success)),void u.trackStripe("Free");{const{message:e,metadata:{error:i}}=await o.json();return n.logFromBackgroundScript("getSubscriptionApi","Failure in getting subscription",null!==(p=null==i?void 0:i.message)&&void 0!==p?p:e),t(c(s.Q.Fail)),void(401===o.status&&(n.logFromBackgroundScript("getSubscriptionApi","Force logout",i),t((0,r.UN)(e))))}}}catch(e){n.errorFromBackgroundScript("getSubscriptionApi","Failure in getting subscription",e),t(c(s.Q.Fail))}}},306:(t,e,n)=>{"use strict";n.d(e,{R9:()=>u,WZ:()=>s});var r=n(5369),i=n(3760),o=n(1316);const s={customerId:null,stripeData:null,fetchingStatus:n(5441).Q.Default},a=(0,r.d0)(s).toMap(),c=(0,r.d0)({plan:{name:"Free"}}),u=(t=a,e)=>{let n=t;switch(e.type){case i._.STRIPE_UPDATED:return e.stripeData?(n=n.set("customerId",e.stripeData.customerId),n=n.set("stripeData",e.stripeData.subscription||c)):n=n.set("stripeData",c),n;case i._.STRIPE_FETCHING_STATUS:return n.set("fetchingStatus",e.status);case o.x.USER_LOGGED_OUT_SUCCESS:return a;default:return n}}},4366:(t,e,n)=>{"use strict";n.d(e,{t:()=>i});var r=n(143);const i={trackEvent:(t,e,n)=>function(i,o,{logger:s}){return r.E.enableTracking?(t?r.E.trackEvent(t,n,r.E.app):"content"===e?s.errorFromContentScript("Content Script: Track Action error"):s.errorFromBackgroundScript("Background Page: Track Action error"),Promise.resolve()):Promise.resolve()}}},569:(t,e,n)=>{"use strict";n.d(e,{ZC:()=>i.Z,RQ:()=>r.RQ,uM:()=>r.uM,vj:()=>r.vj,Jm:()=>r.Jm});var r=n(9545),i=n(8532),o=n(573),s=(n(3312),n(3431));const a=t=>null==t?void 0:t.uiStateReducer.folderAPIActionStatus;(0,o.P1)(a,(t=>{var e;return null!==(e=null==t?void 0:t.status)&&void 0!==e?e:s.Q.Default})),(0,o.P1)(a,(t=>null==t?void 0:t.operation)),(0,o.P1)(a,(t=>null==t?void 0:t.folderId))},9545:(t,e,n)=>{"use strict";n.d(e,{Gf:()=>f,IT:()=>v,Jm:()=>E,RQ:()=>u,XE:()=>h,aZ:()=>l,bz:()=>y,iv:()=>p,rp:()=>m,uM:()=>a,vj:()=>c,yt:()=>_,yw:()=>d,zU:()=>g});var r=n(758),i=n(5910),o=n(5112),s=n(6885);const a=(t,e)=>({type:r.jp.FOLDER_LOADING,operation:e,folderId:t}),c=(t,e)=>({type:r.jp.FOLDER_SUCCESS,operation:e,folderId:t}),u=(t,e,n)=>({type:r.jp.FOLDER_FAILED,operation:e,folderId:t,message:n}),l=()=>({type:r.jp.FOLDER_RESET}),h=(t,e,n)=>({type:i.li.NOTE_SUCCESS,operation:n,websiteId:t,highlightId:e}),d=(t,e,n,r)=>({type:i.li.NOTE_FAILED,operation:n,websiteId:t,highlightId:e,message:r}),p=()=>({type:o.Gg.DRAG_ACTION_END}),f=(t,e,n,r,i,o)=>({type:s.T.WEBSITE_SUCCESS,operation:i,websiteId:e,fromFolderId:n,toFolderId:r,message:o,entityType:t}),_=(t,e,n,r,i)=>({type:s.T.WEBSITE_FAILED,operation:n,websiteId:e,message:r,errorStatus:i,entityType:t}),g=(t,e,n,r,o,s,a)=>({type:i.gB.HIGHLIGHT_SUCCESS,operation:o,highlightId:t,fromFolderId:e,toFolderId:n,websiteId:r,entityType:s,message:a}),v=(t,e,n)=>({type:i.gB.HIGHLIGHT_FAILED,operation:e,highlightId:t,message:n}),m=()=>({type:i.gB.HIGHLIGHT_RESET}),y=(t,e,n)=>({type:i.gB.HIGHLIGHT_LOADING,operation:e,highlightId:t,entityType:n}),E=(t,e)=>({type:o.Gg.SET_ACTIVE_HIGHLIGHT_ID,tabId:t,highlightId:e})},8532:(t,e,n)=>{"use strict";n.d(e,{Z:()=>h,c:()=>p});var r=n(5369),i=n(758),o=n(5910),s=n(1316),a=n(6885),c=n(5441),u=n(5112),l=n(1856);const h={folderAPIActionStatus:u.Zk,highlightAPIActionStatus:u.KA,notesAPIActionStatus:u.As,websiteAPIActionStatus:u.fx,highlightsVisibility:(0,r.D5)(),sortHighlightsOption:(0,r.D5)(),authStatus:{status:c.Q.Default},websiteStatus:{status:c.Q.Default},activeHighlightIdMap:(0,r.D5)()},d=(0,r.d0)(h).toMap(),p=(t=d,e)=>{var n;const r=t;switch(e.type){case a.T.WEBSITE_LOADING_REQUEST:return r.set(l.Y.websiteStatus,{status:c.Q.Loading});case a.T.WEBSITE_LOADING_SUCCESS:return r.set(l.Y.websiteStatus,{status:c.Q.Success});case a.T.WEBSITE_LOADING_ERROR:return r.set(l.Y.websiteStatus,{status:c.Q.Fail});case a.T.WEBSITE_SUCCESS:return r.set(l.Y.websiteAPIActionStatus,{websiteId:e.websiteId,fromFolderId:e.fromFolderId,toFolderId:e.toFolderId,operation:e.operation,status:c.Q.Success,message:e.message,type:e.entityType});case a.T.WEBSITE_FAILED:return r.set(l.Y.websiteAPIActionStatus,{websiteId:e.websiteId,operation:e.operation,status:c.Q.Fail,message:e.message,type:e.entityType,errorStatus:null!==(n=e.errorStatus)&&void 0!==n?n:0});case a.T.WEBSITE_RESET:return r.set(l.Y.websiteAPIActionStatus,u.fx);case s.x.USER_LOGGED_IN_REQUEST:return r.set(l.Y.authStatus,{status:c.Q.Loading});case s.x.USER_LOGGED_IN_SUCCESS:return r.set(l.Y.authStatus,{status:c.Q.Success});case s.x.USER_LOGGED_IN_ERROR:return r.set(l.Y.authStatus,{status:c.Q.Fail});case s.x.USER_LOGGED_OUT_SUCCESS:return d;case s.x.USER_LOGGED_OUT_ERROR:return r.set(l.Y.authStatus,{status:c.Q.Fail});case i.jp.FOLDER_LOADING:return r.set(l.Y.folderAPIActionStatus,{folderId:e.folderId,operation:e.operation,status:c.Q.Loading,type:"folder"});case i.jp.FOLDER_SUCCESS:return r.set(l.Y.folderAPIActionStatus,{folderId:e.folderId,operation:e.operation,status:c.Q.Success,type:"folder"});case i.jp.FOLDER_FAILED:return r.set(l.Y.folderAPIActionStatus,{folderId:e.folderId,operation:e.operation,status:c.Q.Fail,message:e.message,type:"folder"});case i.jp.FOLDER_RESET:return r.set(l.Y.folderAPIActionStatus,u.Zk);case o.gB.HIGHLIGHT_SUCCESS:return r.set(l.Y.highlightAPIActionStatus,{highlightId:e.highlightId,websiteId:e.websiteId,fromFolderId:e.fromFolderId,toFolderId:e.toFolderId,operation:e.operation,status:c.Q.Success,message:e.message,type:e.entityType});case o.gB.HIGHLIGHT_FAILED:return r.set(l.Y.highlightAPIActionStatus,{highlightId:e.highlightId,operation:e.operation,status:c.Q.Fail,message:e.message,type:"highlight"});case o.gB.HIGHLIGHT_LOADING:return r.set(l.Y.highlightAPIActionStatus,{highlightId:e.highlightId,operation:e.operation,status:c.Q.Loading,type:"highlight"});case o.gB.HIGHLIGHT_RESET:return r.set(l.Y.highlightAPIActionStatus,u.KA);case o.li.NOTE_SUCCESS:return r.set(l.Y.notesAPIActionStatus,{highlightId:e.highlightId,websiteId:e.websiteId,operation:e.operation,status:c.Q.Success,type:"note"});case o.li.NOTE_FAILED:return r.set(l.Y.notesAPIActionStatus,{highlightId:e.highlightId,websiteId:e.websiteId,operation:e.operation,status:c.Q.Fail,message:e.message,type:"note"});case u.Gg.DRAG_ACTION_START:return r.set(l.Y.dragAction,{tabId:e.tabId,data:e.data});case u.Gg.DRAG_ACTION_END:return r.set(l.Y.dragAction,null);case u.Gg.TOGGLE_HIGHLIGHTS_VISIBILITY:return r.setIn([l.Y.highlightsVisibility,e.tabId.toString()],e.visible);case u.Gg.RESET_HIGHLIGHTS_VISIBILITY:return r.setIn([l.Y.highlightsVisibility,e.tabId.toString()],!1);case u.Gg.SORT_HIGHLIGHTS:return r.setIn([l.Y.sortHighlightsOption,e.tabId.toString()],e.sort);case u.Gg.SET_ACTIVE_HIGHLIGHT_ID:return r.setIn([l.Y.activeHighlightIdMap,e.tabId.toString()],e.highlightId);case u.Gg.RESET_ACTIVE_HIGHLIGHT_ID:return r.removeIn([l.Y.activeHighlightIdMap,e.tabId.toString()]);default:return r}}},3815:(t,e,n)=>{"use strict";n.d(e,{S:()=>i,X:()=>o});var r=n(3312);const i=t=>({type:r.uA.OPEN_TAB,url:t}),o=()=>({type:r.uA.OPEN_TAB_SUCCESS})},2410:(t,e,n)=>{"use strict";n.d(e,{V:()=>s,Y:()=>c});var r=n(5369),i=n(1856),o=n(1882);const s={openTabQueue:(0,r.aV)([])},a=(0,r.D5)(s),c=(t=a,e)=>{const n=i.Y.openTabQueue;let s=t,c=(null==s?void 0:s.get(n))||(0,r.aV)([]);switch(e.type){case o.u.OPEN_TAB:return c=c.push({url:e.url}),s=s.set(n,c),s;case o.u.OPEN_TAB_SUCCESS:return c=c.shift(),s=s.set(n,c),s;default:return s}}},9600:(t,e,n)=>{"use strict";n.d(e,{PR:()=>a,n5:()=>c,y6:()=>s});var r=n(5369),i=n(573),o=n(3312);const s=t=>{var e;return null!==(e=null==t?void 0:t.userStateReducer.get(o.Yh.isLoggedIn))&&void 0!==e&&e},a=t=>(0,r.D5)(null==t?void 0:t.userStateReducer.get(o.Yh.user)),c=(0,i.P1)(a,(t=>null==t?void 0:t.get("uid")))},2714:(t,e,n)=>{"use strict";n.d(e,{H:()=>i.H,p:()=>r.p,UN:()=>r.UN});var r=n(634),i=n(4577),o=n(573);n(1316);const s=t=>null==t?void 0:t.userStateReducer.user;(0,o.P1)(s,(t=>{var e;return null!==(e=null==t?void 0:t.displayName)&&void 0!==e?e:""})),(0,o.P1)(s,(t=>null==t?void 0:t.createdAt)),(0,o.P1)(s,(t=>null==t?void 0:t.uid)),(0,o.P1)(s,(t=>null==t?void 0:t.emailVerified))},634:(t,e,n)=>{"use strict";n.d(e,{CO:()=>h,Tz:()=>v,UN:()=>g,Xb:()=>p,e4:()=>m,eD:()=>_,p:()=>f});var r=n(77),i=n(9769),o=n(2035),s=n(3312),a=n(9600),c=n(4366),u=n(70),l=n(545);const h=t=>({type:s.xf.USER_LOGGED_IN_SUCCESS,isLoggedIn:!0,user:t}),d=t=>({type:s.xf.USER_LOGGED_OUT_ERROR,error:t}),p=()=>(t,e,{logger:n})=>{chrome.storage.sync.get([i.L.onboardingStatus],(r=>{var i,o;if(chrome.runtime.lastError)n.errorFromBackgroundScript("getOnboardingStatusFromStorage","Error getting onboarding status from chrome.storage.sync",null===(i=chrome.runtime.lastError)||void 0===i?void 0:i.message);else{const i=null!==(o=r.onboardingStatus)&&void 0!==o?o:e().userStateReducer.get(s.Yh.onboardingStatus);n.logFromBackgroundScript("getOnboardingStatusFromStorage","Get onboarding status from chrome store",i),t((t=>({type:s.xf.USER_ONBOARDING_STATUS,status:t}))(i)),n.logFromBackgroundScript("getOnboardingStatusFromStorage","Set onboarding status in redux store",i)}}))},f=t=>(e,n,{logger:r})=>{const o={[i.L.onboardingStatus]:t};return new Promise(((t,e)=>{chrome.storage.sync.set(o,(()=>{var n;chrome.runtime.lastError?(r.errorFromBackgroundScript("saveOnboardingStatusToStorage","Error saving onboarding status to chrome.storage.sync",null===(n=chrome.runtime.lastError)||void 0===n?void 0:n.message),e()):(r.logFromBackgroundScript("saveOnboardingStatusToStorage","Save onboarding status to chrome.storage",o),t())}))}))},_=t=>async(e,n,{logger:i,tracker:d,environment:p,version:f,fbInstance:_})=>{if(!(0,a.y6)(n()))try{e({type:s.xf.USER_LOGGED_IN_REQUEST});const n=(await(0,r._p)(_.auth,t)).user,{uid:a,displayName:l,email:g,emailVerified:v,photoURL:m,metadata:y,providerId:E,providerData:I}=n;i.logFromBackgroundScript("User action","dispatch userLoginWithCustomToken action"),e((t=>({type:s.xf.USER_LOGGED_IN_WITH_CUSTOM_TOKEN,customToken:t}))(t)),i.logFromBackgroundScript("User action","dispatch userLoginSuccess action");const b={uid:a,displayName:l||"",email:g||"",emailVerified:v,photoURL:m||"",providerId:E,createdAt:y.creationTime||""};e(h(b));const S={extensionVersion:f,providerData:(0,u.Wi)(I),uid:a,displayName:l||"Anonymous",email:g||"Anonymous",emailVerified:v,photoURL:m||"",environment:p.type};d.trackUserId(a),d.trackUserProfile(S),e(c.t.trackEvent(o.l.LOGIN_USER_IN_EXTENSION,"background"))}catch(t){i.logFromBackgroundScript("User action","dispatch userLoginError action"),e((t=>({type:s.xf.USER_LOGGED_IN_ERROR,error:t}))((0,l.Yo)(t))),e(c.t.trackEvent(o.l.LOGIN_USER_IN_EXTENSION_FAIL,"background",{error:t.message}))}},g=t=>async(e,n,{logger:i,tracker:s,fbInstance:a})=>{try{await(0,r.w7)(a.auth),s.untrackUser(),e(d(t))}catch(t){i.logFromBackgroundScript("User action","dispatch userLogoutError action"),e(d(t.message?t.message:t)),e(c.t.trackEvent(o.l.SIGNOUT_ERROR,"background",{error:t}))}},v=()=>async(t,e,{logger:n,tracker:i,fbInstance:u})=>{try{(0,a.y6)(e())&&(await(0,r.w7)(u.auth),n.logFromBackgroundScript("User action","dispatch userLogoutSuccess action"),t({type:s.xf.USER_LOGGED_OUT_SUCCESS}),i.untrackUser())}catch(e){n.logFromBackgroundScript("User action","dispatch userLogoutError action"),t(d(e.message?e.message:e)),t(c.t.trackEvent(o.l.SIGNOUT_ERROR,"background",{error:e}))}},m=()=>async(t,e,{logger:n,fbInstance:r})=>{var i,o;try{const e=r.auth.currentUser;if(e){await e.reload();const a=r.auth.currentUser,{uid:c,displayName:u,email:l,emailVerified:h,photoURL:d,metadata:p}=a;n.logFromBackgroundScript("User Action","Check if email verified:",h,l),a&&a.emailVerified&&(n.logFromBackgroundScript("User Data Reloaded","UserData:",h,l),t((o={uid:c,displayName:null!=u?u:"",email:null!=l?l:"",emailVerified:h,photoURL:null!=d?d:"",createdAt:null!==(i=p.creationTime)&&void 0!==i?i:Date.now().toString()},{type:s.xf.USER_RELOAD_REQUEST,user:o})))}}catch(t){n.errorFromBackgroundScript("User action","dispatch email verified error action")}}},4577:(t,e,n)=>{"use strict";n.d(e,{H:()=>s,n:()=>c});var r=n(5369),i=n(1856),o=n(1316);const s={isLoggedIn:!1,user:null,customToken:null,onboardingStatus:o.Q.DEFAULT},a=(0,r.d0)(s).toMap(),c=(t=a,e)=>{let n=t;switch(e.type){case o.x.USER_LOGGED_IN_SUCCESS:return n=n.set(i.Y.isLoggedIn,e.isLoggedIn),n=n.set(i.Y.user,e.user),n=n.set(i.Y.authError,null),n;case o.x.USER_LOGGED_IN_ERROR:return a.set(i.Y.authError,e.error);case o.x.USER_LOGGED_OUT_SUCCESS:return a;case o.x.USER_LOGGED_OUT_ERROR:return a.set(i.Y.authError,e.error);case o.x.USER_LOGGED_IN_WITH_CUSTOM_TOKEN:return n.set(i.Y.customToken,e.customToken);case o.x.USER_ONBOARDING_STATUS:return n.set(i.Y.onboardingStatus,e.status);case o.x.USER_RELOAD_REQUEST:return n.set(i.Y.user,e.user);default:return n}}},1376:(t,e,n)=>{"use strict";n.d(e,{fe:()=>b,Sn:()=>I,hz:()=>S,z0:()=>m,uh:()=>y,$h:()=>v,rN:()=>E});var r=n(5369),i=n(9297),o=n(9545),s=n(2714),a=n(8679),c=n(695),u=n(545);const l=async(t,e)=>{const n=e.map((async e=>{const n=`websites/${e}`,i=(await(0,a.U2)((0,a.iH)(t,n))).val();if(i){let t=(0,r.D5)();return(0,r.D5)(i.highlights).map(((e,n)=>{const r=(0,u.rr)(e);t=t.set(n,r)})),{id:e,payload:Object.assign(Object.assign({},i),{highlights:t})}}return{id:e}})),i=await Promise.all(n);let o=(0,r.D5)();return i.forEach((t=>{o=o.set(t.id,new c.k(t.payload))})),o};var h=n(6885),d=n(9533),p=n(70);const f=()=>({type:h.T.WEBSITE_LOADING_REQUEST}),_=()=>({type:h.T.WEBSITE_LOADING_SUCCESS}),g=()=>({type:h.T.WEBSITE_SAVED}),v=t=>({type:h.T.WEBSITE_UPDATE_ALL,websiteBodyMap:t}),m=(t,e)=>async(n,i,{fbInstance:o})=>{n(f());const s=await l(o.db,t),a=(0,r.TS)(e,s);n(v(a)),n(_())},y=()=>async(t,e,{fbInstance:n})=>{t({type:h.T.WEBSITE_RESET_ALL}),t(_())},E=(t,e)=>async(n,r,{fbInstance:o})=>{const s=(0,i.f$)(r());if(t===s){n(f());n((t=>({type:h.T.WEBSITE_UPDATE,websiteBodyMap:t}))(await l(o.db,e))),n(_())}},I=(t,e,n,r,i,o,a)=>async(c,l,{logger:f,environment:_,fbInstance:v})=>{var m,y;try{const l=await(0,p.Nh)(v.auth,!1);if(!l)throw new Error("Unable to fetch token");const E=await(async(t,e,n,r,i,o,s,a,c)=>{const l=`${t}/2/websites`,h={token:e,data:{folderId:n,url:u.V8.normalizeUrl(r)||r,title:i,favIconUrl:o,websiteId:s,highlightId:a,highlightObj:c}};return await fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)})})(_.server.apiPath,l,t,e,n,r,i,o,a),I=await E.json();if(E.ok){c(g());const e={type:d.iz.SEND_MESSAGE_TO_IFRAME_IN_WEBAPP,action:h.T.WEBSITE_UPDATE,payload:{folderId:t,websiteIds:[i]}};return(0,u.lH)(e),I}{const{message:t,metadata:{error:e}}=await E.json();return f.logFromBackgroundScript("createHighlightApi","Failure in saving highlight",null!==(m=null==e?void 0:e.message)&&void 0!==m?m:t),void(401===E.status&&(f.logFromBackgroundScript("createHighlightApi","Force logout",null!==(y=null==e?void 0:e.message)&&void 0!==y?y:t),c((0,s.UN)(t))))}}catch(t){f.logFromBackgroundScript("saveHighlightNoteApi","Failure in saving highlight note",t)}},b=(t,e,n,r)=>async(i,o,{logger:a,environment:c,fbInstance:l})=>{var f;const _=o().dataReducer,v=await(0,p.Nh)(l.auth,!1);if(!v)throw new Error("Unable to fetch token");if(t){let o=(0,u.dY)(_,e),m=!1;if(o||(m=!0,o=(0,p.HC)(l.db)),m){a.logFromBackgroundScript("createWebsiteApi","Website Created",t);const l=await(async(t,e,n,r,i,o,s)=>{const a=`${t}/2/websites`,c={token:e,data:{folderId:n,url:u.V8.normalizeUrl(r)||r,title:i,favIconUrl:o,websiteId:s}};return await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})})(c.server.apiPath,v,t,e,n,r,o),p=await l.json();if(l.ok){i(g());const e={type:d.iz.SEND_MESSAGE_TO_IFRAME_IN_WEBAPP,action:h.T.WEBSITE_UPDATE,payload:{folderId:t,websiteIds:[o]}};return(0,u.lH)(e),p}{const{message:t,metadata:{error:e}}=await l.json();return a.logFromBackgroundScript("createWebsiteApi","Failure in saving website",null!==(f=null==e?void 0:e.message)&&void 0!==f?f:t),void(401===l.status&&i((0,s.UN)(t)))}}a.logFromBackgroundScript("createWebsiteApi","Website Already Created",t)}},S=(t,e)=>async(n,r,{logger:i,environment:a,fbInstance:c})=>{var l,f;try{const r=await(0,p.Nh)(c.auth,!1);if(r){const c=await(async(t,e,n,r)=>{const i={token:e,data:{folderId:n}},o=`${t}/2/websites/${r}`;return await fetch(o,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})})(a.server.apiPath,r,t,e);if(c.ok){n(((t,e)=>({type:h.T.WEBSITE_DELETED,folderId:t,websiteId:e}))(t,e));const r={type:d.iz.SEND_MESSAGE_TO_IFRAME_IN_WEBAPP,action:h.T.WEBSITE_UPDATE,payload:{folderId:t,websiteIds:[e]}};return(0,u.lH)(r),void n((0,o.Gf)("website",e,t,"","delete"))}{const{message:t,metadata:{error:r}}=await c.json();return i.logFromBackgroundScript("deleteWebsiteApi","Failure in deleting website",null!==(l=null==r?void 0:r.message)&&void 0!==l?l:t),n((0,o.yt)("website",e,"delete",t,+c.status)),void(401===c.status&&(i.logFromBackgroundScript("deleteWebsiteApi","Force logout",null!==(f=null==r?void 0:r.message)&&void 0!==f?f:t),n((0,s.UN)(t))))}}}catch(t){i.logFromBackgroundScript("deleteWebsiteApi","Failure in deleting website",t),n((0,o.yt)("website",e,"delete",t.message)||t)}}},866:(t,e,n)=>{"use strict";n.d(e,{Hd:()=>v});var r=n(974),i=n(179),o=n(4178),s=n(141),a=n(3985),c=n(3420),u=n(9922),l=n(250),h=n(1705),d=n(306),p=n(8532),f=n(2410),_=n(4577);class g{constructor(t,e=!0){this.previousState=null,this.unBindStore=()=>{},this.store=t,this.currentState=this.getCurrentState(),e&&this.bindStore()}bindStore(){this.unBindStore=this.store.subscribe(this.handleChangeListener.bind(this))}handleChangeListener(){const t=this.getCurrentState();this.previousState=this.currentState,this.currentState=t,this.handleStoreChange()}}class v extends g{constructor(t){super(t)}getCurrentState(){return this.store.getState()}}s.W,r.$I,i.p,o.l,a.G,c.p,u.c,l.x,h.P,d.WZ,p.Z,f.V,_.H},9817:(t,e,n)=>{"use strict";var r,i;n.d(e,{AW:()=>s,IB:()=>v,Qj:()=>g,Wd:()=>c,XV:()=>d,Xd:()=>p,bN:()=>_,db:()=>l,hf:()=>u,kk:()=>i,nN:()=>a,qP:()=>r,qj:()=>f,t9:()=>m,u3:()=>h}),function(t){t.ON="assets/images/logo/38.png",t.OFF="assets/images/logo/38-off.png",t.BANNED="assets/images/logo/38-banned.png"}(r||(r={})),function(t){t.HOME="dashboard",t.HOME_NOTIFICATION="dashboard?notifications=true",t.UPLOAD_PDF="dashboard?action=uploadPdf",t.ACCOUNT_DETAILS="dashboard?acctdetails=true",t.SIGN_OUT="signout",t.SIGN_UP="signup",t.SIGN_IN="login",t.REFERRAL="referral",t.PREMIUM="premium",t.CONTRIBUTE="contribute-weava"}(i||(i={}));const o={LOCAL:"http://localhost",TESTING:"https://testing.weavatools.com",STAGING:"https://staging.weavatools.com",PROD:"https://www.weavatools.com"},s=Object.entries(o).map((([t,e])=>"LOCAL"===t?`${e}:4200/dashboard*`:`${e}/app/dashboard*`)),a={local:{appPath:`${o.LOCAL}:4200`,apiPath:`${o.LOCAL}:3000/apis`,premiumPath:`${o.TESTING}/premium`,subscriptionPath:`${o.LOCAL}:4200/subscription`,donationSuccessPath:`${o.LOCAL}:4200/contribute-weava-success`,donationPath:`${o.LOCAL}:4200/contribute-weava`},testing:{appPath:`${o.TESTING}/app`,apiPath:`${o.TESTING}/apis`,premiumPath:`${o.TESTING}/premium`,subscriptionPath:`${o.TESTING}/subscription`,donationSuccessPath:`${o.TESTING}/contribute-weava-success`,donationPath:`${o.TESTING}/contribute-weava`},staging:{appPath:`${o.STAGING}/app`,apiPath:`${o.STAGING}/apis`,premiumPath:`${o.STAGING}/premium`,subscriptionPath:`${o.STAGING}/subscription`,donationSuccessPath:`${o.STAGING}/contribute-weava-success`,donationPath:`${o.STAGING}/contribute-weava`},prod:{appPath:`${o.PROD}/app`,apiPath:`${o.PROD}/apis`,premiumPath:`${o.PROD}/premium`,subscriptionPath:`${o.PROD}/subscription`,donationSuccessPath:`${o.PROD}/contribute-weava-success`,donationPath:`${o.PROD}/contribute-weava`}},c="cbnaodkpfinfiipjblikofhlhlcickei",u="bnhmmfcknkmbafbefmpnldhclojbhged",l=["http://*/*","https://*/*","file://*/*.pdf*"],h=[...l,"*://*.weavatools.com/*","https://weava-files-storage.s3.amazonaws.com/pdf/*","https://weava-files-storage-dev.s3.amazonaws.com/pdf/*"],d="src/pdfviewer/web/viewer.html",p="src/webviewer/viewer.html",f=[`chrome-extension://${c}/${d}?file=`,`chrome-extension://${u}/${d}?file=`,`chrome-extension://${c}/${p}?url=`,`chrome-extension://${u}/${p}?url=`],_="chrome://extensions/shortcuts",g="chrome://settings/content/notifications",v="WEAVA-CHROME-EXTENSION",m={ALL:"All",LOCAL:"Local",TESTING:"Testing",STAGING:"Staging",PRODUCTION:"Production"}},8723:(t,e,n)=>{"use strict";n.d(e,{fP:()=>c});var r=n(9817);const i=["about://newtab","chrome://newtab","https://accounts.google.com/AccountChooser","https://chrome.google.com/webstore","https://chromewebstore.google.com/","chrome://extensions","https://hkucc1.hku.hk","http://localhost:8021"],o=["chrome:","chrome-extension:"],s=/^.*(weavatools.com|localhost).*\/onboarding.*/,a=[/^.*(weavatools.com\/app|localhost.*)\/.*/,/^.*google.com.*/,/^.*facebook.com.*/,/^.*instapaper.com.*/,/^.*instagram.com.*/,/^.*twitter.com.*/],c=t=>{if(!t)return!1;if((t=>!!r.qj.find((e=>t.startsWith(e)))||s.test(t))(t))return!1;const e=i.find((e=>t.startsWith(e))),n=new URL(t),c=a.find((e=>e.test(t)));return!!(o.includes(n.protocol)||e||c)}},1368:(t,e,n)=>{"use strict";n.d(e,{fP:()=>r.fP});var r=n(8723);n(806)},806:(t,e,n)=>{"use strict";n.d(e,{n:()=>i,t:()=>o});var r=n(8723);const i=()=>new Promise(((t,e)=>{try{chrome.tabs.query({currentWindow:!0},(n=>{const i=n.filter((t=>!(0,r.fP)(t.url||"")));chrome.runtime.lastError&&e(chrome.runtime.lastError),t(i.length)}))}catch(t){e(t)}})),o=()=>new Promise(((t,e)=>{try{chrome.tabs.query({active:!0,lastFocusedWindow:!0},(n=>{const r=n[0].url||"";chrome.runtime.lastError&&e(chrome.runtime.lastError),t(r)}))}catch(t){e(t)}}))},2154:(t,e,n)=>{"use strict";n.d(e,{IB:()=>r.IB,Wd:()=>r.Wd,XV:()=>r.XV,db:()=>r.db,fP:()=>o.fP,hf:()=>r.hf,iz:()=>i.iz,kk:()=>r.kk,nN:()=>r.nN,t9:()=>r.t9});var r=n(9817),i=n(8082),o=n(1368)},8082:(t,e,n)=>{"use strict";n.d(e,{Op:()=>a,Ti:()=>o,iz:()=>s,yj:()=>c});var r=n(3192),i=n.n(r);const o=i()({QUERY_TAB:null,GET_ACTIVE_TAB_URL:null,OPEN_OR_SWITCH_URL:null,OPEN_VIA_DEFAULT_PDF_VIEWER:null,OPEN_VIA_WEAVA_PDF_VIEWER:null,SET_AUTO_PDF:null,GET_FILE_SCHEME_ACCESS:null,COUNT_TABS:null,CHECK_SITE_ACCESS:null,SET_HIGHLIGHT_MODE:null,TOGGLE_SIDEBAR:null,SET_IS_WEBSITE_SAVED_MODE:null}),s=i()({SCROLL_TO_HIGHLIGHT:null,SEND_MESSAGE_TO_IFRAME_IN_WEBAPP:null,ENABLE_ACTIVE_TAB:null,BROADCAST_SET_HIGHLIGHT_MODE:null,BROADCAST_TOGGLE_SIDEBAR:null,BROADCAST_RESEND_MESSAGE:null}),a=i()({SIGN_IN:null,SIGN_OUT:null,EMAIL_VERIFIED:null,CHECK_VERSION:null,STRIPE_UPDATE:null,DELETE_HIGHLIGHT:null,DELETE_MULTIPLE_HIGHLIGHTS:null,DELETE_PDF:null,DELETE_WEBSITE:null,UPDATE_WEBSITE:null,ADD_HIGHLIGHT_NOTE:null,DELETE_HIGHLIGHT_NOTE:null,MOVE_HIGHLIGHT:null,OPEN_CHROME_EXTENSION_SHORTCUTS:null,OPEN_CHROME_NOTIFICATION_SETTINGS:null,OPEN_OR_SWITCH_URL:null,SCROLL_TO_HIGHLIGHT:null}),c=i()({GENERATE_NEW_PUSH_ID:null,GENERATE_TOKEN:null,SWITCH_ACTIVE_FOLDER:null,CREATE_NEW_FOLDER:null,DELETE_FOLDER:null,EDIT_FOLDER:null,FETCH_EDIT_FOLDER:null,MOVE_FOLDER:null,FETCH_SHARE_FOLDER:null,ADD_INVITE_SHARE_FOLDER:null,REMOVE_COLLABORATOR_SHARE_FOLDER:null,MOVE_WEBSITE:null,MOVE_HIGHLIGHT:null,SAVE_HIGHLIGHT:null,SAVE_IMAGE_HIGHLIGHT_TO_STORAGE:null,DELETE_IMAGE_HIGHLIGHT_TO_STORAGE:null,UPDATE_HIGHLIGHT:null,DELETE_HIGHLIGHT:null,CREATE_WEBSITE:null,SAVE_WEBSITE:null,DELETE_WEBSITE:null,DELETE_PDF_FROM_STORAGE:null,SAVE_HIGHLIGHT_NOTE:null,DELETE_HIGHLIGHT_NOTE:null,UPDATE_FOLDER_COLORS:null,GET_FOLDER_HIGHLIGHTS:null,GET_SUBSCRIPTION:null,GET_FOLDER_ACCESS_FOR_DELETE:null})},9533:(t,e,n)=>{"use strict";n.d(e,{Hd:()=>r.Hd,iz:()=>i.iz});var r=n(866),i=n(2154)},143:(t,e,n)=>{"use strict";n.d(e,{E:()=>o});var r=n(7380),i=n(2938);const o={enableTracking:!1,app:"",userProfile:void 0,initialized:!1,init(t){this.initialized?console.error("Initialize only once"):(r.Z.getInstance().init(t),this.initialized=!0)},trackUserId(t){this.initialized?this.enableTracking&&r.Z.getInstance().setUserId(t):console.error("Amplitude must be initialized first")},trackNumberOfTabs(t){this.initialized?this.enableTracking&&r.Z.getInstance().setUserProperties({totalTabs:t}):console.error("Amplitude must be initialized first")},trackUserProfile(t){this.initialized?(t||console.error("profile is empty"),this.userProfile=t,this.enableTracking&&r.Z.getInstance().setUserProperties(t)):console.error("Amplitude must be initialized first")},trackEvent(t,e,n){this.initialized?((e=e||{}).app=n,this.enableTracking&&r.Z.getInstance().logEvent(t,e)):console.error("Amplitude must be initialized first")},trackStripe(t){if(!this.initialized)return void console.error("Amplitude must be initialized first");const e=(0,i.I5)(t);this.userProfile=Object.assign(Object.assign({},this.userProfile),{paid:e,subscriptionPlan:t}),r.Z.getInstance().setUserProperties(this.userProfile)},untrackUser(){this.initialized?(r.Z.getInstance().setUserId(null),r.Z.getInstance().regenerateDeviceId()):console.error("Amplitude must be initialized first")}}},7259:(t,e,n)=>{"use strict";n.d(e,{rr:()=>r});n(2960),n(841);const r=t=>t?function(t){const e=t;return e.pdfPageNumber?(e.type="pdf",e.pdfPageNumber=parseInt(e.pdfPageNumber.toString()),e):e.text?(e.type="text",e):Object.assign(Object.assign({},e),{type:"image"})}(t):t},2482:(t,e,n)=>{"use strict";n.d(e,{CP:()=>a,dY:()=>l,fX:()=>u});var r=n(5369),i=(n(2307),n(2960)),o=n(3312),s=n(1313);const a=(t,e)=>{let n=c(t,e);if(!n)return null;n=n.delete(0);let i=(0,r.aV)([]);return n.forEach((t=>{i=i.push("folderMetaMap"),i=i.push(t)})),i},c=(t,e)=>{const n=(t,r,i)=>{if(r=r.add(t[0]),t[0]===e)return i;const o=t[1].folderMetaMap;if(o){const t=o.keySeq().toSet().subtract(r).toArray();for(const e of t){const t=n([e,o.get(e)],r,i.push(e));if(t)return t}}return null};return n(["~",{folderMetaMap:t}],(0,r.l4)([]),(0,r.aV)(["~"]))},u=t=>t.get(o.Yh.activeFolderMap).keySeq().first()||null,l=(t,e)=>{const n=(t=>{const e=u(t)||null;if(!e||0===t.get(o.Yh.activeFolderMap).count())return null;const n=t.get(o.Yh.activeFolderMap).get(e);return n?new s.uY(n).get("websiteIds"):null})(t);if(null==n?void 0:n.count()){return n.findKey((t=>{const n=t.get("url");return!!n&&i.V8.normalizeUrl(n)===i.V8.normalizeUrl(e)}))||null}return null}},3877:(t,e,n)=>{"use strict";n.d(e,{V8:()=>o.V8,Yo:()=>a,ro:()=>s,fX:()=>i.fX,dY:()=>i.dY,Ze:()=>o.Ze,lH:()=>u,rr:()=>r.rr});var r=n(7259),i=n(2482),o=n(2960);const s=t=>{if(!t)throw new Error("Error argument is required for tracking");return"string"==typeof t?{error:t}:{statusCode:t.status,error:`${a(t)}`}},a=t=>(t=>t instanceof Error)(t)?t.message:t;var c=n(9817);const u=t=>{chrome.tabs.query({currentWindow:!0,url:c.AW},(e=>{var n;for(let r=0;r<e.length;++r){const i=null===(n=e[r])||void 0===n?void 0:n.id;i&&chrome.tabs.sendMessage(i,t,(t=>{chrome.runtime.lastError&&console.error("sendMessageToWebapp:",t,chrome.runtime.lastError)}))}}))}},2960:(t,e,n)=>{"use strict";n.d(e,{V8:()=>c,Ze:()=>s});var r=n(9817);const i=/.*(?<=viewer\.html\?file=)/i,o=/^(?:\?file=)+/,s=t=>!!t&&i.test(t),a={protocol:!0,search:!1,hash:!1};class c{static buildMatchString(t,e){var n,r;const i=new URL(t);if((e=Object.assign(Object.assign({},a),e)).protocol&&e.search&&e.hash&&!e.firstQueryOnly)return t;let o=e.protocol?i.protocol+"//":"";return o+=i.host,o+=i.pathname,e.search&&(null===(n=i.search)||void 0===n?void 0:n.length)&&(e.firstQueryOnly?o+=i.search.split("&")[0]:o+=i.search),e.hash&&(null===(r=i.hash)||void 0===r?void 0:r.length)&&(o+=i.hash),o}static stripWebViewerLink(t){if(!t)return t;let e=t;return t.startsWith(c.chromeUrl)?(e=e.split(`${c.chromeUrl}${c.webViewerOldUrl}`).pop()||"",e=e.split(`${c.chromeUrl}${c.webViewerUrl}`).pop()||""):t.startsWith(c.chromeStagingUrl)&&(e=e.split(`${c.chromeStagingUrl}${c.webViewerOldUrl}`).pop()||"",e=e.split(`${c.chromeStagingUrl}${c.webViewerUrl}`).pop()||""),e||""}static getOriginalUrl(t){if(!t)return t;const e=c.stripWebViewerLink(t),n=-1!==e.indexOf("chrome-extension://");return-1!==e.indexOf("washingtonpost")?c.buildMatchString(e,{protocol:!0,search:!1,hash:!1}):n?c.buildMatchString(e,Object.assign(Object.assign({},a),{search:!0})):c.buildMatchString(e,{protocol:!0,firstQueryOnly:!0,hash:!1})}static normalizePdfUrl(t,e){const n=new URL(t).searchParams.get("file")||"";if(n.length&&-1!==n.indexOf("apis/pdfstorage"))return`${e}${n.split("?token")[0]}`;if(/file:[/]+/i.test(t)){return`${e}${t.split("?file=")[1]}`}return`${e}${n}`}static normalizeUrl(t){if(!t)return t;t=t.replace(o,"");const e=c.getOriginalUrl(t),n=`${c.chromeUrl}${this.pdfViewerUrl}`,r=`${c.chromeStagingUrl}${this.pdfViewerUrl}`;return 0===e.indexOf(n)?c.normalizePdfUrl(e,n):0===e.indexOf(r)?c.normalizePdfUrl(e,r):e}static isChromePdfViewerUrl(t){if(!t)return!1;const e=`${c.chromeUrl}${this.pdfViewerUrl}`,n=`${c.chromeStagingUrl}${this.pdfViewerUrl}`;return 0===t.indexOf(e)||0===t.indexOf(n)}}c.chromeUrl=`chrome-extension://${r.Wd}`,c.chromeStagingUrl=`chrome-extension://${r.hf}`,c.webViewerOldUrl="/src/webviewer/gistnoteWebViewer.html?url=",c.webViewerUrl=`/${r.Xd}?url=`,c.pdfViewerUrl=`/${r.XV}?file=`},545:(t,e,n)=>{"use strict";n.d(e,{V8:()=>r.V8,Yo:()=>r.Yo,ro:()=>r.ro,fX:()=>r.fX,dY:()=>r.dY,Ze:()=>r.Ze,lH:()=>r.lH,rr:()=>r.rr});n(143);var r=n(3877);n(4310),n(9533),n(2482)},4310:(t,e,n)=>{"use strict";n.d(e,{o:()=>r});const r=new class{constructor(){this.logEnabled=!1}log(t,e,n,r,...i){this.logEnabled&&console.log(`%c [ ${t} ] %c ${r}`,`background-color: ${e}; color: ${n}`,"color:black;font-weight:bold;",...i)}logContentScript(t,e="#2ea44f",n="white",r,...i){this.logEnabled&&console.log(`%c [Content Script] %c [ ${t} ] %c ${r}`,"background-color: green; color: white",`background-color: ${e}; color: ${n}`,"color:black;font-weight:bold;",...i)}logFromContentScript(t,e,...n){this.logContentScript(t,"#2ea44f","white",e,...n)}logBackgroundScript(t,e,n,r,...i){this.logEnabled&&console.log(`%c [Background Script] %c [ ${t} ] %c ${r}`,"background-color: black; color: white",`background-color: ${e}; color: ${n}`,"color:black;font-weight:bold;",...i)}errorBackgroundScript(t,e,n,r,...i){console.error(`%c [Background Script] %c [ ${t} ] %c ${r}`,"background-color: black; color: white",`background-color: ${e}; color: ${n}`,"color:black;font-weight:bold;",...i)}errorContentScript(t,e,n,r,...i){console.error(`%c [Content Script] %c [ ${t} ] %c ${r}`,"background-color: black; color: white",`background-color: ${e}; color: ${n}`,"color:black;font-weight:bold;",...i)}logFromBackgroundScript(t,e,...n){this.logBackgroundScript(t,"#2ea44f","white",e,...n)}errorFromBackgroundScript(t,e,...n){this.errorBackgroundScript(t,"red","white",e,...n)}errorFromContentScript(t,e,...n){this.errorContentScript(t,"red","white",e,...n)}}},1202:(t,e,n)=>{"use strict";n.d(e,{k6:()=>I,Hi:()=>T,mk:()=>E,Ph:()=>y,hk:()=>b});var r=n(5369),i=n(974),o=n(841),s=n(9896),a=n(141),c=(n(4743),n(3985)),u=n(9956),l=n(5181),h=n(5241),d=n(3501),p=(n(5944),n(306)),f=n(573),_=(n(3431),n(2938));(0,f.P1)((t=>null==t?void 0:t.stripeReducer.stripeData),(t=>{let e=!1;if(t){const n=t.plan.nickname||t.plan.name||"Free";n&&(e=(0,_.$r)(n)||(0,_.I5)(n))}return e}));var g=n(569),v=(n(3815),n(2410)),m=n(2714);const y=async t=>await chrome.storage.local.set(t),E=async(t=null)=>await chrome.storage.local.get(t),I=async(t=!0,e=[])=>{if(t)return await chrome.storage.local.clear();try{const t=await E(),n=Object.keys(t).filter((t=>!e.includes(t)));return await(async(t=[])=>await chrome.storage.local.remove(t))(n)}catch(t){throw t}},b=t=>{const e={};for(const[n,i]of Object.entries(t))e[n]=r.D5.isMap(i)||r.aV.isList(i)||r.WV.isRecord(i)?i.toJS():i;return e},S=t=>{if((t=>"object"!=typeof t||null===t)(t))return t;let e=(0,r.D5)();for(const[n,i]of Object.entries(t))e=Array.isArray(i)?e.set(n,(0,r.aV)(i)):e.set(n,(0,r.d0)(S(i)));return e},T=t=>{var e,n,r,f,_,y,E,I,T,w,O,C,A;return{chromeIconReducer:S(null!==(e=t.chromeIconReducer)&&void 0!==e?e:a.W),dataReducer:S(null!==(n=t.dataReducer)&&void 0!==n?n:b(i.d5)),folderStateReducer:S(null!==(r=t.folderStateReducer)&&void 0!==r?r:b(o.pd)),hotkeyStateReducer:S(null!==(f=t.hotkeyStateReducer)&&void 0!==f?f:b(s.lP)),notificationsReducer:S(null!==(_=t.notificationsReducer)&&void 0!==_?_:b(c.G)),optionsStateReducer:S(null!==(y=t.optionsStateReducer)&&void 0!==y?y:b(u.pG)),pdfReducer:S(null!==(E=t.pdfReducer)&&void 0!==E?E:b(l.c7)),popoverStateReducer:S(null!==(I=t.popoverStateReducer)&&void 0!==I?I:b(h.xr)),sidebarStateReducer:S(null!==(T=t.sidebarStateReducer)&&void 0!==T?T:b(d.PK)),stripeReducer:S(null!==(w=t.stripeReducer)&&void 0!==w?w:b(p.WZ)),uiStateReducer:S(null!==(O=t.uiStateReducer)&&void 0!==O?O:b(g.ZC)),urlReducer:S(null!==(C=t.urlReducer)&&void 0!==C?C:b(v.V)),userStateReducer:S(null!==(A=t.userStateReducer)&&void 0!==A?A:b(m.H))}}},389:(t,e,n)=>{"use strict";n.d(e,{Jn:()=>F,qX:()=>P,Xd:()=>N,Mq:()=>H,ZF:()=>M,KN:()=>j});var r=n(8463),i=n(3333),o=n(4444);const s=(t,e)=>e.some((e=>t instanceof e));let a,c;const u=new WeakMap,l=new WeakMap,h=new WeakMap,d=new WeakMap,p=new WeakMap;let f={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return l.get(t);if("objectStoreNames"===e)return t.objectStoreNames||h.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return v(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function _(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(c||(c=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(m(this),e),v(u.get(this))}:function(...e){return v(t.apply(m(this),e))}:function(e,...n){const r=t.call(m(this),e,...n);return h.set(r,e.sort?e.sort():[e]),v(r)}}function g(t){return"function"==typeof t?_(t):(t instanceof IDBTransaction&&function(t){if(l.has(t))return;const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{e(),r()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)}));l.set(t,e)}(t),s(t,a||(a=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,f):t)}function v(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{e(v(t.result)),r()},o=()=>{n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)}));return e.then((e=>{e instanceof IDBCursor&&u.set(e,t)})).catch((()=>{})),p.set(e,t),e}(t);if(d.has(t))return d.get(t);const e=g(t);return e!==t&&(d.set(t,e),p.set(e,t)),e}const m=t=>p.get(t);const y=["get","getKey","getAll","getAllKeys","count"],E=["put","add","delete","clear"],I=new Map;function b(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(I.get(e))return I.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=E.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!y.includes(n))return;const o=async function(t,...e){const o=this.transaction(t,i?"readwrite":"readonly");let s=o.store;return r&&(s=s.index(e.shift())),(await Promise.all([s[n](...e),i&&o.done]))[0]};return I.set(e,o),o}f=(t=>({...t,get:(e,n,r)=>b(e,n)||t.get(e,n,r),has:(e,n)=>!!b(e,n)||t.has(e,n)}))(f);class S{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const T="@firebase/app",w="0.9.19",O=new i.Yd("@firebase/app"),C="[DEFAULT]",A={[T]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},R=new Map,k=new Map;function D(t,e){try{t.container.addComponent(e)}catch(n){O.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function N(t){const e=t.name;if(k.has(e))return O.debug(`There were multiple attempts to register component ${e}.`),!1;k.set(e,t);for(const e of R.values())D(e,t);return!0}function P(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const L={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},x=new o.LL("app","Firebase",L);class U{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new r.wA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw x.create("app-deleted",{appName:this._name})}}const F="10.4.0";function M(t,e={}){let n=t;if("object"!=typeof e){e={name:e}}const i=Object.assign({name:C,automaticDataCollectionEnabled:!1},e),s=i.name;if("string"!=typeof s||!s)throw x.create("bad-app-name",{appName:String(s)});if(n||(n=(0,o.aH)()),!n)throw x.create("no-options");const a=R.get(s);if(a){if((0,o.vZ)(n,a.options)&&(0,o.vZ)(i,a.config))return a;throw x.create("duplicate-app",{appName:s})}const c=new r.H0(s);for(const t of k.values())c.addComponent(t);const u=new U(n,i,c);return R.set(s,u),u}function H(t=C){const e=R.get(t);if(!e&&t===C&&(0,o.aH)())return M();if(!e)throw x.create("no-app",{appName:t});return e}function j(t,e,n){var i;let o=null!==(i=A[t])&&void 0!==i?i:t;n&&(o+=`-${n}`);const s=o.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const t=[`Unable to register library "${o}" with version "${e}":`];return s&&t.push(`library name "${o}" contains illegal characters (whitespace or "/")`),s&&a&&t.push("and"),a&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void O.warn(t.join(" "))}N(new r.wA(`${o}-version`,(()=>({library:o,version:e})),"VERSION"))}const B="firebase-heartbeat-database",G=1,W="firebase-heartbeat-store";let z=null;function V(){return z||(z=function(t,e,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),a=v(s);return r&&s.addEventListener("upgradeneeded",(t=>{r(v(s.result),t.oldVersion,t.newVersion,v(s.transaction),t)})),n&&s.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{o&&t.addEventListener("close",(()=>o())),i&&t.addEventListener("versionchange",(t=>i(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}(B,G,{upgrade:(t,e)=>{if(0===e)t.createObjectStore(W)}}).catch((t=>{throw x.create("idb-open",{originalErrorMessage:t.message})}))),z}async function q(t,e){try{const n=(await V()).transaction(W,"readwrite"),r=n.objectStore(W);await r.put(e,$(t)),await n.done}catch(t){if(t instanceof o.ZR)O.warn(t.message);else{const e=x.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});O.warn(e.message)}}}function $(t){return`${t.name}!${t.options.appId}`}const Y=1024;class K{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new J(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),e=Q();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==e&&!this._heartbeatsCache.heartbeats.some((t=>t.date===e)))return this._heartbeatsCache.heartbeats.push({date:e,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const t=Q(),{heartbeatsToSend:e,unsentEntries:n}=function(t,e=Y){const n=[];let r=t.slice();for(const i of t){const t=n.find((t=>t.agent===i.agent));if(t){if(t.dates.push(i.date),X(n)>e){t.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),X(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=(0,o.L)(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function Q(){return(new Date).toISOString().substring(0,10)}class J{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,o.hl)()&&(0,o.eu)().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){return await async function(t){try{const e=await V();return await e.transaction(W).objectStore(W).get($(t))}catch(t){if(t instanceof o.ZR)O.warn(t.message);else{const e=x.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});O.warn(e.message)}}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return q(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return q(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function X(t){return(0,o.L)(JSON.stringify({version:2,heartbeats:t})).length}var Z;Z="",N(new r.wA("platform-logger",(t=>new S(t)),"PRIVATE")),N(new r.wA("heartbeat",(t=>new K(t)),"PRIVATE")),j(T,w,Z),j(T,w,"esm2017"),j("fire-js","")},8463:(t,e,n)=>{"use strict";n.d(e,{H0:()=>a,wA:()=>i});var r=n(4444);class i{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const o="[DEFAULT]";class s{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new r.BH;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:o})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=o){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=o){return this.instances.has(t)}getOptions(t=o){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(t)&&e.resolve(r)}return r}onInit(t,e){var n;const r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&t(o,r),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const r of n)try{r(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=t,r===o?void 0:r),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var r;return n||null}normalizeInstanceIdentifier(t=o){return this.component?this.component.multipleInstances?t:o:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new s(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}},3333:(t,e,n)=>{"use strict";n.d(e,{Yd:()=>u,in:()=>i});const r=[];var i;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(i||(i={}));const o={debug:i.DEBUG,verbose:i.VERBOSE,info:i.INFO,warn:i.WARN,error:i.ERROR,silent:i.SILENT},s=i.INFO,a={[i.DEBUG]:"log",[i.VERBOSE]:"log",[i.INFO]:"info",[i.WARN]:"warn",[i.ERROR]:"error"},c=(t,e,...n)=>{if(e<t.logLevel)return;const r=(new Date).toISOString(),i=a[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${r}]  ${t.name}:`,...n)};class u{constructor(t){this.name=t,this._logLevel=s,this._logHandler=c,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in i))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?o[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,i.DEBUG,...t),this._logHandler(this,i.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,i.VERBOSE,...t),this._logHandler(this,i.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,i.INFO,...t),this._logHandler(this,i.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,i.WARN,...t),this._logHandler(this,i.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,i.ERROR,...t),this._logHandler(this,i.ERROR,...t)}}},3977:(t,e,n)=>{"use strict";n.d(e,{ZF:()=>r.ZF});var r=n(389);(0,r.KN)("firebase","10.4.0","app")},77:(t,e,n)=>{"use strict";n.d(e,{v0:()=>En,wU:()=>H,Aj:()=>Kt,_p:()=>Yt,w7:()=>Qt});var r=n(4444),i=n(389),o=n(3333);function s(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}Object.create;Object.create;var a=n(8463);function c(t){return void 0!==t&&void 0!==t.enterprise}class u{constructor(t){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.emailPasswordEnabled=t.recaptchaEnforcementState.some((t=>"EMAIL_PASSWORD_PROVIDER"===t.provider&&"OFF"!==t.enforcementState))}}function l(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const h=l,d=new r.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),p=new o.Yd("@firebase/auth");function f(t,...e){p.logLevel<=o.in.ERROR&&p.error(`Auth (${i.Jn}): ${t}`,...e)}function _(t,...e){throw m(t,...e)}function g(t,...e){return m(t,...e)}function v(t,e,n){const i=Object.assign(Object.assign({},h()),{[e]:n});return new r.LL("auth","Firebase",i).create(e,{appName:t.name})}function m(t,...e){if("string"!=typeof t){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return d.create(t,...e)}function y(t,e,...n){if(!t)throw m(e,...n)}function E(t){const e="INTERNAL ASSERTION FAILED: "+t;throw f(e),new Error(e)}function I(t,e){t||E(e)}function b(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function S(){return"http:"===T()||"https:"===T()}function T(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}class w{constructor(t,e){this.shortDelay=t,this.longDelay=e,I(e>t,"Short delay should be less than long delay!"),this.isMobile=(0,r.uI)()||(0,r.b$)()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(S()||(0,r.ru)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function O(t,e){I(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class C{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void E("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void E("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void E("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const A={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},R=new w(3e4,6e4);function k(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function D(t,e,n,i,o={}){return N(t,o,(async()=>{let o={},s={};i&&("GET"===e?s=i:o={body:JSON.stringify(i)});const a=(0,r.xO)(Object.assign({key:t.config.apiKey},s)).slice(1),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode),C.fetch()(L(t,t.config.apiHost,n,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},o))}))}async function N(t,e,n){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},A),e);try{const e=new x(t),r=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw U(t,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const e=r.ok?o.errorMessage:o.error.message,[n,s]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw U(t,"credential-already-in-use",o);if("EMAIL_EXISTS"===n)throw U(t,"email-already-in-use",o);if("USER_DISABLED"===n)throw U(t,"user-disabled",o);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw v(t,a,s);_(t,a)}}catch(e){if(e instanceof r.ZR)throw e;_(t,"network-request-failed",{message:String(e)})}}async function P(t,e,n,r,i={}){const o=await D(t,e,n,r,i);return"mfaPendingCredential"in o&&_(t,"multi-factor-auth-required",{_serverResponse:o}),o}function L(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?O(t.config,i):`${t.config.apiScheme}://${i}`}class x{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(g(this.auth,"network-request-failed"))),R.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function U(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=g(t,e,r);return i.customData._tokenResponse=n,i}async function F(t,e){return D(t,"GET","/v2/recaptchaConfig",k(t,e))}function M(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function H(t,e=!1){return(0,r.m9)(t).getIdToken(e)}function j(t){return 1e3*Number(t)}function B(t){const[e,n,i]=t.split(".");if(void 0===e||void 0===n||void 0===i)return f("JWT malformed, contained fewer than 3 sections"),null;try{const t=(0,r.tV)(n);return t?JSON.parse(t):(f("Failed to decode base64 JWT payload"),null)}catch(t){return f("Caught error parsing JWT payload as JSON",null==t?void 0:t.toString()),null}}async function G(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof r.ZR&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class W{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===(null==t?void 0:t.code)&&this.schedule(!0))}this.schedule()}}class z{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=M(this.lastLoginAt),this.creationTime=M(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function V(t){var e;const n=t.auth,r=await t.getIdToken(),i=await G(t,async function(t,e){return D(t,"POST","/v1/accounts:lookup",e)}(n,{idToken:r}));y(null==i?void 0:i.users.length,n,"internal-error");const o=i.users[0];t._notifyReloadListener(o);const a=(null===(e=o.providerUserInfo)||void 0===e?void 0:e.length)?o.providerUserInfo.map((t=>{var{providerId:e}=t,n=s(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[];const c=(u=t.providerData,l=a,[...u.filter((t=>!l.some((e=>e.providerId===t.providerId)))),...l]);var u,l;const h=t.isAnonymous,d=!(t.email&&o.passwordHash||(null==c?void 0:c.length)),p=!!h&&d,f={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new z(o.createdAt,o.lastLoginAt),isAnonymous:p};Object.assign(t,f)}class q{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){y(t.idToken,"internal-error"),y(void 0!==t.idToken,"internal-error"),y(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=B(t);return y(e,"internal-error"),y(void 0!==e.exp,"internal-error"),y(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}async getToken(t,e=!1){return y(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:i,expiresIn:o}=await async function(t,e){const n=await N(t,{},(async()=>{const n=(0,r.xO)({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,s=L(t,i,"/v1/token",`key=${o}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",C.fetch()(s,{method:"POST",headers:a,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:r,expirationTime:i}=e,o=new q;return n&&(y("string"==typeof n,"internal-error",{appName:t}),o.refreshToken=n),r&&(y("string"==typeof r,"internal-error",{appName:t}),o.accessToken=r),i&&(y("number"==typeof i,"internal-error",{appName:t}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new q,this.toJSON())}_performRefresh(){return E("not implemented")}}function $(t,e){y("string"==typeof t||void 0===t,"internal-error",{appName:e})}class Y{constructor(t){var{uid:e,auth:n,stsTokenManager:r}=t,i=s(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new W(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new z(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(t){const e=await G(this,this.stsTokenManager.getToken(this.auth,t));return y(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const n=(0,r.m9)(t),i=await n.getIdToken(e),o=B(i);y(o&&o.exp&&o.auth_time&&o.iat,n.auth,"internal-error");const s="object"==typeof o.firebase?o.firebase:void 0,a=null==s?void 0:s.sign_in_provider;return{claims:o,token:i,authTime:M(j(o.auth_time)),issuedAtTime:M(j(o.iat)),expirationTime:M(j(o.exp)),signInProvider:a||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=(0,r.m9)(t);await V(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(y(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new Y(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(t){y(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await V(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await G(this,async function(t,e){return D(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,r,i,o,s,a,c,u;const l=null!==(n=e.displayName)&&void 0!==n?n:void 0,h=null!==(r=e.email)&&void 0!==r?r:void 0,d=null!==(i=e.phoneNumber)&&void 0!==i?i:void 0,p=null!==(o=e.photoURL)&&void 0!==o?o:void 0,f=null!==(s=e.tenantId)&&void 0!==s?s:void 0,_=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,g=null!==(c=e.createdAt)&&void 0!==c?c:void 0,v=null!==(u=e.lastLoginAt)&&void 0!==u?u:void 0,{uid:m,emailVerified:E,isAnonymous:I,providerData:b,stsTokenManager:S}=e;y(m&&S,t,"internal-error");const T=q.fromJSON(this.name,S);y("string"==typeof m,t,"internal-error"),$(l,t.name),$(h,t.name),y("boolean"==typeof E,t,"internal-error"),y("boolean"==typeof I,t,"internal-error"),$(d,t.name),$(p,t.name),$(f,t.name),$(_,t.name),$(g,t.name),$(v,t.name);const w=new Y({uid:m,auth:t,email:h,emailVerified:E,displayName:l,isAnonymous:I,photoURL:p,phoneNumber:d,tenantId:f,stsTokenManager:T,createdAt:g,lastLoginAt:v});return b&&Array.isArray(b)&&(w.providerData=b.map((t=>Object.assign({},t)))),_&&(w._redirectEventId=_),w}static async _fromIdTokenResponse(t,e,n=!1){const r=new q;r.updateFromServerResponse(e);const i=new Y({uid:e.localId,auth:t,stsTokenManager:r,isAnonymous:n});return await V(i),i}}const K=new Map;function Q(t){I(t instanceof Function,"Expected a class definition");let e=K.get(t);return e?(I(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,K.set(t,e),e)}class J{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}J.type="NONE";const X=J;function Z(t,e,n){return`firebase:${t}:${e}:${n}`}class tt{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=Z(this.userKey,r.apiKey,i),this.fullPersistenceKey=Z("persistence",r.apiKey,i),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?Y._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new tt(Q(X),t,n);const r=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let i=r[0]||Q(X);const o=Z(n,t.config.apiKey,t.name);let s=null;for(const n of e)try{const e=await n._get(o);if(e){const r=Y._fromJSON(t,e);n!==i&&(s=r),i=n;break}}catch(t){}const a=r.filter((t=>t._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],s&&await i._set(o,s.toJSON()),await Promise.all(e.map((async t=>{if(t!==i)try{await t._remove(o)}catch(t){}}))),new tt(i,t,n)):new tt(i,t,n)}}function et(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ot(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(nt(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(at(e))return"Blackberry";if(ct(e))return"Webos";if(rt(e))return"Safari";if((e.includes("chrome/")||it(e))&&!e.includes("edge/"))return"Chrome";if(st(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function nt(t=(0,r.z$)()){return/firefox\//i.test(t)}function rt(t=(0,r.z$)()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function it(t=(0,r.z$)()){return/crios\//i.test(t)}function ot(t=(0,r.z$)()){return/iemobile/i.test(t)}function st(t=(0,r.z$)()){return/android/i.test(t)}function at(t=(0,r.z$)()){return/blackberry/i.test(t)}function ct(t=(0,r.z$)()){return/webos/i.test(t)}function ut(t=(0,r.z$)()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function lt(t=(0,r.z$)()){return ut(t)||st(t)||ct(t)||at(t)||/windows phone/i.test(t)||ot(t)}function ht(t,e=[]){let n;switch(t){case"Browser":n=et((0,r.z$)());break;case"Worker":n=`${et((0,r.z$)())}-${t}`;break;default:n=t}const o=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${i.Jn}/${o}`}class dt{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=e=>new Promise(((n,r)=>{try{n(t(e))}catch(t){r(t)}}));n.onAbort=e,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const n of this.queue)await n(t),n.onAbort&&e.push(n.onAbort)}catch(t){e.reverse();for(const t of e)try{t()}catch(t){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==t?void 0:t.message})}}}class pt{constructor(t){var e,n,r,i;const o=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(e=o.minPasswordLength)&&void 0!==e?e:6,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),void 0!==o.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),void 0!==o.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),void 0!==o.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),void 0!==o.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=t.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=t.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=t.schemaVersion}validatePassword(t){var e,n,r,i,o,s;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,a),this.validatePasswordCharacterOptions(t,a),a.isValid&&(a.isValid=null===(e=a.meetsMinPasswordLength)||void 0===e||e),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(o=a.containsNumericCharacter)||void 0===o||o),a.isValid&&(a.isValid=null===(s=a.containsNonAlphanumericCharacter)||void 0===s||s),a}validatePasswordLengthOptions(t,e){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(e.meetsMinPasswordLength=t.length>=n),r&&(e.meetsMaxPasswordLength=t.length<=r)}validatePasswordCharacterOptions(t,e){let n;this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);for(let r=0;r<t.length;r++)n=t.charAt(r),this.updatePasswordCharacterOptionsStatuses(e,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,e,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=i))}}class ft{constructor(t,e,n,r){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gt(this),this.idTokenSubscription=new gt(this),this.beforeStateQueue=new dt(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=d,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=Q(e)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await tt.create(this,t),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(t){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t,!0):void 0}async initializeCurrentUser(t){var e;const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,o=null==r?void 0:r._redirectEventId,s=await this.tryRedirectSignIn(t);n&&n!==o||!(null==s?void 0:s.user)||(r=s.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(t){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(t)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return y(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await V(t)}catch(t){if("auth/network-request-failed"!==(null==t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const e=t?(0,r.m9)(t):null;return e&&y(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&y(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(t){return this.queue((async()=>{await this.assertedPersistence.setPersistence(Q(t))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await async function(t,e={}){return D(t,"GET","/v2/passwordPolicy",k(t,e))}(this),e=new pt(t);null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new r.LL("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}authStateReady(){return new Promise(((t,e)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged((()=>{n(),t()}),e)}}))}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&Q(t)||this._popupRedirectResolver;y(e,this,"argument-error"),this.redirectPersistenceManager=await tt.create(this,[Q(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,r){if(this._deleted)return()=>{};const i="function"==typeof e?e:e.next.bind(e);let o=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(y(s,this,"internal-error"),s.then((()=>{o||i(this.currentUser)})),"function"==typeof e){const i=t.addObserver(e,n,r);return()=>{o=!0,i()}}{const n=t.addObserver(e);return()=>{o=!0,n()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return y(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=ht(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;const e=await(null===(t=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken());return(null==e?void 0:e.error)&&function(t,...e){p.logLevel<=o.in.WARN&&p.warn(`Auth (${i.Jn}): ${t}`,...e)}(`Error while retrieving App Check token: ${e.error}`),null==e?void 0:e.token}}function _t(t){return(0,r.m9)(t)}class gt{constructor(t){this.auth=t,this.observer=null,this.addObserver=(0,r.ne)((t=>this.observer=t))}get next(){return y(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function vt(){return new Promise(((t,e)=>{t()}))}function mt(t){return`__${t}${Math.floor(1e6*Math.random())}`}const yt="NO_RECAPTCHA";class Et{constructor(t){this.type="recaptcha-enterprise",this.auth=_t(t)}async verify(t="verify",e=!1){function n(e,n,r){const i=window.grecaptcha;c(i)?i.enterprise.ready((()=>{i.enterprise.execute(e,{action:t}).then((t=>{n(t)})).catch((()=>{n(yt)}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((t,r)=>{(async function(t){if(!e){if(null==t.tenantId&&null!=t._agentRecaptchaConfig)return t._agentRecaptchaConfig.siteKey;if(null!=t.tenantId&&void 0!==t._tenantRecaptchaConfigs[t.tenantId])return t._tenantRecaptchaConfigs[t.tenantId].siteKey}return new Promise((async(e,n)=>{F(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new u(r);return null==t.tenantId?t._agentRecaptchaConfig=n:t._tenantRecaptchaConfigs[t.tenantId]=n,e(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((t=>{n(t)}))}))})(this.auth).then((i=>{if(!e&&c(window.grecaptcha))n(i,t,r);else{if("undefined"==typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));vt().then((()=>{n(i,t,r)})).catch((t=>{r(t)}))}})).catch((t=>{r(t)}))}))}}async function It(t,e,n,r=!1){const i=new Et(t);let o;try{o=await i.verify(n)}catch(t){o=await i.verify(n,!0)}const s=Object.assign({},e);return r?Object.assign(s,{captchaResp:o}):Object.assign(s,{captchaResponse:o}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}function bt(t,e,n){const r=_t(t);y(r._canInitEmulator,r,"emulator-config-failed"),y(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(null==n?void 0:n.disableWarnings),o=St(e),{host:s,port:a}=function(t){const e=St(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const t=i[1];return{host:t,port:Tt(r.substr(t.length+1))}}{const[t,e]=r.split(":");return{host:t,port:Tt(e)}}}(e),c=null===a?"":`:${a}`;r.config.emulator={url:`${o}//${s}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}function St(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Tt(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class wt{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return E("not implemented")}_getIdTokenResponse(t){return E("not implemented")}_linkToIdToken(t,e){return E("not implemented")}_getReauthenticationResolver(t){return E("not implemented")}}async function Ot(t,e){return D(t,"POST","/v1/accounts:update",e)}async function Ct(t,e){return P(t,"POST","/v1/accounts:signInWithPassword",k(t,e))}class At extends wt{constructor(t,e,n,r=null){super("password",n),this._email=t,this._password=e,this._tenantId=r}static _fromEmailAndPassword(t,e){return new At(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new At(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){var e;switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(null===(e=t._getRecaptchaConfig())||void 0===e?void 0:e.emailPasswordEnabled){const e=await It(t,n,"signInWithPassword");return Ct(t,e)}return Ct(t,n).catch((async e=>{if("auth/missing-recaptcha-token"===e.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const e=await It(t,n,"signInWithPassword");return Ct(t,e)}return Promise.reject(e)}));case"emailLink":return async function(t,e){return P(t,"POST","/v1/accounts:signInWithEmailLink",k(t,e))}(t,{email:this._email,oobCode:this._password});default:_(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return Ot(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return P(t,"POST","/v1/accounts:signInWithEmailLink",k(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:_(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function Rt(t,e){return P(t,"POST","/v1/accounts:signInWithIdp",k(t,e))}class kt extends wt{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new kt(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):_("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:r}=e,i=s(e,["providerId","signInMethod"]);if(!n||!r)return null;const o=new kt(n,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(t){return Rt(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,Rt(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,Rt(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=(0,r.xO)(e)}return t}}const Dt={USER_NOT_FOUND:"user-not-found"};class Nt extends wt{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new Nt({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new Nt({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return P(t,"POST","/v1/accounts:signInWithPhoneNumber",k(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await P(t,"POST","/v1/accounts:signInWithPhoneNumber",k(t,e));if(n.temporaryProof)throw U(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return P(t,"POST","/v1/accounts:signInWithPhoneNumber",k(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),Dt)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:r}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:r}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:r,temporaryProof:i}=t;return n||e||r||i?new Nt({verificationId:e,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Pt{constructor(t){var e,n,i,o,s,a;const c=(0,r.zd)((0,r.pd)(t)),u=null!==(e=c.apiKey)&&void 0!==e?e:null,l=null!==(n=c.oobCode)&&void 0!==n?n:null,h=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=c.mode)&&void 0!==i?i:null);y(u&&l&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=l,this.continueUrl=null!==(o=c.continueUrl)&&void 0!==o?o:null,this.languageCode=null!==(s=c.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(t){const e=function(t){const e=(0,r.zd)((0,r.pd)(t)).link,n=e?(0,r.zd)((0,r.pd)(e)).deep_link_id:null,i=(0,r.zd)((0,r.pd)(t)).deep_link_id;return(i?(0,r.zd)((0,r.pd)(i)).link:null)||i||n||e||t}(t);try{return new Pt(e)}catch(t){return null}}}class Lt{constructor(){this.providerId=Lt.PROVIDER_ID}static credential(t,e){return At._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=Pt.parseLink(e);return y(n,"argument-error"),At._fromEmailAndCode(t,n.code,n.tenantId)}}Lt.PROVIDER_ID="password",Lt.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Lt.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class xt{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class Ut extends xt{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class Ft extends Ut{constructor(){super("facebook.com")}static credential(t){return kt._fromParams({providerId:Ft.PROVIDER_ID,signInMethod:Ft.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Ft.credentialFromTaggedObject(t)}static credentialFromError(t){return Ft.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Ft.credential(t.oauthAccessToken)}catch(t){return null}}}Ft.FACEBOOK_SIGN_IN_METHOD="facebook.com",Ft.PROVIDER_ID="facebook.com";class Mt extends Ut{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return kt._fromParams({providerId:Mt.PROVIDER_ID,signInMethod:Mt.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return Mt.credentialFromTaggedObject(t)}static credentialFromError(t){return Mt.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return Mt.credential(e,n)}catch(t){return null}}}Mt.GOOGLE_SIGN_IN_METHOD="google.com",Mt.PROVIDER_ID="google.com";class Ht extends Ut{constructor(){super("github.com")}static credential(t){return kt._fromParams({providerId:Ht.PROVIDER_ID,signInMethod:Ht.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Ht.credentialFromTaggedObject(t)}static credentialFromError(t){return Ht.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Ht.credential(t.oauthAccessToken)}catch(t){return null}}}Ht.GITHUB_SIGN_IN_METHOD="github.com",Ht.PROVIDER_ID="github.com";class jt extends Ut{constructor(){super("twitter.com")}static credential(t,e){return kt._fromParams({providerId:jt.PROVIDER_ID,signInMethod:jt.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return jt.credentialFromTaggedObject(t)}static credentialFromError(t){return jt.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return jt.credential(e,n)}catch(t){return null}}}jt.TWITTER_SIGN_IN_METHOD="twitter.com",jt.PROVIDER_ID="twitter.com";class Bt{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,r=!1){const i=await Y._fromIdTokenResponse(t,n,r),o=Gt(n);return new Bt({user:i,providerId:o,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const r=Gt(n);return new Bt({user:t,providerId:r,_tokenResponse:n,operationType:e})}}function Gt(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class Wt extends r.ZR{constructor(t,e,n,r){var i;super(e.code,e.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Wt.prototype),this.customData={appName:t.name,tenantId:null!==(i=t.tenantId)&&void 0!==i?i:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,r){return new Wt(t,e,n,r)}}function zt(t,e,n,r){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Wt._fromErrorAndOperation(t,n,e,r);throw n}))}async function Vt(t,e,n=!1){const r=await G(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Bt._forOperation(t,"link",r)}async function qt(t,e,n=!1){const{auth:r}=t,i="reauthenticate";try{const o=await G(t,zt(r,i,e,t),n);y(o.idToken,r,"internal-error");const s=B(o.idToken);y(s,r,"internal-error");const{sub:a}=s;return y(t.uid===a,r,"user-mismatch"),Bt._forOperation(t,i,o)}catch(t){throw"auth/user-not-found"===(null==t?void 0:t.code)&&_(r,"user-mismatch"),t}}async function $t(t,e,n=!1){const r="signIn",i=await zt(t,r,e),o=await Bt._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(o.user),o}async function Yt(t,e){const n=_t(t),r=await async function(t,e){return P(t,"POST","/v1/accounts:signInWithCustomToken",k(t,e))}(n,{token:e,returnSecureToken:!0}),i=await Bt._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}function Kt(t,e,n,i){return(0,r.m9)(t).onAuthStateChanged(e,n,i)}function Qt(t){return(0,r.m9)(t).signOut()}new WeakMap;const Jt="__sak";class Xt{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(Jt,"1"),this.storage.removeItem(Jt),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class Zt extends Xt{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=(0,r.z$)();return rt(t)||ut(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=lt(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),r=this.localCache[e];n!==r&&t(e,r,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(t.newValue!==r)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const i=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},o=this.storage.getItem(n);(0,r.w1)()&&10===document.documentMode&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,10):i()}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}Zt.type="LOCAL";const te=Zt;class ee extends Xt{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}ee.type="SESSION";const ne=ee;class re{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new re(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:r,data:i}=e.data,o=this.handlersMap[r];if(!(null==o?void 0:o.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const s=Array.from(o).map((async t=>t(e.origin,i))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(s);e.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function ie(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}re.receivers=[];class oe{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise(((s,a)=>{const c=ie("",20);r.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);o={messageChannel:r,onMessage(t){const e=t;if(e.data.eventId===c)switch(e.data.status){case"ack":clearTimeout(u),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),s(e.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[r.port2])})).finally((()=>{o&&this.removeMessageHandler(o)}))}}function se(){return window}function ae(){return void 0!==se().WorkerGlobalScope&&"function"==typeof se().importScripts}const ce="firebaseLocalStorageDb",ue=1,le="firebaseLocalStorage",he="fbase_key";class de{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function pe(t,e){return t.transaction([le],e?"readwrite":"readonly").objectStore(le)}function fe(){const t=indexedDB.open(ce,ue);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(le,{keyPath:he})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(le)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(ce);return new de(t).toPromise()}(),e(await fe()))}))}))}async function _e(t,e,n){const r=pe(t,!0).put({[he]:e,value:n});return new de(r).toPromise()}function ge(t,e){const n=pe(t,!0).delete(e);return new de(n).toPromise()}class ve{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await fe()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ae()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=re._getInstance(ae()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new oe(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){var e;if(this.sender&&this.activeServiceWorker&&((null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await fe();return await _e(t,Jt,"1"),await ge(t,Jt),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>_e(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=pe(t,!1).get(e),r=await new de(n).toPromise();return void 0===r?null:r.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>ge(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=pe(t,!1).getAll();return new de(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;for(const{fbase_key:r,value:i}of t)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),e.push(r));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}ve.type="LOCAL";const me=ve;mt("rcb"),new w(3e4,6e4);const ye="recaptcha";async function Ee(t,e,n){var r;const i=await n.verify();try{let o;if(y("string"==typeof i,t,"argument-error"),y(n.type===ye,t,"argument-error"),o="string"==typeof e?{phoneNumber:e}:e,"session"in o){const e=o.session;if("phoneNumber"in o){y("enroll"===e.type,t,"internal-error");const n=await function(t,e){return D(t,"POST","/v2/accounts/mfaEnrollment:start",k(t,e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:o.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{y("signin"===e.type,t,"internal-error");const n=(null===(r=o.multiFactorHint)||void 0===r?void 0:r.uid)||o.multiFactorUid;y(n,t,"missing-multi-factor-info");const s=await function(t,e){return D(t,"POST","/v2/accounts/mfaSignIn:start",k(t,e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return s.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return D(t,"POST","/v1/accounts:sendVerificationCode",k(t,e))}(t,{phoneNumber:o.phoneNumber,recaptchaToken:i});return e}}finally{n._reset()}}class Ie{constructor(t){this.providerId=Ie.PROVIDER_ID,this.auth=_t(t)}verifyPhoneNumber(t,e){return Ee(this.auth,t,(0,r.m9)(e))}static credential(t,e){return Nt._fromVerification(t,e)}static credentialFromResult(t){const e=t;return Ie.credentialFromTaggedObject(e)}static credentialFromError(t){return Ie.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?Nt._fromTokenResponse(e,n):null}}function be(t,e){return e?Q(e):(y(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}Ie.PROVIDER_ID="phone",Ie.PHONE_SIGN_IN_METHOD="phone";class Se extends wt{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Rt(t,this._buildIdpRequest())}_linkToIdToken(t,e){return Rt(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return Rt(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function Te(t){return $t(t.auth,new Se(t),t.bypassAuthState)}function we(t){const{auth:e,user:n}=t;return y(n,e,"internal-error"),qt(n,new Se(t),t.bypassAuthState)}async function Oe(t){const{auth:e,user:n}=t;return y(n,e,"internal-error"),Vt(n,new Se(t),t.bypassAuthState)}class Ce{constructor(t,e,n,r,i=!1){this.auth=t,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:r,tenantId:i,error:o,type:s}=t;if(o)return void this.reject(o);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return Te;case"linkViaPopup":case"linkViaRedirect":return Oe;case"reauthViaPopup":case"reauthViaRedirect":return we;default:_(this.auth,"internal-error")}}resolve(t){I(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){I(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Ae=new w(2e3,1e4);class Re extends Ce{constructor(t,e,n,r,i){super(t,e,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Re.currentPopupAction&&Re.currentPopupAction.cancel(),Re.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return y(t,this.auth,"internal-error"),t}async onExecution(){I(1===this.filter.length,"Popup operations only handle one event");const t=ie();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(g(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(g(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Re.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(g(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(t,Ae.get())};t()}}Re.currentPopupAction=null;const ke="pendingRedirect",De=new Map;class Ne extends Ce{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=De.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=xe(e),r=Le(t);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(e)}catch(e){t=()=>Promise.reject(e)}De.set(this.auth._key(),t)}return this.bypassAuthState||De.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Pe(t,e){De.set(t._key(),e)}function Le(t){return Q(t._redirectPersistence)}function xe(t){return Z(ke,t.config.apiKey,t.name)}async function Ue(t,e,n=!1){const r=_t(t),i=be(r,e),o=new Ne(r,i,n),s=await o.execute();return s&&!n&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,e)),s}class Fe{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return He(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!He(t)){const r=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(g(this.auth,r))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Me(t))}saveEventToCache(t){this.cachedEventUids.add(Me(t)),this.lastProcessedEventTime=Date.now()}}function Me(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function He({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const je=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Be=/^https?/;async function Ge(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return D(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(We(t))return}catch(t){}_(t,"unauthorized-domain")}function We(t){const e=b(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const i=new URL(t);return""===i.hostname&&""===r?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Be.test(n))return!1;if(je.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const ze=new w(3e4,6e4);function Ve(){const t=se().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}let qe=null;function $e(t){return qe=qe||function(t){return new Promise(((e,n)=>{var r,i,o;function s(){Ve(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Ve(),n(g(t,"network-request-failed"))},timeout:ze.get()})}if(null===(i=null===(r=se().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)e(gapi.iframes.getContext());else{if(!(null===(o=se().gapi)||void 0===o?void 0:o.load)){const e=mt("iframefcb");return se()[e]=()=>{gapi.load?s():n(g(t,"network-request-failed"))},vt().catch((t=>n(t)))}s()}})).catch((t=>{throw qe=null,t}))}(t),qe}const Ye=new w(5e3,15e3),Ke="__/auth/iframe",Qe="emulator/auth/iframe",Je={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Xe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ze(t){const e=t.config;y(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?O(e,Qe):`https://${t.config.authDomain}/${Ke}`,o={apiKey:e.apiKey,appName:t.name,v:i.Jn},s=Xe.get(t.config.apiHost);s&&(o.eid=s);const a=t._getFrameworks();return a.length&&(o.fw=a.join(",")),`${n}?${(0,r.xO)(o).slice(1)}`}const tn={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},en=500,nn=600,rn="_blank",on="http://localhost";class sn{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}function an(t,e,n,i=en,o=nn){const s=Math.max((window.screen.availHeight-o)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let c="";const u=Object.assign(Object.assign({},tn),{width:i.toString(),height:o.toString(),top:s,left:a}),l=(0,r.z$)().toLowerCase();n&&(c=it(l)?rn:n),nt(l)&&(e=e||on,u.scrollbars="yes");const h=Object.entries(u).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=(0,r.z$)()){var e;return ut(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(l)&&"_self"!==c)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(e||"",c),new sn(null);const d=window.open(e||"",c,h);y(d,t,"popup-blocked");try{d.focus()}catch(t){}return new sn(d)}const cn="__/auth/handler",un="emulator/auth/handler",ln=encodeURIComponent("fac");async function hn(t,e,n,o,s,a){y(t.config.authDomain,t,"auth-domain-config-required"),y(t.config.apiKey,t,"invalid-api-key");const c={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:o,v:i.Jn,eventId:s};if(e instanceof xt){e.setDefaultLanguage(t.languageCode),c.providerId=e.providerId||"",(0,r.xb)(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(a||{}))c[t]=e}if(e instanceof Ut){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(c.scopes=t.join(","))}t.tenantId&&(c.tid=t.tenantId);const u=c;for(const t of Object.keys(u))void 0===u[t]&&delete u[t];const l=await t._getAppCheckToken(),h=l?`#${ln}=${encodeURIComponent(l)}`:"";return`${function({config:t}){if(!t.emulator)return`https://${t.authDomain}/${cn}`;return O(t,un)}(t)}?${(0,r.xO)(u).slice(1)}${h}`}const dn="webStorageSupport";const pn=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ne,this._completeRedirectFn=Ue,this._overrideRedirectResult=Pe}async _openPopup(t,e,n,r){var i;I(null===(i=this.eventManagers[t._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return an(t,await hn(t,e,n,b(),r),ie())}async _openRedirect(t,e,n,r){await this._originValidation(t);return function(t){se().location.href=t}(await hn(t,e,n,b(),r)),new Promise((()=>{}))}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(I(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch((()=>{delete this.eventManagers[e]})),n}async initAndGetManager(t){const e=await async function(t){const e=await $e(t),n=se().gapi;return y(n,t,"internal-error"),e.open({where:document.body,url:Ze(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Je,dontclear:!0},(e=>new Promise((async(n,r)=>{await e.restyle({setHideOnLeave:!1});const i=g(t,"network-request-failed"),o=se().setTimeout((()=>{r(i)}),Ye.get());function s(){se().clearTimeout(o),n(e)}e.ping(s).then(s,(()=>{r(i)}))}))))}(t),n=new Fe(t);return e.register("authEvent",(e=>{y(null==e?void 0:e.authEvent,t,"invalid-auth-event");return{status:n.onEvent(e.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(dn,{type:dn},(n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[dn];void 0!==i&&e(!!i),_(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=Ge(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return lt()||rt()||ut()}};var fn="@firebase/auth",_n="1.3.0";class gn{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(t)}}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{t((null==e?void 0:e.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){y(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const vn=(0,r.Pz)("authIdTokenMaxAge")||300;let mn=null;const yn=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>vn)return;const i=null==n?void 0:n.token;mn!==i&&(mn=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function En(t=(0,i.Mq)()){const e=(0,i.qX)(t,"auth");if(e.isInitialized())return e.getImmediate();const n=function(t,e){const n=(0,i.qX)(t,"auth");if(n.isInitialized()){const t=n.getImmediate(),i=n.getOptions();if((0,r.vZ)(i,null!=e?e:{}))return t;_(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:pn,persistence:[me,te,ne]}),o=(0,r.Pz)("authTokenSyncURL");if(o){const t=yn(o);!function(t,e,n){(0,r.m9)(t).beforeAuthStateChanged(e,n)}(n,t,(()=>t(n.currentUser))),function(t,e,n,i){(0,r.m9)(t).onIdTokenChanged(e,n,i)}(n,(e=>t(e)))}const s=(0,r.q4)("auth");return s&&bt(n,`http://${s}`),n}var In;In="Browser",(0,i.Xd)(new a.wA("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),r=t.getProvider("heartbeat"),i=t.getProvider("app-check-internal"),{apiKey:o,authDomain:s}=n.options;y(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:o,authDomain:s,clientPlatform:In,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ht(In)},c=new ft(n,r,i,a);return function(t,e){const n=(null==e?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Q);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,null==e?void 0:e.popupRedirectResolver)}(c,e),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),(0,i.Xd)(new a.wA("auth-internal",(t=>(t=>new gn(t))(_t(t.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,i.KN)(fn,_n,function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(In)),(0,i.KN)(fn,_n,"esm2017")},8679:(t,e,n)=>{"use strict";n.d(e,{U2:()=>Di,N8:()=>Gi,S1:()=>Ui,jM:()=>xi,VF:()=>Ri,iH:()=>Ci,Bt:()=>zi});var r=n(389),i=n(8463),o=n(4444),s=n(3333);const a="@firebase/database",c="1.0.1";let u="";function l(t){u=t}class h{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),(0,o.Wl)(e))}get(t){const e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:(0,o.cI)(e)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}class d{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e}get(t){return(0,o.r3)(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}const p=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new h(e)}}catch(t){}return new d},f=p("localStorage"),_=p("sessionStorage"),g=new s.Yd("@firebase/database"),v=function(){let t=1;return function(){return t++}}(),m=function(t){const e=(0,o.dS)(t),n=new o.gQ;n.update(e);const r=n.digest();return o.US.encodeByteArray(r)},y=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=y.apply(null,r):e+="object"==typeof r?(0,o.Wl)(r):r,e+=" "}return e};let E=null,I=!0;const b=function(t,e){(0,o.hu)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(g.logLevel=s.in.VERBOSE,E=g.log.bind(g),e&&_.set("logging_enabled",!0)):"function"==typeof t?E=t:(E=null,_.remove("logging_enabled"))},S=function(...t){if(!0===I&&(I=!1,null===E&&!0===_.get("logging_enabled")&&b(!0)),E){const e=y.apply(null,t);E(e)}},T=function(t){return function(...e){S(t,...e)}},w=function(...t){const e="FIREBASE INTERNAL ERROR: "+y(...t);g.error(e)},O=function(...t){const e=`FIREBASE FATAL ERROR: ${y(...t)}`;throw g.error(e),new Error(e)},C=function(...t){const e="FIREBASE WARNING: "+y(...t);g.warn(e)},A=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},R="[MIN_NAME]",k="[MAX_NAME]",D=function(t,e){if(t===e)return 0;if(t===R||e===k)return-1;if(e===R||t===k)return 1;{const n=H(t),r=H(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1}},N=function(t,e){return t===e?0:t<e?-1:1},P=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+(0,o.Wl)(e))},L=function(t){if("object"!=typeof t||null===t)return(0,o.Wl)(t);const e=[];for(const n in t)e.push(n);e.sort();let n="{";for(let r=0;r<e.length;r++)0!==r&&(n+=","),n+=(0,o.Wl)(e[r]),n+=":",n+=L(t[e[r]]);return n+="}",n},x=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function U(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const F=function(t){(0,o.hu)(!A(t),"Invalid JSON number");const e=1023;let n,r,i,s,a;0===t?(r=0,i=0,n=1/t==-1/0?1:0):(n=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(s=Math.min(Math.floor(Math.log(t)/Math.LN2),e),r=s+e,i=Math.round(t*Math.pow(2,52-s)-Math.pow(2,52))):(r=0,i=Math.round(t/Math.pow(2,-1074))));const c=[];for(a=52;a;a-=1)c.push(i%2?1:0),i=Math.floor(i/2);for(a=11;a;a-=1)c.push(r%2?1:0),r=Math.floor(r/2);c.push(n?1:0),c.reverse();const u=c.join("");let l="";for(a=0;a<64;a+=8){let t=parseInt(u.substr(a,8),2).toString(16);1===t.length&&(t="0"+t),l+=t}return l.toLowerCase()};const M=new RegExp("^-?(0*)\\d{1,10}$"),H=function(t){if(M.test(t)){const e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},j=function(t){try{t()}catch(t){setTimeout((()=>{const e=t.stack||"";throw C("Exception was thrown by user callback.",e),t}),Math.floor(0))}},B=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},G=function(t,e){const n=setTimeout(t,e);return"number"==typeof n&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};class W{constructor(t,e){this.appName_=t,this.appCheckProvider=e,this.appCheck=null==e?void 0:e.getImmediate({optional:!0}),this.appCheck||null==e||e.get().then((t=>this.appCheck=t))}getToken(t){return this.appCheck?this.appCheck.getToken(t):new Promise(((e,n)=>{setTimeout((()=>{this.appCheck?this.getToken(t).then(e,n):e(null)}),0)}))}addTokenChangeListener(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then((e=>e.addTokenListener(t)))}notifyForInvalidToken(){C(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class z{constructor(t,e,n){this.appName_=t,this.firebaseOptions_=e,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((t=>this.auth_=t))}getToken(t){return this.auth_?this.auth_.getToken(t).catch((t=>t&&"auth/token-not-initialized"===t.code?(S("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t))):new Promise(((e,n)=>{setTimeout((()=>{this.auth_?this.getToken(t).then(e,n):e(null)}),0)}))}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then((e=>e.addAuthTokenListener(t)))}removeTokenChangeListener(t){this.authProvider_.get().then((e=>e.removeAuthTokenListener(t)))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',C(t)}}class V{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}V.OWNER="owner";const q="5",$=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Y="ac",K="websocket",Q="long_polling";class J{constructor(t,e,n,r,i=!1,o="",s=!1,a=!1){this.secure=e,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this.isUsingEmulator=a,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=f.get("host:"+t)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&f.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${e}`}}function X(t,e,n){let r;if((0,o.hu)("string"==typeof e,"typeof type must == string"),(0,o.hu)("object"==typeof n,"typeof params must == object"),e===K)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(e!==Q)throw new Error("Unknown connection type: "+e);r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(n.ns=t.namespace);const i=[];return U(n,((t,e)=>{i.push(t+"="+e)})),r+i.join("&")}class Z{constructor(){this.counters_={}}incrementCounter(t,e=1){(0,o.r3)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e}get(){return(0,o.p$)(this.counters_)}}const tt={},et={};function nt(t){const e=t.toString();return tt[e]||(tt[e]=new Z),tt[e]}class rt{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,e){for(this.pendingResponses[t]=e;this.pendingResponses[this.currentResponseNum];){const t=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let e=0;e<t.length;++e)t[e]&&j((()=>{this.onMessage_(t[e])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const it="start";class ot{constructor(t,e,n,r,i,o,s){this.connId=t,this.repoInfo=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=T(t),this.stats_=nt(e),this.urlFn=t=>(this.appCheckToken&&(t[Y]=this.appCheckToken),X(e,Q,t))}open(t,e){this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new rt(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if((0,o.Yr)()||"complete"===document.readyState)t();else{let e=!1;const n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new st(((...t)=>{const[e,n,r,i,o]=t;if(this.incrementIncomingBytes_(t),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,e===it)this.id=n,this.password=r;else{if("close"!==e)throw new Error("Unrecognized command received: "+e);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...t)=>{const[e,n]=t;this.incrementIncomingBytes_(t),this.myPacketOrderer.handleResponse(e,n)}),(()=>{this.onClosed_()}),this.urlFn);const t={};t[it]="t",t.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=this.scriptTagHolder.uniqueCallbackIdentifier),t.v=q,this.transportSessionId&&(t.s=this.transportSessionId),this.lastSessionId&&(t.ls=this.lastSessionId),this.applicationId&&(t.p=this.applicationId),this.appCheckToken&&(t[Y]=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&$.test(location.hostname)&&(t.r="f");const e=this.urlFn(t);this.log_("Connecting via long-poll to "+e),this.scriptTagHolder.addTag(e,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ot.forceAllow_=!0}static forceDisallow(){ot.forceDisallow_=!0}static isAvailable(){return!(0,o.Yr)()&&(!!ot.forceAllow_||!(ot.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const e=(0,o.Wl)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const n=(0,o.h$)(e),r=x(n,1840);for(let t=0;t<r.length;t++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[t]),this.curSegmentNum++}addDisconnectPingFrame(t,e){if((0,o.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const e=(0,o.Wl)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)}}class st{constructor(t,e,n,r){if(this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,o.Yr)())this.commandCB=t,this.onMessageCB=e;else{this.uniqueCallbackIdentifier=v(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=e,this.myIFrame=st.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){n='<script>document.domain="'+document.domain+'";<\/script>'}const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(t){S("frame writing exception"),t.stack&&S(t.stack),S(t)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||S("No IE domain setting required")}catch(e){const n=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;let e=this.urlFn(t),n="",r=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const t=this.pendingSegs.shift();n=n+"&seg"+r+"="+t.seg+"&ts"+r+"="+t.ts+"&d"+r+"="+t.d,r++}}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1}enqueueSegment(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(t,e){this.outstandingRequests.add(e);const n=()=>{this.outstandingRequests.delete(e),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(t,(()=>{clearTimeout(r),n()}))}addTag(t,e){(0,o.Yr)()?this.doNodeLongPoll(t,e):setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=t,n.onload=n.onreadystatechange=function(){const t=n.readyState;t&&"loaded"!==t&&"complete"!==t||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),e())},n.onerror=()=>{S("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(t){}}),Math.floor(1))}}let at=null;"undefined"!=typeof MozWebSocket?at=MozWebSocket:"undefined"!=typeof WebSocket&&(at=WebSocket);class ct{constructor(t,e,n,r,i,o,s){this.connId=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=T(this.connId),this.stats_=nt(e),this.connURL=ct.connectionURL_(e,o,s,r,n),this.nodeAdmin=e.nodeAdmin}static connectionURL_(t,e,n,r,i){const s={};return s.v=q,!(0,o.Yr)()&&"undefined"!=typeof location&&location.hostname&&$.test(location.hostname)&&(s.r="f"),e&&(s.s=e),n&&(s.ls=n),r&&(s[Y]=r),i&&(s.p=i),X(t,K,s)}open(t,e){this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,f.set("previous_websocket_failure",!0);try{let t;if((0,o.Yr)()){const e=this.nodeAdmin?"AdminNode":"Node";t={headers:{"User-Agent":`Firebase/${q}/${u}/${process.platform}/${e}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(t.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(t.headers["X-Firebase-AppCheck"]=this.appCheckToken);const n=process.env,r=0===this.connURL.indexOf("wss://")?n.HTTPS_PROXY||n.https_proxy:n.HTTP_PROXY||n.http_proxy;r&&(t.proxy={origin:r})}this.mySock=new at(this.connURL,[],t)}catch(t){this.log_("Error instantiating WebSocket.");const e=t.message||t.data;return e&&this.log_(e),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=t=>{this.handleIncomingFrame(t)},this.mySock.onerror=t=>{this.log_("WebSocket error.  Closing connection.");const e=t.message||t.data;e&&this.log_(e),this.onClosed_()}}start(){}static forceDisallow(){ct.forceDisallow_=!0}static isAvailable(){let t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const e=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(e);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==at&&!ct.forceDisallow_}static previouslyFailed(){return f.isInMemoryStorage||!0===f.get("previous_websocket_failure")}markConnectionHealthy(){f.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const e=(0,o.cI)(t);this.onMessage(e)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,o.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{const t=this.extractFrameCount_(e);null!==t&&this.appendFrame_(t)}}send(t){this.resetKeepAlive();const e=(0,o.Wl)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const n=x(e,16384);n.length>1&&this.sendString_(String(n.length));for(let t=0;t<n.length;t++)this.sendString_(n[t])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}ct.responsesRequiredToBeHealthy=2,ct.healthyTimeout=3e4;class ut{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[ot,ct]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const e=ct&&ct.isAvailable();let n=e&&!ct.previouslyFailed();if(t.webSocketOnly&&(e||C("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[ct];else{const t=this.transports_=[];for(const e of ut.ALL_TRANSPORTS)e&&e.isAvailable()&&t.push(e);ut.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}ut.globalTransportInitialized_=!1;class lt{constructor(t,e,n,r,i,o,s,a,c,u){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=s,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=T("c:"+this.id+":"),this.transportManager_=new ut(e),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(e,n)}),Math.floor(0));const r=t.healthyTimeout||0;r>0&&(this.healthyTimeout_=G((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return e=>{t===this.conn_?this.onConnectionLost_(e):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return e=>{2!==this.state_&&(t===this.rx_?this.onPrimaryMessageReceived_(e):t===this.secondaryConn_?this.onSecondaryMessageReceived_(e):this.log_("message on old connection"))}}sendRequest(t){const e={t:"d",d:t};this.sendData_(e)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if("t"in t){const e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const e=P("t",t),n=P("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const e=P("t",t),n=P("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const e=P("t",t);if("d"in t){const n=t.d;if("h"===e){const t=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(t.h=this.repoInfo_.host),this.onHandshake_(t)}else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let t=0;t<this.pendingDataMessages.length;++t)this.onDataMessage_(this.pendingDataMessages[t]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?w("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):w("Unknown control packet command: "+e)}}onHandshake_(t){const e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),q!==n&&C("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(e,n),G((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,e){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):G((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()}onConnectionLost_(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(f.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class ht{put(t,e,n,r){}merge(t,e,n,r){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,e,n){}onDisconnectMerge(t,e,n){}onDisconnectCancel(t,e){}reportStats(t){}}class dt{constructor(t){this.allowedEvents_=t,this.listeners_={},(0,o.hu)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...e){if(Array.isArray(this.listeners_[t])){const n=[...this.listeners_[t]];for(let t=0;t<n.length;t++)n[t].callback.apply(n[t].context,e)}}on(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});const r=this.getInitialEvent(t);r&&e.apply(n,r)}off(t,e,n){this.validateEventType_(t);const r=this.listeners_[t]||[];for(let t=0;t<r.length;t++)if(r[t].callback===e&&(!n||n===r[t].context))return void r.splice(t,1)}validateEventType_(t){(0,o.hu)(this.allowedEvents_.find((e=>e===t)),"Unknown event: "+t)}}class pt extends dt{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||(0,o.uI)()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new pt}getInitialEvent(t){return(0,o.hu)("online"===t,"Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}const ft=32,_t=768;class gt{constructor(t,e){if(void 0===e){this.pieces_=t.split("/");let e=0;for(let t=0;t<this.pieces_.length;t++)this.pieces_[t].length>0&&(this.pieces_[e]=this.pieces_[t],e++);this.pieces_.length=e,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}toString(){let t="";for(let e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"}}function vt(){return new gt("")}function mt(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function yt(t){return t.pieces_.length-t.pieceNum_}function Et(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new gt(t.pieces_,e)}function It(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function bt(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function St(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new gt(e,0)}function Tt(t,e){const n=[];for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);if(e instanceof gt)for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);else{const t=e.split("/");for(let e=0;e<t.length;e++)t[e].length>0&&n.push(t[e])}return new gt(n,0)}function wt(t){return t.pieceNum_>=t.pieces_.length}function Ot(t,e){const n=mt(t),r=mt(e);if(null===n)return e;if(n===r)return Ot(Et(t),Et(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function Ct(t,e){if(yt(t)!==yt(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function At(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(yt(t)>yt(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class Rt{constructor(t,e){this.errorPrefix_=e,this.parts_=bt(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let t=0;t<this.parts_.length;t++)this.byteLength_+=(0,o.ug)(this.parts_[t]);kt(this)}}function kt(t){if(t.byteLength_>_t)throw new Error(t.errorPrefix_+"has a key path longer than "+_t+" bytes ("+t.byteLength_+").");if(t.parts_.length>ft)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+ft+") or object contains a cycle "+Dt(t))}function Dt(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}class Nt extends dt{constructor(){let t,e;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(e="visibilitychange",t="hidden"):void 0!==document.mozHidden?(e="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(e="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(e="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,e&&document.addEventListener(e,(()=>{const e=!document[t];e!==this.visible_&&(this.visible_=e,this.trigger("visible",e))}),!1)}static getInstance(){return new Nt}getInitialEvent(t){return(0,o.hu)("visible"===t,"Unknown event type: "+t),[this.visible_]}}const Pt=1e3;class Lt extends ht{constructor(t,e,n,r,i,s,a,c){if(super(),this.repoInfo_=t,this.applicationId_=e,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=Lt.nextPersistentConnectionId_++,this.log_=T("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Pt,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!(0,o.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Nt.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&pt.getInstance().on("online",this.onOnline_,this)}sendRequest(t,e,n){const r=++this.requestNumber_,i={r,a:t,b:e};this.log_((0,o.Wl)(i)),(0,o.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(t){this.initConnection_();const e=new o.BH,n={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:t=>{const n=t.d;"ok"===t.s?e.resolve(n):e.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),e.promise}listen(t,e,n,r){this.initConnection_();const i=t._queryIdentifier,s=t._path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),(0,o.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,o.hu)(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(s).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(t){const e=this.outstandingGets_[t];this.sendRequest("g",e.request,(n=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),e.onComplete&&e.onComplete(n)}))}sendListen_(t){const e=t.query,n=e._path.toString(),r=e._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};t.tag&&(i.q=e._queryObject,i.t=t.tag),i.h=t.hashFn(),this.sendRequest("q",i,(i=>{const o=i.d,s=i.s;Lt.warnOnListenWarnings_(o,e);(this.listens.get(n)&&this.listens.get(n).get(r))===t&&(this.log_("listen response",i),"ok"!==s&&this.removeListen_(n,r),t.onComplete&&t.onComplete(s,o))}))}static warnOnListenWarnings_(t,e){if(t&&"object"==typeof t&&(0,o.r3)(t,"w")){const n=(0,o.DV)(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const t='".indexOn": "'+e._queryParams.getIndex().toString()+'"',n=e._path.toString();C(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${t} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,o.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,e=(0,o.w9)(t)?"auth":"gauth",n={cred:t};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(e,n,(e=>{const n=e.s,r=e.d||"error";this.authToken_===t&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(t=>{const e=t.s,n=t.d||"error";"ok"===e?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(e,n)}))}unlisten(t,e){const n=t._path.toString(),r=t._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),(0,o.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t._queryObject,e)}sendUnlisten_(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);const i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})}onDisconnectMerge(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})}onDisconnectCancel(t,e){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})}sendOnDisconnect_(t,e,n,r){const i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,(t=>{r&&setTimeout((()=>{r(t.s,t.d)}),Math.floor(0))}))}put(t,e,n,r){this.putInternal("p",t,e,n,r)}merge(t,e,n,r){this.putInternal("m",t,e,n,r)}putInternal(t,e,n,r,i){this.initConnection_();const o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;const s=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(s):this.log_("Buffering put: "+e)}sendPut_(t){const e=this.outstandingPuts_[t].action,n=this.outstandingPuts_[t].request,r=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(e,n,(n=>{this.log_(e+" response",n),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(t){if(this.connected_){const e={c:t};this.log_("reportStats",e),this.sendRequest("s",e,(t=>{if("ok"!==t.s){const e=t.d;this.log_("reportStats","Error sending stats: "+e)}}))}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,o.Wl)(t));const e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"apc"===t?this.onAppCheckRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):w("Unrecognized action received from server: "+(0,o.Wl)(t)+"\nAre you using the latest client?")}onReady_(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,o.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Pt,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Pt,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Pt),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),e=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Lt.nextConnectionId_++,i=this.lastSessionId;let s=!1,a=null;const c=function(){a?a.close():(s=!0,n())},u=function(t){(0,o.hu)(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(t)};this.realtime_={close:c,sendRequest:u};const l=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[o,c]=await Promise.all([this.authTokenProvider_.getToken(l),this.appCheckTokenProvider_.getToken(l)]);s?S("getToken() completed but was canceled"):(S("getToken() completed. Creating connection."),this.authToken_=o&&o.accessToken,this.appCheckToken_=c&&c.token,a=new lt(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,e,n,(t=>{C(t+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(t){this.log_("Failed to get token: "+t),s||(this.repoInfo_.nodeAdmin&&C(t),c())}}}interrupt(t){S("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){S("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,o.xb)(this.interruptReasons_)&&(this.reconnectDelay_=Pt,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,e){let n;n=e?e.map((t=>L(t))).join("$"):"default";const r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(t,e){const n=new gt(t).toString();let r;if(this.listens.has(n)){const t=this.listens.get(n);r=t.get(e),t.delete(e),0===t.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(t,e){S("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,e){S("App check token revoked: "+t+"/"+e),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const e of t.values())this.sendListen_(e);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let e="js";(0,o.Yr)()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+u.replace(/\./g,"-")]=1,(0,o.uI)()?t["framework.cordova"]=1:(0,o.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=pt.getInstance().currentlyOnline();return(0,o.xb)(this.interruptReasons_)&&t}}Lt.nextPersistentConnectionId_=0,Lt.nextConnectionId_=0;class xt{constructor(t,e){this.name=t,this.node=e}static Wrap(t,e){return new xt(t,e)}}class Ut{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,e){const n=new xt(R,t),r=new xt(R,e);return 0!==this.compare(n,r)}minPost(){return xt.MIN}}let Ft;class Mt extends Ut{static get __EMPTY_NODE(){return Ft}static set __EMPTY_NODE(t){Ft=t}compare(t,e){return D(t.name,e.name)}isDefinedOn(t){throw(0,o.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,e){return!1}minPost(){return xt.MIN}maxPost(){return new xt(k,Ft)}makePost(t,e){return(0,o.hu)("string"==typeof t,"KeyIndex indexValue must always be a string."),new xt(t,Ft)}toString(){return".key"}}const Ht=new Mt;class jt{constructor(t,e,n,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!t.isEmpty();)if(o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class Bt{constructor(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Bt.RED,this.left=null!=r?r:Gt.EMPTY_NODE,this.right=null!=i?i:Gt.EMPTY_NODE}copy(t,e,n,r,i){return new Bt(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let r=this;const i=n(t,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return Gt.EMPTY_NODE;let t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,e){let n,r;if(n=this,e(t,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Gt.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,Bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,Bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}Bt.RED=!0,Bt.BLACK=!1;class Gt{constructor(t,e=Gt.EMPTY_NODE){this.comparator_=t,this.root_=e}insert(t,e){return new Gt(this.comparator_,this.root_.insert(t,e,this.comparator_).copy(null,null,Bt.BLACK,null,null))}remove(t){return new Gt(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Bt.BLACK,null,null))}get(t){let e,n=this.root_;for(;!n.isEmpty();){if(e=this.comparator_(t,n.key),0===e)return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null}getPredecessorKey(t){let e,n=this.root_,r=null;for(;!n.isEmpty();){if(e=this.comparator_(t,n.key),0===e){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new jt(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,e){return new jt(this.root_,t,this.comparator_,!1,e)}getReverseIteratorFrom(t,e){return new jt(this.root_,t,this.comparator_,!0,e)}getReverseIterator(t){return new jt(this.root_,null,this.comparator_,!0,t)}}function Wt(t,e){return D(t.name,e.name)}function zt(t,e){return D(t,e)}let Vt;Gt.EMPTY_NODE=new class{copy(t,e,n,r,i){return this}insert(t,e,n){return new Bt(t,e,null)}remove(t,e){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const qt=function(t){return"number"==typeof t?"number:"+F(t):"string:"+t},$t=function(t){if(t.isLeafNode()){const e=t.val();(0,o.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,o.r3)(e,".sv"),"Priority must be a string or number.")}else(0,o.hu)(t===Vt||t.isEmpty(),"priority of unexpected type.");(0,o.hu)(t===Vt||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Yt,Kt,Qt;class Jt{constructor(t,e=Jt.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=e,this.lazyHash_=null,(0,o.hu)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),$t(this.priorityNode_)}static set __childrenNodeConstructor(t){Yt=t}static get __childrenNodeConstructor(){return Yt}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new Jt(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:Jt.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return wt(t)?this:".priority"===mt(t)?this.priorityNode_:Jt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,e){return null}updateImmediateChild(t,e){return".priority"===t?this.updatePriority(e):e.isEmpty()&&".priority"!==t?this:Jt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,e).updatePriority(this.priorityNode_)}updateChild(t,e){const n=mt(t);return null===n?e:e.isEmpty()&&".priority"!==n?this:((0,o.hu)(".priority"!==n||1===yt(t),".priority must be the last token in a path"),this.updateImmediateChild(n,Jt.__childrenNodeConstructor.EMPTY_NODE.updateChild(Et(t),e)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,e){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+qt(this.priorityNode_.val())+":");const e=typeof this.value_;t+=e+":",t+="number"===e?F(this.value_):this.value_,this.lazyHash_=m(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===Jt.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof Jt.__childrenNodeConstructor?-1:((0,o.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const e=typeof t.value_,n=typeof this.value_,r=Jt.VALUE_TYPE_ORDER.indexOf(e),i=Jt.VALUE_TYPE_ORDER.indexOf(n);return(0,o.hu)(r>=0,"Unknown leaf type: "+e),(0,o.hu)(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1}}Jt.VALUE_TYPE_ORDER=["object","boolean","number","string"];const Xt=new class extends Ut{compare(t,e){const n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?D(t.name,e.name):i}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,e){return!t.getPriority().equals(e.getPriority())}minPost(){return xt.MIN}maxPost(){return new xt(k,new Jt("[PRIORITY-POST]",Qt))}makePost(t,e){const n=Kt(t);return new xt(e,new Jt("[PRIORITY-POST]",n))}toString(){return".priority"}},Zt=Math.log(2);class te{constructor(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/Zt,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=t+1&n}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const ee=function(t,e,n,r){t.sort(e);const i=function(e,r){const o=r-e;let s,a;if(0===o)return null;if(1===o)return s=t[e],a=n?n(s):s,new Bt(a,s.node,Bt.BLACK,null,null);{const c=parseInt(o/2,10)+e,u=i(e,c),l=i(c+1,r);return s=t[c],a=n?n(s):s,new Bt(a,s.node,Bt.BLACK,u,l)}},o=function(e){let r=null,o=null,s=t.length;const a=function(e,r){const o=s-e,a=s;s-=e;const u=i(o+1,a),l=t[o],h=n?n(l):l;c(new Bt(h,l.node,r,null,u))},c=function(t){r?(r.left=t,r=t):(o=t,r=t)};for(let t=0;t<e.count;++t){const n=e.nextBitIsOne(),r=Math.pow(2,e.count-(t+1));n?a(r,Bt.BLACK):(a(r,Bt.BLACK),a(r,Bt.RED))}return o}(new te(t.length));return new Gt(r||e,o)};let ne;const re={};class ie{constructor(t,e){this.indexes_=t,this.indexSet_=e}static get Default(){return(0,o.hu)(re&&Xt,"ChildrenNode.ts has not been loaded"),ne=ne||new ie({".priority":re},{".priority":Xt}),ne}get(t){const e=(0,o.DV)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Gt?e:null}hasIndex(t){return(0,o.r3)(this.indexSet_,t.toString())}addIndex(t,e){(0,o.hu)(t!==Ht,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=e.getIterator(xt.Wrap);let s,a=i.getNext();for(;a;)r=r||t.isDefinedOn(a.node),n.push(a),a=i.getNext();s=r?ee(n,t.getCompare()):re;const c=t.toString(),u=Object.assign({},this.indexSet_);u[c]=t;const l=Object.assign({},this.indexes_);return l[c]=s,new ie(l,u)}addToIndexes(t,e){const n=(0,o.UI)(this.indexes_,((n,r)=>{const i=(0,o.DV)(this.indexSet_,r);if((0,o.hu)(i,"Missing index implementation for "+r),n===re){if(i.isDefinedOn(t.node)){const n=[],r=e.getIterator(xt.Wrap);let o=r.getNext();for(;o;)o.name!==t.name&&n.push(o),o=r.getNext();return n.push(t),ee(n,i.getCompare())}return re}{const r=e.get(t.name);let i=n;return r&&(i=i.remove(new xt(t.name,r))),i.insert(t,t.node)}}));return new ie(n,this.indexSet_)}removeFromIndexes(t,e){const n=(0,o.UI)(this.indexes_,(n=>{if(n===re)return n;{const r=e.get(t.name);return r?n.remove(new xt(t.name,r)):n}}));return new ie(n,this.indexSet_)}}let oe;class se{constructor(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&$t(this.priorityNode_),this.children_.isEmpty()&&(0,o.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return oe||(oe=new se(new Gt(zt),null,ie.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||oe}updatePriority(t){return this.children_.isEmpty()?this:new se(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const e=this.children_.get(t);return null===e?oe:e}}getChild(t){const e=mt(t);return null===e?this:this.getImmediateChild(e).getChild(Et(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,e){if((0,o.hu)(e,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(e);{const n=new xt(t,e);let r,i;e.isEmpty()?(r=this.children_.remove(t),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(t,e),i=this.indexMap_.addToIndexes(n,this.children_));const o=r.isEmpty()?oe:this.priorityNode_;return new se(r,o,i)}}updateChild(t,e){const n=mt(t);if(null===n)return e;{(0,o.hu)(".priority"!==mt(t)||1===yt(t),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(Et(t),e);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const e={};let n=0,r=0,i=!0;if(this.forEachChild(Xt,((o,s)=>{e[o]=s.val(t),n++,i&&se.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):i=!1})),!t&&i&&r<2*n){const t=[];for(const n in e)t[n]=e[n];return t}return t&&!this.getPriority().isEmpty()&&(e[".priority"]=this.getPriority().val()),e}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+qt(this.getPriority().val())+":"),this.forEachChild(Xt,((e,n)=>{const r=n.hash();""!==r&&(t+=":"+e+":"+r)})),this.lazyHash_=""===t?"":m(t)}return this.lazyHash_}getPredecessorChildName(t,e,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new xt(t,e));return n?n.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const e=this.resolveIndex_(t);if(e){const t=e.minKey();return t&&t.name}return this.children_.minKey()}getFirstChild(t){const e=this.getFirstChildName(t);return e?new xt(e,this.children_.get(e)):null}getLastChildName(t){const e=this.resolveIndex_(t);if(e){const t=e.maxKey();return t&&t.name}return this.children_.maxKey()}getLastChild(t){const e=this.getLastChildName(t);return e?new xt(e,this.children_.get(e)):null}forEachChild(t,e){const n=this.resolveIndex_(t);return n?n.inorderTraversal((t=>e(t.name,t.node))):this.children_.inorderTraversal(e)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,e){const n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(t=>t));{const n=this.children_.getIteratorFrom(t.name,xt.Wrap);let r=n.peek();for(;null!=r&&e.compare(r,t)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,e){const n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(t=>t));{const n=this.children_.getReverseIteratorFrom(t.name,xt.Wrap);let r=n.peek();for(;null!=r&&e.compare(r,t)>0;)n.getNext(),r=n.peek();return n}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===ae?-1:0}withIndex(t){if(t===Ht||this.indexMap_.hasIndex(t))return this;{const e=this.indexMap_.addIndex(t,this.children_);return new se(this.children_,this.priorityNode_,e)}}isIndexed(t){return t===Ht||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){const t=this.getIterator(Xt),n=e.getIterator(Xt);let r=t.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=t.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(t){return t===Ht?null:this.indexMap_.get(t.toString())}}se.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const ae=new class extends se{constructor(){super(new Gt(zt),se.EMPTY_NODE,ie.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return se.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(xt,{MIN:{value:new xt(R,se.EMPTY_NODE)},MAX:{value:new xt(k,ae)}}),Mt.__EMPTY_NODE=se.EMPTY_NODE,Jt.__childrenNodeConstructor=se,Vt=ae,function(t){Qt=t}(ae);const ce=!0;function ue(t,e=null){if(null===t)return se.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),(0,o.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t){return new Jt(t,ue(e))}if(t instanceof Array||!ce){let n=se.EMPTY_NODE;return U(t,((e,r)=>{if((0,o.r3)(t,e)&&"."!==e.substring(0,1)){const t=ue(r);!t.isLeafNode()&&t.isEmpty()||(n=n.updateImmediateChild(e,t))}})),n.updatePriority(ue(e))}{const n=[];let r=!1;if(U(t,((t,e)=>{if("."!==t.substring(0,1)){const i=ue(e);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new xt(t,i)))}})),0===n.length)return se.EMPTY_NODE;const i=ee(n,Wt,(t=>t.name),zt);if(r){const t=ee(n,Xt.getCompare());return new se(i,ue(e),new ie({".priority":t},{".priority":Xt}))}return new se(i,ue(e),ie.Default)}}!function(t){Kt=t}(ue);class le extends Ut{constructor(t){super(),this.indexPath_=t,(0,o.hu)(!wt(t)&&".priority"!==mt(t),"Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,e){const n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?D(t.name,e.name):i}makePost(t,e){const n=ue(t),r=se.EMPTY_NODE.updateChild(this.indexPath_,n);return new xt(e,r)}maxPost(){const t=se.EMPTY_NODE.updateChild(this.indexPath_,ae);return new xt(k,t)}toString(){return bt(this.indexPath_,0).join("/")}}const he=new class extends Ut{compare(t,e){const n=t.node.compareTo(e.node);return 0===n?D(t.name,e.name):n}isDefinedOn(t){return!0}indexedValueChanged(t,e){return!t.equals(e)}minPost(){return xt.MIN}maxPost(){return xt.MAX}makePost(t,e){const n=ue(t);return new xt(e,n)}toString(){return".value"}};function de(t){return{type:"value",snapshotNode:t}}function pe(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function fe(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function _e(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}class ge{constructor(t){this.index_=t}updateChild(t,e,n,r,i,s){(0,o.hu)(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=t.getImmediateChild(e);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()===n.isEmpty()?t:(null!=s&&(n.isEmpty()?t.hasChild(e)?s.trackChildChange(fe(e,a)):(0,o.hu)(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?s.trackChildChange(pe(e,n)):s.trackChildChange(_e(e,n,a))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))}updateFullNode(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(Xt,((t,r)=>{e.hasChild(t)||n.trackChildChange(fe(t,r))})),e.isLeafNode()||e.forEachChild(Xt,((e,r)=>{if(t.hasChild(e)){const i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(_e(e,r,i))}else n.trackChildChange(pe(e,r))}))),e.withIndex(this.index_)}updatePriority(t,e){return t.isEmpty()?se.EMPTY_NODE:t.updatePriority(e)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class ve{constructor(t){this.indexedFilter_=new ge(t.getIndex()),this.index_=t.getIndex(),this.startPost_=ve.getStartPost_(t),this.endPost_=ve.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const e=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,n=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return e&&n}updateChild(t,e,n,r,i,o){return this.matches(new xt(e,n))||(n=se.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)}updateFullNode(t,e,n){e.isLeafNode()&&(e=se.EMPTY_NODE);let r=e.withIndex(this.index_);r=r.updatePriority(se.EMPTY_NODE);const i=this;return e.forEachChild(Xt,((t,e)=>{i.matches(new xt(t,e))||(r=r.updateImmediateChild(t,se.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,r,n)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()}}class me{constructor(t){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const e=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?e<=0:e<0},this.withinEndPost=t=>{const e=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?e<=0:e<0},this.rangedFilter_=new ve(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,e,n,r,i,o){return this.rangedFilter_.matches(new xt(e,n))||(n=se.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)}updateFullNode(t,e,n){let r;if(e.isLeafNode()||e.isEmpty())r=se.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){let t;r=se.EMPTY_NODE.withIndex(this.index_),t=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;t.hasNext()&&n<this.limit_;){const e=t.getNext();if(this.withinDirectionalStart(e)){if(!this.withinDirectionalEnd(e))break;r=r.updateImmediateChild(e.name,e.node),n++}}}else{let t;r=e.withIndex(this.index_),r=r.updatePriority(se.EMPTY_NODE),t=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);let n=0;for(;t.hasNext();){const e=t.getNext();n<this.limit_&&this.withinDirectionalStart(e)&&this.withinDirectionalEnd(e)?n++:r=r.updateImmediateChild(e.name,se.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,e,n,r,i){let s;if(this.reverse_){const t=this.index_.getCompare();s=(e,n)=>t(n,e)}else s=this.index_.getCompare();const a=t;(0,o.hu)(a.numChildren()===this.limit_,"");const c=new xt(e,n),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),l=this.rangedFilter_.matches(c);if(a.hasChild(e)){const t=a.getImmediateChild(e);let o=r.getChildAfterChild(this.index_,u,this.reverse_);for(;null!=o&&(o.name===e||a.hasChild(o.name));)o=r.getChildAfterChild(this.index_,o,this.reverse_);const h=null==o?1:s(o,c);if(l&&!n.isEmpty()&&h>=0)return null!=i&&i.trackChildChange(_e(e,n,t)),a.updateImmediateChild(e,n);{null!=i&&i.trackChildChange(fe(e,t));const n=a.updateImmediateChild(e,se.EMPTY_NODE);return null!=o&&this.rangedFilter_.matches(o)?(null!=i&&i.trackChildChange(pe(o.name,o.node)),n.updateImmediateChild(o.name,o.node)):n}}return n.isEmpty()?t:l&&s(u,c)>=0?(null!=i&&(i.trackChildChange(fe(u.name,u.node)),i.trackChildChange(pe(e,n))),a.updateImmediateChild(e,n).updateImmediateChild(u.name,se.EMPTY_NODE)):t}}class ye{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Xt}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,o.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,o.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:R}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,o.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,o.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:k}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,o.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Xt}copy(){const t=new ye;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function Ee(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Xt?n="$priority":t.index_===he?n="$value":t.index_===Ht?n="$key":((0,o.hu)(t.index_ instanceof le,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=(0,o.Wl)(n),t.startSet_){const n=t.startAfterSet_?"startAfter":"startAt";e[n]=(0,o.Wl)(t.indexStartValue_),t.startNameSet_&&(e[n]+=","+(0,o.Wl)(t.indexStartName_))}if(t.endSet_){const n=t.endBeforeSet_?"endBefore":"endAt";e[n]=(0,o.Wl)(t.indexEndValue_),t.endNameSet_&&(e[n]+=","+(0,o.Wl)(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Ie(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==Xt&&(e.i=t.index_.toString()),e}class be extends ht{constructor(t,e,n,r){super(),this.repoInfo_=t,this.onDataUpdate_=e,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=T("p:rest:"),this.listens_={}}reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,e){return void 0!==e?"tag$"+e:((0,o.hu)(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}listen(t,e,n,r){const i=t._path.toString();this.log_("Listen called for "+i+" "+t._queryIdentifier);const s=be.getListenId_(t,n),a={};this.listens_[s]=a;const c=Ee(t._queryParams);this.restRequest_(i+".json",c,((t,e)=>{let c=e;if(404===t&&(c=null,t=null),null===t&&this.onDataUpdate_(i,c,!1,n),(0,o.DV)(this.listens_,s)===a){let e;e=t?401===t?"permission_denied":"rest_error:"+t:"ok",r(e,null)}}))}unlisten(t,e){const n=be.getListenId_(t,e);delete this.listens_[n]}get(t){const e=Ee(t._queryParams),n=t._path.toString(),r=new o.BH;return this.restRequest_(n+".json",e,((t,e)=>{let i=e;404===t&&(i=null,t=null),null===t?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(t){}restRequest_(t,e={},n){return e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([r,i])=>{r&&r.accessToken&&(e.auth=r.accessToken),i&&i.token&&(e.ac=i.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+(0,o.xO)(e);this.log_("Sending REST request for "+s);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(n&&4===a.readyState){this.log_("REST Response for "+s+" received. status:",a.status,"response:",a.responseText);let t=null;if(a.status>=200&&a.status<300){try{t=(0,o.cI)(a.responseText)}catch(t){C("Failed to parse JSON response for "+s+": "+a.responseText)}n(null,t)}else 401!==a.status&&404!==a.status&&C("Got unsuccessful REST response for "+s+" Status: "+a.status),n(a.status);n=null}},a.open("GET",s,!0),a.send()}))}}class Se{constructor(){this.rootNode_=se.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)}}function Te(){return{value:null,children:new Map}}function we(t,e,n){if(wt(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{const r=mt(e);t.children.has(r)||t.children.set(r,Te());we(t.children.get(r),e=Et(e),n)}}function Oe(t,e,n){null!==t.value?n(e,t.value):function(t,e){t.children.forEach(((t,n)=>{e(n,t)}))}(t,((t,r)=>{Oe(r,new gt(e.toString()+"/"+t),n)}))}class Ce{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),e=Object.assign({},t);return this.last_&&U(this.last_,((t,n)=>{e[t]=e[t]-n})),this.last_=t,e}}class Ae{constructor(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Ce(t);const n=1e4+2e4*Math.random();G(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const t=this.statsListener_.get(),e={};let n=!1;U(t,((t,r)=>{r>0&&(0,o.r3)(this.statsToReport_,t)&&(e[t]=r,n=!0)})),n&&this.server_.reportStats(e),G(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Re;function ke(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Re||(Re={}));class De{constructor(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=Re.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(t){if(wt(this.path)){if(null!=this.affectedTree.value)return(0,o.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const e=this.affectedTree.subtree(new gt(t));return new De(vt(),e,this.revert)}}return(0,o.hu)(mt(this.path)===t,"operationForChild called for unrelated child."),new De(Et(this.path),this.affectedTree,this.revert)}}class Ne{constructor(t,e){this.source=t,this.path=e,this.type=Re.LISTEN_COMPLETE}operationForChild(t){return wt(this.path)?new Ne(this.source,vt()):new Ne(this.source,Et(this.path))}}class Pe{constructor(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=Re.OVERWRITE}operationForChild(t){return wt(this.path)?new Pe(this.source,vt(),this.snap.getImmediateChild(t)):new Pe(this.source,Et(this.path),this.snap)}}class Le{constructor(t,e,n){this.source=t,this.path=e,this.children=n,this.type=Re.MERGE}operationForChild(t){if(wt(this.path)){const e=this.children.subtree(new gt(t));return e.isEmpty()?null:e.value?new Pe(this.source,vt(),e.value):new Le(this.source,vt(),e)}return(0,o.hu)(mt(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new Le(this.source,Et(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class xe{constructor(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(wt(t))return this.isFullyInitialized()&&!this.filtered_;const e=mt(t);return this.isCompleteForChild(e)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}class Ue{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function Fe(t,e,n,r,i,s){const a=r.filter((t=>t.type===n));a.sort(((e,n)=>function(t,e,n){if(null==e.childName||null==n.childName)throw(0,o.g5)("Should only compare child_ events.");const r=new xt(e.childName,e.snapshotNode),i=new xt(n.childName,n.snapshotNode);return t.index_.compare(r,i)}(t,e,n))),a.forEach((n=>{const r=function(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,n,s);i.forEach((i=>{i.respondsTo(n.type)&&e.push(i.createEvent(r,t.query_))}))}))}function Me(t,e){return{eventCache:t,serverCache:e}}function He(t,e,n,r){return Me(new xe(e,n,r),t.serverCache)}function je(t,e,n,r){return Me(t.eventCache,new xe(e,n,r))}function Be(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Ge(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}let We;class ze{constructor(t,e=(()=>(We||(We=new Gt(N)),We))()){this.value=t,this.children=e}static fromObject(t){let e=new ze(null);return U(t,((t,n)=>{e=e.set(new gt(t),n)})),e}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,e){if(null!=this.value&&e(this.value))return{path:vt(),value:this.value};if(wt(t))return null;{const n=mt(t),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(Et(t),e);if(null!=i){return{path:Tt(new gt(n),i.path),value:i.value}}return null}return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,(()=>!0))}subtree(t){if(wt(t))return this;{const e=mt(t),n=this.children.get(e);return null!==n?n.subtree(Et(t)):new ze(null)}}set(t,e){if(wt(t))return new ze(e,this.children);{const n=mt(t),r=(this.children.get(n)||new ze(null)).set(Et(t),e),i=this.children.insert(n,r);return new ze(this.value,i)}}remove(t){if(wt(t))return this.children.isEmpty()?new ze(null):new ze(null,this.children);{const e=mt(t),n=this.children.get(e);if(n){const r=n.remove(Et(t));let i;return i=r.isEmpty()?this.children.remove(e):this.children.insert(e,r),null===this.value&&i.isEmpty()?new ze(null):new ze(this.value,i)}return this}}get(t){if(wt(t))return this.value;{const e=mt(t),n=this.children.get(e);return n?n.get(Et(t)):null}}setTree(t,e){if(wt(t))return e;{const n=mt(t),r=(this.children.get(n)||new ze(null)).setTree(Et(t),e);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new ze(this.value,i)}}fold(t){return this.fold_(vt(),t)}fold_(t,e){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_(Tt(t,r),e)})),e(t,this.value,n)}findOnPath(t,e){return this.findOnPath_(t,vt(),e)}findOnPath_(t,e,n){const r=!!this.value&&n(e,this.value);if(r)return r;if(wt(t))return null;{const r=mt(t),i=this.children.get(r);return i?i.findOnPath_(Et(t),Tt(e,r),n):null}}foreachOnPath(t,e){return this.foreachOnPath_(t,vt(),e)}foreachOnPath_(t,e,n){if(wt(t))return this;{this.value&&n(e,this.value);const r=mt(t),i=this.children.get(r);return i?i.foreachOnPath_(Et(t),Tt(e,r),n):new ze(null)}}foreach(t){this.foreach_(vt(),t)}foreach_(t,e){this.children.inorderTraversal(((n,r)=>{r.foreach_(Tt(t,n),e)})),this.value&&e(t,this.value)}foreachChild(t){this.children.inorderTraversal(((e,n)=>{n.value&&t(e,n.value)}))}}class Ve{constructor(t){this.writeTree_=t}static empty(){return new Ve(new ze(null))}}function qe(t,e,n){if(wt(e))return new Ve(new ze(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let o=r.value;const s=Ot(i,e);return o=o.updateChild(s,n),new Ve(t.writeTree_.set(i,o))}{const r=new ze(n),i=t.writeTree_.setTree(e,r);return new Ve(i)}}}function $e(t,e,n){let r=t;return U(n,((t,n)=>{r=qe(r,Tt(e,t),n)})),r}function Ye(t,e){if(wt(e))return Ve.empty();{const n=t.writeTree_.setTree(e,new ze(null));return new Ve(n)}}function Ke(t,e){return null!=Qe(t,e)}function Qe(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(Ot(n.path,e)):null}function Je(t){const e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Xt,((t,n)=>{e.push(new xt(t,n))})):t.writeTree_.children.inorderTraversal(((t,n)=>{null!=n.value&&e.push(new xt(t,n.value))})),e}function Xe(t,e){if(wt(e))return t;{const n=Qe(t,e);return new Ve(null!=n?new ze(n):t.writeTree_.subtree(e))}}function Ze(t){return t.writeTree_.isEmpty()}function tn(t,e){return en(vt(),t.writeTree_,e)}function en(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal(((e,i)=>{".priority"===e?((0,o.hu)(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=en(Tt(t,e),i,n)})),n.getChild(t).isEmpty()||null===r||(n=n.updateChild(Tt(t,".priority"),r)),n}}function nn(t,e){return gn(e,t)}function rn(t,e){const n=t.allWrites.findIndex((t=>t.writeId===e));(0,o.hu)(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,a=t.allWrites.length-1;for(;i&&a>=0;){const e=t.allWrites[a];e.visible&&(a>=n&&on(e,r.path)?i=!1:At(r.path,e.path)&&(s=!0)),a--}if(i){if(s)return function(t){t.visibleWrites=an(t.allWrites,sn,vt()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}(t),!0;if(r.snap)t.visibleWrites=Ye(t.visibleWrites,r.path);else{U(r.children,(e=>{t.visibleWrites=Ye(t.visibleWrites,Tt(r.path,e))}))}return!0}return!1}function on(t,e){if(t.snap)return At(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&At(Tt(t.path,n),e))return!0;return!1}function sn(t){return t.visible}function an(t,e,n){let r=Ve.empty();for(let i=0;i<t.length;++i){const s=t[i];if(e(s)){const t=s.path;let e;if(s.snap)At(n,t)?(e=Ot(n,t),r=qe(r,e,s.snap)):At(t,n)&&(e=Ot(t,n),r=qe(r,vt(),s.snap.getChild(e)));else{if(!s.children)throw(0,o.g5)("WriteRecord should have .snap or .children");if(At(n,t))e=Ot(n,t),r=$e(r,e,s.children);else if(At(t,n))if(e=Ot(t,n),wt(e))r=$e(r,vt(),s.children);else{const t=(0,o.DV)(s.children,mt(e));if(t){const n=t.getChild(Et(e));r=qe(r,vt(),n)}}}}}return r}function cn(t,e,n,r,i){if(r||i){const o=Xe(t.visibleWrites,e);if(!i&&Ze(o))return n;if(i||null!=n||Ke(o,vt())){const o=function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(At(t.path,e)||At(e,t.path))};return tn(an(t.allWrites,o,e),n||se.EMPTY_NODE)}return null}{const r=Qe(t.visibleWrites,e);if(null!=r)return r;{const r=Xe(t.visibleWrites,e);if(Ze(r))return n;if(null!=n||Ke(r,vt())){return tn(r,n||se.EMPTY_NODE)}return null}}}function un(t,e,n,r){return cn(t.writeTree,t.treePath,e,n,r)}function ln(t,e){return function(t,e,n){let r=se.EMPTY_NODE;const i=Qe(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Xt,((t,e)=>{r=r.updateImmediateChild(t,e)})),r;if(n){const i=Xe(t.visibleWrites,e);return n.forEachChild(Xt,((t,e)=>{const n=tn(Xe(i,new gt(t)),e);r=r.updateImmediateChild(t,n)})),Je(i).forEach((t=>{r=r.updateImmediateChild(t.name,t.node)})),r}return Je(Xe(t.visibleWrites,e)).forEach((t=>{r=r.updateImmediateChild(t.name,t.node)})),r}(t.writeTree,t.treePath,e)}function hn(t,e,n,r){return function(t,e,n,r,i){(0,o.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Tt(e,n);if(Ke(t.visibleWrites,s))return null;{const e=Xe(t.visibleWrites,s);return Ze(e)?i.getChild(n):tn(e,i.getChild(n))}}(t.writeTree,t.treePath,e,n,r)}function dn(t,e){return function(t,e){return Qe(t.visibleWrites,e)}(t.writeTree,Tt(t.treePath,e))}function pn(t,e,n,r,i,o){return function(t,e,n,r,i,o,s){let a;const c=Xe(t.visibleWrites,e),u=Qe(c,vt());if(null!=u)a=u;else{if(null==n)return[];a=tn(c,n)}if(a=a.withIndex(s),a.isEmpty()||a.isLeafNode())return[];{const t=[],e=s.getCompare(),n=o?a.getReverseIteratorFrom(r,s):a.getIteratorFrom(r,s);let c=n.getNext();for(;c&&t.length<i;)0!==e(c,r)&&t.push(c),c=n.getNext();return t}}(t.writeTree,t.treePath,e,n,r,i,o)}function fn(t,e,n){return function(t,e,n,r){const i=Tt(e,n),o=Qe(t.visibleWrites,i);if(null!=o)return o;if(r.isCompleteForChild(n))return tn(Xe(t.visibleWrites,i),r.getNode().getImmediateChild(n));return null}(t.writeTree,t.treePath,e,n)}function _n(t,e){return gn(Tt(t.treePath,e),t.writeTree)}function gn(t,e){return{treePath:t,writeTree:e}}class vn{constructor(){this.changeMap=new Map}trackChildChange(t){const e=t.type,n=t.childName;(0,o.hu)("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),(0,o.hu)(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const i=r.type;if("child_added"===e&&"child_removed"===i)this.changeMap.set(n,_e(n,t.snapshotNode,r.snapshotNode));else if("child_removed"===e&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===e&&"child_changed"===i)this.changeMap.set(n,fe(n,r.oldSnap));else if("child_changed"===e&&"child_added"===i)this.changeMap.set(n,pe(n,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==i)throw(0,o.g5)("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,_e(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)}getChanges(){return Array.from(this.changeMap.values())}}const mn=new class{getCompleteChild(t){return null}getChildAfterChild(t,e,n){return null}};class yn{constructor(t,e,n=null){this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}getCompleteChild(t){const e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);{const e=null!=this.optCompleteServerCache_?new xe(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return fn(this.writes_,t,e)}}getChildAfterChild(t,e,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Ge(this.viewCache_),i=pn(this.writes_,r,e,1,n,t);return 0===i.length?null:i[0]}}function En(t,e,n,r,i){const s=new vn;let a,c;if(n.type===Re.OVERWRITE){const u=n;u.source.fromUser?a=Sn(t,e,u.path,u.snap,r,i,s):((0,o.hu)(u.source.fromServer,"Unknown source."),c=u.source.tagged||e.serverCache.isFiltered()&&!wt(u.path),a=bn(t,e,u.path,u.snap,r,i,c,s))}else if(n.type===Re.MERGE){const u=n;u.source.fromUser?a=function(t,e,n,r,i,o,s){let a=e;return r.foreach(((r,c)=>{const u=Tt(n,r);Tn(e,mt(u))&&(a=Sn(t,a,u,c,i,o,s))})),r.foreach(((r,c)=>{const u=Tt(n,r);Tn(e,mt(u))||(a=Sn(t,a,u,c,i,o,s))})),a}(t,e,u.path,u.children,r,i,s):((0,o.hu)(u.source.fromServer,"Unknown source."),c=u.source.tagged||e.serverCache.isFiltered(),a=On(t,e,u.path,u.children,r,i,c,s))}else if(n.type===Re.ACK_USER_WRITE){const c=n;a=c.revert?function(t,e,n,r,i,s){let a;if(null!=dn(r,n))return e;{const c=new yn(r,e,i),u=e.eventCache.getNode();let l;if(wt(n)||".priority"===mt(n)){let n;if(e.serverCache.isFullyInitialized())n=un(r,Ge(e));else{const t=e.serverCache.getNode();(0,o.hu)(t instanceof se,"serverChildren would be complete if leaf node"),n=ln(r,t)}l=t.filter.updateFullNode(u,n,s)}else{const i=mt(n);let o=fn(r,i,e.serverCache);null==o&&e.serverCache.isCompleteForChild(i)&&(o=u.getImmediateChild(i)),l=null!=o?t.filter.updateChild(u,i,o,Et(n),c,s):e.eventCache.getNode().hasChild(i)?t.filter.updateChild(u,i,se.EMPTY_NODE,Et(n),c,s):u,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(a=un(r,Ge(e)),a.isLeafNode()&&(l=t.filter.updateFullNode(l,a,s)))}return a=e.serverCache.isFullyInitialized()||null!=dn(r,vt()),He(e,l,a,t.filter.filtersNodes())}}(t,e,c.path,r,i,s):function(t,e,n,r,i,o,s){if(null!=dn(i,n))return e;const a=e.serverCache.isFiltered(),c=e.serverCache;if(null!=r.value){if(wt(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return bn(t,e,n,c.getNode().getChild(n),i,o,a,s);if(wt(n)){let r=new ze(null);return c.getNode().forEachChild(Ht,((t,e)=>{r=r.set(new gt(t),e)})),On(t,e,n,r,i,o,a,s)}return e}{let u=new ze(null);return r.foreach(((t,e)=>{const r=Tt(n,t);c.isCompleteForPath(r)&&(u=u.set(t,c.getNode().getChild(r)))})),On(t,e,n,u,i,o,a,s)}}(t,e,c.path,c.affectedTree,r,i,s)}else{if(n.type!==Re.LISTEN_COMPLETE)throw(0,o.g5)("Unknown operation type: "+n.type);a=function(t,e,n,r,i){const o=e.serverCache,s=je(e,o.getNode(),o.isFullyInitialized()||wt(n),o.isFiltered());return In(t,s,n,r,mn,i)}(t,e,n.path,r,s)}const u=s.getChanges();return function(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=Be(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(de(Be(e)))}}(e,a,u),{viewCache:a,changes:u}}function In(t,e,n,r,i,s){const a=e.eventCache;if(null!=dn(r,n))return e;{let c,u;if(wt(n))if((0,o.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const n=Ge(e),i=ln(r,n instanceof se?n:se.EMPTY_NODE);c=t.filter.updateFullNode(e.eventCache.getNode(),i,s)}else{const n=un(r,Ge(e));c=t.filter.updateFullNode(e.eventCache.getNode(),n,s)}else{const l=mt(n);if(".priority"===l){(0,o.hu)(1===yt(n),"Can't have a priority with additional path components");const i=a.getNode();u=e.serverCache.getNode();const s=hn(r,n,i,u);c=null!=s?t.filter.updatePriority(i,s):a.getNode()}else{const o=Et(n);let h;if(a.isCompleteForChild(l)){u=e.serverCache.getNode();const t=hn(r,n,a.getNode(),u);h=null!=t?a.getNode().getImmediateChild(l).updateChild(o,t):a.getNode().getImmediateChild(l)}else h=fn(r,l,e.serverCache);c=null!=h?t.filter.updateChild(a.getNode(),l,h,o,i,s):a.getNode()}}return He(e,c,a.isFullyInitialized()||wt(n),t.filter.filtersNodes())}}function bn(t,e,n,r,i,o,s,a){const c=e.serverCache;let u;const l=s?t.filter:t.filter.getIndexedFilter();if(wt(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){const t=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),t,null)}else{const t=mt(n);if(!c.isCompleteForPath(n)&&yt(n)>1)return e;const i=Et(n),o=c.getNode().getImmediateChild(t).updateChild(i,r);u=".priority"===t?l.updatePriority(c.getNode(),o):l.updateChild(c.getNode(),t,o,i,mn,null)}const h=je(e,u,c.isFullyInitialized()||wt(n),l.filtersNodes());return In(t,h,n,i,new yn(i,h,o),a)}function Sn(t,e,n,r,i,o,s){const a=e.eventCache;let c,u;const l=new yn(i,e,o);if(wt(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,s),c=He(e,u,!0,t.filter.filtersNodes());else{const i=mt(n);if(".priority"===i)u=t.filter.updatePriority(e.eventCache.getNode(),r),c=He(e,u,a.isFullyInitialized(),a.isFiltered());else{const o=Et(n),u=a.getNode().getImmediateChild(i);let h;if(wt(o))h=r;else{const t=l.getCompleteChild(i);h=null!=t?".priority"===It(o)&&t.getChild(St(o)).isEmpty()?t:t.updateChild(o,r):se.EMPTY_NODE}if(u.equals(h))c=e;else{c=He(e,t.filter.updateChild(a.getNode(),i,h,o,l,s),a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function Tn(t,e){return t.eventCache.isCompleteForChild(e)}function wn(t,e,n){return n.foreach(((t,n)=>{e=e.updateChild(t,n)})),e}function On(t,e,n,r,i,o,s,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c,u=e;c=wt(n)?r:new ze(null).setTree(n,r);const l=e.serverCache.getNode();return c.children.inorderTraversal(((n,r)=>{if(l.hasChild(n)){const c=wn(0,e.serverCache.getNode().getImmediateChild(n),r);u=bn(t,u,new gt(n),c,i,o,s,a)}})),c.children.inorderTraversal(((n,r)=>{const c=!e.serverCache.isCompleteForChild(n)&&null===r.value;if(!l.hasChild(n)&&!c){const c=wn(0,e.serverCache.getNode().getImmediateChild(n),r);u=bn(t,u,new gt(n),c,i,o,s,a)}})),u}class Cn{constructor(t,e){this.query_=t,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new ge(n.getIndex()),i=(o=n).loadsAllData()?new ge(o.getIndex()):o.hasLimit()?new me(o):new ve(o);var o;this.processor_=function(t){return{filter:t}}(i);const s=e.serverCache,a=e.eventCache,c=r.updateFullNode(se.EMPTY_NODE,s.getNode(),null),u=i.updateFullNode(se.EMPTY_NODE,a.getNode(),null),l=new xe(c,s.isFullyInitialized(),r.filtersNodes()),h=new xe(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=Me(h,l),this.eventGenerator_=new Ue(this.query_)}get query(){return this.query_}}function An(t,e){const n=Ge(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!wt(e)&&!n.getImmediateChild(mt(e)).isEmpty())?n.getChild(e):null}function Rn(t){return 0===t.eventRegistrations_.length}function kn(t,e,n){const r=[];if(n){(0,o.hu)(null==e,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach((t=>{const e=t.createCancelEvent(n,i);e&&r.push(e)}))}if(e){let n=[];for(let r=0;r<t.eventRegistrations_.length;++r){const i=t.eventRegistrations_[r];if(i.matches(e)){if(e.hasAnyCallback()){n=n.concat(t.eventRegistrations_.slice(r+1));break}}else n.push(i)}t.eventRegistrations_=n}else t.eventRegistrations_=[];return r}function Dn(t,e,n,r){e.type===Re.MERGE&&null!==e.source.queryId&&((0,o.hu)(Ge(t.viewCache_),"We should always have a full cache before handling merges"),(0,o.hu)(Be(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,s=En(t.processor_,i,e,n,r);var a,c;return a=t.processor_,c=s.viewCache,(0,o.hu)(c.eventCache.getNode().isIndexed(a.filter.getIndex()),"Event snap not indexed"),(0,o.hu)(c.serverCache.getNode().isIndexed(a.filter.getIndex()),"Server snap not indexed"),(0,o.hu)(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,Nn(t,s.changes,s.viewCache.eventCache.getNode(),null)}function Nn(t,e,n,r){const i=r?[r]:t.eventRegistrations_;return function(t,e,n,r){const i=[],o=[];return e.forEach((e=>{var n;"child_changed"===e.type&&t.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push((n=e.childName,{type:"child_moved",snapshotNode:e.snapshotNode,childName:n}))})),Fe(t,i,"child_removed",e,r,n),Fe(t,i,"child_added",e,r,n),Fe(t,i,"child_moved",o,r,n),Fe(t,i,"child_changed",e,r,n),Fe(t,i,"value",e,r,n),i}(t.eventGenerator_,e,n,i)}let Pn,Ln;class xn{constructor(){this.views=new Map}}function Un(t,e,n,r){const i=e.source.queryId;if(null!==i){const s=t.views.get(i);return(0,o.hu)(null!=s,"SyncTree gave us an op for an invalid query."),Dn(s,e,n,r)}{let i=[];for(const o of t.views.values())i=i.concat(Dn(o,e,n,r));return i}}function Fn(t,e,n,r,i){const o=e._queryIdentifier,s=t.views.get(o);if(!s){let t=un(n,i?r:null),o=!1;t?o=!0:r instanceof se?(t=ln(n,r),o=!1):(t=se.EMPTY_NODE,o=!1);const s=Me(new xe(t,o,!1),new xe(r,i,!1));return new Cn(e,s)}return s}function Mn(t,e,n,r,i,o){const s=Fn(t,e,r,i,o);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,s),function(t,e){t.eventRegistrations_.push(e)}(s,n),function(t,e){const n=t.viewCache_.eventCache,r=[];n.getNode().isLeafNode()||n.getNode().forEachChild(Xt,((t,e)=>{r.push(pe(t,e))}));return n.isFullyInitialized()&&r.push(de(n.getNode())),Nn(t,r,n.getNode(),e)}(s,n)}function Hn(t,e,n,r){const i=e._queryIdentifier,s=[];let a=[];const c=zn(t);if("default"===i)for(const[e,i]of t.views.entries())a=a.concat(kn(i,n,r)),Rn(i)&&(t.views.delete(e),i.query._queryParams.loadsAllData()||s.push(i.query));else{const e=t.views.get(i);e&&(a=a.concat(kn(e,n,r)),Rn(e)&&(t.views.delete(i),e.query._queryParams.loadsAllData()||s.push(e.query)))}return c&&!zn(t)&&s.push(new((0,o.hu)(Pn,"Reference.ts has not been loaded"),Pn)(e._repo,e._path)),{removed:s,events:a}}function jn(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Bn(t,e){let n=null;for(const r of t.views.values())n=n||An(r,e);return n}function Gn(t,e){if(e._queryParams.loadsAllData())return Vn(t);{const n=e._queryIdentifier;return t.views.get(n)}}function Wn(t,e){return null!=Gn(t,e)}function zn(t){return null!=Vn(t)}function Vn(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let qn=1;class $n{constructor(t){this.listenProvider_=t,this.syncPointTree_=new ze(null),this.pendingWriteTree_={visibleWrites:Ve.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Yn(t,e,n,r,i){return function(t,e,n,r,i){(0,o.hu)(r>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=qe(t.visibleWrites,e,n)),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r,i),i?nr(t,new Pe({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,n)):[]}function Kn(t,e,n=!1){const r=function(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}(t.pendingWriteTree_,e);if(rn(t.pendingWriteTree_,e)){let e=new ze(null);return null!=r.snap?e=e.set(vt(),!0):U(r.children,(t=>{e=e.set(new gt(t),!0)})),nr(t,new De(r.path,e,n))}return[]}function Qn(t,e,n){return nr(t,new Pe({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function Jn(t,e,n,r,i=!1){const o=e._path,s=t.syncPointTree_.get(o);let a=[];if(s&&("default"===e._queryIdentifier||Wn(s,e))){const c=Hn(s,e,n,r);0===s.views.size&&(t.syncPointTree_=t.syncPointTree_.remove(o));const u=c.removed;if(a=c.events,!i){const n=-1!==u.findIndex((t=>t._queryParams.loadsAllData())),i=t.syncPointTree_.findOnPath(o,((t,e)=>zn(e)));if(n&&!i){const e=t.syncPointTree_.subtree(o);if(!e.isEmpty()){const n=function(t){return t.fold(((t,e,n)=>{if(e&&zn(e)){return[Vn(e)]}{let t=[];return e&&(t=jn(e)),U(n,((e,n)=>{t=t.concat(n)})),t}}))}(e);for(let e=0;e<n.length;++e){const r=n[e],i=r.query,o=or(t,r);t.listenProvider_.startListening(hr(i),sr(t,i),o.hashFn,o.onComplete)}}}if(!i&&u.length>0&&!r)if(n){const n=null;t.listenProvider_.stopListening(hr(e),n)}else u.forEach((e=>{const n=t.queryToTagMap.get(ar(e));t.listenProvider_.stopListening(hr(e),n)}))}!function(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const e=ar(r),n=t.queryToTagMap.get(e);t.queryToTagMap.delete(e),t.tagToQueryMap.delete(n)}}}(t,u)}return a}function Xn(t,e,n,r){const i=cr(t,r);if(null!=i){const r=ur(i),o=r.path,s=r.queryId,a=Ot(o,e);return lr(t,o,new Pe(ke(s),a,n))}return[]}function Zn(t,e,n,r=!1){const i=e._path;let s=null,a=!1;t.syncPointTree_.foreachOnPath(i,((t,e)=>{const n=Ot(t,i);s=s||Bn(e,n),a=a||zn(e)}));let c,u=t.syncPointTree_.get(i);if(u?(a=a||zn(u),s=s||Bn(u,vt())):(u=new xn,t.syncPointTree_=t.syncPointTree_.set(i,u)),null!=s)c=!0;else{c=!1,s=se.EMPTY_NODE;t.syncPointTree_.subtree(i).foreachChild(((t,e)=>{const n=Bn(e,vt());n&&(s=s.updateImmediateChild(t,n))}))}const l=Wn(u,e);if(!l&&!e._queryParams.loadsAllData()){const n=ar(e);(0,o.hu)(!t.queryToTagMap.has(n),"View does not exist, but we have a tag");const r=qn++;t.queryToTagMap.set(n,r),t.tagToQueryMap.set(r,n)}let h=Mn(u,e,n,nn(t.pendingWriteTree_,i),s,c);if(!l&&!a&&!r){const n=Gn(u,e);h=h.concat(function(t,e,n){const r=e._path,i=sr(t,e),s=or(t,n),a=t.listenProvider_.startListening(hr(e),i,s.hashFn,s.onComplete),c=t.syncPointTree_.subtree(r);if(i)(0,o.hu)(!zn(c.value),"If we're adding a query, it shouldn't be shadowed");else{const e=c.fold(((t,e,n)=>{if(!wt(t)&&e&&zn(e))return[Vn(e).query];{let t=[];return e&&(t=t.concat(jn(e).map((t=>t.query)))),U(n,((e,n)=>{t=t.concat(n)})),t}}));for(let n=0;n<e.length;++n){const r=e[n];t.listenProvider_.stopListening(hr(r),sr(t,r))}}return a}(t,e,n))}return h}function tr(t,e,n){const r=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,((t,n)=>{const r=Bn(n,Ot(t,e));if(r)return r}));return cn(r,e,i,n,!0)}function er(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,((t,e)=>{const i=Ot(t,n);r=r||Bn(e,i)}));let i=t.syncPointTree_.get(n);i?r=r||Bn(i,vt()):(i=new xn,t.syncPointTree_=t.syncPointTree_.set(n,i));const o=null!=r,s=o?new xe(r,!0,!1):null;return function(t){return Be(t.viewCache_)}(Fn(i,e,nn(t.pendingWriteTree_,e._path),o?s.getNode():se.EMPTY_NODE,o))}function nr(t,e){return rr(e,t.syncPointTree_,null,nn(t.pendingWriteTree_,vt()))}function rr(t,e,n,r){if(wt(t.path))return ir(t,e,n,r);{const i=e.get(vt());null==n&&null!=i&&(n=Bn(i,vt()));let o=[];const s=mt(t.path),a=t.operationForChild(s),c=e.children.get(s);if(c&&a){const t=n?n.getImmediateChild(s):null,e=_n(r,s);o=o.concat(rr(a,c,t,e))}return i&&(o=o.concat(Un(i,t,r,n))),o}}function ir(t,e,n,r){const i=e.get(vt());null==n&&null!=i&&(n=Bn(i,vt()));let o=[];return e.children.inorderTraversal(((e,i)=>{const s=n?n.getImmediateChild(e):null,a=_n(r,e),c=t.operationForChild(e);c&&(o=o.concat(ir(c,i,s,a)))})),i&&(o=o.concat(Un(i,t,r,n))),o}function or(t,e){const n=e.query,r=sr(t,n);return{hashFn:()=>{const t=function(t){return t.viewCache_.serverCache.getNode()}(e)||se.EMPTY_NODE;return t.hash()},onComplete:e=>{if("ok"===e)return r?function(t,e,n){const r=cr(t,n);if(r){const n=ur(r),i=n.path,o=n.queryId,s=Ot(i,e);return lr(t,i,new Ne(ke(o),s))}return[]}(t,n._path,r):function(t,e){return nr(t,new Ne({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(t,n._path);{const r=function(t,e){let n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}(e,n);return Jn(t,n,null,r)}}}}function sr(t,e){const n=ar(e);return t.queryToTagMap.get(n)}function ar(t){return t._path.toString()+"$"+t._queryIdentifier}function cr(t,e){return t.tagToQueryMap.get(e)}function ur(t){const e=t.indexOf("$");return(0,o.hu)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new gt(t.substr(0,e))}}function lr(t,e,n){const r=t.syncPointTree_.get(e);(0,o.hu)(r,"Missing sync point for query tag that we're tracking");return Un(r,n,nn(t.pendingWriteTree_,e),null)}function hr(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new((0,o.hu)(Ln,"Reference.ts has not been loaded"),Ln)(t._repo,t._path):t}class dr{constructor(t){this.node_=t}getImmediateChild(t){const e=this.node_.getImmediateChild(t);return new dr(e)}node(){return this.node_}}class pr{constructor(t,e){this.syncTree_=t,this.path_=e}getImmediateChild(t){const e=Tt(this.path_,t);return new pr(this.syncTree_,e)}node(){return tr(this.syncTree_,this.path_)}}const fr=function(t){return(t=t||{}).timestamp=t.timestamp||(new Date).getTime(),t},_r=function(t,e,n){return t&&"object"==typeof t?((0,o.hu)(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?gr(t[".sv"],e,n):"object"==typeof t[".sv"]?vr(t[".sv"],e):void(0,o.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},gr=function(t,e,n){if("timestamp"===t)return n.timestamp;(0,o.hu)(!1,"Unexpected server value: "+t)},vr=function(t,e,n){t.hasOwnProperty("increment")||(0,o.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;"number"!=typeof r&&(0,o.hu)(!1,"Unexpected increment value: "+r);const i=e.node();if((0,o.hu)(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const s=i.getValue();return"number"!=typeof s?r:s+r},mr=function(t,e,n,r){return Er(e,new pr(n,t),r)},yr=function(t,e,n){return Er(t,new dr(e),n)};function Er(t,e,n){const r=t.getPriority().val(),i=_r(r,e.getImmediateChild(".priority"),n);let o;if(t.isLeafNode()){const r=t,o=_r(r.getValue(),e,n);return o!==r.getValue()||i!==r.getPriority().val()?new Jt(o,ue(i)):t}{const r=t;return o=r,i!==r.getPriority().val()&&(o=o.updatePriority(new Jt(i))),r.forEachChild(Xt,((t,r)=>{const i=Er(r,e.getImmediateChild(t),n);i!==r&&(o=o.updateImmediateChild(t,i))})),o}}class Ir{constructor(t="",e=null,n={children:{},childCount:0}){this.name=t,this.parent=e,this.node=n}}function br(t,e){let n=e instanceof gt?e:new gt(e),r=t,i=mt(n);for(;null!==i;){const t=(0,o.DV)(r.node.children,i)||{children:{},childCount:0};r=new Ir(i,r,t),n=Et(n),i=mt(n)}return r}function Sr(t){return t.node.value}function Tr(t,e){t.node.value=e,Rr(t)}function wr(t){return t.node.childCount>0}function Or(t,e){U(t.node.children,((n,r)=>{e(new Ir(n,t,r))}))}function Cr(t,e,n,r){n&&!r&&e(t),Or(t,(t=>{Cr(t,e,!0,r)})),n&&r&&e(t)}function Ar(t){return new gt(null===t.parent?t.name:Ar(t.parent)+"/"+t.name)}function Rr(t){null!==t.parent&&function(t,e,n){const r=function(t){return void 0===Sr(t)&&!wr(t)}(n),i=(0,o.r3)(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,Rr(t)):r||i||(t.node.children[e]=n.node,t.node.childCount++,Rr(t))}(t.parent,t.name,t)}const kr=/[\[\].#$\/\u0000-\u001F\u007F]/,Dr=/[\[\].#$\u0000-\u001F\u007F]/,Nr=10485760,Pr=function(t){return"string"==typeof t&&0!==t.length&&!kr.test(t)},Lr=function(t){return"string"==typeof t&&0!==t.length&&!Dr.test(t)},xr=function(t,e,n,r){r&&void 0===e||Ur((0,o.gK)(t,"value"),e,n)},Ur=function(t,e,n){const r=n instanceof gt?new Rt(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+Dt(r));if("function"==typeof e)throw new Error(t+"contains a function "+Dt(r)+" with contents = "+e.toString());if(A(e))throw new Error(t+"contains "+e.toString()+" "+Dt(r));if("string"==typeof e&&e.length>Nr/3&&(0,o.ug)(e)>Nr)throw new Error(t+"contains a string greater than "+Nr+" utf8 bytes "+Dt(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let n=!1,i=!1;if(U(e,((e,s)=>{if(".value"===e)n=!0;else if(".priority"!==e&&".sv"!==e&&(i=!0,!Pr(e)))throw new Error(t+" contains an invalid key ("+e+") "+Dt(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=(0,o.ug)(e),kt(t)}(r,e),Ur(t,s,r),function(t){const e=t.parts_.pop();t.byteLength_-=(0,o.ug)(e),t.parts_.length>0&&(t.byteLength_-=1)}(r)})),n&&i)throw new Error(t+' contains ".value" child '+Dt(r)+" in addition to actual children.")}},Fr=function(t,e,n,r){if(!(r&&void 0===n||Lr(n)))throw new Error((0,o.gK)(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Mr=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Fr(t,e,n,r)},Hr=function(t,e){if(".info"===mt(e))throw new Error(t+" failed = Can't modify data under /.info/")},jr=function(t,e){const n=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!Pr(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Lr(t)}(n))throw new Error((0,o.gK)(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Br{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Gr(t,e){let n=null;for(let r=0;r<e.length;r++){const i=e[r],o=i.getPath();null===n||Ct(o,n.path)||(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&t.eventLists_.push(n)}function Wr(t,e,n){Gr(t,n),Vr(t,(t=>Ct(t,e)))}function zr(t,e,n){Gr(t,n),Vr(t,(t=>At(t,e)||At(e,t)))}function Vr(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const i=t.eventLists_[r];if(i){e(i.path)?(qr(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function qr(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(null!==n){t.events[e]=null;const r=n.getEventRunner();E&&S("event: "+n.toString()),j(r)}}}const $r="repo_interrupt",Yr=25;class Kr{constructor(t,e,n,r){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Br,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Te(),this.transactionQueueTree_=new Ir,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Qr(t,e,n){if(t.stats_=nt(t.repoInfo_),t.forceRestClient_||B())t.server_=new be(t.repoInfo_,((e,n,r,i)=>{Zr(t,e,n,r,i)}),t.authTokenProvider_,t.appCheckProvider_),setTimeout((()=>ti(t,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,o.Wl)(n)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}t.persistentConnection_=new Lt(t.repoInfo_,e,((e,n,r,i)=>{Zr(t,e,n,r,i)}),(e=>{ti(t,e)}),(e=>{!function(t,e){U(e,((e,n)=>{ei(t,e,n)}))}(t,e)}),t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener((e=>{t.server_.refreshAuthToken(e)})),t.appCheckProvider_.addTokenChangeListener((e=>{t.server_.refreshAppCheckToken(e.token)})),t.statsReporter_=function(t,e){const n=t.toString();return et[n]||(et[n]=e()),et[n]}(t.repoInfo_,(()=>new Ae(t.stats_,t.server_))),t.infoData_=new Se,t.infoSyncTree_=new $n({startListening:(e,n,r,i)=>{let o=[];const s=t.infoData_.getNode(e._path);return s.isEmpty()||(o=Qn(t.infoSyncTree_,e._path,s),setTimeout((()=>{i("ok")}),0)),o},stopListening:()=>{}}),ei(t,"connected",!1),t.serverSyncTree_=new $n({startListening:(e,n,r,i)=>(t.server_.listen(e,r,n,((n,r)=>{const o=i(n,r);zr(t.eventQueue_,e._path,o)})),[]),stopListening:(e,n)=>{t.server_.unlisten(e,n)}})}function Jr(t){const e=t.infoData_.getNode(new gt(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function Xr(t){return fr({timestamp:Jr(t)})}function Zr(t,e,n,r,i){t.dataUpdateCount++;const s=new gt(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let a=[];if(i)if(r){const e=(0,o.UI)(n,(t=>ue(t)));a=function(t,e,n,r){const i=cr(t,r);if(i){const r=ur(i),o=r.path,s=r.queryId,a=Ot(o,e),c=ze.fromObject(n);return lr(t,o,new Le(ke(s),a,c))}return[]}(t.serverSyncTree_,s,e,i)}else{const e=ue(n);a=Xn(t.serverSyncTree_,s,e,i)}else if(r){const e=(0,o.UI)(n,(t=>ue(t)));a=function(t,e,n){const r=ze.fromObject(n);return nr(t,new Le({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(t.serverSyncTree_,s,e)}else{const e=ue(n);a=Qn(t.serverSyncTree_,s,e)}let c=s;a.length>0&&(c=li(t,s)),zr(t.eventQueue_,c,a)}function ti(t,e){ei(t,"connected",e),!1===e&&function(t){si(t,"onDisconnectEvents");const e=Xr(t),n=Te();Oe(t.onDisconnect_,vt(),((r,i)=>{const o=mr(r,i,t.serverSyncTree_,e);we(n,r,o)}));let r=[];Oe(n,vt(),((e,n)=>{r=r.concat(Qn(t.serverSyncTree_,e,n));const i=_i(t,e);li(t,i)})),t.onDisconnect_=Te(),zr(t.eventQueue_,vt(),r)}(t)}function ei(t,e,n){const r=new gt("/.info/"+e),i=ue(n);t.infoData_.updateSnapshot(r,i);const o=Qn(t.infoSyncTree_,r,i);zr(t.eventQueue_,r,o)}function ni(t){return t.nextWriteId_++}function ri(t,e,n,r,i){si(t,"set",{path:e.toString(),value:n,priority:r});const o=Xr(t),s=ue(n,r),a=tr(t.serverSyncTree_,e),c=yr(s,a,o),u=ni(t),l=Yn(t.serverSyncTree_,e,c,u,!0);Gr(t.eventQueue_,l),t.server_.put(e.toString(),s.val(!0),((n,r)=>{const o="ok"===n;o||C("set at "+e+" failed: "+n);const s=Kn(t.serverSyncTree_,u,!o);zr(t.eventQueue_,e,s),ai(t,i,n,r)}));const h=_i(t,e);li(t,h),zr(t.eventQueue_,h,[])}function ii(t,e,n){let r;r=".info"===mt(e._path)?Jn(t.infoSyncTree_,e,n):Jn(t.serverSyncTree_,e,n),Wr(t.eventQueue_,e._path,r)}function oi(t){t.persistentConnection_&&t.persistentConnection_.interrupt($r)}function si(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),S(n,...e)}function ai(t,e,n,r){e&&j((()=>{if("ok"===n)e(null);else{const t=(n||"error").toUpperCase();let i=t;r&&(i+=": "+r);const o=new Error(i);o.code=t,e(o)}}))}function ci(t,e,n){return tr(t.serverSyncTree_,e,n)||se.EMPTY_NODE}function ui(t,e=t.transactionQueueTree_){if(e||fi(t,e),Sr(e)){const n=di(t,e);(0,o.hu)(n.length>0,"Sending zero length transaction queue");n.every((t=>0===t.status))&&function(t,e,n){const r=n.map((t=>t.currentWriteId)),i=ci(t,e,r);let s=i;const a=i.hash();for(let t=0;t<n.length;t++){const r=n[t];(0,o.hu)(0===r.status,"tryToSendTransactionQueue_: items in queue should all be run."),r.status=1,r.retryCount++;const i=Ot(e,r.path);s=s.updateChild(i,r.currentOutputSnapshotRaw)}const c=s.val(!0),u=e;t.server_.put(u.toString(),c,(r=>{si(t,"transaction put response",{path:u.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let e=0;e<n.length;e++)n[e].status=2,i=i.concat(Kn(t.serverSyncTree_,n[e].currentWriteId)),n[e].onComplete&&r.push((()=>n[e].onComplete(null,!0,n[e].currentOutputSnapshotResolved))),n[e].unwatcher();fi(t,br(t.transactionQueueTree_,e)),ui(t,t.transactionQueueTree_),zr(t.eventQueue_,e,i);for(let t=0;t<r.length;t++)j(r[t])}else{if("datastale"===r)for(let t=0;t<n.length;t++)3===n[t].status?n[t].status=4:n[t].status=0;else{C("transaction at "+u.toString()+" failed: "+r);for(let t=0;t<n.length;t++)n[t].status=4,n[t].abortReason=r}li(t,e)}}),a)}(t,Ar(e),n)}else wr(e)&&Or(e,(e=>{ui(t,e)}))}function li(t,e){const n=hi(t,e),r=Ar(n);return function(t,e,n){if(0===e.length)return;const r=[];let i=[];const s=e.filter((t=>0===t.status)),a=s.map((t=>t.currentWriteId));for(let s=0;s<e.length;s++){const u=e[s],l=Ot(n,u.path);let h,d=!1;if((0,o.hu)(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===u.status)d=!0,h=u.abortReason,i=i.concat(Kn(t.serverSyncTree_,u.currentWriteId,!0));else if(0===u.status)if(u.retryCount>=Yr)d=!0,h="maxretry",i=i.concat(Kn(t.serverSyncTree_,u.currentWriteId,!0));else{const n=ci(t,u.path,a);u.currentInputSnapshot=n;const r=e[s].update(n.val());if(void 0!==r){Ur("transaction failed: Data returned ",r,u.path);let e=ue(r);"object"==typeof r&&null!=r&&(0,o.r3)(r,".priority")||(e=e.updatePriority(n.getPriority()));const s=u.currentWriteId,c=Xr(t),l=yr(e,n,c);u.currentOutputSnapshotRaw=e,u.currentOutputSnapshotResolved=l,u.currentWriteId=ni(t),a.splice(a.indexOf(s),1),i=i.concat(Yn(t.serverSyncTree_,u.path,l,u.currentWriteId,u.applyLocally)),i=i.concat(Kn(t.serverSyncTree_,s,!0))}else d=!0,h="nodata",i=i.concat(Kn(t.serverSyncTree_,u.currentWriteId,!0))}zr(t.eventQueue_,n,i),i=[],d&&(e[s].status=2,c=e[s].unwatcher,setTimeout(c,Math.floor(0)),e[s].onComplete&&("nodata"===h?r.push((()=>e[s].onComplete(null,!1,e[s].currentInputSnapshot))):r.push((()=>e[s].onComplete(new Error(h),!1,null)))))}var c;fi(t,t.transactionQueueTree_);for(let t=0;t<r.length;t++)j(r[t]);ui(t,t.transactionQueueTree_)}(t,di(t,n),r),r}function hi(t,e){let n,r=t.transactionQueueTree_;for(n=mt(e);null!==n&&void 0===Sr(r);)r=br(r,n),n=mt(e=Et(e));return r}function di(t,e){const n=[];return pi(t,e,n),n.sort(((t,e)=>t.order-e.order)),n}function pi(t,e,n){const r=Sr(e);if(r)for(let t=0;t<r.length;t++)n.push(r[t]);Or(e,(e=>{pi(t,e,n)}))}function fi(t,e){const n=Sr(e);if(n){let t=0;for(let e=0;e<n.length;e++)2!==n[e].status&&(n[t]=n[e],t++);n.length=t,Tr(e,n.length>0?n:void 0)}Or(e,(e=>{fi(t,e)}))}function _i(t,e){const n=Ar(hi(t,e)),r=br(t.transactionQueueTree_,e);return function(t,e,n){let r=n?t:t.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,(e=>{gi(t,e)})),gi(t,r),Cr(r,(e=>{gi(t,e)})),n}function gi(t,e){const n=Sr(e);if(n){const r=[];let i=[],s=-1;for(let e=0;e<n.length;e++)3===n[e].status||(1===n[e].status?((0,o.hu)(s===e-1,"All SENT items should be at beginning of queue."),s=e,n[e].status=3,n[e].abortReason="set"):((0,o.hu)(0===n[e].status,"Unexpected transaction status in abort"),n[e].unwatcher(),i=i.concat(Kn(t.serverSyncTree_,n[e].currentWriteId,!0)),n[e].onComplete&&r.push(n[e].onComplete.bind(null,new Error("set"),!1,null))));-1===s?Tr(e,void 0):n.length=s+1,zr(t.eventQueue_,Ar(e),i);for(let t=0;t<r.length;t++)j(r[t])}}const vi=function(t,e){const n=mi(t),r=n.namespace;"firebase.com"===n.domain&&O(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||O("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&C("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new J(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new gt(n.pathString)}},mi=function(t){let e="",n="",r="",i="",o="",s=!0,a="https",c=443;if("string"==typeof t){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let l=t.indexOf("/");-1===l&&(l=t.length);let h=t.indexOf("?");-1===h&&(h=t.length),e=t.substring(0,Math.min(l,h)),l<h&&(i=function(t){let e="";const n=t.split("/");for(let t=0;t<n.length;t++)if(n[t].length>0){let r=n[t];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(t){}e+="/"+r}return e}(t.substring(l,h)));const d=function(t){const e={};"?"===t.charAt(0)&&(t=t.substring(1));for(const n of t.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):C(`Invalid query segment '${n}' in query '${t}'`)}return e}(t.substring(Math.min(t.length,h)));u=e.indexOf(":"),u>=0?(s="https"===a||"wss"===a,c=parseInt(e.substring(u+1),10)):u=e.length;const p=e.slice(0,u);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{const t=e.indexOf(".");r=e.substring(0,t).toLowerCase(),n=e.substring(t+1),o=r}"ns"in d&&(o=d.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:s,scheme:a,pathString:i,namespace:o}},yi="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Ei=function(){let t=0;const e=[];return function(n){const r=n===t;let i;t=n;const s=new Array(8);for(i=7;i>=0;i--)s[i]=yi.charAt(n%64),n=Math.floor(n/64);(0,o.hu)(0===n,"Cannot push at time == 0");let a=s.join("");if(r){for(i=11;i>=0&&63===e[i];i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)a+=yi.charAt(e[i]);return(0,o.hu)(20===a.length,"nextPushId: Length should be 20."),a}}();class Ii{constructor(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}getPath(){const t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,o.Wl)(this.snapshot.exportVal())}}class bi{constructor(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class Si{constructor(t,e){this.snapshotCallback=t,this.cancelCallback=e}onValue(t,e){this.snapshotCallback.call(null,t,e)}onCancel(t){return(0,o.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}class Ti{constructor(t,e,n,r){this._repo=t,this._path=e,this._queryParams=n,this._orderByCalled=r}get key(){return wt(this._path)?null:It(this._path)}get ref(){return new wi(this._repo,this._path)}get _queryIdentifier(){const t=Ie(this._queryParams),e=L(t);return"{}"===e?"default":e}get _queryObject(){return Ie(this._queryParams)}isEqual(t){if(!((t=(0,o.m9)(t))instanceof Ti))return!1;const e=this._repo===t._repo,n=Ct(this._path,t._path),r=this._queryIdentifier===t._queryIdentifier;return e&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)}}class wi extends Ti{constructor(t,e){super(t,e,new ye,!1)}get parent(){const t=St(this._path);return null===t?null:new wi(this._repo,t)}get root(){let t=this;for(;null!==t.parent;)t=t.parent;return t}}class Oi{constructor(t,e,n){this._node=t,this.ref=e,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const e=new gt(t),n=Ai(this.ref,t);return new Oi(this._node.getChild(e),n,Xt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,((e,n)=>t(new Oi(n,Ai(this.ref,e),Xt))))}hasChild(t){const e=new gt(t);return!this._node.getChild(e).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Ci(t,e){return(t=(0,o.m9)(t))._checkNotDeleted("ref"),void 0!==e?Ai(t._root,e):t._root}function Ai(t,e){return null===mt((t=(0,o.m9)(t))._path)?Mr("child","path",e,!1):Fr("child","path",e,!1),new wi(t._repo,Tt(t._path,e))}function Ri(t,e){t=(0,o.m9)(t),Hr("push",t._path),xr("push",e,t._path,!0);const n=Jr(t._repo),r=Ei(n),i=Ai(t,r),s=Ai(t,r);let a;return a=null!=e?ki(s,e).then((()=>s)):Promise.resolve(s),i.then=a.then.bind(a),i.catch=a.then.bind(a,void 0),i}function ki(t,e){t=(0,o.m9)(t),Hr("set",t._path),xr("set",e,t._path,!1);const n=new o.BH;return ri(t._repo,t._path,e,null,n.wrapCallback((()=>{}))),n.promise}function Di(t){t=(0,o.m9)(t);const e=new Si((()=>{})),n=new Ni(e);return function(t,e,n){const r=er(t.serverSyncTree_,e);return null!=r?Promise.resolve(r):t.server_.get(e).then((r=>{const i=ue(r).withIndex(e._queryParams.getIndex());let o;if(Zn(t.serverSyncTree_,e,n,!0),e._queryParams.loadsAllData())o=Qn(t.serverSyncTree_,e._path,i);else{const n=sr(t.serverSyncTree_,e);o=Xn(t.serverSyncTree_,e._path,i,n)}return zr(t.eventQueue_,e._path,o),Jn(t.serverSyncTree_,e,n,null,!0),i}),(n=>(si(t,"get for query "+(0,o.Wl)(e)+" failed: "+n),Promise.reject(new Error(n)))))}(t._repo,t,n).then((e=>new Oi(e,new wi(t._repo,t._path),t._queryParams.getIndex())))}class Ni{constructor(t){this.callbackContext=t}respondsTo(t){return"value"===t}createEvent(t,e){const n=e._queryParams.getIndex();return new Ii("value",this,new Oi(t.snapshotNode,new wi(e._repo,e._path),n))}getEventRunner(t){return"cancel"===t.getEventType()?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,e){return this.callbackContext.hasCancelCallback?new bi(this,t,e):null}matches(t){return t instanceof Ni&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class Pi{constructor(t,e){this.eventType=t,this.callbackContext=e}respondsTo(t){let e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,this.eventType===e}createCancelEvent(t,e){return this.callbackContext.hasCancelCallback?new bi(this,t,e):null}createEvent(t,e){(0,o.hu)(null!=t.childName,"Child events should have a childName.");const n=Ai(new wi(e._repo,e._path),t.childName),r=e._queryParams.getIndex();return new Ii(t.type,this,new Oi(t.snapshotNode,n,r),t.prevName)}getEventRunner(t){return"cancel"===t.getEventType()?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,t.prevName)}matches(t){return t instanceof Pi&&(this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext)))}hasAnyCallback(){return!!this.callbackContext}}function Li(t,e,n,r,i){let o;if("object"==typeof r&&(o=void 0,i=r),"function"==typeof r&&(o=r),i&&i.onlyOnce){const e=n,r=(n,r)=>{ii(t._repo,t,a),e(n,r)};r.userCallback=n.userCallback,r.context=n.context,n=r}const s=new Si(n,o||void 0),a="value"===e?new Ni(s):new Pi(e,s);return function(t,e,n){let r;r=".info"===mt(e._path)?Zn(t.infoSyncTree_,e,n):Zn(t.serverSyncTree_,e,n),Wr(t.eventQueue_,e._path,r)}(t._repo,t,a),()=>ii(t._repo,t,a)}function xi(t,e,n,r){return Li(t,"value",e,n,r)}function Ui(t,e,n){let r=null;const i=n?new Si(n):null;"value"===e?r=new Ni(i):e&&(r=new Pi(e,i)),ii(t._repo,t,r)}!function(t){(0,o.hu)(!Pn,"__referenceConstructor has already been defined"),Pn=t}(wi),function(t){(0,o.hu)(!Ln,"__referenceConstructor has already been defined"),Ln=t}(wi);const Fi="FIREBASE_DATABASE_EMULATOR_HOST",Mi={};let Hi=!1;function ji(t,e,n,r,i){let o=r||t.options.databaseURL;void 0===o&&(t.options.projectId||O("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),S("Using default host for project ",t.options.projectId),o=`${t.options.projectId}-default-rtdb.firebaseio.com`);let s,a,c=vi(o,i),u=c.repoInfo;"undefined"!=typeof process&&process.env&&(a=process.env[Fi]),a?(s=!0,o=`http://${a}?ns=${u.namespace}`,c=vi(o,i),u=c.repoInfo):s=!c.repoInfo.secure;const l=i&&s?new V(V.OWNER):new z(t.name,t.options,e);jr("Invalid Firebase Database URL",c),wt(c.path)||O("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(t,e,n,r){let i=Mi[e.name];i||(i={},Mi[e.name]=i);let o=i[t.toURLString()];o&&O("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return o=new Kr(t,Hi,n,r),i[t.toURLString()]=o,o}(u,t,l,new W(t.name,n));return new Bi(h,t)}class Bi{constructor(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Qr(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new wi(this._repo,vt())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(t,e){const n=Mi[e];n&&n[t.key]===t||O(`Database ${e}(${t.repoInfo_}) has already been deleted.`),oi(t),delete n[t.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){null===this._rootInternal&&O("Cannot call "+t+" on a deleted database.")}}function Gi(t=(0,r.Mq)(),e){const n=(0,r.qX)(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const t=(0,o.P0)("database");t&&function(t,e,n,r={}){t=(0,o.m9)(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&O("Cannot call useEmulator() after instance has already been initialized.");const i=t._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&O('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new V(V.OWNER);else if(r.mockUserToken){const e="string"==typeof r.mockUserToken?r.mockUserToken:(0,o.Sg)(r.mockUserToken,t.app.options.projectId);s=new V(e)}!function(t,e,n,r){t.repoInfo_=new J(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}(i,e,n,s)}(n,...t)}return n}const Wi={".sv":"timestamp"};function zi(){return Wi}Lt.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},Lt.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var Vi;l(r.Jn),(0,r.Xd)(new i.wA("database",((t,{instanceIdentifier:e})=>ji(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"),t.getProvider("app-check-internal"),e)),"PUBLIC").setMultipleInstances(!0)),(0,r.KN)(a,c,Vi),(0,r.KN)(a,c,"esm2017")},1181:t=>{"use strict";t.exports=JSON.parse('{"dev":{"apiKey":"AIzaSyBp58tvynk0oEJ3N7Tc_0aCd8PEfTbNWHs","authDomain":"gistnote-dev.firebaseapp.com","databaseURL":"https://gistnote-dev.firebaseio.com","storageBucket":"gistnote-dev.appspot.com","projectId":"gistnote-dev","analytics":{"amplitude":"d915a9066cb91b49a61853100eeaae90"}},"staging":{"apiKey":"AIzaSyDe8oqmBd2F638LOPMBs3voqMuYyHb-oBQ","authDomain":"weavatools.firebaseapp.com","databaseURL":"https://writio-1341.firebaseio.com","storageBucket":"writio-1341.appspot.com","projectId":"writio-1341","analytics":{"amplitude":"adc4c4cd02358b8f8ecc7ff38a82f624"}},"prod":{"apiKey":"AIzaSyDe8oqmBd2F638LOPMBs3voqMuYyHb-oBQ","authDomain":"weavatools.firebaseapp.com","databaseURL":"https://writio-1341.firebaseio.com","storageBucket":"writio-1341.appspot.com","projectId":"writio-1341","analytics":{"amplitude":"adc4c4cd02358b8f8ecc7ff38a82f624"}}}')}},o={};function s(t){var e=o[t];if(void 0!==e)return e.exports;var n=o[t]={id:t,loaded:!1,exports:{}};return i[t].call(n.exports,n,n.exports,s),n.loaded=!0,n.exports}s.amdO={},t="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",e="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",n="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",r=t=>{t&&!t.d&&(t.d=1,t.forEach((t=>t.r--)),t.forEach((t=>t.r--?t.r++:t())))},s.a=(i,o,s)=>{var a;s&&((a=[]).d=1);var c,u,l,h=new Set,d=i.exports,p=new Promise(((t,e)=>{l=e,u=t}));p[e]=d,p[t]=t=>(a&&t(a),h.forEach(t),p.catch((t=>{}))),i.exports=p,o((i=>{var o;c=(i=>i.map((i=>{if(null!==i&&"object"==typeof i){if(i[t])return i;if(i.then){var o=[];o.d=0,i.then((t=>{s[e]=t,r(o)}),(t=>{s[n]=t,r(o)}));var s={};return s[t]=t=>t(o),s}}var a={};return a[t]=t=>{},a[e]=i,a})))(i);var s=()=>c.map((t=>{if(t[n])throw t[n];return t[e]})),u=new Promise((e=>{(o=()=>e(s)).r=0;var n=t=>t!==a&&!h.has(t)&&(h.add(t),t&&!t.d&&(o.r++,t.push(o)));c.map((e=>e[t](n)))}));return o.r?u:s()}),(t=>(t?l(p[n]=t):u(d),r(a)))),a&&(a.d=0)},s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var n in e)s.o(e,n)&&!s.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);s(7348)})();